{"ast":null,"code":"var _jsxFileName = \"/home/joshpoms/dndtest2/client/src/Grid.jsx\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { useContext, useMemo, useRef, useState, useEffect } from \"react\";\nimport { useDndContext, useDroppable, DndContext, PointerSensor, useSensor, useSensors, TouchSensor, pointerWithin, rectIntersection } from \"@dnd-kit/core\";\nimport Panel from \"./Panel\";\nimport { GridDataContext } from \"./GridDataContext\";\nimport { GridActionsContext } from \"./GridActionsContext\";\n\n/* ------------------------------------------------------------\n   DROPPABLE GRID CELL\n   ✅ Highlight driven by dnd-kit `isOver` (no cached over state)\n------------------------------------------------------------ */\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction CellDroppable({\n  r,\n  c,\n  dark\n}) {\n  _s();\n  var _active$data, _active$data$current;\n  const {\n    active\n  } = useDndContext();\n  const isPanelDrag = (active === null || active === void 0 ? void 0 : (_active$data = active.data) === null || _active$data === void 0 ? void 0 : (_active$data$current = _active$data.current) === null || _active$data$current === void 0 ? void 0 : _active$data$current.role) === \"panel\";\n  const {\n    setNodeRef,\n    isOver\n  } = useDroppable({\n    id: `cell-${r}-${c}`,\n    data: {\n      role: \"grid:cell\",\n      row: r,\n      col: c\n    }\n  });\n  const highlight = isPanelDrag && isOver;\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    ref: setNodeRef,\n    style: {\n      background: highlight ? \"rgba(50,150,255,0.45)\" : dark ? \"#22272B\" : \"#2C333A\",\n      border: \"1px solid #3F444A\",\n      transition: \"background 80ms\"\n    }\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 34,\n    columnNumber: 5\n  }, this);\n}\n_s(CellDroppable, \"xfLalxbUPsJqilrMIvibg7pdQe4=\", false, function () {\n  return [useDndContext, useDroppable];\n});\n_c = CellDroppable;\nfunction GridInner({\n  components\n}) {\n  _s2();\n  var _grid$rows, _grid$cols;\n  const {\n    state,\n    containersRender,\n    instances,\n    activeId: globalActiveId,\n    activeSize\n  } = useContext(GridDataContext);\n  const {\n    handleDragStart: handleDragStartProp,\n    handleDragOver: handleDragOverProp,\n    handleDragEnd: handleDragEndProp,\n    handleDragCancel: handleDragCancelProp,\n    useRenderCount,\n    dispatch,\n    updatePanel,\n    updateGrid,\n    addContainer,\n    socket\n  } = useContext(GridActionsContext);\n  const sensors = useSensors(useSensor(TouchSensor, {\n    activationConstraint: {\n      delay: 500,\n      tolerance: 8\n    }\n  }), useSensor(PointerSensor));\n  useRenderCount(\"Grid\");\n  const grid = state.grid;\n  const gridId = grid === null || grid === void 0 ? void 0 : grid._id;\n  const rows = (_grid$rows = grid === null || grid === void 0 ? void 0 : grid.rows) !== null && _grid$rows !== void 0 ? _grid$rows : 1;\n  const cols = (_grid$cols = grid === null || grid === void 0 ? void 0 : grid.cols) !== null && _grid$cols !== void 0 ? _grid$cols : 1;\n  const visiblePanels = state.panels.filter(p => p.gridId === gridId);\n  const gridRef = useRef(null);\n  const [activeId, setActiveId] = useState(state.activeId);\n  const [activeData, setActiveData] = useState(null);\n\n  // When true: we keep panel transition off (used by Panel via gridActive)\n  const [panelDragging, setPanelDragging] = useState(false);\n\n  // Track live drag delta for panel placement calculation\n  const panelDragLiveRef = useRef({\n    id: null,\n    dx: 0,\n    dy: 0\n  });\n\n  /* ------------------------------------------------------------\n      GRID SIZE STATE\n  ------------------------------------------------------------ */\n  const ensureSizes = (arr, count) => {\n    if (!Array.isArray(arr) || arr.length === 0) return Array(count).fill(1);\n    if (arr.length === count) return arr;\n    if (arr.length < count) return [...arr, ...Array(count - arr.length).fill(1)];\n    return arr.slice(0, count);\n  };\n  const [colSizes, setColSizes] = useState(() => ensureSizes(grid.colSizes, cols));\n  const [rowSizes, setRowSizes] = useState(() => ensureSizes(grid.rowSizes, rows));\n  useEffect(() => setColSizes(ensureSizes(grid.colSizes, cols)), [grid.colSizes, cols]);\n  useEffect(() => setRowSizes(ensureSizes(grid.rowSizes, rows)), [grid.rowSizes, rows]);\n  useEffect(() => {\n    if (gridRef.current) {\n      gridRef.current.dataset.sizes = JSON.stringify({\n        colSizes,\n        rowSizes\n      });\n    }\n  }, [colSizes, rowSizes]);\n  const colTemplate = colSizes.map(s => `${s}fr`).join(\" \");\n  const rowTemplate = rowSizes.map(s => `${s}fr`).join(\" \");\n\n  /* ------------------------------------------------------------\n      ✅ COLLISION DETECTION\n      Panels: only pointerWithin grid cells (prevents schedule stealing \"over\")\n      Others: keep normal rectIntersection behavior\n  ------------------------------------------------------------ */\n  const collisionDetection = useMemo(() => {\n    return args => {\n      var _args$active, _args$active$data, _args$active$data$cur;\n      const activeRole = (_args$active = args.active) === null || _args$active === void 0 ? void 0 : (_args$active$data = _args$active.data) === null || _args$active$data === void 0 ? void 0 : (_args$active$data$cur = _args$active$data.current) === null || _args$active$data$cur === void 0 ? void 0 : _args$active$data$cur.role;\n      if (activeRole === \"panel\") {\n        const pointerHits = pointerWithin(args);\n        const cellHits = pointerHits.filter(hit => {\n          var _args$droppableContai, _args$droppableContai2, _args$droppableContai3;\n          const role = (_args$droppableContai = args.droppableContainers.find(d => d.id === hit.id)) === null || _args$droppableContai === void 0 ? void 0 : (_args$droppableContai2 = _args$droppableContai.data) === null || _args$droppableContai2 === void 0 ? void 0 : (_args$droppableContai3 = _args$droppableContai2.current) === null || _args$droppableContai3 === void 0 ? void 0 : _args$droppableContai3.role;\n          return role === \"grid:cell\";\n        });\n        return cellHits.length ? [cellHits[0]] : [];\n      }\n      return rectIntersection(args);\n    };\n  }, []);\n  const getPanel = id => visiblePanels.find(p => p.id === id);\n  const clamp = (n, min, max) => Math.max(min, Math.min(n, max));\n  const getCellFromPointer = (clientX, clientY) => {\n    if (!gridRef.current) return {\n      row: 0,\n      col: 0\n    };\n    const rect = gridRef.current.getBoundingClientRect();\n    const x = clamp(clientX - rect.left, 0, rect.width - 1);\n    const y = clamp(clientY - rect.top, 0, rect.height - 1);\n    const totalCols = colSizes.reduce((a, b) => a + b, 0);\n    const totalRows = rowSizes.reduce((a, b) => a + b, 0);\n    let col = colSizes.length - 1;\n    let acc = 0;\n    for (let i = 0; i < colSizes.length; i++) {\n      acc += colSizes[i] / totalCols * rect.width;\n      if (x < acc) {\n        col = i;\n        break;\n      }\n    }\n    let row = rowSizes.length - 1;\n    acc = 0;\n    for (let i = 0; i < rowSizes.length; i++) {\n      acc += rowSizes[i] / totalRows * rect.height;\n      if (y < acc) {\n        row = i;\n        break;\n      }\n    }\n    return {\n      row,\n      col\n    };\n  };\n\n  /* ------------------------------------------------------------\n      DRAG START\n  ------------------------------------------------------------ */\n  const handleDragStart = event => {\n    setActiveId(event.active.id);\n    setActiveData(event.active.data.current);\n    const data = event.active.data.current;\n    if ((data === null || data === void 0 ? void 0 : data.role) === \"panel\") {\n      setPanelDragging(true);\n      return;\n    }\n    handleDragStartProp === null || handleDragStartProp === void 0 ? void 0 : handleDragStartProp(event);\n  };\n\n  /* ------------------------------------------------------------\n      DRAG END (Panels)\n      - Commit placement from activator point + delta\n      - Turn off panelDragging next frame to avoid snap animation\n  ------------------------------------------------------------ */\n  const sanitizePanelPlacement = (panel, rows, cols) => ({\n    ...panel,\n    row: Math.max(0, Math.min(panel.row, rows - 1)),\n    col: Math.max(0, Math.min(panel.col, cols - 1)),\n    width: panel.width,\n    height: panel.height\n  });\n  const handleDragOver = event => {\n    // keep existing task behavior\n    handleDragOverProp === null || handleDragOverProp === void 0 ? void 0 : handleDragOverProp(event);\n    // (no panel highlight state here; cells use isOver)\n  };\n  const handleDragEnd = event => {\n    var _active$data2, _event$activatorEvent, _event$activatorEvent2, _event$activatorEvent3, _event$activatorEvent4, _event$activatorEvent5, _event$activatorEvent6, _event$activatorEvent7, _event$activatorEvent8, _event$activatorEvent9, _event$activatorEvent0;\n    const {\n      active\n    } = event;\n    const data = active === null || active === void 0 ? void 0 : (_active$data2 = active.data) === null || _active$data2 === void 0 ? void 0 : _active$data2.current;\n    setActiveId(null);\n    requestAnimationFrame(() => setPanelDragging(false));\n    if (!data) return;\n    if (data.role !== \"panel\") {\n      handleDragEndProp === null || handleDragEndProp === void 0 ? void 0 : handleDragEndProp(event);\n      return;\n    }\n    const panel = getPanel(active.id);\n    if (!panel) return;\n    const startX = (_event$activatorEvent = (_event$activatorEvent2 = event.activatorEvent) === null || _event$activatorEvent2 === void 0 ? void 0 : _event$activatorEvent2.clientX) !== null && _event$activatorEvent !== void 0 ? _event$activatorEvent : (_event$activatorEvent3 = event.activatorEvent) === null || _event$activatorEvent3 === void 0 ? void 0 : (_event$activatorEvent4 = _event$activatorEvent3.touches) === null || _event$activatorEvent4 === void 0 ? void 0 : (_event$activatorEvent5 = _event$activatorEvent4[0]) === null || _event$activatorEvent5 === void 0 ? void 0 : _event$activatorEvent5.clientX;\n    const startY = (_event$activatorEvent6 = (_event$activatorEvent7 = event.activatorEvent) === null || _event$activatorEvent7 === void 0 ? void 0 : _event$activatorEvent7.clientY) !== null && _event$activatorEvent6 !== void 0 ? _event$activatorEvent6 : (_event$activatorEvent8 = event.activatorEvent) === null || _event$activatorEvent8 === void 0 ? void 0 : (_event$activatorEvent9 = _event$activatorEvent8.touches) === null || _event$activatorEvent9 === void 0 ? void 0 : (_event$activatorEvent0 = _event$activatorEvent9[0]) === null || _event$activatorEvent0 === void 0 ? void 0 : _event$activatorEvent0.clientY;\n    if (typeof startX !== \"number\" || typeof startY !== \"number\") return;\n    const pointerX = startX + panelDragLiveRef.current.dx;\n    const pointerY = startY + panelDragLiveRef.current.dy;\n    const {\n      row,\n      col\n    } = getCellFromPointer(pointerX, pointerY);\n    const updated = sanitizePanelPlacement({\n      ...panel,\n      row,\n      col\n    }, rows, cols);\n    dispatch(updatePanel(updated));\n    socket.emit(\"update_panel\", {\n      panel: updated,\n      gridId\n    });\n    panelDragLiveRef.current = {\n      id: null,\n      dx: 0,\n      dy: 0\n    };\n  };\n  const handleDragMove = event => {\n    var _event$active, _event$active$data;\n    const data = (_event$active = event.active) === null || _event$active === void 0 ? void 0 : (_event$active$data = _event$active.data) === null || _event$active$data === void 0 ? void 0 : _event$active$data.current;\n    if (!data || data.role !== \"panel\") return;\n    panelDragLiveRef.current.id = data.panelId;\n    panelDragLiveRef.current.dx = event.delta.x;\n    panelDragLiveRef.current.dy = event.delta.y;\n  };\n  const handleDragCancel = event => {\n    setActiveId(null);\n    requestAnimationFrame(() => setPanelDragging(false));\n    handleDragCancelProp === null || handleDragCancelProp === void 0 ? void 0 : handleDragCancelProp(event);\n  };\n\n  /* ------------------------------------------------------------\n      GRID RESIZING (unchanged)\n  ------------------------------------------------------------ */\n  const resizePendingRef = useRef({\n    rowSizes: null,\n    colSizes: null\n  });\n  const finalizeResize = () => {\n    var _state$grid, _pending$rowSizes, _pending$colSizes, _pending$rowSizes2, _pending$colSizes2;\n    const pending = resizePendingRef.current;\n    if (!pending.rowSizes && !pending.colSizes) return;\n    if (!((_state$grid = state.grid) !== null && _state$grid !== void 0 && _state$grid._id)) return;\n    dispatch(updateGrid({\n      _id: state.grid._id,\n      rows: state.grid.rows,\n      cols: state.grid.cols,\n      rowSizes: (_pending$rowSizes = pending.rowSizes) !== null && _pending$rowSizes !== void 0 ? _pending$rowSizes : rowSizes,\n      colSizes: (_pending$colSizes = pending.colSizes) !== null && _pending$colSizes !== void 0 ? _pending$colSizes : colSizes\n    }));\n    socket.emit(\"update_grid\", {\n      gridId: state.grid._id,\n      grid: {\n        _id: state.grid._id,\n        rows: state.grid.rows,\n        cols: state.grid.cols,\n        rowSizes: (_pending$rowSizes2 = pending.rowSizes) !== null && _pending$rowSizes2 !== void 0 ? _pending$rowSizes2 : rowSizes,\n        colSizes: (_pending$colSizes2 = pending.colSizes) !== null && _pending$colSizes2 !== void 0 ? _pending$colSizes2 : colSizes\n      }\n    });\n    resizePendingRef.current = {\n      rowSizes: null,\n      colSizes: null\n    };\n  };\n  const getGridWidth = () => {\n    var _gridRef$current;\n    return ((_gridRef$current = gridRef.current) === null || _gridRef$current === void 0 ? void 0 : _gridRef$current.clientWidth) || 1;\n  };\n  const getGridHeight = () => {\n    var _gridRef$current2;\n    return ((_gridRef$current2 = gridRef.current) === null || _gridRef$current2 === void 0 ? void 0 : _gridRef$current2.clientHeight) || 1;\n  };\n  const resizeColumn = (i, pixelDelta) => {\n    const gridWidth = getGridWidth();\n    setColSizes(sizes => {\n      const next = i + 1;\n      if (next >= sizes.length) return sizes;\n      const total = sizes.reduce((a, b) => a + b, 0);\n      const frDelta = pixelDelta / gridWidth * total;\n      const copy = [...sizes];\n      copy[i] = Math.max(0.3, copy[i] + frDelta);\n      copy[next] = Math.max(0.3, copy[next] - frDelta);\n      resizePendingRef.current.colSizes = copy;\n      return copy;\n    });\n  };\n  const resizeRow = (i, pixelDelta) => {\n    const gridHeight = getGridHeight();\n    setRowSizes(sizes => {\n      const next = i + 1;\n      if (next >= sizes.length) return sizes;\n      const total = sizes.reduce((a, b) => a + b, 0);\n      const frDelta = pixelDelta / gridHeight * total;\n      const copy = [...sizes];\n      copy[i] = Math.max(0.3, copy[i] + frDelta);\n      copy[next] = Math.max(0.3, copy[next] - frDelta);\n      resizePendingRef.current.rowSizes = copy;\n      return copy;\n    });\n  };\n  const getClientX = e => e.touches ? e.touches[0].clientX : e.clientX;\n  const getClientY = e => e.touches ? e.touches[0].clientY : e.clientY;\n  const getColPosition = i => {\n    const total = colSizes.reduce((a, b) => a + b, 0);\n    const before = colSizes.slice(0, i + 1).reduce((a, b) => a + b, 0);\n    return before / total * 100;\n  };\n  const getRowPosition = i => {\n    const total = rowSizes.reduce((a, b) => a + b, 0);\n    const before = rowSizes.slice(0, i + 1).reduce((a, b) => a + b, 0);\n    return before / total * 100;\n  };\n  const startColResize = (e, i) => {\n    e.preventDefault();\n    let startX = getClientX(e);\n    const move = ev => {\n      ev.preventDefault();\n      const currentX = getClientX(ev);\n      const delta = currentX - startX;\n      startX = currentX;\n      resizeColumn(i, delta);\n    };\n    const stop = () => {\n      window.removeEventListener(\"mousemove\", move);\n      window.removeEventListener(\"mouseup\", stop);\n      window.removeEventListener(\"touchmove\", move);\n      window.removeEventListener(\"touchend\", stop);\n      finalizeResize();\n    };\n    window.addEventListener(\"mousemove\", move);\n    window.addEventListener(\"mouseup\", stop);\n    window.addEventListener(\"touchmove\", move);\n    window.addEventListener(\"touchend\", stop);\n  };\n  const startRowResize = (e, i) => {\n    e.preventDefault();\n    let startY = getClientY(e);\n    const move = ev => {\n      ev.preventDefault();\n      const currentY = getClientY(ev);\n      const delta = currentY - startY;\n      startY = currentY;\n      resizeRow(i, delta);\n    };\n    const stop = () => {\n      window.removeEventListener(\"mousemove\", move);\n      window.removeEventListener(\"mouseup\", stop);\n      window.removeEventListener(\"touchmove\", move);\n      window.removeEventListener(\"touchend\", stop);\n      finalizeResize();\n    };\n    window.addEventListener(\"mousemove\", move);\n    window.addEventListener(\"mouseup\", stop);\n    window.addEventListener(\"touchmove\", move);\n    window.addEventListener(\"touchend\", stop);\n  };\n  if (!(grid !== null && grid !== void 0 && grid._id)) return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: \"Loading grid\\u2026\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 414,\n    columnNumber: 26\n  }, this);\n  return /*#__PURE__*/_jsxDEV(DndContext, {\n    sensors: sensors,\n    collisionDetection: collisionDetection,\n    onDragStart: handleDragStart,\n    onDragMove: handleDragMove,\n    onDragEnd: handleDragEnd,\n    onDragOver: handleDragOver,\n    onDragCancel: handleDragCancel,\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        position: \"absolute\",\n        inset: 0,\n        background: \"#1D2125\",\n        overflow: \"hidden\"\n      },\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        ref: gridRef,\n        style: {\n          position: \"absolute\",\n          inset: 0,\n          display: \"grid\",\n          gridTemplateColumns: colTemplate,\n          gridTemplateRows: rowTemplate,\n          width: \"100%\",\n          height: \"93vh\",\n          overflow: \"hidden\",\n          touchAction: \"none\",\n          overscrollBehaviorY: \"none\"\n        },\n        children: [[...Array(rows)].map((_, r) => [...Array(cols)].map((_, c) => {\n          const dark = (r + c) % 2 === 0;\n          return /*#__PURE__*/_jsxDEV(CellDroppable, {\n            r: r,\n            c: c,\n            dark: dark\n          }, `${r}-${c}`, false, {\n            fileName: _jsxFileName,\n            lineNumber: 452,\n            columnNumber: 22\n          }, this);\n        })), [...Array(cols - 1)].map((_, i) => /*#__PURE__*/_jsxDEV(\"div\", {\n          onMouseDown: e => startColResize(e, i),\n          onTouchStart: e => startColResize(e, i),\n          style: {\n            position: \"absolute\",\n            top: 0,\n            bottom: 0,\n            left: `${getColPosition(i)}%`,\n            width: 6,\n            marginLeft: -3,\n            cursor: \"col-resize\",\n            zIndex: 50,\n            background: \"transparent\"\n          }\n        }, `col-resize-${i}`, false, {\n          fileName: _jsxFileName,\n          lineNumber: 458,\n          columnNumber: 13\n        }, this)), [...Array(rows - 1)].map((_, i) => /*#__PURE__*/_jsxDEV(\"div\", {\n          onMouseDown: e => startRowResize(e, i),\n          onTouchStart: e => startRowResize(e, i),\n          style: {\n            position: \"absolute\",\n            left: 0,\n            right: 0,\n            top: `${getRowPosition(i)}%`,\n            height: 6,\n            marginTop: -3,\n            cursor: \"row-resize\",\n            zIndex: 50,\n            background: \"transparent\"\n          }\n        }, `row-resize-${i}`, false, {\n          fileName: _jsxFileName,\n          lineNumber: 478,\n          columnNumber: 13\n        }, this)), visiblePanels.map(p => /*#__PURE__*/_jsxDEV(Panel, {\n          panel: p,\n          dispatch: dispatch,\n          gridRef: gridRef,\n          cols: cols,\n          rows: rows,\n          activeId: activeId,\n          components: components,\n          gridActive: panelDragging // Panel should disable transitions when true\n          ,\n          addContainer: addContainer\n        }, p.id, false, {\n          fileName: _jsxFileName,\n          lineNumber: 498,\n          columnNumber: 13\n        }, this))]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 434,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 426,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 417,\n    columnNumber: 5\n  }, this);\n}\n_s2(GridInner, \"xuQ4XAYboqNf3atcY/AODXE86rA=\", false, function () {\n  return [useSensors, useSensor, useSensor, useRenderCount];\n});\n_c2 = GridInner;\nexport default _c3 = /*#__PURE__*/React.memo(GridInner);\nvar _c, _c2, _c3;\n$RefreshReg$(_c, \"CellDroppable\");\n$RefreshReg$(_c2, \"GridInner\");\n$RefreshReg$(_c3, \"%default%\");","map":{"version":3,"names":["React","useContext","useMemo","useRef","useState","useEffect","useDndContext","useDroppable","DndContext","PointerSensor","useSensor","useSensors","TouchSensor","pointerWithin","rectIntersection","Panel","GridDataContext","GridActionsContext","jsxDEV","_jsxDEV","CellDroppable","r","c","dark","_s","_active$data","_active$data$current","active","isPanelDrag","data","current","role","setNodeRef","isOver","id","row","col","highlight","ref","style","background","border","transition","fileName","_jsxFileName","lineNumber","columnNumber","_c","GridInner","components","_s2","_grid$rows","_grid$cols","state","containersRender","instances","activeId","globalActiveId","activeSize","handleDragStart","handleDragStartProp","handleDragOver","handleDragOverProp","handleDragEnd","handleDragEndProp","handleDragCancel","handleDragCancelProp","useRenderCount","dispatch","updatePanel","updateGrid","addContainer","socket","sensors","activationConstraint","delay","tolerance","grid","gridId","_id","rows","cols","visiblePanels","panels","filter","p","gridRef","setActiveId","activeData","setActiveData","panelDragging","setPanelDragging","panelDragLiveRef","dx","dy","ensureSizes","arr","count","Array","isArray","length","fill","slice","colSizes","setColSizes","rowSizes","setRowSizes","dataset","sizes","JSON","stringify","colTemplate","map","s","join","rowTemplate","collisionDetection","args","_args$active","_args$active$data","_args$active$data$cur","activeRole","pointerHits","cellHits","hit","_args$droppableContai","_args$droppableContai2","_args$droppableContai3","droppableContainers","find","d","getPanel","clamp","n","min","max","Math","getCellFromPointer","clientX","clientY","rect","getBoundingClientRect","x","left","width","y","top","height","totalCols","reduce","a","b","totalRows","acc","i","event","sanitizePanelPlacement","panel","_active$data2","_event$activatorEvent","_event$activatorEvent2","_event$activatorEvent3","_event$activatorEvent4","_event$activatorEvent5","_event$activatorEvent6","_event$activatorEvent7","_event$activatorEvent8","_event$activatorEvent9","_event$activatorEvent0","requestAnimationFrame","startX","activatorEvent","touches","startY","pointerX","pointerY","updated","emit","handleDragMove","_event$active","_event$active$data","panelId","delta","resizePendingRef","finalizeResize","_state$grid","_pending$rowSizes","_pending$colSizes","_pending$rowSizes2","_pending$colSizes2","pending","getGridWidth","_gridRef$current","clientWidth","getGridHeight","_gridRef$current2","clientHeight","resizeColumn","pixelDelta","gridWidth","next","total","frDelta","copy","resizeRow","gridHeight","getClientX","e","getClientY","getColPosition","before","getRowPosition","startColResize","preventDefault","move","ev","currentX","stop","window","removeEventListener","addEventListener","startRowResize","currentY","children","onDragStart","onDragMove","onDragEnd","onDragOver","onDragCancel","position","inset","overflow","display","gridTemplateColumns","gridTemplateRows","touchAction","overscrollBehaviorY","_","onMouseDown","onTouchStart","bottom","marginLeft","cursor","zIndex","right","marginTop","gridActive","_c2","_c3","memo","$RefreshReg$"],"sources":["/home/joshpoms/dndtest2/client/src/Grid.jsx"],"sourcesContent":["import React, { useContext, useMemo, useRef, useState, useEffect } from \"react\";\nimport {\n  useDndContext,\n  useDroppable,\n  DndContext,\n  PointerSensor,\n  useSensor,\n  useSensors,\n  TouchSensor,\n  pointerWithin,\n  rectIntersection,\n} from \"@dnd-kit/core\";\n\nimport Panel from \"./Panel\";\nimport { GridDataContext } from \"./GridDataContext\";\nimport { GridActionsContext } from \"./GridActionsContext\";\n\n/* ------------------------------------------------------------\n   DROPPABLE GRID CELL\n   ✅ Highlight driven by dnd-kit `isOver` (no cached over state)\n------------------------------------------------------------ */\nfunction CellDroppable({ r, c, dark }) {\n  const { active } = useDndContext();\n  const isPanelDrag = active?.data?.current?.role === \"panel\";\n\n  const { setNodeRef, isOver } = useDroppable({\n    id: `cell-${r}-${c}`,\n    data: { role: \"grid:cell\", row: r, col: c },\n  });\n\n  const highlight = isPanelDrag && isOver;\n\n  return (\n    <div\n      ref={setNodeRef}\n      style={{\n        background: highlight\n          ? \"rgba(50,150,255,0.45)\"\n          : dark\n          ? \"#22272B\"\n          : \"#2C333A\",\n        border: \"1px solid #3F444A\",\n        transition: \"background 80ms\",\n      }}\n    />\n  );\n}\n\nfunction GridInner({ components }) {\n  const { state, containersRender, instances, activeId: globalActiveId, activeSize } =\n    useContext(GridDataContext);\n\n  const {\n    handleDragStart: handleDragStartProp,\n    handleDragOver: handleDragOverProp,\n    handleDragEnd: handleDragEndProp,\n    handleDragCancel: handleDragCancelProp,\n    useRenderCount,\n    dispatch,\n    updatePanel,\n    updateGrid,\n    addContainer,\n    socket,\n  } = useContext(GridActionsContext);\n\n  const sensors = useSensors(\n    useSensor(TouchSensor, {\n      activationConstraint: { delay: 500, tolerance: 8 },\n    }),\n    useSensor(PointerSensor)\n  );\n\n  useRenderCount(\"Grid\");\n\n  const grid = state.grid;\n  const gridId = grid?._id;\n  const rows = grid?.rows ?? 1;\n  const cols = grid?.cols ?? 1;\n\n  const visiblePanels = state.panels.filter((p) => p.gridId === gridId);\n\n  const gridRef = useRef(null);\n  const [activeId, setActiveId] = useState(state.activeId);\n  const [activeData, setActiveData] = useState(null);\n\n  // When true: we keep panel transition off (used by Panel via gridActive)\n  const [panelDragging, setPanelDragging] = useState(false);\n\n  // Track live drag delta for panel placement calculation\n  const panelDragLiveRef = useRef({ id: null, dx: 0, dy: 0 });\n\n  /* ------------------------------------------------------------\n      GRID SIZE STATE\n  ------------------------------------------------------------ */\n  const ensureSizes = (arr, count) => {\n    if (!Array.isArray(arr) || arr.length === 0) return Array(count).fill(1);\n    if (arr.length === count) return arr;\n    if (arr.length < count)\n      return [...arr, ...Array(count - arr.length).fill(1)];\n    return arr.slice(0, count);\n  };\n\n  const [colSizes, setColSizes] = useState(() =>\n    ensureSizes(grid.colSizes, cols)\n  );\n  const [rowSizes, setRowSizes] = useState(() =>\n    ensureSizes(grid.rowSizes, rows)\n  );\n\n  useEffect(() => setColSizes(ensureSizes(grid.colSizes, cols)), [grid.colSizes, cols]);\n  useEffect(() => setRowSizes(ensureSizes(grid.rowSizes, rows)), [grid.rowSizes, rows]);\n\n  useEffect(() => {\n    if (gridRef.current) {\n      gridRef.current.dataset.sizes = JSON.stringify({ colSizes, rowSizes });\n    }\n  }, [colSizes, rowSizes]);\n\n  const colTemplate = colSizes.map((s) => `${s}fr`).join(\" \");\n  const rowTemplate = rowSizes.map((s) => `${s}fr`).join(\" \");\n\n  /* ------------------------------------------------------------\n      ✅ COLLISION DETECTION\n      Panels: only pointerWithin grid cells (prevents schedule stealing \"over\")\n      Others: keep normal rectIntersection behavior\n  ------------------------------------------------------------ */\n  const collisionDetection = useMemo(() => {\n    return (args) => {\n      const activeRole = args.active?.data?.current?.role;\n\n      if (activeRole === \"panel\") {\n        const pointerHits = pointerWithin(args);\n\n        const cellHits = pointerHits.filter((hit) => {\n          const role = args.droppableContainers.find((d) => d.id === hit.id)\n            ?.data?.current?.role;\n          return role === \"grid:cell\";\n        });\n\n        return cellHits.length ? [cellHits[0]] : [];\n      }\n\n      return rectIntersection(args);\n    };\n  }, []);\n\n  const getPanel = (id) => visiblePanels.find((p) => p.id === id);\n  const clamp = (n, min, max) => Math.max(min, Math.min(n, max));\n\n  const getCellFromPointer = (clientX, clientY) => {\n    if (!gridRef.current) return { row: 0, col: 0 };\n\n    const rect = gridRef.current.getBoundingClientRect();\n\n    const x = clamp(clientX - rect.left, 0, rect.width - 1);\n    const y = clamp(clientY - rect.top, 0, rect.height - 1);\n\n    const totalCols = colSizes.reduce((a, b) => a + b, 0);\n    const totalRows = rowSizes.reduce((a, b) => a + b, 0);\n\n    let col = colSizes.length - 1;\n    let acc = 0;\n    for (let i = 0; i < colSizes.length; i++) {\n      acc += (colSizes[i] / totalCols) * rect.width;\n      if (x < acc) {\n        col = i;\n        break;\n      }\n    }\n\n    let row = rowSizes.length - 1;\n    acc = 0;\n    for (let i = 0; i < rowSizes.length; i++) {\n      acc += (rowSizes[i] / totalRows) * rect.height;\n      if (y < acc) {\n        row = i;\n        break;\n      }\n    }\n\n    return { row, col };\n  };\n\n  /* ------------------------------------------------------------\n      DRAG START\n  ------------------------------------------------------------ */\n  const handleDragStart = (event) => {\n    setActiveId(event.active.id);\n    setActiveData(event.active.data.current);\n\n    const data = event.active.data.current;\n\n    if (data?.role === \"panel\") {\n      setPanelDragging(true);\n      return;\n    }\n\n    handleDragStartProp?.(event);\n  };\n\n  /* ------------------------------------------------------------\n      DRAG END (Panels)\n      - Commit placement from activator point + delta\n      - Turn off panelDragging next frame to avoid snap animation\n  ------------------------------------------------------------ */\n  const sanitizePanelPlacement = (panel, rows, cols) => ({\n    ...panel,\n    row: Math.max(0, Math.min(panel.row, rows - 1)),\n    col: Math.max(0, Math.min(panel.col, cols - 1)),\n    width: panel.width,\n    height: panel.height,\n  });\n\n  const handleDragOver = (event) => {\n    // keep existing task behavior\n    handleDragOverProp?.(event);\n    // (no panel highlight state here; cells use isOver)\n  };\n\n  const handleDragEnd = (event) => {\n    const { active } = event;\n    const data = active?.data?.current;\n\n    setActiveId(null);\n    requestAnimationFrame(() => setPanelDragging(false));\n\n    if (!data) return;\n\n    if (data.role !== \"panel\") {\n      handleDragEndProp?.(event);\n      return;\n    }\n\n    const panel = getPanel(active.id);\n    if (!panel) return;\n\n    const startX =\n      event.activatorEvent?.clientX ??\n      event.activatorEvent?.touches?.[0]?.clientX;\n    const startY =\n      event.activatorEvent?.clientY ??\n      event.activatorEvent?.touches?.[0]?.clientY;\n\n    if (typeof startX !== \"number\" || typeof startY !== \"number\") return;\n\n    const pointerX = startX + panelDragLiveRef.current.dx;\n    const pointerY = startY + panelDragLiveRef.current.dy;\n\n    const { row, col } = getCellFromPointer(pointerX, pointerY);\n\n    const updated = sanitizePanelPlacement({ ...panel, row, col }, rows, cols);\n\n    dispatch(updatePanel(updated));\n    socket.emit(\"update_panel\", { panel: updated, gridId });\n\n    panelDragLiveRef.current = { id: null, dx: 0, dy: 0 };\n  };\n\n  const handleDragMove = (event) => {\n    const data = event.active?.data?.current;\n    if (!data || data.role !== \"panel\") return;\n\n    panelDragLiveRef.current.id = data.panelId;\n    panelDragLiveRef.current.dx = event.delta.x;\n    panelDragLiveRef.current.dy = event.delta.y;\n  };\n\n  const handleDragCancel = (event) => {\n    setActiveId(null);\n    requestAnimationFrame(() => setPanelDragging(false));\n    handleDragCancelProp?.(event);\n  };\n\n  /* ------------------------------------------------------------\n      GRID RESIZING (unchanged)\n  ------------------------------------------------------------ */\n  const resizePendingRef = useRef({ rowSizes: null, colSizes: null });\n\n  const finalizeResize = () => {\n    const pending = resizePendingRef.current;\n    if (!pending.rowSizes && !pending.colSizes) return;\n    if (!state.grid?._id) return;\n\n    dispatch(\n      updateGrid({\n        _id: state.grid._id,\n        rows: state.grid.rows,\n        cols: state.grid.cols,\n        rowSizes: pending.rowSizes ?? rowSizes,\n        colSizes: pending.colSizes ?? colSizes,\n      })\n    );\n\n    socket.emit(\"update_grid\", {\n      gridId: state.grid._id,\n      grid: {\n        _id: state.grid._id,\n        rows: state.grid.rows,\n        cols: state.grid.cols,\n        rowSizes: pending.rowSizes ?? rowSizes,\n        colSizes: pending.colSizes ?? colSizes,\n      },\n    });\n\n    resizePendingRef.current = { rowSizes: null, colSizes: null };\n  };\n\n  const getGridWidth = () => gridRef.current?.clientWidth || 1;\n  const getGridHeight = () => gridRef.current?.clientHeight || 1;\n\n  const resizeColumn = (i, pixelDelta) => {\n    const gridWidth = getGridWidth();\n    setColSizes((sizes) => {\n      const next = i + 1;\n      if (next >= sizes.length) return sizes;\n\n      const total = sizes.reduce((a, b) => a + b, 0);\n      const frDelta = (pixelDelta / gridWidth) * total;\n\n      const copy = [...sizes];\n      copy[i] = Math.max(0.3, copy[i] + frDelta);\n      copy[next] = Math.max(0.3, copy[next] - frDelta);\n\n      resizePendingRef.current.colSizes = copy;\n      return copy;\n    });\n  };\n\n  const resizeRow = (i, pixelDelta) => {\n    const gridHeight = getGridHeight();\n    setRowSizes((sizes) => {\n      const next = i + 1;\n      if (next >= sizes.length) return sizes;\n\n      const total = sizes.reduce((a, b) => a + b, 0);\n      const frDelta = (pixelDelta / gridHeight) * total;\n\n      const copy = [...sizes];\n      copy[i] = Math.max(0.3, copy[i] + frDelta);\n      copy[next] = Math.max(0.3, copy[next] - frDelta);\n\n      resizePendingRef.current.rowSizes = copy;\n      return copy;\n    });\n  };\n\n  const getClientX = (e) => (e.touches ? e.touches[0].clientX : e.clientX);\n  const getClientY = (e) => (e.touches ? e.touches[0].clientY : e.clientY);\n\n  const getColPosition = (i) => {\n    const total = colSizes.reduce((a, b) => a + b, 0);\n    const before = colSizes.slice(0, i + 1).reduce((a, b) => a + b, 0);\n    return (before / total) * 100;\n  };\n\n  const getRowPosition = (i) => {\n    const total = rowSizes.reduce((a, b) => a + b, 0);\n    const before = rowSizes.slice(0, i + 1).reduce((a, b) => a + b, 0);\n    return (before / total) * 100;\n  };\n\n  const startColResize = (e, i) => {\n    e.preventDefault();\n    let startX = getClientX(e);\n\n    const move = (ev) => {\n      ev.preventDefault();\n      const currentX = getClientX(ev);\n      const delta = currentX - startX;\n      startX = currentX;\n      resizeColumn(i, delta);\n    };\n\n    const stop = () => {\n      window.removeEventListener(\"mousemove\", move);\n      window.removeEventListener(\"mouseup\", stop);\n      window.removeEventListener(\"touchmove\", move);\n      window.removeEventListener(\"touchend\", stop);\n      finalizeResize();\n    };\n\n    window.addEventListener(\"mousemove\", move);\n    window.addEventListener(\"mouseup\", stop);\n    window.addEventListener(\"touchmove\", move);\n    window.addEventListener(\"touchend\", stop);\n  };\n\n  const startRowResize = (e, i) => {\n    e.preventDefault();\n    let startY = getClientY(e);\n\n    const move = (ev) => {\n      ev.preventDefault();\n      const currentY = getClientY(ev);\n      const delta = currentY - startY;\n      startY = currentY;\n      resizeRow(i, delta);\n    };\n\n    const stop = () => {\n      window.removeEventListener(\"mousemove\", move);\n      window.removeEventListener(\"mouseup\", stop);\n      window.removeEventListener(\"touchmove\", move);\n      window.removeEventListener(\"touchend\", stop);\n      finalizeResize();\n    };\n\n    window.addEventListener(\"mousemove\", move);\n    window.addEventListener(\"mouseup\", stop);\n    window.addEventListener(\"touchmove\", move);\n    window.addEventListener(\"touchend\", stop);\n  };\n\n  if (!grid?._id) return <div>Loading grid…</div>;\n\n  return (\n    <DndContext\n      sensors={sensors}\n      collisionDetection={collisionDetection}\n      onDragStart={handleDragStart}\n      onDragMove={handleDragMove}\n      onDragEnd={handleDragEnd}\n      onDragOver={handleDragOver}\n      onDragCancel={handleDragCancel}\n    >\n      <div\n        style={{\n          position: \"absolute\",\n          inset: 0,\n          background: \"#1D2125\",\n          overflow: \"hidden\",\n        }}\n      >\n        <div\n          ref={gridRef}\n          style={{\n            position: \"absolute\",\n            inset: 0,\n            display: \"grid\",\n            gridTemplateColumns: colTemplate,\n            gridTemplateRows: rowTemplate,\n            width: \"100%\",\n            height: \"93vh\",\n            overflow: \"hidden\",\n            touchAction: \"none\",\n            overscrollBehaviorY: \"none\",\n          }}\n        >\n          {[...Array(rows)].map((_, r) =>\n            [...Array(cols)].map((_, c) => {\n              const dark = (r + c) % 2 === 0;\n              return <CellDroppable key={`${r}-${c}`} r={r} c={c} dark={dark} />;\n            })\n          )}\n\n          {/* Vertical resizers */}\n          {[...Array(cols - 1)].map((_, i) => (\n            <div\n              key={`col-resize-${i}`}\n              onMouseDown={(e) => startColResize(e, i)}\n              onTouchStart={(e) => startColResize(e, i)}\n              style={{\n                position: \"absolute\",\n                top: 0,\n                bottom: 0,\n                left: `${getColPosition(i)}%`,\n                width: 6,\n                marginLeft: -3,\n                cursor: \"col-resize\",\n                zIndex: 50,\n                background: \"transparent\",\n              }}\n            />\n          ))}\n\n          {/* Row resizers */}\n          {[...Array(rows - 1)].map((_, i) => (\n            <div\n              key={`row-resize-${i}`}\n              onMouseDown={(e) => startRowResize(e, i)}\n              onTouchStart={(e) => startRowResize(e, i)}\n              style={{\n                position: \"absolute\",\n                left: 0,\n                right: 0,\n                top: `${getRowPosition(i)}%`,\n                height: 6,\n                marginTop: -3,\n                cursor: \"row-resize\",\n                zIndex: 50,\n                background: \"transparent\",\n              }}\n            />\n          ))}\n\n          {/* Panels */}\n          {visiblePanels.map((p) => (\n            <Panel\n              key={p.id}\n              panel={p}\n              dispatch={dispatch}\n              gridRef={gridRef}\n              cols={cols}\n              rows={rows}\n              activeId={activeId}\n              components={components}\n              gridActive={panelDragging} // Panel should disable transitions when true\n              addContainer={addContainer}\n            />\n          ))}\n        </div>\n      </div>\n\n      {/* No DragOverlay for panels (prevents clone+real double issues) */}\n    </DndContext>\n  );\n}\n\nexport default React.memo(GridInner);\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}