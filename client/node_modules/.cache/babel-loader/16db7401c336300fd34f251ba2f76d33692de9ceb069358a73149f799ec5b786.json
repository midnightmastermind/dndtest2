{"ast":null,"code":"// client/src/state/bindSocketToStore.js\n// =========================================\n// bindSocketToStore.js — CLEAN + CONSISTENT\n// Goals:\n// - Match server.js event names + payload shapes\n// - Dispatch ActionTypes using the SAME shapes your reducer/action-creators expect\n// - Keep auth + full_state behavior correct (reconnect w/ token, then hydrate)\n// - Provide proper cleanup for HMR\n//\n// MERGED FIXES:\n// - full_state -> ONLY dispatch FULL_STATE (atomic hydrate incl gridId)\n// - auth_success -> DO NOT wipe moduli-gridId (so selection persists)\n// =========================================\n\nimport { ActionTypes } from \"./actions\";\nexport function bindSocketToStore(socket, dispatch) {\n  // ======================================================\n  // FULL STATE HYDRATE\n  // ======================================================\n  function onFullState(payload = {}) {\n    console.log(\"[socket] full_state received:\", payload);\n\n    // persist selection\n    if (payload.gridId) {\n      localStorage.setItem(\"moduli-gridId\", payload.gridId);\n    }\n\n    // ✅ single atomic hydrate (sets gridId + grid + panels + grids list + etc)\n    dispatch({\n      type: ActionTypes.FULL_STATE,\n      payload\n    });\n  }\n  socket.on(\"full_state\", onFullState);\n\n  // ======================================================\n  // CONTAINERS (CRUD)\n  // ======================================================\n  function onContainerCreated({\n    container\n  } = {}) {\n    if (!(container !== null && container !== void 0 && container.id)) return;\n    dispatch({\n      type: ActionTypes.CREATE_CONTAINER,\n      payload: {\n        container\n      }\n    });\n  }\n  function onContainerItemsUpdated({\n    containerId,\n    items\n  } = {}) {\n    if (!containerId || !Array.isArray(items)) return;\n    dispatch({\n      type: ActionTypes.UPDATE_CONTAINER_ITEMS,\n      payload: {\n        containerId,\n        items\n      }\n    });\n  }\n\n  // forward-compat\n  function onContainerUpdated(payload = {}) {\n    const container = payload.container || payload;\n    const id = (container === null || container === void 0 ? void 0 : container.id) || payload.containerId;\n    if (!id) return;\n    dispatch({\n      type: ActionTypes.UPDATE_CONTAINER,\n      payload: {\n        container: {\n          ...container,\n          id\n        }\n      }\n    });\n  }\n\n  // forward-compat\n  function onContainerDeleted(payload = {}) {\n    const containerId = payload.containerId || payload.id;\n    if (!containerId) return;\n    dispatch({\n      type: ActionTypes.DELETE_CONTAINER,\n      payload: {\n        containerId\n      }\n    });\n  }\n  socket.on(\"container_created\", onContainerCreated);\n  socket.on(\"container_items_updated\", onContainerItemsUpdated);\n  socket.on(\"container_updated\", onContainerUpdated);\n  socket.on(\"container_deleted\", onContainerDeleted);\n\n  // ======================================================\n  // INSTANCES (CRUD)\n  // ======================================================\n  function onInstanceCreatedInContainer({\n    containerId,\n    instance\n  } = {}) {\n    if (!containerId || !(instance !== null && instance !== void 0 && instance.id)) return;\n    dispatch({\n      type: ActionTypes.CREATE_INSTANCE_IN_CONTAINER,\n      payload: {\n        containerId,\n        instance\n      }\n    });\n  }\n  function onInstanceUpdated({\n    instance\n  } = {}) {\n    if (!(instance !== null && instance !== void 0 && instance.id)) return;\n    dispatch({\n      type: ActionTypes.UPDATE_INSTANCE,\n      payload: {\n        instance\n      }\n    });\n  }\n\n  // forward-compat\n  function onInstanceDeleted(payload = {}) {\n    const instanceId = payload.instanceId || payload.id;\n    if (!instanceId) return;\n    dispatch({\n      type: ActionTypes.DELETE_INSTANCE,\n      payload: {\n        instanceId\n      }\n    });\n  }\n  socket.on(\"instance_created_in_container\", onInstanceCreatedInContainer);\n  socket.on(\"instance_updated\", onInstanceUpdated);\n  socket.on(\"instance_deleted\", onInstanceDeleted);\n\n  // ======================================================\n  // PANELS (CRUD)\n  // ======================================================\n  function onPanelUpdated(panel) {\n    if (!(panel !== null && panel !== void 0 && panel.id)) return;\n    dispatch({\n      type: ActionTypes.UPDATE_PANEL,\n      payload: {\n        panel\n      }\n    });\n  }\n\n  // forward-compat\n  function onPanelDeleted(payload = {}) {\n    const panelId = payload.panelId || payload.id;\n    if (!panelId) return;\n    dispatch({\n      type: ActionTypes.DELETE_PANEL,\n      payload: {\n        panelId\n      }\n    });\n  }\n\n  // optional alias\n  function onPanelCreated(panel) {\n    if (!(panel !== null && panel !== void 0 && panel.id)) return;\n    dispatch({\n      type: ActionTypes.UPDATE_PANEL,\n      payload: {\n        panel\n      }\n    });\n  }\n  socket.on(\"panel_updated\", onPanelUpdated);\n  socket.on(\"panel_deleted\", onPanelDeleted);\n  socket.on(\"panel_created\", onPanelCreated);\n\n  // ======================================================\n  // GRIDS (CRUD)\n  // ======================================================\n  function onGridUpdated(gridPatch = {}) {\n    dispatch({\n      type: ActionTypes.UPDATE_GRID,\n      payload: {\n        grid: gridPatch\n      }\n    });\n  }\n\n  // forward-compat\n  function onGridDeleted(payload = {}) {\n    const gridId = payload.gridId || payload.id;\n    if (!gridId) return;\n    dispatch({\n      type: ActionTypes.DELETE_GRID,\n      payload: {\n        gridId\n      }\n    });\n    const saved = localStorage.getItem(\"moduli-gridId\");\n    if (saved && saved === gridId) localStorage.removeItem(\"moduli-gridId\");\n  }\n\n  // optional alias\n  function onGridCreated(payload = {}) {\n    const grid = payload.grid || payload;\n    dispatch({\n      type: ActionTypes.CREATE_GRID,\n      payload: {\n        grid\n      }\n    });\n  }\n  socket.on(\"grid_updated\", onGridUpdated);\n  socket.on(\"grid_deleted\", onGridDeleted);\n  socket.on(\"grid_created\", onGridCreated);\n\n  // ======================================================\n  // AUTH\n  // ======================================================\n  function onAuthSuccess({\n    token,\n    userId\n  } = {}) {\n    console.log(\"[socket] auth_success\", {\n      userId\n    });\n    if (token) localStorage.setItem(\"moduli-token\", token);\n    if (userId) localStorage.setItem(\"moduli-userId\", userId);\n\n    // ✅ IMPORTANT FIX:\n    // Do NOT wipe moduli-gridId here, or you lose selected grid persistence.\n    // localStorage.removeItem(\"moduli-gridId\");\n\n    dispatch({\n      type: ActionTypes.SET_USER_ID,\n      payload: {\n        userId\n      }\n    });\n\n    // Force a new handshake so io.use(auth) runs with the token\n    try {\n      socket.disconnect();\n    } catch {}\n    socket.auth = {\n      token\n    };\n    socket.connect();\n\n    // Wait for reconnect, THEN hydrate\n    socket.once(\"connect\", () => {\n      const savedGridId = localStorage.getItem(\"moduli-gridId\");\n      socket.emit(\"request_full_state\", savedGridId ? {\n        gridId: savedGridId\n      } : undefined);\n    });\n  }\n  function onAuthError(msg) {\n    console.log(\"[socket] auth_error:\", msg);\n    localStorage.removeItem(\"moduli-token\");\n    localStorage.removeItem(\"moduli-userId\");\n    localStorage.removeItem(\"moduli-gridId\");\n    dispatch({\n      type: ActionTypes.LOGOUT\n    });\n  }\n  function onConnectError(err) {\n    const msg = err === null || err === void 0 ? void 0 : err.message;\n    console.log(\"[socket] connect_error:\", msg);\n    if (msg === \"INVALID_TOKEN\" || msg === \"USER_NOT_FOUND\") {\n      localStorage.removeItem(\"moduli-token\");\n      localStorage.removeItem(\"moduli-userId\");\n      localStorage.removeItem(\"moduli-gridId\");\n      dispatch({\n        type: ActionTypes.LOGOUT\n      });\n      try {\n        socket.disconnect();\n      } catch {}\n      socket.auth = {}; // guest\n      socket.connect();\n    }\n  }\n  socket.on(\"auth_success\", onAuthSuccess);\n  socket.on(\"auth_error\", onAuthError);\n  socket.on(\"connect_error\", onConnectError);\n\n  // ======================================================\n  // SERVER ERRORS / MISC\n  // ======================================================\n  function onServerError(msg) {\n    console.warn(\"[socket] server_error:\", msg);\n  }\n  socket.on(\"server_error\", onServerError);\n\n  // ======================================================\n  // CLEANUP (important with HMR)\n  // ======================================================\n  return () => {\n    socket.off(\"full_state\", onFullState);\n    socket.off(\"container_created\", onContainerCreated);\n    socket.off(\"container_items_updated\", onContainerItemsUpdated);\n    socket.off(\"container_updated\", onContainerUpdated);\n    socket.off(\"container_deleted\", onContainerDeleted);\n    socket.off(\"instance_created_in_container\", onInstanceCreatedInContainer);\n    socket.off(\"instance_updated\", onInstanceUpdated);\n    socket.off(\"instance_deleted\", onInstanceDeleted);\n    socket.off(\"panel_updated\", onPanelUpdated);\n    socket.off(\"panel_deleted\", onPanelDeleted);\n    socket.off(\"panel_created\", onPanelCreated);\n    socket.off(\"grid_updated\", onGridUpdated);\n    socket.off(\"grid_deleted\", onGridDeleted);\n    socket.off(\"grid_created\", onGridCreated);\n    socket.off(\"auth_success\", onAuthSuccess);\n    socket.off(\"auth_error\", onAuthError);\n    socket.off(\"connect_error\", onConnectError);\n    socket.off(\"server_error\", onServerError);\n  };\n}","map":{"version":3,"names":["ActionTypes","bindSocketToStore","socket","dispatch","onFullState","payload","console","log","gridId","localStorage","setItem","type","FULL_STATE","on","onContainerCreated","container","id","CREATE_CONTAINER","onContainerItemsUpdated","containerId","items","Array","isArray","UPDATE_CONTAINER_ITEMS","onContainerUpdated","UPDATE_CONTAINER","onContainerDeleted","DELETE_CONTAINER","onInstanceCreatedInContainer","instance","CREATE_INSTANCE_IN_CONTAINER","onInstanceUpdated","UPDATE_INSTANCE","onInstanceDeleted","instanceId","DELETE_INSTANCE","onPanelUpdated","panel","UPDATE_PANEL","onPanelDeleted","panelId","DELETE_PANEL","onPanelCreated","onGridUpdated","gridPatch","UPDATE_GRID","grid","onGridDeleted","DELETE_GRID","saved","getItem","removeItem","onGridCreated","CREATE_GRID","onAuthSuccess","token","userId","SET_USER_ID","disconnect","auth","connect","once","savedGridId","emit","undefined","onAuthError","msg","LOGOUT","onConnectError","err","message","onServerError","warn","off"],"sources":["/home/joshpoms/dndtest2/client/src/state/bindSocketToStore.js"],"sourcesContent":["// client/src/state/bindSocketToStore.js\n// =========================================\n// bindSocketToStore.js — CLEAN + CONSISTENT\n// Goals:\n// - Match server.js event names + payload shapes\n// - Dispatch ActionTypes using the SAME shapes your reducer/action-creators expect\n// - Keep auth + full_state behavior correct (reconnect w/ token, then hydrate)\n// - Provide proper cleanup for HMR\n//\n// MERGED FIXES:\n// - full_state -> ONLY dispatch FULL_STATE (atomic hydrate incl gridId)\n// - auth_success -> DO NOT wipe moduli-gridId (so selection persists)\n// =========================================\n\nimport { ActionTypes } from \"./actions\";\n\nexport function bindSocketToStore(socket, dispatch) {\n  // ======================================================\n  // FULL STATE HYDRATE\n  // ======================================================\n  function onFullState(payload = {}) {\n    console.log(\"[socket] full_state received:\", payload);\n\n    // persist selection\n    if (payload.gridId) {\n      localStorage.setItem(\"moduli-gridId\", payload.gridId);\n    }\n\n    // ✅ single atomic hydrate (sets gridId + grid + panels + grids list + etc)\n    dispatch({ type: ActionTypes.FULL_STATE, payload });\n  }\n\n  socket.on(\"full_state\", onFullState);\n\n  // ======================================================\n  // CONTAINERS (CRUD)\n  // ======================================================\n  function onContainerCreated({ container } = {}) {\n    if (!container?.id) return;\n\n    dispatch({\n      type: ActionTypes.CREATE_CONTAINER,\n      payload: { container },\n    });\n  }\n\n  function onContainerItemsUpdated({ containerId, items } = {}) {\n    if (!containerId || !Array.isArray(items)) return;\n\n    dispatch({\n      type: ActionTypes.UPDATE_CONTAINER_ITEMS,\n      payload: { containerId, items },\n    });\n  }\n\n  // forward-compat\n  function onContainerUpdated(payload = {}) {\n    const container = payload.container || payload;\n    const id = container?.id || payload.containerId;\n    if (!id) return;\n\n    dispatch({\n      type: ActionTypes.UPDATE_CONTAINER,\n      payload: { container: { ...container, id } },\n    });\n  }\n\n  // forward-compat\n  function onContainerDeleted(payload = {}) {\n    const containerId = payload.containerId || payload.id;\n    if (!containerId) return;\n\n    dispatch({\n      type: ActionTypes.DELETE_CONTAINER,\n      payload: { containerId },\n    });\n  }\n\n  socket.on(\"container_created\", onContainerCreated);\n  socket.on(\"container_items_updated\", onContainerItemsUpdated);\n  socket.on(\"container_updated\", onContainerUpdated);\n  socket.on(\"container_deleted\", onContainerDeleted);\n\n  // ======================================================\n  // INSTANCES (CRUD)\n  // ======================================================\n  function onInstanceCreatedInContainer({ containerId, instance } = {}) {\n    if (!containerId || !instance?.id) return;\n\n    dispatch({\n      type: ActionTypes.CREATE_INSTANCE_IN_CONTAINER,\n      payload: { containerId, instance },\n    });\n  }\n\n  function onInstanceUpdated({ instance } = {}) {\n    if (!instance?.id) return;\n\n    dispatch({\n      type: ActionTypes.UPDATE_INSTANCE,\n      payload: { instance },\n    });\n  }\n\n  // forward-compat\n  function onInstanceDeleted(payload = {}) {\n    const instanceId = payload.instanceId || payload.id;\n    if (!instanceId) return;\n\n    dispatch({\n      type: ActionTypes.DELETE_INSTANCE,\n      payload: { instanceId },\n    });\n  }\n\n  socket.on(\"instance_created_in_container\", onInstanceCreatedInContainer);\n  socket.on(\"instance_updated\", onInstanceUpdated);\n  socket.on(\"instance_deleted\", onInstanceDeleted);\n\n  // ======================================================\n  // PANELS (CRUD)\n  // ======================================================\n  function onPanelUpdated(panel) {\n    if (!panel?.id) return;\n\n    dispatch({\n      type: ActionTypes.UPDATE_PANEL,\n      payload: { panel },\n    });\n  }\n\n  // forward-compat\n  function onPanelDeleted(payload = {}) {\n    const panelId = payload.panelId || payload.id;\n    if (!panelId) return;\n\n    dispatch({\n      type: ActionTypes.DELETE_PANEL,\n      payload: { panelId },\n    });\n  }\n\n  // optional alias\n  function onPanelCreated(panel) {\n    if (!panel?.id) return;\n\n    dispatch({\n      type: ActionTypes.UPDATE_PANEL,\n      payload: { panel },\n    });\n  }\n\n  socket.on(\"panel_updated\", onPanelUpdated);\n  socket.on(\"panel_deleted\", onPanelDeleted);\n  socket.on(\"panel_created\", onPanelCreated);\n\n  // ======================================================\n  // GRIDS (CRUD)\n  // ======================================================\n  function onGridUpdated(gridPatch = {}) {\n    dispatch({\n      type: ActionTypes.UPDATE_GRID,\n      payload: { grid: gridPatch },\n    });\n  }\n\n  // forward-compat\n  function onGridDeleted(payload = {}) {\n    const gridId = payload.gridId || payload.id;\n    if (!gridId) return;\n\n    dispatch({\n      type: ActionTypes.DELETE_GRID,\n      payload: { gridId },\n    });\n\n    const saved = localStorage.getItem(\"moduli-gridId\");\n    if (saved && saved === gridId) localStorage.removeItem(\"moduli-gridId\");\n  }\n\n  // optional alias\n  function onGridCreated(payload = {}) {\n    const grid = payload.grid || payload;\n    dispatch({\n      type: ActionTypes.CREATE_GRID,\n      payload: { grid },\n    });\n  }\n\n  socket.on(\"grid_updated\", onGridUpdated);\n  socket.on(\"grid_deleted\", onGridDeleted);\n  socket.on(\"grid_created\", onGridCreated);\n\n  // ======================================================\n  // AUTH\n  // ======================================================\n  function onAuthSuccess({ token, userId } = {}) {\n    console.log(\"[socket] auth_success\", { userId });\n\n    if (token) localStorage.setItem(\"moduli-token\", token);\n    if (userId) localStorage.setItem(\"moduli-userId\", userId);\n\n    // ✅ IMPORTANT FIX:\n    // Do NOT wipe moduli-gridId here, or you lose selected grid persistence.\n    // localStorage.removeItem(\"moduli-gridId\");\n\n    dispatch({\n      type: ActionTypes.SET_USER_ID,\n      payload: { userId },\n    });\n\n    // Force a new handshake so io.use(auth) runs with the token\n    try {\n      socket.disconnect();\n    } catch {}\n\n    socket.auth = { token };\n    socket.connect();\n\n    // Wait for reconnect, THEN hydrate\n    socket.once(\"connect\", () => {\n      const savedGridId = localStorage.getItem(\"moduli-gridId\");\n      socket.emit(\n        \"request_full_state\",\n        savedGridId ? { gridId: savedGridId } : undefined\n      );\n    });\n  }\n\n  function onAuthError(msg) {\n    console.log(\"[socket] auth_error:\", msg);\n    localStorage.removeItem(\"moduli-token\");\n    localStorage.removeItem(\"moduli-userId\");\n    localStorage.removeItem(\"moduli-gridId\");\n    dispatch({ type: ActionTypes.LOGOUT });\n  }\n\n  function onConnectError(err) {\n    const msg = err?.message;\n    console.log(\"[socket] connect_error:\", msg);\n\n    if (msg === \"INVALID_TOKEN\" || msg === \"USER_NOT_FOUND\") {\n      localStorage.removeItem(\"moduli-token\");\n      localStorage.removeItem(\"moduli-userId\");\n      localStorage.removeItem(\"moduli-gridId\");\n\n      dispatch({ type: ActionTypes.LOGOUT });\n\n      try {\n        socket.disconnect();\n      } catch {}\n\n      socket.auth = {}; // guest\n      socket.connect();\n    }\n  }\n\n  socket.on(\"auth_success\", onAuthSuccess);\n  socket.on(\"auth_error\", onAuthError);\n  socket.on(\"connect_error\", onConnectError);\n\n  // ======================================================\n  // SERVER ERRORS / MISC\n  // ======================================================\n  function onServerError(msg) {\n    console.warn(\"[socket] server_error:\", msg);\n  }\n  socket.on(\"server_error\", onServerError);\n\n  // ======================================================\n  // CLEANUP (important with HMR)\n  // ======================================================\n  return () => {\n    socket.off(\"full_state\", onFullState);\n\n    socket.off(\"container_created\", onContainerCreated);\n    socket.off(\"container_items_updated\", onContainerItemsUpdated);\n    socket.off(\"container_updated\", onContainerUpdated);\n    socket.off(\"container_deleted\", onContainerDeleted);\n\n    socket.off(\"instance_created_in_container\", onInstanceCreatedInContainer);\n    socket.off(\"instance_updated\", onInstanceUpdated);\n    socket.off(\"instance_deleted\", onInstanceDeleted);\n\n    socket.off(\"panel_updated\", onPanelUpdated);\n    socket.off(\"panel_deleted\", onPanelDeleted);\n    socket.off(\"panel_created\", onPanelCreated);\n\n    socket.off(\"grid_updated\", onGridUpdated);\n    socket.off(\"grid_deleted\", onGridDeleted);\n    socket.off(\"grid_created\", onGridCreated);\n\n    socket.off(\"auth_success\", onAuthSuccess);\n    socket.off(\"auth_error\", onAuthError);\n    socket.off(\"connect_error\", onConnectError);\n\n    socket.off(\"server_error\", onServerError);\n  };\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}