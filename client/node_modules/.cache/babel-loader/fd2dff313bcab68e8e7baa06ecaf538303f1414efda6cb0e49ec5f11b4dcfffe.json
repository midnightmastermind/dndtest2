{"ast":null,"code":"var _jsxFileName = \"/home/joshpoms/dndtest2/client/src/App.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { useCallback, useEffect, useMemo, useState } from \"react\";\nimport Textfield from \"@atlaskit/textfield\";\nimport Button from \"@atlaskit/button\";\nimport { Label } from \"@atlaskit/form\";\nimport { socket } from \"./socket\";\nimport { bindSocketToStore } from \"./state/bindSocketToStore\";\n\n// âœ… use your action creators (no ActionTypes import)\n\nimport { updateGridAction, createPanelAction, updatePanelAction,\n// âœ… add these (you already have them in actions.js)\ncreateContainerAction, createInstanceInContainerAction } from \"./state/actions\";\nimport Grid from \"./Grid\";\nimport LoginScreen from \"./LoginScreen\";\nimport { GridDataContext } from \"./GridDataContext\";\nimport { GridActionsContext } from \"./GridActionsContext\";\nimport { useBoardState } from \"./state/useBoardState\";\nimport { useDndReorderCoordinator } from \"./helpers/useDndReorderCoordinator\";\nimport SortableContainer from \"./SortableContainer\";\nimport SortableInstance from \"./SortableInstance\";\nimport Instance from \"./Instance\";\nimport Debugbar from \"./Debugbar\";\nimport Toolbar from \"./Toolbar\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction useRenderCount(label) {\n  _s();\n  const ref = React.useRef(0);\n  ref.current += 1;\n  console.log(`${label} render #${ref.current}`);\n}\n_s(useRenderCount, \"QMBuJFIdzLIeqBcFwhMf246mjOM=\");\nfunction findNextOpenPosition(panels = [], rows = 1, cols = 1) {\n  const taken = new Set(panels.map(p => `${p.row}-${p.col}`));\n  for (let r = 0; r < rows; r++) {\n    for (let c = 0; c < cols; c++) {\n      const key = `${r}-${c}`;\n      if (!taken.has(key)) return {\n        row: r,\n        col: c\n      };\n    }\n  }\n  return {\n    row: 0,\n    col: 0\n  };\n}\nexport default function App() {\n  _s2();\n  var _state$grid, _state$grid2, _state$grid3, _state$grid4;\n  const {\n    state,\n    dispatch\n  } = useBoardState();\n  const {\n    handleDragStart,\n    handleDragOver,\n    handleDragEnd,\n    handleDragCancel,\n    containersDraftRef,\n    getWorkingContainers\n  } = useDndReorderCoordinator({\n    state,\n    dispatch,\n    socket\n  });\n  const containersRender = getWorkingContainers();\n\n  // -----------------------------\n  // TOOLBAR LOCAL UI STATE\n  // -----------------------------\n  const [gridName, setGridName] = useState(\"\");\n  const [rowInput, setRowInput] = useState(\"1\");\n  const [colInput, setColInput] = useState(\"1\");\n\n  // Sync toolbar fields from hydrated grid\n  useEffect(() => {\n    if (state !== null && state !== void 0 && state.grid) {\n      var _state$grid$rows, _state$grid$cols;\n      setGridName(state.grid.name || \"\");\n      setRowInput(String((_state$grid$rows = state.grid.rows) !== null && _state$grid$rows !== void 0 ? _state$grid$rows : 1));\n      setColInput(String((_state$grid$cols = state.grid.cols) !== null && _state$grid$cols !== void 0 ? _state$grid$cols : 1));\n    } else {\n      setGridName(\"\");\n      setRowInput(\"1\");\n      setColInput(\"1\");\n    }\n  }, [state === null || state === void 0 ? void 0 : (_state$grid = state.grid) === null || _state$grid === void 0 ? void 0 : _state$grid._id, state === null || state === void 0 ? void 0 : (_state$grid2 = state.grid) === null || _state$grid2 === void 0 ? void 0 : _state$grid2.name, state === null || state === void 0 ? void 0 : (_state$grid3 = state.grid) === null || _state$grid3 === void 0 ? void 0 : _state$grid3.rows, state === null || state === void 0 ? void 0 : (_state$grid4 = state.grid) === null || _state$grid4 === void 0 ? void 0 : _state$grid4.cols]);\n\n  // -----------------------------\n  // SOCKET BIND + HYDRATE\n  // -----------------------------\n\n  useEffect(() => {\n    const unbind = bindSocketToStore(socket, dispatch);\n    const token = localStorage.getItem(\"moduli-token\");\n    if (!token) return () => unbind === null || unbind === void 0 ? void 0 : unbind(); // ðŸ‘ˆ don't request_full_state as guest\n\n    let didRequest = false;\n    const request = () => {\n      if (didRequest) return;\n      didRequest = true;\n      const savedGridId = localStorage.getItem(\"moduli-gridId\");\n      socket.emit(\"request_full_state\", savedGridId ? {\n        gridId: savedGridId\n      } : undefined);\n    };\n    if (socket.connected) request();else socket.once(\"connect\", request);\n    return () => {\n      socket.off(\"connect\", request);\n      unbind === null || unbind === void 0 ? void 0 : unbind();\n    };\n  }, [dispatch]);\n  // -----------------------------\n  // TOOLBAR HANDLERS (REAL EMITS)\n  // -----------------------------\n  const handleGridChange = e => {\n    const newGridId = e.target.value;\n    if (!newGridId || newGridId === state.gridId) return;\n    localStorage.setItem(\"moduli-gridId\", newGridId);\n    socket.emit(\"request_full_state\", {\n      gridId: newGridId\n    });\n  };\n  const handleCreateNewGrid = () => {\n    localStorage.removeItem(\"moduli-gridId\");\n    socket.emit(\"request_full_state\"); // server creates new grid\n  };\n  const commitGridName = () => {\n    if (!state.gridId) return;\n    const trimmed = (gridName || \"\").trim();\n    if (!trimmed) return;\n\n    // âœ… optimistic local patch\n    dispatch(updateGridAction({\n      name: trimmed\n    }));\n\n    // server patch\n    socket.emit(\"update_grid\", {\n      gridId: state.gridId,\n      name: trimmed\n    });\n  };\n  const updateRows = val => {\n    if (!state.gridId) return;\n    const num = Math.max(1, Number(val) || 1);\n\n    // âœ… optimistic local patch\n    dispatch(updateGridAction({\n      rows: num\n    }));\n    socket.emit(\"update_grid\", {\n      gridId: state.gridId,\n      rows: num\n    });\n  };\n  const updateCols = val => {\n    if (!state.gridId) return;\n    const num = Math.max(1, Number(val) || 1);\n\n    // âœ… optimistic local patch\n    dispatch(updateGridAction({\n      cols: num\n    }));\n    socket.emit(\"update_grid\", {\n      gridId: state.gridId,\n      cols: num\n    });\n  };\n  const addNewPanel = () => {\n    var _state$grid$rows2, _state$grid$cols2;\n    if (!state.gridId || !state.grid) return;\n    const panelId = crypto.randomUUID();\n    const {\n      row,\n      col\n    } = findNextOpenPosition(state.panels || [], (_state$grid$rows2 = state.grid.rows) !== null && _state$grid$rows2 !== void 0 ? _state$grid$rows2 : 1, (_state$grid$cols2 = state.grid.cols) !== null && _state$grid$cols2 !== void 0 ? _state$grid$cols2 : 1);\n    const panel = {\n      id: panelId,\n      role: \"panel\",\n      type: \"\",\n      row,\n      col,\n      width: 1,\n      height: 1,\n      containers: [],\n      gridId: state.gridId\n    };\n\n    // âœ… optimistic local add (create)\n    dispatch(createPanelAction(panel));\n\n    // âœ… and also upsert/update (your request: do both)\n    //   dispatch(updatePanelAction(panel));\n\n    // tell server to upsert + broadcast panel_updated\n    socket.emit(\"create_panel\", {\n      panel\n    });\n\n    // ensure container exists\n    /*  if (!(state.containers || []).some((c) => c.id === containerId)) {\n        dispatch(addContainerAction({ id: containerId, label: \"TaskBox\" }));\n           socket.emit(\"create_container\", {\n          container: { id: containerId, label: \"TaskBox\" },\n        });\n      }\n         // ensure items are empty (both local + server)\n      dispatch(patchContainerItemsAction({ containerId, items: [] }));\n      socket.emit(\"update_container_items\", { containerId, items: [] });\n      */\n  };\n\n  // App.jsx\n  const addContainerToPanel = useCallback(panelId => {\n    var _state$containers;\n    if (!panelId || !state.gridId) return;\n    const id = crypto.randomUUID();\n    const label = `List ${(((_state$containers = state.containers) === null || _state$containers === void 0 ? void 0 : _state$containers.length) || 0) + 1}`;\n    const container = {\n      id,\n      label,\n      items: []\n    };\n\n    // 1) optimistic container create\n    dispatch(createContainerAction(container));\n\n    // 2) persist container\n    socket.emit(\"create_container\", {\n      container\n    });\n\n    // 3) optimistic panel patch (attach container id)\n    const panel = (state.panels || []).find(p => p.id === panelId);\n    if (!panel) return;\n    const nextPanel = {\n      ...panel,\n      containers: [...(panel.containers || []), id]\n    };\n    dispatch(updatePanelAction(nextPanel));\n    socket.emit(\"update_panel\", {\n      panel: nextPanel,\n      gridId: state.gridId\n    });\n  }, [dispatch, socket, state.gridId, state.containers, state.panels]);\n  const addInstanceToContainer = useCallback(containerId => {\n    var _state$instances;\n    if (!containerId) return;\n    const id = crypto.randomUUID();\n    const label = `Item ${(((_state$instances = state.instances) === null || _state$instances === void 0 ? void 0 : _state$instances.length) || 0) + 1}`;\n    const instance = {\n      id,\n      label\n    };\n\n    // optimistic\n    dispatch(createInstanceInContainerAction({\n      containerId,\n      instance\n    }));\n\n    // persist\n    socket.emit(\"create_instance_in_container\", {\n      containerId,\n      instance\n    });\n  }, [dispatch, socket, state.instances]);\n\n  // -----------------------------\n  // CONTEXT VALUES\n  // -----------------------------\n  const dataValue = useMemo(() => ({\n    state,\n    // âœ… THIS is the key fix\n    containersRender // âœ… keep\n  }), [state, containersRender]);\n  const actionsValue = useMemo(() => ({\n    socket,\n    dispatch,\n    // âœ… add these wrappers so Grid can call them\n    updatePanel: updatePanelAction,\n    updateGrid: updateGridAction,\n    addContainerToPanel,\n    addInstanceToContainer,\n    handleDragStart,\n    handleDragOver,\n    handleDragEnd,\n    handleDragCancel,\n    useRenderCount\n  }), [socket, dispatch, addContainerToPanel, addInstanceToContainer, handleDragStart, handleDragOver, handleDragEnd, handleDragCancel]);\n  useRenderCount(\"App\");\n  const components = useMemo(() => ({\n    SortableContainer,\n    Instance,\n    SortableInstance\n  }), []);\n\n  // -----------------------------\n  // LOGIN GATE\n  // -----------------------------\n  if (!state.userId) return /*#__PURE__*/_jsxDEV(LoginScreen, {}, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 311,\n    columnNumber: 29\n  }, this);\n  console.log(state);\n  return /*#__PURE__*/_jsxDEV(GridActionsContext.Provider, {\n    value: actionsValue,\n    children: /*#__PURE__*/_jsxDEV(GridDataContext.Provider, {\n      value: dataValue,\n      children: [/*#__PURE__*/_jsxDEV(Toolbar, {\n        gridId: state.gridId,\n        availableGrids: state.availableGrids || [],\n        gridName: gridName,\n        setGridName: setGridName,\n        rowInput: rowInput,\n        setRowInput: setRowInput,\n        colInput: colInput,\n        setColInput: setColInput,\n        onGridChange: handleGridChange,\n        onCreateNewGrid: handleCreateNewGrid,\n        onCommitGridName: commitGridName,\n        onUpdateRows: updateRows,\n        onUpdateCols: updateCols,\n        onAddPanel: addNewPanel\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 317,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Debugbar, {\n        containers: state.containers,\n        containersDraft: containersDraftRef.current,\n        activeId: state.activeId,\n        debugEvent: state.debugEvent\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 334,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"app-root\",\n        children: state.grid && /*#__PURE__*/_jsxDEV(Grid, {\n          components: components\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 342,\n          columnNumber: 26\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 341,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 316,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 315,\n    columnNumber: 5\n  }, this);\n}\n_s2(App, \"Jyg5A/i57NSmFfp9J0hLNvmJ8W8=\", false, function () {\n  return [useBoardState, useDndReorderCoordinator, useRenderCount];\n});\n_c = App;\nvar _c;\n$RefreshReg$(_c, \"App\");","map":{"version":3,"names":["React","useCallback","useEffect","useMemo","useState","Textfield","Button","Label","socket","bindSocketToStore","updateGridAction","createPanelAction","updatePanelAction","createContainerAction","createInstanceInContainerAction","Grid","LoginScreen","GridDataContext","GridActionsContext","useBoardState","useDndReorderCoordinator","SortableContainer","SortableInstance","Instance","Debugbar","Toolbar","jsxDEV","_jsxDEV","useRenderCount","label","_s","ref","useRef","current","console","log","findNextOpenPosition","panels","rows","cols","taken","Set","map","p","row","col","r","c","key","has","App","_s2","_state$grid","_state$grid2","_state$grid3","_state$grid4","state","dispatch","handleDragStart","handleDragOver","handleDragEnd","handleDragCancel","containersDraftRef","getWorkingContainers","containersRender","gridName","setGridName","rowInput","setRowInput","colInput","setColInput","grid","_state$grid$rows","_state$grid$cols","name","String","_id","unbind","token","localStorage","getItem","didRequest","request","savedGridId","emit","gridId","undefined","connected","once","off","handleGridChange","e","newGridId","target","value","setItem","handleCreateNewGrid","removeItem","commitGridName","trimmed","trim","updateRows","val","num","Math","max","Number","updateCols","addNewPanel","_state$grid$rows2","_state$grid$cols2","panelId","crypto","randomUUID","panel","id","role","type","width","height","containers","addContainerToPanel","_state$containers","length","container","items","find","nextPanel","addInstanceToContainer","containerId","_state$instances","instances","instance","dataValue","actionsValue","updatePanel","updateGrid","components","userId","fileName","_jsxFileName","lineNumber","columnNumber","Provider","children","availableGrids","onGridChange","onCreateNewGrid","onCommitGridName","onUpdateRows","onUpdateCols","onAddPanel","containersDraft","activeId","debugEvent","className","_c","$RefreshReg$"],"sources":["/home/joshpoms/dndtest2/client/src/App.js"],"sourcesContent":["import React, { useCallback, useEffect, useMemo, useState } from \"react\";\nimport Textfield from \"@atlaskit/textfield\";\nimport Button from \"@atlaskit/button\";\nimport { Label } from \"@atlaskit/form\";\n\nimport { socket } from \"./socket\";\nimport { bindSocketToStore } from \"./state/bindSocketToStore\";\n\n// âœ… use your action creators (no ActionTypes import)\n\nimport {\n  updateGridAction,\n  createPanelAction,\n  updatePanelAction,\n\n  // âœ… add these (you already have them in actions.js)\n  createContainerAction,\n  createInstanceInContainerAction,\n} from \"./state/actions\";\n\nimport Grid from \"./Grid\";\nimport LoginScreen from \"./LoginScreen\";\n\nimport { GridDataContext } from \"./GridDataContext\";\nimport { GridActionsContext } from \"./GridActionsContext\";\n\nimport { useBoardState } from \"./state/useBoardState\";\nimport { useDndReorderCoordinator } from \"./helpers/useDndReorderCoordinator\";\nimport SortableContainer from \"./SortableContainer\";\nimport SortableInstance from \"./SortableInstance\";\nimport Instance from \"./Instance\";\nimport Debugbar from \"./Debugbar\";\nimport Toolbar from \"./Toolbar\";\n\n\n\nfunction useRenderCount(label) {\n  const ref = React.useRef(0);\n  ref.current += 1;\n  console.log(`${label} render #${ref.current}`);\n}\n\n\nfunction findNextOpenPosition(panels = [], rows = 1, cols = 1) {\n  const taken = new Set(panels.map((p) => `${p.row}-${p.col}`));\n  for (let r = 0; r < rows; r++) {\n    for (let c = 0; c < cols; c++) {\n      const key = `${r}-${c}`;\n      if (!taken.has(key)) return { row: r, col: c };\n    }\n  }\n  return { row: 0, col: 0 };\n}\n\nexport default function App() {\n  const { state, dispatch } = useBoardState();\n\n  const {\n    handleDragStart,\n    handleDragOver,\n    handleDragEnd,\n    handleDragCancel,\n    containersDraftRef,\n    getWorkingContainers,\n  } = useDndReorderCoordinator({ state, dispatch, socket });\n\n  const containersRender = getWorkingContainers();\n\n  // -----------------------------\n  // TOOLBAR LOCAL UI STATE\n  // -----------------------------\n  const [gridName, setGridName] = useState(\"\");\n  const [rowInput, setRowInput] = useState(\"1\");\n  const [colInput, setColInput] = useState(\"1\");\n\n  // Sync toolbar fields from hydrated grid\n  useEffect(() => {\n    if (state?.grid) {\n      setGridName(state.grid.name || \"\");\n      setRowInput(String(state.grid.rows ?? 1));\n      setColInput(String(state.grid.cols ?? 1));\n    } else {\n      setGridName(\"\");\n      setRowInput(\"1\");\n      setColInput(\"1\");\n    }\n  }, [state?.grid?._id, state?.grid?.name, state?.grid?.rows, state?.grid?.cols]);\n\n  // -----------------------------\n  // SOCKET BIND + HYDRATE\n  // -----------------------------\n\n  useEffect(() => {\n    const unbind = bindSocketToStore(socket, dispatch);\n\n    const token = localStorage.getItem(\"moduli-token\");\n    if (!token) return () => unbind?.(); // ðŸ‘ˆ don't request_full_state as guest\n\n    let didRequest = false;\n    const request = () => {\n      if (didRequest) return;\n      didRequest = true;\n\n      const savedGridId = localStorage.getItem(\"moduli-gridId\");\n      socket.emit(\"request_full_state\", savedGridId ? { gridId: savedGridId } : undefined);\n    };\n\n    if (socket.connected) request();\n    else socket.once(\"connect\", request);\n\n    return () => {\n      socket.off(\"connect\", request);\n      unbind?.();\n    };\n  }, [dispatch]);\n  // -----------------------------\n  // TOOLBAR HANDLERS (REAL EMITS)\n  // -----------------------------\n  const handleGridChange = (e) => {\n    const newGridId = e.target.value;\n    if (!newGridId || newGridId === state.gridId) return;\n\n    localStorage.setItem(\"moduli-gridId\", newGridId);\n    socket.emit(\"request_full_state\", { gridId: newGridId });\n  };\n\n  const handleCreateNewGrid = () => {\n    localStorage.removeItem(\"moduli-gridId\");\n    socket.emit(\"request_full_state\"); // server creates new grid\n  };\n\n  const commitGridName = () => {\n    if (!state.gridId) return;\n\n    const trimmed = (gridName || \"\").trim();\n    if (!trimmed) return;\n\n    // âœ… optimistic local patch\n    dispatch(updateGridAction({ name: trimmed }));\n\n    // server patch\n    socket.emit(\"update_grid\", { gridId: state.gridId, name: trimmed });\n  };\n\n  const updateRows = (val) => {\n    if (!state.gridId) return;\n    const num = Math.max(1, Number(val) || 1);\n\n    // âœ… optimistic local patch\n    dispatch(updateGridAction({ rows: num }));\n\n    socket.emit(\"update_grid\", { gridId: state.gridId, rows: num });\n  };\n\n  const updateCols = (val) => {\n    if (!state.gridId) return;\n    const num = Math.max(1, Number(val) || 1);\n\n    // âœ… optimistic local patch\n    dispatch(updateGridAction({ cols: num }));\n\n    socket.emit(\"update_grid\", { gridId: state.gridId, cols: num });\n  };\n\n  const addNewPanel = () => {\n    if (!state.gridId || !state.grid) return;\n\n    const panelId = crypto.randomUUID();\n\n    const { row, col } = findNextOpenPosition(\n      state.panels || [],\n      state.grid.rows ?? 1,\n      state.grid.cols ?? 1\n    );\n\n    const panel = {\n      id: panelId,\n      role: \"panel\",\n      type: \"\",\n      row,\n      col,\n      width: 1,\n      height: 1,\n      containers: [],\n      gridId: state.gridId,\n    };\n\n    // âœ… optimistic local add (create)\n    dispatch(createPanelAction(panel));\n\n    // âœ… and also upsert/update (your request: do both)\n    //   dispatch(updatePanelAction(panel));\n\n    // tell server to upsert + broadcast panel_updated\n    socket.emit(\"create_panel\", { panel });\n\n    // ensure container exists\n    /*  if (!(state.containers || []).some((c) => c.id === containerId)) {\n        dispatch(addContainerAction({ id: containerId, label: \"TaskBox\" }));\n  \n        socket.emit(\"create_container\", {\n          container: { id: containerId, label: \"TaskBox\" },\n        });\n      }\n  \n      // ensure items are empty (both local + server)\n      dispatch(patchContainerItemsAction({ containerId, items: [] }));\n      socket.emit(\"update_container_items\", { containerId, items: [] });\n      */\n  };\n\n  // App.jsx\nconst addContainerToPanel = useCallback(\n  (panelId) => {\n    if (!panelId || !state.gridId) return;\n\n    const id = crypto.randomUUID();\n    const label = `List ${(state.containers?.length || 0) + 1}`;\n\n    const container = { id, label, items: [] };\n\n    // 1) optimistic container create\n    dispatch(createContainerAction(container));\n\n    // 2) persist container\n    socket.emit(\"create_container\", { container });\n\n    // 3) optimistic panel patch (attach container id)\n    const panel = (state.panels || []).find((p) => p.id === panelId);\n    if (!panel) return;\n\n    const nextPanel = {\n      ...panel,\n      containers: [...(panel.containers || []), id],\n    };\n\n    dispatch(updatePanelAction(nextPanel));\n    socket.emit(\"update_panel\", { panel: nextPanel, gridId: state.gridId });\n  },\n  [dispatch, socket, state.gridId, state.containers, state.panels]\n);\n\nconst addInstanceToContainer = useCallback(\n  (containerId) => {\n    if (!containerId) return;\n\n    const id = crypto.randomUUID();\n    const label = `Item ${(state.instances?.length || 0) + 1}`;\n\n    const instance = { id, label };\n\n    // optimistic\n    dispatch(createInstanceInContainerAction({ containerId, instance }));\n\n    // persist\n    socket.emit(\"create_instance_in_container\", { containerId, instance });\n  },\n  [dispatch, socket, state.instances]\n);\n\n  // -----------------------------\n  // CONTEXT VALUES\n  // -----------------------------\n  const dataValue = useMemo(\n    () => ({\n      state,                 // âœ… THIS is the key fix\n      containersRender,      // âœ… keep\n    }),\n    [state, containersRender]\n  );\n\n  const actionsValue = useMemo(\n    () => ({\n      socket,\n      dispatch,\n\n      // âœ… add these wrappers so Grid can call them\n      updatePanel: updatePanelAction,\n      updateGrid: updateGridAction,\n\n      addContainerToPanel,\n      addInstanceToContainer,\n      handleDragStart,\n      handleDragOver,\n      handleDragEnd,\n      handleDragCancel,\n      useRenderCount,\n    }),\n    [\n      socket,\n      dispatch,\n      addContainerToPanel,\n      addInstanceToContainer,\n      handleDragStart,\n      handleDragOver,\n      handleDragEnd,\n      handleDragCancel,\n    ]\n  );\n\n  useRenderCount(\"App\");\n  const components = useMemo(() => ({\n    SortableContainer,\n    Instance,\n    SortableInstance,\n  }), []);\n\n  // -----------------------------\n  // LOGIN GATE\n  // -----------------------------\n  if (!state.userId) return <LoginScreen />;\n\n  console.log(state);\n  return (\n    <GridActionsContext.Provider value={actionsValue}>\n      <GridDataContext.Provider value={dataValue}>\n        <Toolbar\n          gridId={state.gridId}\n          availableGrids={state.availableGrids || []}\n          gridName={gridName}\n          setGridName={setGridName}\n          rowInput={rowInput}\n          setRowInput={setRowInput}\n          colInput={colInput}\n          setColInput={setColInput}\n          onGridChange={handleGridChange}\n          onCreateNewGrid={handleCreateNewGrid}\n          onCommitGridName={commitGridName}\n          onUpdateRows={updateRows}\n          onUpdateCols={updateCols}\n          onAddPanel={addNewPanel}\n        />\n\n        <Debugbar\n          containers={state.containers}\n          containersDraft={containersDraftRef.current}\n          activeId={state.activeId}\n          debugEvent={state.debugEvent}\n        />\n\n        <div className=\"app-root\">\n          {state.grid && <Grid components={components} />}\n        </div>\n      </GridDataContext.Provider>\n    </GridActionsContext.Provider>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}