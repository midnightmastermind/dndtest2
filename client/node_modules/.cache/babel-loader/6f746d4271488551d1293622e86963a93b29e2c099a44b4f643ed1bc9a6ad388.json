{"ast":null,"code":"import { COMMERCIAL } from '../../common/constants';\nimport { fullDomainOverride, globalDomains } from '../../common/constants/domains';\nimport { cloudEnvironment, isolatedCloudDomain } from '../perimeter';\nimport { AtlDomainMapping, isolatedCloudFunctions, nonIsolatedCloudFunctions, ReservedNameMapping } from './constants';\n\n/**\n *\n * Gets the full domain for an Atlassian experience in the context of the current request.\n * Returns undefined only when a new perimeter has been created that is not yet supported by the atlassian-context library or when the ic domain cannot be retrieved.\n *\n * For Non Isolated Cloud, the domain will be determined by the perimeter and environment combination unless the subdomain belongs in the list of global domains or overrides.\n * For Isolated Cloud, the domain type defaults to the vanity name pattern.\n *\n * @param subdomain - The Atlassian experience subdomain\n * @param envType - The environment to get the domain for ('dev', 'staging', or 'prod'). When in Isolated Cloud, the same value will be returned for all env types.\n * @returns The full domain associated with the subdomain for the given environment\n */\n\nexport function getDomainInContext(subdomain, envType) {\n  var currentCloudEnvironment = cloudEnvironment();\n  if (currentCloudEnvironment === undefined) {\n    return undefined;\n  }\n  if (currentCloudEnvironment.type === 'isolated-cloud') {\n    var domain = isolatedCloudDomain();\n    if (domain === undefined) {\n      return undefined;\n    }\n    return getDomainForIsolatedCloud(subdomain, COMMERCIAL, domain);\n  }\n  return getDomainForNonIsolatedCloud(subdomain, currentCloudEnvironment.perimeter, envType);\n}\n\n/**\n * Gets the full Isolated Cloud domain\n * Returns undefined only if ic_domain cannot be determined from the atl-ctx cookies\n * Defaults to returning the vanity name pattern\n * @param subdomain - The Atlassian experience subdomain\n * @param perimeter - The Isolated Cloud perimeter to get the domain for\n * @param isolatedCloudDomain - The IC domain (ex. \"company.atlassian-isolated.net\")\n * @returns The full domain associated with the subdomain in a specific IC\n */\n\nfunction getDomainForIsolatedCloud(subdomain, perimeter, isolatedCloudDomain) {\n  var domainMappings = isolatedCloudFunctions[perimeter];\n  if (ReservedNameMapping[perimeter].includes(subdomain)) {\n    return domainMappings.isolatedCloudReservedNameDomain(subdomain, isolatedCloudDomain);\n  }\n  if (AtlDomainMapping[perimeter].includes(subdomain)) {\n    return domainMappings.isolatedCloudAtlDomain(subdomain, isolatedCloudDomain);\n  }\n  return domainMappings.isolatedCloudVanityDomain(subdomain, isolatedCloudDomain);\n}\n\n/**\n * Gets the full domain in an non-Isolated Cloud perimeter\n *\n * @param subdomain - The Atlassian experience subdomain\n * @param perimeter - The non-isolated cloud perimeter to get the domain for\n * @param The environment to get the domain for ('dev', 'staging', or 'prod'). When in Isolated Cloud, the same value will be returned for all env types.\n * @returns The full domain associated with the subdomain for the given perimeter and environment\n */\nfunction getDomainForNonIsolatedCloud(subdomain, perimeter, envType) {\n  var _fullDomainOverride$s;\n  // First, check if the subdomain is associated with a global domain\n  if (globalDomains[subdomain]) {\n    return globalDomains[subdomain];\n  }\n\n  // Second, check if the subdomain is associated with a full domain override (ex. a domain that uses a different pattern in other perimeters/environments)\n  var override = (_fullDomainOverride$s = fullDomainOverride[subdomain]) === null || _fullDomainOverride$s === void 0 || (_fullDomainOverride$s = _fullDomainOverride$s[perimeter]) === null || _fullDomainOverride$s === void 0 ? void 0 : _fullDomainOverride$s[envType];\n  if (override) {\n    return override;\n  }\n\n  // Use default domain ending for the given perimeter\n  var domainMappings = nonIsolatedCloudFunctions[perimeter];\n  return domainMappings.defaultDomainEnding(subdomain, envType);\n}\n\n/**\n *\n * Gets the full URL for an Atlassian experience in the context of the current request\n * Returns undefined only when a new perimeter has been created that is not yet supported by the atlassian-context library\n *\n * @param subdomain - The Atlassian experience subdomain\n * @param The environment to get the domain for ('dev', 'staging', or 'prod'). When in Isolated Cloud, the same value will be returned for all env types.\n * @returns The full URL for the given subdomain and environment\n */\nexport function getUrlForDomainInContext(subdomain, envType) {\n  var domain = getDomainInContext(subdomain, envType);\n  if (!domain) {\n    console.warn(\"Domain could not be determined for requested subdomain: \".concat(subdomain));\n    return undefined;\n  }\n  return \"\".concat(globalThis.location.protocol, \"//\").concat(domain);\n}","map":{"version":3,"names":["COMMERCIAL","fullDomainOverride","globalDomains","cloudEnvironment","isolatedCloudDomain","AtlDomainMapping","isolatedCloudFunctions","nonIsolatedCloudFunctions","ReservedNameMapping","getDomainInContext","subdomain","envType","currentCloudEnvironment","undefined","type","domain","getDomainForIsolatedCloud","getDomainForNonIsolatedCloud","perimeter","domainMappings","includes","isolatedCloudReservedNameDomain","isolatedCloudAtlDomain","isolatedCloudVanityDomain","_fullDomainOverride$s","override","defaultDomainEnding","getUrlForDomainInContext","console","warn","concat","globalThis","location","protocol"],"sources":["/home/joshpoms/dndtest2/client/node_modules/@atlaskit/atlassian-context/dist/esm/services/generalized-domain-lookup/index.js"],"sourcesContent":["import { COMMERCIAL } from '../../common/constants';\nimport { fullDomainOverride, globalDomains } from '../../common/constants/domains';\nimport { cloudEnvironment, isolatedCloudDomain } from '../perimeter';\nimport { AtlDomainMapping, isolatedCloudFunctions, nonIsolatedCloudFunctions, ReservedNameMapping } from './constants';\n\n/**\n *\n * Gets the full domain for an Atlassian experience in the context of the current request.\n * Returns undefined only when a new perimeter has been created that is not yet supported by the atlassian-context library or when the ic domain cannot be retrieved.\n *\n * For Non Isolated Cloud, the domain will be determined by the perimeter and environment combination unless the subdomain belongs in the list of global domains or overrides.\n * For Isolated Cloud, the domain type defaults to the vanity name pattern.\n *\n * @param subdomain - The Atlassian experience subdomain\n * @param envType - The environment to get the domain for ('dev', 'staging', or 'prod'). When in Isolated Cloud, the same value will be returned for all env types.\n * @returns The full domain associated with the subdomain for the given environment\n */\n\nexport function getDomainInContext(subdomain, envType) {\n  var currentCloudEnvironment = cloudEnvironment();\n  if (currentCloudEnvironment === undefined) {\n    return undefined;\n  }\n  if (currentCloudEnvironment.type === 'isolated-cloud') {\n    var domain = isolatedCloudDomain();\n    if (domain === undefined) {\n      return undefined;\n    }\n    return getDomainForIsolatedCloud(subdomain, COMMERCIAL, domain);\n  }\n  return getDomainForNonIsolatedCloud(subdomain, currentCloudEnvironment.perimeter, envType);\n}\n\n/**\n * Gets the full Isolated Cloud domain\n * Returns undefined only if ic_domain cannot be determined from the atl-ctx cookies\n * Defaults to returning the vanity name pattern\n * @param subdomain - The Atlassian experience subdomain\n * @param perimeter - The Isolated Cloud perimeter to get the domain for\n * @param isolatedCloudDomain - The IC domain (ex. \"company.atlassian-isolated.net\")\n * @returns The full domain associated with the subdomain in a specific IC\n */\n\nfunction getDomainForIsolatedCloud(subdomain, perimeter, isolatedCloudDomain) {\n  var domainMappings = isolatedCloudFunctions[perimeter];\n  if (ReservedNameMapping[perimeter].includes(subdomain)) {\n    return domainMappings.isolatedCloudReservedNameDomain(subdomain, isolatedCloudDomain);\n  }\n  if (AtlDomainMapping[perimeter].includes(subdomain)) {\n    return domainMappings.isolatedCloudAtlDomain(subdomain, isolatedCloudDomain);\n  }\n  return domainMappings.isolatedCloudVanityDomain(subdomain, isolatedCloudDomain);\n}\n\n/**\n * Gets the full domain in an non-Isolated Cloud perimeter\n *\n * @param subdomain - The Atlassian experience subdomain\n * @param perimeter - The non-isolated cloud perimeter to get the domain for\n * @param The environment to get the domain for ('dev', 'staging', or 'prod'). When in Isolated Cloud, the same value will be returned for all env types.\n * @returns The full domain associated with the subdomain for the given perimeter and environment\n */\nfunction getDomainForNonIsolatedCloud(subdomain, perimeter, envType) {\n  var _fullDomainOverride$s;\n  // First, check if the subdomain is associated with a global domain\n  if (globalDomains[subdomain]) {\n    return globalDomains[subdomain];\n  }\n\n  // Second, check if the subdomain is associated with a full domain override (ex. a domain that uses a different pattern in other perimeters/environments)\n  var override = (_fullDomainOverride$s = fullDomainOverride[subdomain]) === null || _fullDomainOverride$s === void 0 || (_fullDomainOverride$s = _fullDomainOverride$s[perimeter]) === null || _fullDomainOverride$s === void 0 ? void 0 : _fullDomainOverride$s[envType];\n  if (override) {\n    return override;\n  }\n\n  // Use default domain ending for the given perimeter\n  var domainMappings = nonIsolatedCloudFunctions[perimeter];\n  return domainMappings.defaultDomainEnding(subdomain, envType);\n}\n\n/**\n *\n * Gets the full URL for an Atlassian experience in the context of the current request\n * Returns undefined only when a new perimeter has been created that is not yet supported by the atlassian-context library\n *\n * @param subdomain - The Atlassian experience subdomain\n * @param The environment to get the domain for ('dev', 'staging', or 'prod'). When in Isolated Cloud, the same value will be returned for all env types.\n * @returns The full URL for the given subdomain and environment\n */\nexport function getUrlForDomainInContext(subdomain, envType) {\n  var domain = getDomainInContext(subdomain, envType);\n  if (!domain) {\n    console.warn(\"Domain could not be determined for requested subdomain: \".concat(subdomain));\n    return undefined;\n  }\n  return \"\".concat(globalThis.location.protocol, \"//\").concat(domain);\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}