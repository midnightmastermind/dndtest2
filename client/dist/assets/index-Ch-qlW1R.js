function oL(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in t)){const o=Object.getOwnPropertyDescriptor(r,i);o&&Object.defineProperty(t,i,o.get?o:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}})();function Qx(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Ey={exports:{}},Vc={};var BE;function sL(){if(BE)return Vc;BE=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function n(r,i,o){var a=null;if(o!==void 0&&(a=""+o),i.key!==void 0&&(a=""+i.key),"key"in i){o={};for(var c in i)c!=="key"&&(o[c]=i[c])}else o=i;return i=o.ref,{$$typeof:t,type:r,key:a,ref:i!==void 0?i:null,props:o}}return Vc.Fragment=e,Vc.jsx=n,Vc.jsxs=n,Vc}var FE;function aL(){return FE||(FE=1,Ey.exports=sL()),Ey.exports}var h=aL(),Cy={exports:{}},lt={};var $E;function lL(){if($E)return lt;$E=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),a=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),g=Symbol.for("react.activity"),v=Symbol.iterator;function y(P){return P===null||typeof P!="object"?null:(P=v&&P[v]||P["@@iterator"],typeof P=="function"?P:null)}var w={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},S=Object.assign,C={};function T(P,K,B){this.props=P,this.context=K,this.refs=C,this.updater=B||w}T.prototype.isReactComponent={},T.prototype.setState=function(P,K){if(typeof P!="object"&&typeof P!="function"&&P!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,P,K,"setState")},T.prototype.forceUpdate=function(P){this.updater.enqueueForceUpdate(this,P,"forceUpdate")};function N(){}N.prototype=T.prototype;function k(P,K,B){this.props=P,this.context=K,this.refs=C,this.updater=B||w}var D=k.prototype=new N;D.constructor=k,S(D,T.prototype),D.isPureReactComponent=!0;var M=Array.isArray;function R(){}var O={H:null,A:null,T:null,S:null},I=Object.prototype.hasOwnProperty;function z(P,K,B){var Z=B.ref;return{$$typeof:t,type:P,key:K,ref:Z!==void 0?Z:null,props:B}}function U(P,K){return z(P.type,K,P.props)}function Y(P){return typeof P=="object"&&P!==null&&P.$$typeof===t}function W(P){var K={"=":"=0",":":"=2"};return"$"+P.replace(/[=:]/g,function(B){return K[B]})}var j=/\/+/g;function G(P,K){return typeof P=="object"&&P!==null&&P.key!=null?W(""+P.key):K.toString(36)}function oe(P){switch(P.status){case"fulfilled":return P.value;case"rejected":throw P.reason;default:switch(typeof P.status=="string"?P.then(R,R):(P.status="pending",P.then(function(K){P.status==="pending"&&(P.status="fulfilled",P.value=K)},function(K){P.status==="pending"&&(P.status="rejected",P.reason=K)})),P.status){case"fulfilled":return P.value;case"rejected":throw P.reason}}throw P}function L(P,K,B,Z,le){var be=typeof P;(be==="undefined"||be==="boolean")&&(P=null);var H=!1;if(P===null)H=!0;else switch(be){case"bigint":case"string":case"number":H=!0;break;case"object":switch(P.$$typeof){case t:case e:H=!0;break;case p:return H=P._init,L(H(P._payload),K,B,Z,le)}}if(H)return le=le(P),H=Z===""?"."+G(P,0):Z,M(le)?(B="",H!=null&&(B=H.replace(j,"$&/")+"/"),L(le,K,B,"",function(me){return me})):le!=null&&(Y(le)&&(le=U(le,B+(le.key==null||P&&P.key===le.key?"":(""+le.key).replace(j,"$&/")+"/")+H)),K.push(le)),1;H=0;var ce=Z===""?".":Z+":";if(M(P))for(var te=0;te<P.length;te++)Z=P[te],be=ce+G(Z,te),H+=L(Z,K,B,be,le);else if(te=y(P),typeof te=="function")for(P=te.call(P),te=0;!(Z=P.next()).done;)Z=Z.value,be=ce+G(Z,te++),H+=L(Z,K,B,be,le);else if(be==="object"){if(typeof P.then=="function")return L(oe(P),K,B,Z,le);throw K=String(P),Error("Objects are not valid as a React child (found: "+(K==="[object Object]"?"object with keys {"+Object.keys(P).join(", ")+"}":K)+"). If you meant to render a collection of children, use an array instead.")}return H}function $(P,K,B){if(P==null)return P;var Z=[],le=0;return L(P,Z,"","",function(be){return K.call(B,be,le++)}),Z}function V(P){if(P._status===-1){var K=P._result;K=K(),K.then(function(B){(P._status===0||P._status===-1)&&(P._status=1,P._result=B)},function(B){(P._status===0||P._status===-1)&&(P._status=2,P._result=B)}),P._status===-1&&(P._status=0,P._result=K)}if(P._status===1)return P._result.default;throw P._result}var we=typeof reportError=="function"?reportError:function(P){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var K=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof P=="object"&&P!==null&&typeof P.message=="string"?String(P.message):String(P),error:P});if(!window.dispatchEvent(K))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",P);return}console.error(P)},pe={map:$,forEach:function(P,K,B){$(P,function(){K.apply(this,arguments)},B)},count:function(P){var K=0;return $(P,function(){K++}),K},toArray:function(P){return $(P,function(K){return K})||[]},only:function(P){if(!Y(P))throw Error("React.Children.only expected to receive a single React element child.");return P}};return lt.Activity=g,lt.Children=pe,lt.Component=T,lt.Fragment=n,lt.Profiler=i,lt.PureComponent=k,lt.StrictMode=r,lt.Suspense=u,lt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=O,lt.__COMPILER_RUNTIME={__proto__:null,c:function(P){return O.H.useMemoCache(P)}},lt.cache=function(P){return function(){return P.apply(null,arguments)}},lt.cacheSignal=function(){return null},lt.cloneElement=function(P,K,B){if(P==null)throw Error("The argument must be a React element, but you passed "+P+".");var Z=S({},P.props),le=P.key;if(K!=null)for(be in K.key!==void 0&&(le=""+K.key),K)!I.call(K,be)||be==="key"||be==="__self"||be==="__source"||be==="ref"&&K.ref===void 0||(Z[be]=K[be]);var be=arguments.length-2;if(be===1)Z.children=B;else if(1<be){for(var H=Array(be),ce=0;ce<be;ce++)H[ce]=arguments[ce+2];Z.children=H}return z(P.type,le,Z)},lt.createContext=function(P){return P={$$typeof:a,_currentValue:P,_currentValue2:P,_threadCount:0,Provider:null,Consumer:null},P.Provider=P,P.Consumer={$$typeof:o,_context:P},P},lt.createElement=function(P,K,B){var Z,le={},be=null;if(K!=null)for(Z in K.key!==void 0&&(be=""+K.key),K)I.call(K,Z)&&Z!=="key"&&Z!=="__self"&&Z!=="__source"&&(le[Z]=K[Z]);var H=arguments.length-2;if(H===1)le.children=B;else if(1<H){for(var ce=Array(H),te=0;te<H;te++)ce[te]=arguments[te+2];le.children=ce}if(P&&P.defaultProps)for(Z in H=P.defaultProps,H)le[Z]===void 0&&(le[Z]=H[Z]);return z(P,be,le)},lt.createRef=function(){return{current:null}},lt.forwardRef=function(P){return{$$typeof:c,render:P}},lt.isValidElement=Y,lt.lazy=function(P){return{$$typeof:p,_payload:{_status:-1,_result:P},_init:V}},lt.memo=function(P,K){return{$$typeof:f,type:P,compare:K===void 0?null:K}},lt.startTransition=function(P){var K=O.T,B={};O.T=B;try{var Z=P(),le=O.S;le!==null&&le(B,Z),typeof Z=="object"&&Z!==null&&typeof Z.then=="function"&&Z.then(R,we)}catch(be){we(be)}finally{K!==null&&B.types!==null&&(K.types=B.types),O.T=K}},lt.unstable_useCacheRefresh=function(){return O.H.useCacheRefresh()},lt.use=function(P){return O.H.use(P)},lt.useActionState=function(P,K,B){return O.H.useActionState(P,K,B)},lt.useCallback=function(P,K){return O.H.useCallback(P,K)},lt.useContext=function(P){return O.H.useContext(P)},lt.useDebugValue=function(){},lt.useDeferredValue=function(P,K){return O.H.useDeferredValue(P,K)},lt.useEffect=function(P,K){return O.H.useEffect(P,K)},lt.useEffectEvent=function(P){return O.H.useEffectEvent(P)},lt.useId=function(){return O.H.useId()},lt.useImperativeHandle=function(P,K,B){return O.H.useImperativeHandle(P,K,B)},lt.useInsertionEffect=function(P,K){return O.H.useInsertionEffect(P,K)},lt.useLayoutEffect=function(P,K){return O.H.useLayoutEffect(P,K)},lt.useMemo=function(P,K){return O.H.useMemo(P,K)},lt.useOptimistic=function(P,K){return O.H.useOptimistic(P,K)},lt.useReducer=function(P,K,B){return O.H.useReducer(P,K,B)},lt.useRef=function(P){return O.H.useRef(P)},lt.useState=function(P){return O.H.useState(P)},lt.useSyncExternalStore=function(P,K,B){return O.H.useSyncExternalStore(P,K,B)},lt.useTransition=function(){return O.H.useTransition()},lt.version="19.2.4",lt}var HE;function Wu(){return HE||(HE=1,Cy.exports=lL()),Cy.exports}var x=Wu();const Se=Qx(x),Zx=oL({__proto__:null,default:Se},[x]);var Ty={exports:{}},qc={},Ny={exports:{}},Ay={};var UE;function cL(){return UE||(UE=1,(function(t){function e(L,$){var V=L.length;L.push($);e:for(;0<V;){var we=V-1>>>1,pe=L[we];if(0<i(pe,$))L[we]=$,L[V]=pe,V=we;else break e}}function n(L){return L.length===0?null:L[0]}function r(L){if(L.length===0)return null;var $=L[0],V=L.pop();if(V!==$){L[0]=V;e:for(var we=0,pe=L.length,P=pe>>>1;we<P;){var K=2*(we+1)-1,B=L[K],Z=K+1,le=L[Z];if(0>i(B,V))Z<pe&&0>i(le,B)?(L[we]=le,L[Z]=V,we=Z):(L[we]=B,L[K]=V,we=K);else if(Z<pe&&0>i(le,V))L[we]=le,L[Z]=V,we=Z;else break e}}return $}function i(L,$){var V=L.sortIndex-$.sortIndex;return V!==0?V:L.id-$.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;t.unstable_now=function(){return o.now()}}else{var a=Date,c=a.now();t.unstable_now=function(){return a.now()-c}}var u=[],f=[],p=1,g=null,v=3,y=!1,w=!1,S=!1,C=!1,T=typeof setTimeout=="function"?setTimeout:null,N=typeof clearTimeout=="function"?clearTimeout:null,k=typeof setImmediate<"u"?setImmediate:null;function D(L){for(var $=n(f);$!==null;){if($.callback===null)r(f);else if($.startTime<=L)r(f),$.sortIndex=$.expirationTime,e(u,$);else break;$=n(f)}}function M(L){if(S=!1,D(L),!w)if(n(u)!==null)w=!0,R||(R=!0,W());else{var $=n(f);$!==null&&oe(M,$.startTime-L)}}var R=!1,O=-1,I=5,z=-1;function U(){return C?!0:!(t.unstable_now()-z<I)}function Y(){if(C=!1,R){var L=t.unstable_now();z=L;var $=!0;try{e:{w=!1,S&&(S=!1,N(O),O=-1),y=!0;var V=v;try{t:{for(D(L),g=n(u);g!==null&&!(g.expirationTime>L&&U());){var we=g.callback;if(typeof we=="function"){g.callback=null,v=g.priorityLevel;var pe=we(g.expirationTime<=L);if(L=t.unstable_now(),typeof pe=="function"){g.callback=pe,D(L),$=!0;break t}g===n(u)&&r(u),D(L)}else r(u);g=n(u)}if(g!==null)$=!0;else{var P=n(f);P!==null&&oe(M,P.startTime-L),$=!1}}break e}finally{g=null,v=V,y=!1}$=void 0}}finally{$?W():R=!1}}}var W;if(typeof k=="function")W=function(){k(Y)};else if(typeof MessageChannel<"u"){var j=new MessageChannel,G=j.port2;j.port1.onmessage=Y,W=function(){G.postMessage(null)}}else W=function(){T(Y,0)};function oe(L,$){O=T(function(){L(t.unstable_now())},$)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(L){L.callback=null},t.unstable_forceFrameRate=function(L){0>L||125<L?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<L?Math.floor(1e3/L):5},t.unstable_getCurrentPriorityLevel=function(){return v},t.unstable_next=function(L){switch(v){case 1:case 2:case 3:var $=3;break;default:$=v}var V=v;v=$;try{return L()}finally{v=V}},t.unstable_requestPaint=function(){C=!0},t.unstable_runWithPriority=function(L,$){switch(L){case 1:case 2:case 3:case 4:case 5:break;default:L=3}var V=v;v=L;try{return $()}finally{v=V}},t.unstable_scheduleCallback=function(L,$,V){var we=t.unstable_now();switch(typeof V=="object"&&V!==null?(V=V.delay,V=typeof V=="number"&&0<V?we+V:we):V=we,L){case 1:var pe=-1;break;case 2:pe=250;break;case 5:pe=1073741823;break;case 4:pe=1e4;break;default:pe=5e3}return pe=V+pe,L={id:p++,callback:$,priorityLevel:L,startTime:V,expirationTime:pe,sortIndex:-1},V>we?(L.sortIndex=V,e(f,L),n(u)===null&&L===n(f)&&(S?(N(O),O=-1):S=!0,oe(M,V-we))):(L.sortIndex=pe,e(u,L),w||y||(w=!0,R||(R=!0,W()))),L},t.unstable_shouldYield=U,t.unstable_wrapCallback=function(L){var $=v;return function(){var V=v;v=$;try{return L.apply(this,arguments)}finally{v=V}}}})(Ay)),Ay}var VE;function uL(){return VE||(VE=1,Ny.exports=cL()),Ny.exports}var ky={exports:{}},Un={};var qE;function dL(){if(qE)return Un;qE=1;var t=Wu();function e(u){var f="https://react.dev/errors/"+u;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)f+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+u+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var r={d:{f:n,r:function(){throw Error(e(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},i=Symbol.for("react.portal");function o(u,f,p){var g=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:i,key:g==null?null:""+g,children:u,containerInfo:f,implementation:p}}var a=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(u,f){if(u==="font")return"";if(typeof f=="string")return f==="use-credentials"?f:""}return Un.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,Un.createPortal=function(u,f){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11)throw Error(e(299));return o(u,f,null,p)},Un.flushSync=function(u){var f=a.T,p=r.p;try{if(a.T=null,r.p=2,u)return u()}finally{a.T=f,r.p=p,r.d.f()}},Un.preconnect=function(u,f){typeof u=="string"&&(f?(f=f.crossOrigin,f=typeof f=="string"?f==="use-credentials"?f:"":void 0):f=null,r.d.C(u,f))},Un.prefetchDNS=function(u){typeof u=="string"&&r.d.D(u)},Un.preinit=function(u,f){if(typeof u=="string"&&f&&typeof f.as=="string"){var p=f.as,g=c(p,f.crossOrigin),v=typeof f.integrity=="string"?f.integrity:void 0,y=typeof f.fetchPriority=="string"?f.fetchPriority:void 0;p==="style"?r.d.S(u,typeof f.precedence=="string"?f.precedence:void 0,{crossOrigin:g,integrity:v,fetchPriority:y}):p==="script"&&r.d.X(u,{crossOrigin:g,integrity:v,fetchPriority:y,nonce:typeof f.nonce=="string"?f.nonce:void 0})}},Un.preinitModule=function(u,f){if(typeof u=="string")if(typeof f=="object"&&f!==null){if(f.as==null||f.as==="script"){var p=c(f.as,f.crossOrigin);r.d.M(u,{crossOrigin:p,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0})}}else f==null&&r.d.M(u)},Un.preload=function(u,f){if(typeof u=="string"&&typeof f=="object"&&f!==null&&typeof f.as=="string"){var p=f.as,g=c(p,f.crossOrigin);r.d.L(u,p,{crossOrigin:g,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0,type:typeof f.type=="string"?f.type:void 0,fetchPriority:typeof f.fetchPriority=="string"?f.fetchPriority:void 0,referrerPolicy:typeof f.referrerPolicy=="string"?f.referrerPolicy:void 0,imageSrcSet:typeof f.imageSrcSet=="string"?f.imageSrcSet:void 0,imageSizes:typeof f.imageSizes=="string"?f.imageSizes:void 0,media:typeof f.media=="string"?f.media:void 0})}},Un.preloadModule=function(u,f){if(typeof u=="string")if(f){var p=c(f.as,f.crossOrigin);r.d.m(u,{as:typeof f.as=="string"&&f.as!=="script"?f.as:void 0,crossOrigin:p,integrity:typeof f.integrity=="string"?f.integrity:void 0})}else r.d.m(u)},Un.requestFormReset=function(u){r.d.r(u)},Un.unstable_batchedUpdates=function(u,f){return u(f)},Un.useFormState=function(u,f,p){return a.H.useFormState(u,f,p)},Un.useFormStatus=function(){return a.H.useHostTransitionStatus()},Un.version="19.2.4",Un}var GE;function gA(){if(GE)return ky.exports;GE=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),ky.exports=dL(),ky.exports}var WE;function fL(){if(WE)return qc;WE=1;var t=uL(),e=Wu(),n=gA();function r(s){var l="https://react.dev/errors/"+s;if(1<arguments.length){l+="?args[]="+encodeURIComponent(arguments[1]);for(var d=2;d<arguments.length;d++)l+="&args[]="+encodeURIComponent(arguments[d])}return"Minified React error #"+s+"; visit "+l+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function o(s){var l=s,d=s;if(s.alternate)for(;l.return;)l=l.return;else{s=l;do l=s,(l.flags&4098)!==0&&(d=l.return),s=l.return;while(s)}return l.tag===3?d:null}function a(s){if(s.tag===13){var l=s.memoizedState;if(l===null&&(s=s.alternate,s!==null&&(l=s.memoizedState)),l!==null)return l.dehydrated}return null}function c(s){if(s.tag===31){var l=s.memoizedState;if(l===null&&(s=s.alternate,s!==null&&(l=s.memoizedState)),l!==null)return l.dehydrated}return null}function u(s){if(o(s)!==s)throw Error(r(188))}function f(s){var l=s.alternate;if(!l){if(l=o(s),l===null)throw Error(r(188));return l!==s?null:s}for(var d=s,m=l;;){var b=d.return;if(b===null)break;var E=b.alternate;if(E===null){if(m=b.return,m!==null){d=m;continue}break}if(b.child===E.child){for(E=b.child;E;){if(E===d)return u(b),s;if(E===m)return u(b),l;E=E.sibling}throw Error(r(188))}if(d.return!==m.return)d=b,m=E;else{for(var A=!1,_=b.child;_;){if(_===d){A=!0,d=b,m=E;break}if(_===m){A=!0,m=b,d=E;break}_=_.sibling}if(!A){for(_=E.child;_;){if(_===d){A=!0,d=E,m=b;break}if(_===m){A=!0,m=E,d=b;break}_=_.sibling}if(!A)throw Error(r(189))}}if(d.alternate!==m)throw Error(r(190))}if(d.tag!==3)throw Error(r(188));return d.stateNode.current===d?s:l}function p(s){var l=s.tag;if(l===5||l===26||l===27||l===6)return s;for(s=s.child;s!==null;){if(l=p(s),l!==null)return l;s=s.sibling}return null}var g=Object.assign,v=Symbol.for("react.element"),y=Symbol.for("react.transitional.element"),w=Symbol.for("react.portal"),S=Symbol.for("react.fragment"),C=Symbol.for("react.strict_mode"),T=Symbol.for("react.profiler"),N=Symbol.for("react.consumer"),k=Symbol.for("react.context"),D=Symbol.for("react.forward_ref"),M=Symbol.for("react.suspense"),R=Symbol.for("react.suspense_list"),O=Symbol.for("react.memo"),I=Symbol.for("react.lazy"),z=Symbol.for("react.activity"),U=Symbol.for("react.memo_cache_sentinel"),Y=Symbol.iterator;function W(s){return s===null||typeof s!="object"?null:(s=Y&&s[Y]||s["@@iterator"],typeof s=="function"?s:null)}var j=Symbol.for("react.client.reference");function G(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===j?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case S:return"Fragment";case T:return"Profiler";case C:return"StrictMode";case M:return"Suspense";case R:return"SuspenseList";case z:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case w:return"Portal";case k:return s.displayName||"Context";case N:return(s._context.displayName||"Context")+".Consumer";case D:var l=s.render;return s=s.displayName,s||(s=l.displayName||l.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case O:return l=s.displayName||null,l!==null?l:G(s.type)||"Memo";case I:l=s._payload,s=s._init;try{return G(s(l))}catch{}}return null}var oe=Array.isArray,L=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,$=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,V={pending:!1,data:null,method:null,action:null},we=[],pe=-1;function P(s){return{current:s}}function K(s){0>pe||(s.current=we[pe],we[pe]=null,pe--)}function B(s,l){pe++,we[pe]=s.current,s.current=l}var Z=P(null),le=P(null),be=P(null),H=P(null);function ce(s,l){switch(B(be,l),B(le,s),B(Z,null),l.nodeType){case 9:case 11:s=(s=l.documentElement)&&(s=s.namespaceURI)?lE(s):0;break;default:if(s=l.tagName,l=l.namespaceURI)l=lE(l),s=cE(l,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}K(Z),B(Z,s)}function te(){K(Z),K(le),K(be)}function me(s){s.memoizedState!==null&&B(H,s);var l=Z.current,d=cE(l,s.type);l!==d&&(B(le,s),B(Z,d))}function Te(s){le.current===s&&(K(Z),K(le)),H.current===s&&(K(H),Fc._currentValue=V)}var re,he;function Ae(s){if(re===void 0)try{throw Error()}catch(d){var l=d.stack.trim().match(/\n( *(at )?)/);re=l&&l[1]||"",he=-1<d.stack.indexOf(`
    at`)?" (<anonymous>)":-1<d.stack.indexOf("@")?"@unknown:0:0":""}return`
`+re+s+he}var Re=!1;function Le(s,l){if(!s||Re)return"";Re=!0;var d=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var m={DetermineComponentFrameRoot:function(){try{if(l){var xe=function(){throw Error()};if(Object.defineProperty(xe.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(xe,[])}catch(fe){var se=fe}Reflect.construct(s,[],xe)}else{try{xe.call()}catch(fe){se=fe}s.call(xe.prototype)}}else{try{throw Error()}catch(fe){se=fe}(xe=s())&&typeof xe.catch=="function"&&xe.catch(function(){})}}catch(fe){if(fe&&se&&typeof fe.stack=="string")return[fe.stack,se.stack]}return[null,null]}};m.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var b=Object.getOwnPropertyDescriptor(m.DetermineComponentFrameRoot,"name");b&&b.configurable&&Object.defineProperty(m.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var E=m.DetermineComponentFrameRoot(),A=E[0],_=E[1];if(A&&_){var F=A.split(`
`),ie=_.split(`
`);for(b=m=0;m<F.length&&!F[m].includes("DetermineComponentFrameRoot");)m++;for(;b<ie.length&&!ie[b].includes("DetermineComponentFrameRoot");)b++;if(m===F.length||b===ie.length)for(m=F.length-1,b=ie.length-1;1<=m&&0<=b&&F[m]!==ie[b];)b--;for(;1<=m&&0<=b;m--,b--)if(F[m]!==ie[b]){if(m!==1||b!==1)do if(m--,b--,0>b||F[m]!==ie[b]){var ge=`
`+F[m].replace(" at new "," at ");return s.displayName&&ge.includes("<anonymous>")&&(ge=ge.replace("<anonymous>",s.displayName)),ge}while(1<=m&&0<=b);break}}}finally{Re=!1,Error.prepareStackTrace=d}return(d=s?s.displayName||s.name:"")?Ae(d):""}function ae(s,l){switch(s.tag){case 26:case 27:case 5:return Ae(s.type);case 16:return Ae("Lazy");case 13:return s.child!==l&&l!==null?Ae("Suspense Fallback"):Ae("Suspense");case 19:return Ae("SuspenseList");case 0:case 15:return Le(s.type,!1);case 11:return Le(s.type.render,!1);case 1:return Le(s.type,!0);case 31:return Ae("Activity");default:return""}}function Me(s){try{var l="",d=null;do l+=ae(s,d),d=s,s=s.return;while(s);return l}catch(m){return`
Error generating stack: `+m.message+`
`+m.stack}}var J=Object.prototype.hasOwnProperty,X=t.unstable_scheduleCallback,ve=t.unstable_cancelCallback,Ce=t.unstable_shouldYield,Oe=t.unstable_requestPaint,Ye=t.unstable_now,et=t.unstable_getCurrentPriorityLevel,at=t.unstable_ImmediatePriority,ct=t.unstable_UserBlockingPriority,ze=t.unstable_NormalPriority,He=t.unstable_LowPriority,ke=t.unstable_IdlePriority,rt=t.log,Ge=t.unstable_setDisableYieldValue,pt=null,Ke=null;function ut(s){if(typeof rt=="function"&&Ge(s),Ke&&typeof Ke.setStrictMode=="function")try{Ke.setStrictMode(pt,s)}catch{}}var Qe=Math.clz32?Math.clz32:de,jt=Math.log,dt=Math.LN2;function de(s){return s>>>=0,s===0?32:31-(jt(s)/dt|0)|0}var De=256,yt=262144,mt=4194304;function We(s){var l=s&42;if(l!==0)return l;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return s&261888;case 262144:case 524288:case 1048576:case 2097152:return s&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function Be(s,l,d){var m=s.pendingLanes;if(m===0)return 0;var b=0,E=s.suspendedLanes,A=s.pingedLanes;s=s.warmLanes;var _=m&134217727;return _!==0?(m=_&~E,m!==0?b=We(m):(A&=_,A!==0?b=We(A):d||(d=_&~s,d!==0&&(b=We(d))))):(_=m&~E,_!==0?b=We(_):A!==0?b=We(A):d||(d=m&~s,d!==0&&(b=We(d)))),b===0?0:l!==0&&l!==b&&(l&E)===0&&(E=b&-b,d=l&-l,E>=d||E===32&&(d&4194048)!==0)?l:b}function Dt(s,l){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&l)===0}function rn(s,l){switch(s){case 1:case 2:case 4:case 8:case 64:return l+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Tn(){var s=mt;return mt<<=1,(mt&62914560)===0&&(mt=4194304),s}function xo(s){for(var l=[],d=0;31>d;d++)l.push(s);return l}function on(s,l){s.pendingLanes|=l,l!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function tr(s,l,d,m,b,E){var A=s.pendingLanes;s.pendingLanes=d,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=d,s.entangledLanes&=d,s.errorRecoveryDisabledLanes&=d,s.shellSuspendCounter=0;var _=s.entanglements,F=s.expirationTimes,ie=s.hiddenUpdates;for(d=A&~d;0<d;){var ge=31-Qe(d),xe=1<<ge;_[ge]=0,F[ge]=-1;var se=ie[ge];if(se!==null)for(ie[ge]=null,ge=0;ge<se.length;ge++){var fe=se[ge];fe!==null&&(fe.lane&=-536870913)}d&=~xe}m!==0&&Ns(s,m,0),E!==0&&b===0&&s.tag!==0&&(s.suspendedLanes|=E&~(A&~l))}function Ns(s,l,d){s.pendingLanes|=l,s.suspendedLanes&=~l;var m=31-Qe(l);s.entangledLanes|=l,s.entanglements[m]=s.entanglements[m]|1073741824|d&261930}function nr(s,l){var d=s.entangledLanes|=l;for(s=s.entanglements;d;){var m=31-Qe(d),b=1<<m;b&l|s[m]&l&&(s[m]|=l),d&=~b}}function rr(s,l){var d=l&-l;return d=(d&42)!==0?1:wa(d),(d&(s.suspendedLanes|l))!==0?0:d}function wa(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function Kr(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function hm(){var s=$.p;return s!==0?s:(s=window.event,s===void 0?32:RE(s.type))}function Y0(s,l){var d=$.p;try{return $.p=s,l()}finally{$.p=d}}var bo=Math.random().toString(36).slice(2),jn="__reactFiber$"+bo,ir="__reactProps$"+bo,Sa="__reactContainer$"+bo,pm="__reactEvents$"+bo,Yj="__reactListeners$"+bo,Kj="__reactHandles$"+bo,K0="__reactResources$"+bo,tc="__reactMarker$"+bo;function mm(s){delete s[jn],delete s[ir],delete s[pm],delete s[Yj],delete s[Kj]}function Ea(s){var l=s[jn];if(l)return l;for(var d=s.parentNode;d;){if(l=d[Sa]||d[jn]){if(d=l.alternate,l.child!==null||d!==null&&d.child!==null)for(s=gE(s);s!==null;){if(d=s[jn])return d;s=gE(s)}return l}s=d,d=s.parentNode}return null}function Ca(s){if(s=s[jn]||s[Sa]){var l=s.tag;if(l===5||l===6||l===13||l===31||l===26||l===27||l===3)return s}return null}function nc(s){var l=s.tag;if(l===5||l===26||l===27||l===6)return s.stateNode;throw Error(r(33))}function Ta(s){var l=s[K0];return l||(l=s[K0]={hoistableStyles:new Map,hoistableScripts:new Map}),l}function Nn(s){s[tc]=!0}var X0=new Set,J0={};function As(s,l){Na(s,l),Na(s+"Capture",l)}function Na(s,l){for(J0[s]=l,s=0;s<l.length;s++)X0.add(l[s])}var Xj=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Q0={},Z0={};function Jj(s){return J.call(Z0,s)?!0:J.call(Q0,s)?!1:Xj.test(s)?Z0[s]=!0:(Q0[s]=!0,!1)}function ld(s,l,d){if(Jj(l))if(d===null)s.removeAttribute(l);else{switch(typeof d){case"undefined":case"function":case"symbol":s.removeAttribute(l);return;case"boolean":var m=l.toLowerCase().slice(0,5);if(m!=="data-"&&m!=="aria-"){s.removeAttribute(l);return}}s.setAttribute(l,""+d)}}function cd(s,l,d){if(d===null)s.removeAttribute(l);else{switch(typeof d){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(l);return}s.setAttribute(l,""+d)}}function Ii(s,l,d,m){if(m===null)s.removeAttribute(d);else{switch(typeof m){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(d);return}s.setAttributeNS(l,d,""+m)}}function Dr(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function e1(s){var l=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(l==="checkbox"||l==="radio")}function Qj(s,l,d){var m=Object.getOwnPropertyDescriptor(s.constructor.prototype,l);if(!s.hasOwnProperty(l)&&typeof m<"u"&&typeof m.get=="function"&&typeof m.set=="function"){var b=m.get,E=m.set;return Object.defineProperty(s,l,{configurable:!0,get:function(){return b.call(this)},set:function(A){d=""+A,E.call(this,A)}}),Object.defineProperty(s,l,{enumerable:m.enumerable}),{getValue:function(){return d},setValue:function(A){d=""+A},stopTracking:function(){s._valueTracker=null,delete s[l]}}}}function gm(s){if(!s._valueTracker){var l=e1(s)?"checked":"value";s._valueTracker=Qj(s,l,""+s[l])}}function t1(s){if(!s)return!1;var l=s._valueTracker;if(!l)return!0;var d=l.getValue(),m="";return s&&(m=e1(s)?s.checked?"true":"false":s.value),s=m,s!==d?(l.setValue(s),!0):!1}function ud(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var Zj=/[\n"\\]/g;function Or(s){return s.replace(Zj,function(l){return"\\"+l.charCodeAt(0).toString(16)+" "})}function ym(s,l,d,m,b,E,A,_){s.name="",A!=null&&typeof A!="function"&&typeof A!="symbol"&&typeof A!="boolean"?s.type=A:s.removeAttribute("type"),l!=null?A==="number"?(l===0&&s.value===""||s.value!=l)&&(s.value=""+Dr(l)):s.value!==""+Dr(l)&&(s.value=""+Dr(l)):A!=="submit"&&A!=="reset"||s.removeAttribute("value"),l!=null?vm(s,A,Dr(l)):d!=null?vm(s,A,Dr(d)):m!=null&&s.removeAttribute("value"),b==null&&E!=null&&(s.defaultChecked=!!E),b!=null&&(s.checked=b&&typeof b!="function"&&typeof b!="symbol"),_!=null&&typeof _!="function"&&typeof _!="symbol"&&typeof _!="boolean"?s.name=""+Dr(_):s.removeAttribute("name")}function n1(s,l,d,m,b,E,A,_){if(E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"&&(s.type=E),l!=null||d!=null){if(!(E!=="submit"&&E!=="reset"||l!=null)){gm(s);return}d=d!=null?""+Dr(d):"",l=l!=null?""+Dr(l):d,_||l===s.value||(s.value=l),s.defaultValue=l}m=m??b,m=typeof m!="function"&&typeof m!="symbol"&&!!m,s.checked=_?s.checked:!!m,s.defaultChecked=!!m,A!=null&&typeof A!="function"&&typeof A!="symbol"&&typeof A!="boolean"&&(s.name=A),gm(s)}function vm(s,l,d){l==="number"&&ud(s.ownerDocument)===s||s.defaultValue===""+d||(s.defaultValue=""+d)}function Aa(s,l,d,m){if(s=s.options,l){l={};for(var b=0;b<d.length;b++)l["$"+d[b]]=!0;for(d=0;d<s.length;d++)b=l.hasOwnProperty("$"+s[d].value),s[d].selected!==b&&(s[d].selected=b),b&&m&&(s[d].defaultSelected=!0)}else{for(d=""+Dr(d),l=null,b=0;b<s.length;b++){if(s[b].value===d){s[b].selected=!0,m&&(s[b].defaultSelected=!0);return}l!==null||s[b].disabled||(l=s[b])}l!==null&&(l.selected=!0)}}function r1(s,l,d){if(l!=null&&(l=""+Dr(l),l!==s.value&&(s.value=l),d==null)){s.defaultValue!==l&&(s.defaultValue=l);return}s.defaultValue=d!=null?""+Dr(d):""}function i1(s,l,d,m){if(l==null){if(m!=null){if(d!=null)throw Error(r(92));if(oe(m)){if(1<m.length)throw Error(r(93));m=m[0]}d=m}d==null&&(d=""),l=d}d=Dr(l),s.defaultValue=d,m=s.textContent,m===d&&m!==""&&m!==null&&(s.value=m),gm(s)}function ka(s,l){if(l){var d=s.firstChild;if(d&&d===s.lastChild&&d.nodeType===3){d.nodeValue=l;return}}s.textContent=l}var eI=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function o1(s,l,d){var m=l.indexOf("--")===0;d==null||typeof d=="boolean"||d===""?m?s.setProperty(l,""):l==="float"?s.cssFloat="":s[l]="":m?s.setProperty(l,d):typeof d!="number"||d===0||eI.has(l)?l==="float"?s.cssFloat=d:s[l]=(""+d).trim():s[l]=d+"px"}function s1(s,l,d){if(l!=null&&typeof l!="object")throw Error(r(62));if(s=s.style,d!=null){for(var m in d)!d.hasOwnProperty(m)||l!=null&&l.hasOwnProperty(m)||(m.indexOf("--")===0?s.setProperty(m,""):m==="float"?s.cssFloat="":s[m]="");for(var b in l)m=l[b],l.hasOwnProperty(b)&&d[b]!==m&&o1(s,b,m)}else for(var E in l)l.hasOwnProperty(E)&&o1(s,E,l[E])}function xm(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var tI=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),nI=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function dd(s){return nI.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}function _i(){}var bm=null;function wm(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var Da=null,Oa=null;function a1(s){var l=Ca(s);if(l&&(s=l.stateNode)){var d=s[ir]||null;e:switch(s=l.stateNode,l.type){case"input":if(ym(s,d.value,d.defaultValue,d.defaultValue,d.checked,d.defaultChecked,d.type,d.name),l=d.name,d.type==="radio"&&l!=null){for(d=s;d.parentNode;)d=d.parentNode;for(d=d.querySelectorAll('input[name="'+Or(""+l)+'"][type="radio"]'),l=0;l<d.length;l++){var m=d[l];if(m!==s&&m.form===s.form){var b=m[ir]||null;if(!b)throw Error(r(90));ym(m,b.value,b.defaultValue,b.defaultValue,b.checked,b.defaultChecked,b.type,b.name)}}for(l=0;l<d.length;l++)m=d[l],m.form===s.form&&t1(m)}break e;case"textarea":r1(s,d.value,d.defaultValue);break e;case"select":l=d.value,l!=null&&Aa(s,!!d.multiple,l,!1)}}}var Sm=!1;function l1(s,l,d){if(Sm)return s(l,d);Sm=!0;try{var m=s(l);return m}finally{if(Sm=!1,(Da!==null||Oa!==null)&&(Qd(),Da&&(l=Da,s=Oa,Oa=Da=null,a1(l),s)))for(l=0;l<s.length;l++)a1(s[l])}}function rc(s,l){var d=s.stateNode;if(d===null)return null;var m=d[ir]||null;if(m===null)return null;d=m[l];e:switch(l){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(m=!m.disabled)||(s=s.type,m=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!m;break e;default:s=!1}if(s)return null;if(d&&typeof d!="function")throw Error(r(231,l,typeof d));return d}var Li=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Em=!1;if(Li)try{var ic={};Object.defineProperty(ic,"passive",{get:function(){Em=!0}}),window.addEventListener("test",ic,ic),window.removeEventListener("test",ic,ic)}catch{Em=!1}var wo=null,Cm=null,fd=null;function c1(){if(fd)return fd;var s,l=Cm,d=l.length,m,b="value"in wo?wo.value:wo.textContent,E=b.length;for(s=0;s<d&&l[s]===b[s];s++);var A=d-s;for(m=1;m<=A&&l[d-m]===b[E-m];m++);return fd=b.slice(s,1<m?1-m:void 0)}function hd(s){var l=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&l===13&&(s=13)):s=l,s===10&&(s=13),32<=s||s===13?s:0}function pd(){return!0}function u1(){return!1}function or(s){function l(d,m,b,E,A){this._reactName=d,this._targetInst=b,this.type=m,this.nativeEvent=E,this.target=A,this.currentTarget=null;for(var _ in s)s.hasOwnProperty(_)&&(d=s[_],this[_]=d?d(E):E[_]);return this.isDefaultPrevented=(E.defaultPrevented!=null?E.defaultPrevented:E.returnValue===!1)?pd:u1,this.isPropagationStopped=u1,this}return g(l.prototype,{preventDefault:function(){this.defaultPrevented=!0;var d=this.nativeEvent;d&&(d.preventDefault?d.preventDefault():typeof d.returnValue!="unknown"&&(d.returnValue=!1),this.isDefaultPrevented=pd)},stopPropagation:function(){var d=this.nativeEvent;d&&(d.stopPropagation?d.stopPropagation():typeof d.cancelBubble!="unknown"&&(d.cancelBubble=!0),this.isPropagationStopped=pd)},persist:function(){},isPersistent:pd}),l}var ks={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},md=or(ks),oc=g({},ks,{view:0,detail:0}),rI=or(oc),Tm,Nm,sc,gd=g({},oc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:km,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==sc&&(sc&&s.type==="mousemove"?(Tm=s.screenX-sc.screenX,Nm=s.screenY-sc.screenY):Nm=Tm=0,sc=s),Tm)},movementY:function(s){return"movementY"in s?s.movementY:Nm}}),d1=or(gd),iI=g({},gd,{dataTransfer:0}),oI=or(iI),sI=g({},oc,{relatedTarget:0}),Am=or(sI),aI=g({},ks,{animationName:0,elapsedTime:0,pseudoElement:0}),lI=or(aI),cI=g({},ks,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),uI=or(cI),dI=g({},ks,{data:0}),f1=or(dI),fI={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},hI={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},pI={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function mI(s){var l=this.nativeEvent;return l.getModifierState?l.getModifierState(s):(s=pI[s])?!!l[s]:!1}function km(){return mI}var gI=g({},oc,{key:function(s){if(s.key){var l=fI[s.key]||s.key;if(l!=="Unidentified")return l}return s.type==="keypress"?(s=hd(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?hI[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:km,charCode:function(s){return s.type==="keypress"?hd(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?hd(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),yI=or(gI),vI=g({},gd,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),h1=or(vI),xI=g({},oc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:km}),bI=or(xI),wI=g({},ks,{propertyName:0,elapsedTime:0,pseudoElement:0}),SI=or(wI),EI=g({},gd,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),CI=or(EI),TI=g({},ks,{newState:0,oldState:0}),NI=or(TI),AI=[9,13,27,32],Dm=Li&&"CompositionEvent"in window,ac=null;Li&&"documentMode"in document&&(ac=document.documentMode);var kI=Li&&"TextEvent"in window&&!ac,p1=Li&&(!Dm||ac&&8<ac&&11>=ac),m1=" ",g1=!1;function y1(s,l){switch(s){case"keyup":return AI.indexOf(l.keyCode)!==-1;case"keydown":return l.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function v1(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var Ma=!1;function DI(s,l){switch(s){case"compositionend":return v1(l);case"keypress":return l.which!==32?null:(g1=!0,m1);case"textInput":return s=l.data,s===m1&&g1?null:s;default:return null}}function OI(s,l){if(Ma)return s==="compositionend"||!Dm&&y1(s,l)?(s=c1(),fd=Cm=wo=null,Ma=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(l.ctrlKey||l.altKey||l.metaKey)||l.ctrlKey&&l.altKey){if(l.char&&1<l.char.length)return l.char;if(l.which)return String.fromCharCode(l.which)}return null;case"compositionend":return p1&&l.locale!=="ko"?null:l.data;default:return null}}var MI={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function x1(s){var l=s&&s.nodeName&&s.nodeName.toLowerCase();return l==="input"?!!MI[s.type]:l==="textarea"}function b1(s,l,d,m){Da?Oa?Oa.push(m):Oa=[m]:Da=m,l=sf(l,"onChange"),0<l.length&&(d=new md("onChange","change",null,d,m),s.push({event:d,listeners:l}))}var lc=null,cc=null;function RI(s){nE(s,0)}function yd(s){var l=nc(s);if(t1(l))return s}function w1(s,l){if(s==="change")return l}var S1=!1;if(Li){var Om;if(Li){var Mm="oninput"in document;if(!Mm){var E1=document.createElement("div");E1.setAttribute("oninput","return;"),Mm=typeof E1.oninput=="function"}Om=Mm}else Om=!1;S1=Om&&(!document.documentMode||9<document.documentMode)}function C1(){lc&&(lc.detachEvent("onpropertychange",T1),cc=lc=null)}function T1(s){if(s.propertyName==="value"&&yd(cc)){var l=[];b1(l,cc,s,wm(s)),l1(RI,l)}}function jI(s,l,d){s==="focusin"?(C1(),lc=l,cc=d,lc.attachEvent("onpropertychange",T1)):s==="focusout"&&C1()}function II(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return yd(cc)}function _I(s,l){if(s==="click")return yd(l)}function LI(s,l){if(s==="input"||s==="change")return yd(l)}function PI(s,l){return s===l&&(s!==0||1/s===1/l)||s!==s&&l!==l}var mr=typeof Object.is=="function"?Object.is:PI;function uc(s,l){if(mr(s,l))return!0;if(typeof s!="object"||s===null||typeof l!="object"||l===null)return!1;var d=Object.keys(s),m=Object.keys(l);if(d.length!==m.length)return!1;for(m=0;m<d.length;m++){var b=d[m];if(!J.call(l,b)||!mr(s[b],l[b]))return!1}return!0}function N1(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function A1(s,l){var d=N1(s);s=0;for(var m;d;){if(d.nodeType===3){if(m=s+d.textContent.length,s<=l&&m>=l)return{node:d,offset:l-s};s=m}e:{for(;d;){if(d.nextSibling){d=d.nextSibling;break e}d=d.parentNode}d=void 0}d=N1(d)}}function k1(s,l){return s&&l?s===l?!0:s&&s.nodeType===3?!1:l&&l.nodeType===3?k1(s,l.parentNode):"contains"in s?s.contains(l):s.compareDocumentPosition?!!(s.compareDocumentPosition(l)&16):!1:!1}function D1(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var l=ud(s.document);l instanceof s.HTMLIFrameElement;){try{var d=typeof l.contentWindow.location.href=="string"}catch{d=!1}if(d)s=l.contentWindow;else break;l=ud(s.document)}return l}function Rm(s){var l=s&&s.nodeName&&s.nodeName.toLowerCase();return l&&(l==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||l==="textarea"||s.contentEditable==="true")}var zI=Li&&"documentMode"in document&&11>=document.documentMode,Ra=null,jm=null,dc=null,Im=!1;function O1(s,l,d){var m=d.window===d?d.document:d.nodeType===9?d:d.ownerDocument;Im||Ra==null||Ra!==ud(m)||(m=Ra,"selectionStart"in m&&Rm(m)?m={start:m.selectionStart,end:m.selectionEnd}:(m=(m.ownerDocument&&m.ownerDocument.defaultView||window).getSelection(),m={anchorNode:m.anchorNode,anchorOffset:m.anchorOffset,focusNode:m.focusNode,focusOffset:m.focusOffset}),dc&&uc(dc,m)||(dc=m,m=sf(jm,"onSelect"),0<m.length&&(l=new md("onSelect","select",null,l,d),s.push({event:l,listeners:m}),l.target=Ra)))}function Ds(s,l){var d={};return d[s.toLowerCase()]=l.toLowerCase(),d["Webkit"+s]="webkit"+l,d["Moz"+s]="moz"+l,d}var ja={animationend:Ds("Animation","AnimationEnd"),animationiteration:Ds("Animation","AnimationIteration"),animationstart:Ds("Animation","AnimationStart"),transitionrun:Ds("Transition","TransitionRun"),transitionstart:Ds("Transition","TransitionStart"),transitioncancel:Ds("Transition","TransitionCancel"),transitionend:Ds("Transition","TransitionEnd")},_m={},M1={};Li&&(M1=document.createElement("div").style,"AnimationEvent"in window||(delete ja.animationend.animation,delete ja.animationiteration.animation,delete ja.animationstart.animation),"TransitionEvent"in window||delete ja.transitionend.transition);function Os(s){if(_m[s])return _m[s];if(!ja[s])return s;var l=ja[s],d;for(d in l)if(l.hasOwnProperty(d)&&d in M1)return _m[s]=l[d];return s}var R1=Os("animationend"),j1=Os("animationiteration"),I1=Os("animationstart"),BI=Os("transitionrun"),FI=Os("transitionstart"),$I=Os("transitioncancel"),_1=Os("transitionend"),L1=new Map,Lm="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Lm.push("scrollEnd");function Xr(s,l){L1.set(s,l),As(l,[s])}var vd=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var l=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(l))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)},Mr=[],Ia=0,Pm=0;function xd(){for(var s=Ia,l=Pm=Ia=0;l<s;){var d=Mr[l];Mr[l++]=null;var m=Mr[l];Mr[l++]=null;var b=Mr[l];Mr[l++]=null;var E=Mr[l];if(Mr[l++]=null,m!==null&&b!==null){var A=m.pending;A===null?b.next=b:(b.next=A.next,A.next=b),m.pending=b}E!==0&&P1(d,b,E)}}function bd(s,l,d,m){Mr[Ia++]=s,Mr[Ia++]=l,Mr[Ia++]=d,Mr[Ia++]=m,Pm|=m,s.lanes|=m,s=s.alternate,s!==null&&(s.lanes|=m)}function zm(s,l,d,m){return bd(s,l,d,m),wd(s)}function Ms(s,l){return bd(s,null,null,l),wd(s)}function P1(s,l,d){s.lanes|=d;var m=s.alternate;m!==null&&(m.lanes|=d);for(var b=!1,E=s.return;E!==null;)E.childLanes|=d,m=E.alternate,m!==null&&(m.childLanes|=d),E.tag===22&&(s=E.stateNode,s===null||s._visibility&1||(b=!0)),s=E,E=E.return;return s.tag===3?(E=s.stateNode,b&&l!==null&&(b=31-Qe(d),s=E.hiddenUpdates,m=s[b],m===null?s[b]=[l]:m.push(l),l.lane=d|536870912),E):null}function wd(s){if(50<jc)throw jc=0,Wg=null,Error(r(185));for(var l=s.return;l!==null;)s=l,l=s.return;return s.tag===3?s.stateNode:null}var _a={};function HI(s,l,d,m){this.tag=s,this.key=d,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=l,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=m,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function gr(s,l,d,m){return new HI(s,l,d,m)}function Bm(s){return s=s.prototype,!(!s||!s.isReactComponent)}function Pi(s,l){var d=s.alternate;return d===null?(d=gr(s.tag,l,s.key,s.mode),d.elementType=s.elementType,d.type=s.type,d.stateNode=s.stateNode,d.alternate=s,s.alternate=d):(d.pendingProps=l,d.type=s.type,d.flags=0,d.subtreeFlags=0,d.deletions=null),d.flags=s.flags&65011712,d.childLanes=s.childLanes,d.lanes=s.lanes,d.child=s.child,d.memoizedProps=s.memoizedProps,d.memoizedState=s.memoizedState,d.updateQueue=s.updateQueue,l=s.dependencies,d.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext},d.sibling=s.sibling,d.index=s.index,d.ref=s.ref,d.refCleanup=s.refCleanup,d}function z1(s,l){s.flags&=65011714;var d=s.alternate;return d===null?(s.childLanes=0,s.lanes=l,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=d.childLanes,s.lanes=d.lanes,s.child=d.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=d.memoizedProps,s.memoizedState=d.memoizedState,s.updateQueue=d.updateQueue,s.type=d.type,l=d.dependencies,s.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext}),s}function Sd(s,l,d,m,b,E){var A=0;if(m=s,typeof s=="function")Bm(s)&&(A=1);else if(typeof s=="string")A=W_(s,d,Z.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case z:return s=gr(31,d,l,b),s.elementType=z,s.lanes=E,s;case S:return Rs(d.children,b,E,l);case C:A=8,b|=24;break;case T:return s=gr(12,d,l,b|2),s.elementType=T,s.lanes=E,s;case M:return s=gr(13,d,l,b),s.elementType=M,s.lanes=E,s;case R:return s=gr(19,d,l,b),s.elementType=R,s.lanes=E,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case k:A=10;break e;case N:A=9;break e;case D:A=11;break e;case O:A=14;break e;case I:A=16,m=null;break e}A=29,d=Error(r(130,s===null?"null":typeof s,"")),m=null}return l=gr(A,d,l,b),l.elementType=s,l.type=m,l.lanes=E,l}function Rs(s,l,d,m){return s=gr(7,s,m,l),s.lanes=d,s}function Fm(s,l,d){return s=gr(6,s,null,l),s.lanes=d,s}function B1(s){var l=gr(18,null,null,0);return l.stateNode=s,l}function $m(s,l,d){return l=gr(4,s.children!==null?s.children:[],s.key,l),l.lanes=d,l.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},l}var F1=new WeakMap;function Rr(s,l){if(typeof s=="object"&&s!==null){var d=F1.get(s);return d!==void 0?d:(l={value:s,source:l,stack:Me(l)},F1.set(s,l),l)}return{value:s,source:l,stack:Me(l)}}var La=[],Pa=0,Ed=null,fc=0,jr=[],Ir=0,So=null,hi=1,pi="";function zi(s,l){La[Pa++]=fc,La[Pa++]=Ed,Ed=s,fc=l}function $1(s,l,d){jr[Ir++]=hi,jr[Ir++]=pi,jr[Ir++]=So,So=s;var m=hi;s=pi;var b=32-Qe(m)-1;m&=~(1<<b),d+=1;var E=32-Qe(l)+b;if(30<E){var A=b-b%5;E=(m&(1<<A)-1).toString(32),m>>=A,b-=A,hi=1<<32-Qe(l)+b|d<<b|m,pi=E+s}else hi=1<<E|d<<b|m,pi=s}function Hm(s){s.return!==null&&(zi(s,1),$1(s,1,0))}function Um(s){for(;s===Ed;)Ed=La[--Pa],La[Pa]=null,fc=La[--Pa],La[Pa]=null;for(;s===So;)So=jr[--Ir],jr[Ir]=null,pi=jr[--Ir],jr[Ir]=null,hi=jr[--Ir],jr[Ir]=null}function H1(s,l){jr[Ir++]=hi,jr[Ir++]=pi,jr[Ir++]=So,hi=l.id,pi=l.overflow,So=s}var In=null,Jt=null,Nt=!1,Eo=null,_r=!1,Vm=Error(r(519));function Co(s){var l=Error(r(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw hc(Rr(l,s)),Vm}function U1(s){var l=s.stateNode,d=s.type,m=s.memoizedProps;switch(l[jn]=s,l[ir]=m,d){case"dialog":Et("cancel",l),Et("close",l);break;case"iframe":case"object":case"embed":Et("load",l);break;case"video":case"audio":for(d=0;d<_c.length;d++)Et(_c[d],l);break;case"source":Et("error",l);break;case"img":case"image":case"link":Et("error",l),Et("load",l);break;case"details":Et("toggle",l);break;case"input":Et("invalid",l),n1(l,m.value,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name,!0);break;case"select":Et("invalid",l);break;case"textarea":Et("invalid",l),i1(l,m.value,m.defaultValue,m.children)}d=m.children,typeof d!="string"&&typeof d!="number"&&typeof d!="bigint"||l.textContent===""+d||m.suppressHydrationWarning===!0||sE(l.textContent,d)?(m.popover!=null&&(Et("beforetoggle",l),Et("toggle",l)),m.onScroll!=null&&Et("scroll",l),m.onScrollEnd!=null&&Et("scrollend",l),m.onClick!=null&&(l.onclick=_i),l=!0):l=!1,l||Co(s,!0)}function V1(s){for(In=s.return;In;)switch(In.tag){case 5:case 31:case 13:_r=!1;return;case 27:case 3:_r=!0;return;default:In=In.return}}function za(s){if(s!==In)return!1;if(!Nt)return V1(s),Nt=!0,!1;var l=s.tag,d;if((d=l!==3&&l!==27)&&((d=l===5)&&(d=s.type,d=!(d!=="form"&&d!=="button")||ly(s.type,s.memoizedProps)),d=!d),d&&Jt&&Co(s),V1(s),l===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(r(317));Jt=mE(s)}else if(l===31){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(r(317));Jt=mE(s)}else l===27?(l=Jt,zo(s.type)?(s=hy,hy=null,Jt=s):Jt=l):Jt=In?Pr(s.stateNode.nextSibling):null;return!0}function js(){Jt=In=null,Nt=!1}function qm(){var s=Eo;return s!==null&&(cr===null?cr=s:cr.push.apply(cr,s),Eo=null),s}function hc(s){Eo===null?Eo=[s]:Eo.push(s)}var Gm=P(null),Is=null,Bi=null;function To(s,l,d){B(Gm,l._currentValue),l._currentValue=d}function Fi(s){s._currentValue=Gm.current,K(Gm)}function Wm(s,l,d){for(;s!==null;){var m=s.alternate;if((s.childLanes&l)!==l?(s.childLanes|=l,m!==null&&(m.childLanes|=l)):m!==null&&(m.childLanes&l)!==l&&(m.childLanes|=l),s===d)break;s=s.return}}function Ym(s,l,d,m){var b=s.child;for(b!==null&&(b.return=s);b!==null;){var E=b.dependencies;if(E!==null){var A=b.child;E=E.firstContext;e:for(;E!==null;){var _=E;E=b;for(var F=0;F<l.length;F++)if(_.context===l[F]){E.lanes|=d,_=E.alternate,_!==null&&(_.lanes|=d),Wm(E.return,d,s),m||(A=null);break e}E=_.next}}else if(b.tag===18){if(A=b.return,A===null)throw Error(r(341));A.lanes|=d,E=A.alternate,E!==null&&(E.lanes|=d),Wm(A,d,s),A=null}else A=b.child;if(A!==null)A.return=b;else for(A=b;A!==null;){if(A===s){A=null;break}if(b=A.sibling,b!==null){b.return=A.return,A=b;break}A=A.return}b=A}}function Ba(s,l,d,m){s=null;for(var b=l,E=!1;b!==null;){if(!E){if((b.flags&524288)!==0)E=!0;else if((b.flags&262144)!==0)break}if(b.tag===10){var A=b.alternate;if(A===null)throw Error(r(387));if(A=A.memoizedProps,A!==null){var _=b.type;mr(b.pendingProps.value,A.value)||(s!==null?s.push(_):s=[_])}}else if(b===H.current){if(A=b.alternate,A===null)throw Error(r(387));A.memoizedState.memoizedState!==b.memoizedState.memoizedState&&(s!==null?s.push(Fc):s=[Fc])}b=b.return}s!==null&&Ym(l,s,d,m),l.flags|=262144}function Cd(s){for(s=s.firstContext;s!==null;){if(!mr(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function _s(s){Is=s,Bi=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function _n(s){return q1(Is,s)}function Td(s,l){return Is===null&&_s(s),q1(s,l)}function q1(s,l){var d=l._currentValue;if(l={context:l,memoizedValue:d,next:null},Bi===null){if(s===null)throw Error(r(308));Bi=l,s.dependencies={lanes:0,firstContext:l},s.flags|=524288}else Bi=Bi.next=l;return d}var UI=typeof AbortController<"u"?AbortController:function(){var s=[],l=this.signal={aborted:!1,addEventListener:function(d,m){s.push(m)}};this.abort=function(){l.aborted=!0,s.forEach(function(d){return d()})}},VI=t.unstable_scheduleCallback,qI=t.unstable_NormalPriority,mn={$$typeof:k,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Km(){return{controller:new UI,data:new Map,refCount:0}}function pc(s){s.refCount--,s.refCount===0&&VI(qI,function(){s.controller.abort()})}var mc=null,Xm=0,Fa=0,$a=null;function GI(s,l){if(mc===null){var d=mc=[];Xm=0,Fa=Zg(),$a={status:"pending",value:void 0,then:function(m){d.push(m)}}}return Xm++,l.then(G1,G1),l}function G1(){if(--Xm===0&&mc!==null){$a!==null&&($a.status="fulfilled");var s=mc;mc=null,Fa=0,$a=null;for(var l=0;l<s.length;l++)(0,s[l])()}}function WI(s,l){var d=[],m={status:"pending",value:null,reason:null,then:function(b){d.push(b)}};return s.then(function(){m.status="fulfilled",m.value=l;for(var b=0;b<d.length;b++)(0,d[b])(l)},function(b){for(m.status="rejected",m.reason=b,b=0;b<d.length;b++)(0,d[b])(void 0)}),m}var W1=L.S;L.S=function(s,l){OS=Ye(),typeof l=="object"&&l!==null&&typeof l.then=="function"&&GI(s,l),W1!==null&&W1(s,l)};var Ls=P(null);function Jm(){var s=Ls.current;return s!==null?s:Yt.pooledCache}function Nd(s,l){l===null?B(Ls,Ls.current):B(Ls,l.pool)}function Y1(){var s=Jm();return s===null?null:{parent:mn._currentValue,pool:s}}var Ha=Error(r(460)),Qm=Error(r(474)),Ad=Error(r(542)),kd={then:function(){}};function K1(s){return s=s.status,s==="fulfilled"||s==="rejected"}function X1(s,l,d){switch(d=s[d],d===void 0?s.push(l):d!==l&&(l.then(_i,_i),l=d),l.status){case"fulfilled":return l.value;case"rejected":throw s=l.reason,Q1(s),s;default:if(typeof l.status=="string")l.then(_i,_i);else{if(s=Yt,s!==null&&100<s.shellSuspendCounter)throw Error(r(482));s=l,s.status="pending",s.then(function(m){if(l.status==="pending"){var b=l;b.status="fulfilled",b.value=m}},function(m){if(l.status==="pending"){var b=l;b.status="rejected",b.reason=m}})}switch(l.status){case"fulfilled":return l.value;case"rejected":throw s=l.reason,Q1(s),s}throw zs=l,Ha}}function Ps(s){try{var l=s._init;return l(s._payload)}catch(d){throw d!==null&&typeof d=="object"&&typeof d.then=="function"?(zs=d,Ha):d}}var zs=null;function J1(){if(zs===null)throw Error(r(459));var s=zs;return zs=null,s}function Q1(s){if(s===Ha||s===Ad)throw Error(r(483))}var Ua=null,gc=0;function Dd(s){var l=gc;return gc+=1,Ua===null&&(Ua=[]),X1(Ua,s,l)}function yc(s,l){l=l.props.ref,s.ref=l!==void 0?l:null}function Od(s,l){throw l.$$typeof===v?Error(r(525)):(s=Object.prototype.toString.call(l),Error(r(31,s==="[object Object]"?"object with keys {"+Object.keys(l).join(", ")+"}":s)))}function Z1(s){function l(Q,q){if(s){var ne=Q.deletions;ne===null?(Q.deletions=[q],Q.flags|=16):ne.push(q)}}function d(Q,q){if(!s)return null;for(;q!==null;)l(Q,q),q=q.sibling;return null}function m(Q){for(var q=new Map;Q!==null;)Q.key!==null?q.set(Q.key,Q):q.set(Q.index,Q),Q=Q.sibling;return q}function b(Q,q){return Q=Pi(Q,q),Q.index=0,Q.sibling=null,Q}function E(Q,q,ne){return Q.index=ne,s?(ne=Q.alternate,ne!==null?(ne=ne.index,ne<q?(Q.flags|=67108866,q):ne):(Q.flags|=67108866,q)):(Q.flags|=1048576,q)}function A(Q){return s&&Q.alternate===null&&(Q.flags|=67108866),Q}function _(Q,q,ne,ye){return q===null||q.tag!==6?(q=Fm(ne,Q.mode,ye),q.return=Q,q):(q=b(q,ne),q.return=Q,q)}function F(Q,q,ne,ye){var Ze=ne.type;return Ze===S?ge(Q,q,ne.props.children,ye,ne.key):q!==null&&(q.elementType===Ze||typeof Ze=="object"&&Ze!==null&&Ze.$$typeof===I&&Ps(Ze)===q.type)?(q=b(q,ne.props),yc(q,ne),q.return=Q,q):(q=Sd(ne.type,ne.key,ne.props,null,Q.mode,ye),yc(q,ne),q.return=Q,q)}function ie(Q,q,ne,ye){return q===null||q.tag!==4||q.stateNode.containerInfo!==ne.containerInfo||q.stateNode.implementation!==ne.implementation?(q=$m(ne,Q.mode,ye),q.return=Q,q):(q=b(q,ne.children||[]),q.return=Q,q)}function ge(Q,q,ne,ye,Ze){return q===null||q.tag!==7?(q=Rs(ne,Q.mode,ye,Ze),q.return=Q,q):(q=b(q,ne),q.return=Q,q)}function xe(Q,q,ne){if(typeof q=="string"&&q!==""||typeof q=="number"||typeof q=="bigint")return q=Fm(""+q,Q.mode,ne),q.return=Q,q;if(typeof q=="object"&&q!==null){switch(q.$$typeof){case y:return ne=Sd(q.type,q.key,q.props,null,Q.mode,ne),yc(ne,q),ne.return=Q,ne;case w:return q=$m(q,Q.mode,ne),q.return=Q,q;case I:return q=Ps(q),xe(Q,q,ne)}if(oe(q)||W(q))return q=Rs(q,Q.mode,ne,null),q.return=Q,q;if(typeof q.then=="function")return xe(Q,Dd(q),ne);if(q.$$typeof===k)return xe(Q,Td(Q,q),ne);Od(Q,q)}return null}function se(Q,q,ne,ye){var Ze=q!==null?q.key:null;if(typeof ne=="string"&&ne!==""||typeof ne=="number"||typeof ne=="bigint")return Ze!==null?null:_(Q,q,""+ne,ye);if(typeof ne=="object"&&ne!==null){switch(ne.$$typeof){case y:return ne.key===Ze?F(Q,q,ne,ye):null;case w:return ne.key===Ze?ie(Q,q,ne,ye):null;case I:return ne=Ps(ne),se(Q,q,ne,ye)}if(oe(ne)||W(ne))return Ze!==null?null:ge(Q,q,ne,ye,null);if(typeof ne.then=="function")return se(Q,q,Dd(ne),ye);if(ne.$$typeof===k)return se(Q,q,Td(Q,ne),ye);Od(Q,ne)}return null}function fe(Q,q,ne,ye,Ze){if(typeof ye=="string"&&ye!==""||typeof ye=="number"||typeof ye=="bigint")return Q=Q.get(ne)||null,_(q,Q,""+ye,Ze);if(typeof ye=="object"&&ye!==null){switch(ye.$$typeof){case y:return Q=Q.get(ye.key===null?ne:ye.key)||null,F(q,Q,ye,Ze);case w:return Q=Q.get(ye.key===null?ne:ye.key)||null,ie(q,Q,ye,Ze);case I:return ye=Ps(ye),fe(Q,q,ne,ye,Ze)}if(oe(ye)||W(ye))return Q=Q.get(ne)||null,ge(q,Q,ye,Ze,null);if(typeof ye.then=="function")return fe(Q,q,ne,Dd(ye),Ze);if(ye.$$typeof===k)return fe(Q,q,ne,Td(q,ye),Ze);Od(q,ye)}return null}function Pe(Q,q,ne,ye){for(var Ze=null,Ot=null,Ue=q,gt=q=0,Tt=null;Ue!==null&&gt<ne.length;gt++){Ue.index>gt?(Tt=Ue,Ue=null):Tt=Ue.sibling;var Mt=se(Q,Ue,ne[gt],ye);if(Mt===null){Ue===null&&(Ue=Tt);break}s&&Ue&&Mt.alternate===null&&l(Q,Ue),q=E(Mt,q,gt),Ot===null?Ze=Mt:Ot.sibling=Mt,Ot=Mt,Ue=Tt}if(gt===ne.length)return d(Q,Ue),Nt&&zi(Q,gt),Ze;if(Ue===null){for(;gt<ne.length;gt++)Ue=xe(Q,ne[gt],ye),Ue!==null&&(q=E(Ue,q,gt),Ot===null?Ze=Ue:Ot.sibling=Ue,Ot=Ue);return Nt&&zi(Q,gt),Ze}for(Ue=m(Ue);gt<ne.length;gt++)Tt=fe(Ue,Q,gt,ne[gt],ye),Tt!==null&&(s&&Tt.alternate!==null&&Ue.delete(Tt.key===null?gt:Tt.key),q=E(Tt,q,gt),Ot===null?Ze=Tt:Ot.sibling=Tt,Ot=Tt);return s&&Ue.forEach(function(Uo){return l(Q,Uo)}),Nt&&zi(Q,gt),Ze}function nt(Q,q,ne,ye){if(ne==null)throw Error(r(151));for(var Ze=null,Ot=null,Ue=q,gt=q=0,Tt=null,Mt=ne.next();Ue!==null&&!Mt.done;gt++,Mt=ne.next()){Ue.index>gt?(Tt=Ue,Ue=null):Tt=Ue.sibling;var Uo=se(Q,Ue,Mt.value,ye);if(Uo===null){Ue===null&&(Ue=Tt);break}s&&Ue&&Uo.alternate===null&&l(Q,Ue),q=E(Uo,q,gt),Ot===null?Ze=Uo:Ot.sibling=Uo,Ot=Uo,Ue=Tt}if(Mt.done)return d(Q,Ue),Nt&&zi(Q,gt),Ze;if(Ue===null){for(;!Mt.done;gt++,Mt=ne.next())Mt=xe(Q,Mt.value,ye),Mt!==null&&(q=E(Mt,q,gt),Ot===null?Ze=Mt:Ot.sibling=Mt,Ot=Mt);return Nt&&zi(Q,gt),Ze}for(Ue=m(Ue);!Mt.done;gt++,Mt=ne.next())Mt=fe(Ue,Q,gt,Mt.value,ye),Mt!==null&&(s&&Mt.alternate!==null&&Ue.delete(Mt.key===null?gt:Mt.key),q=E(Mt,q,gt),Ot===null?Ze=Mt:Ot.sibling=Mt,Ot=Mt);return s&&Ue.forEach(function(iL){return l(Q,iL)}),Nt&&zi(Q,gt),Ze}function Gt(Q,q,ne,ye){if(typeof ne=="object"&&ne!==null&&ne.type===S&&ne.key===null&&(ne=ne.props.children),typeof ne=="object"&&ne!==null){switch(ne.$$typeof){case y:e:{for(var Ze=ne.key;q!==null;){if(q.key===Ze){if(Ze=ne.type,Ze===S){if(q.tag===7){d(Q,q.sibling),ye=b(q,ne.props.children),ye.return=Q,Q=ye;break e}}else if(q.elementType===Ze||typeof Ze=="object"&&Ze!==null&&Ze.$$typeof===I&&Ps(Ze)===q.type){d(Q,q.sibling),ye=b(q,ne.props),yc(ye,ne),ye.return=Q,Q=ye;break e}d(Q,q);break}else l(Q,q);q=q.sibling}ne.type===S?(ye=Rs(ne.props.children,Q.mode,ye,ne.key),ye.return=Q,Q=ye):(ye=Sd(ne.type,ne.key,ne.props,null,Q.mode,ye),yc(ye,ne),ye.return=Q,Q=ye)}return A(Q);case w:e:{for(Ze=ne.key;q!==null;){if(q.key===Ze)if(q.tag===4&&q.stateNode.containerInfo===ne.containerInfo&&q.stateNode.implementation===ne.implementation){d(Q,q.sibling),ye=b(q,ne.children||[]),ye.return=Q,Q=ye;break e}else{d(Q,q);break}else l(Q,q);q=q.sibling}ye=$m(ne,Q.mode,ye),ye.return=Q,Q=ye}return A(Q);case I:return ne=Ps(ne),Gt(Q,q,ne,ye)}if(oe(ne))return Pe(Q,q,ne,ye);if(W(ne)){if(Ze=W(ne),typeof Ze!="function")throw Error(r(150));return ne=Ze.call(ne),nt(Q,q,ne,ye)}if(typeof ne.then=="function")return Gt(Q,q,Dd(ne),ye);if(ne.$$typeof===k)return Gt(Q,q,Td(Q,ne),ye);Od(Q,ne)}return typeof ne=="string"&&ne!==""||typeof ne=="number"||typeof ne=="bigint"?(ne=""+ne,q!==null&&q.tag===6?(d(Q,q.sibling),ye=b(q,ne),ye.return=Q,Q=ye):(d(Q,q),ye=Fm(ne,Q.mode,ye),ye.return=Q,Q=ye),A(Q)):d(Q,q)}return function(Q,q,ne,ye){try{gc=0;var Ze=Gt(Q,q,ne,ye);return Ua=null,Ze}catch(Ue){if(Ue===Ha||Ue===Ad)throw Ue;var Ot=gr(29,Ue,null,Q.mode);return Ot.lanes=ye,Ot.return=Q,Ot}}}var Bs=Z1(!0),ew=Z1(!1),No=!1;function Zm(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function eg(s,l){s=s.updateQueue,l.updateQueue===s&&(l.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function Ao(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function ko(s,l,d){var m=s.updateQueue;if(m===null)return null;if(m=m.shared,(It&2)!==0){var b=m.pending;return b===null?l.next=l:(l.next=b.next,b.next=l),m.pending=l,l=wd(s),P1(s,null,d),l}return bd(s,m,l,d),wd(s)}function vc(s,l,d){if(l=l.updateQueue,l!==null&&(l=l.shared,(d&4194048)!==0)){var m=l.lanes;m&=s.pendingLanes,d|=m,l.lanes=d,nr(s,d)}}function tg(s,l){var d=s.updateQueue,m=s.alternate;if(m!==null&&(m=m.updateQueue,d===m)){var b=null,E=null;if(d=d.firstBaseUpdate,d!==null){do{var A={lane:d.lane,tag:d.tag,payload:d.payload,callback:null,next:null};E===null?b=E=A:E=E.next=A,d=d.next}while(d!==null);E===null?b=E=l:E=E.next=l}else b=E=l;d={baseState:m.baseState,firstBaseUpdate:b,lastBaseUpdate:E,shared:m.shared,callbacks:m.callbacks},s.updateQueue=d;return}s=d.lastBaseUpdate,s===null?d.firstBaseUpdate=l:s.next=l,d.lastBaseUpdate=l}var ng=!1;function xc(){if(ng){var s=$a;if(s!==null)throw s}}function bc(s,l,d,m){ng=!1;var b=s.updateQueue;No=!1;var E=b.firstBaseUpdate,A=b.lastBaseUpdate,_=b.shared.pending;if(_!==null){b.shared.pending=null;var F=_,ie=F.next;F.next=null,A===null?E=ie:A.next=ie,A=F;var ge=s.alternate;ge!==null&&(ge=ge.updateQueue,_=ge.lastBaseUpdate,_!==A&&(_===null?ge.firstBaseUpdate=ie:_.next=ie,ge.lastBaseUpdate=F))}if(E!==null){var xe=b.baseState;A=0,ge=ie=F=null,_=E;do{var se=_.lane&-536870913,fe=se!==_.lane;if(fe?(Ct&se)===se:(m&se)===se){se!==0&&se===Fa&&(ng=!0),ge!==null&&(ge=ge.next={lane:0,tag:_.tag,payload:_.payload,callback:null,next:null});e:{var Pe=s,nt=_;se=l;var Gt=d;switch(nt.tag){case 1:if(Pe=nt.payload,typeof Pe=="function"){xe=Pe.call(Gt,xe,se);break e}xe=Pe;break e;case 3:Pe.flags=Pe.flags&-65537|128;case 0:if(Pe=nt.payload,se=typeof Pe=="function"?Pe.call(Gt,xe,se):Pe,se==null)break e;xe=g({},xe,se);break e;case 2:No=!0}}se=_.callback,se!==null&&(s.flags|=64,fe&&(s.flags|=8192),fe=b.callbacks,fe===null?b.callbacks=[se]:fe.push(se))}else fe={lane:se,tag:_.tag,payload:_.payload,callback:_.callback,next:null},ge===null?(ie=ge=fe,F=xe):ge=ge.next=fe,A|=se;if(_=_.next,_===null){if(_=b.shared.pending,_===null)break;fe=_,_=fe.next,fe.next=null,b.lastBaseUpdate=fe,b.shared.pending=null}}while(!0);ge===null&&(F=xe),b.baseState=F,b.firstBaseUpdate=ie,b.lastBaseUpdate=ge,E===null&&(b.shared.lanes=0),jo|=A,s.lanes=A,s.memoizedState=xe}}function tw(s,l){if(typeof s!="function")throw Error(r(191,s));s.call(l)}function nw(s,l){var d=s.callbacks;if(d!==null)for(s.callbacks=null,s=0;s<d.length;s++)tw(d[s],l)}var Va=P(null),Md=P(0);function rw(s,l){s=Ki,B(Md,s),B(Va,l),Ki=s|l.baseLanes}function rg(){B(Md,Ki),B(Va,Va.current)}function ig(){Ki=Md.current,K(Va),K(Md)}var yr=P(null),Lr=null;function Do(s){var l=s.alternate;B(hn,hn.current&1),B(yr,s),Lr===null&&(l===null||Va.current!==null||l.memoizedState!==null)&&(Lr=s)}function og(s){B(hn,hn.current),B(yr,s),Lr===null&&(Lr=s)}function iw(s){s.tag===22?(B(hn,hn.current),B(yr,s),Lr===null&&(Lr=s)):Oo()}function Oo(){B(hn,hn.current),B(yr,yr.current)}function vr(s){K(yr),Lr===s&&(Lr=null),K(hn)}var hn=P(0);function Rd(s){for(var l=s;l!==null;){if(l.tag===13){var d=l.memoizedState;if(d!==null&&(d=d.dehydrated,d===null||dy(d)||fy(d)))return l}else if(l.tag===19&&(l.memoizedProps.revealOrder==="forwards"||l.memoizedProps.revealOrder==="backwards"||l.memoizedProps.revealOrder==="unstable_legacy-backwards"||l.memoizedProps.revealOrder==="together")){if((l.flags&128)!==0)return l}else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===s)break;for(;l.sibling===null;){if(l.return===null||l.return===s)return null;l=l.return}l.sibling.return=l.return,l=l.sibling}return null}var $i=0,ft=null,Vt=null,gn=null,jd=!1,qa=!1,Fs=!1,Id=0,wc=0,Ga=null,YI=0;function ln(){throw Error(r(321))}function sg(s,l){if(l===null)return!1;for(var d=0;d<l.length&&d<s.length;d++)if(!mr(s[d],l[d]))return!1;return!0}function ag(s,l,d,m,b,E){return $i=E,ft=l,l.memoizedState=null,l.updateQueue=null,l.lanes=0,L.H=s===null||s.memoizedState===null?$w:Sg,Fs=!1,E=d(m,b),Fs=!1,qa&&(E=sw(l,d,m,b)),ow(s),E}function ow(s){L.H=Cc;var l=Vt!==null&&Vt.next!==null;if($i=0,gn=Vt=ft=null,jd=!1,wc=0,Ga=null,l)throw Error(r(300));s===null||yn||(s=s.dependencies,s!==null&&Cd(s)&&(yn=!0))}function sw(s,l,d,m){ft=s;var b=0;do{if(qa&&(Ga=null),wc=0,qa=!1,25<=b)throw Error(r(301));if(b+=1,gn=Vt=null,s.updateQueue!=null){var E=s.updateQueue;E.lastEffect=null,E.events=null,E.stores=null,E.memoCache!=null&&(E.memoCache.index=0)}L.H=Hw,E=l(d,m)}while(qa);return E}function KI(){var s=L.H,l=s.useState()[0];return l=typeof l.then=="function"?Sc(l):l,s=s.useState()[0],(Vt!==null?Vt.memoizedState:null)!==s&&(ft.flags|=1024),l}function lg(){var s=Id!==0;return Id=0,s}function cg(s,l,d){l.updateQueue=s.updateQueue,l.flags&=-2053,s.lanes&=~d}function ug(s){if(jd){for(s=s.memoizedState;s!==null;){var l=s.queue;l!==null&&(l.pending=null),s=s.next}jd=!1}$i=0,gn=Vt=ft=null,qa=!1,wc=Id=0,Ga=null}function Jn(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return gn===null?ft.memoizedState=gn=s:gn=gn.next=s,gn}function pn(){if(Vt===null){var s=ft.alternate;s=s!==null?s.memoizedState:null}else s=Vt.next;var l=gn===null?ft.memoizedState:gn.next;if(l!==null)gn=l,Vt=s;else{if(s===null)throw ft.alternate===null?Error(r(467)):Error(r(310));Vt=s,s={memoizedState:Vt.memoizedState,baseState:Vt.baseState,baseQueue:Vt.baseQueue,queue:Vt.queue,next:null},gn===null?ft.memoizedState=gn=s:gn=gn.next=s}return gn}function _d(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Sc(s){var l=wc;return wc+=1,Ga===null&&(Ga=[]),s=X1(Ga,s,l),l=ft,(gn===null?l.memoizedState:gn.next)===null&&(l=l.alternate,L.H=l===null||l.memoizedState===null?$w:Sg),s}function Ld(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return Sc(s);if(s.$$typeof===k)return _n(s)}throw Error(r(438,String(s)))}function dg(s){var l=null,d=ft.updateQueue;if(d!==null&&(l=d.memoCache),l==null){var m=ft.alternate;m!==null&&(m=m.updateQueue,m!==null&&(m=m.memoCache,m!=null&&(l={data:m.data.map(function(b){return b.slice()}),index:0})))}if(l==null&&(l={data:[],index:0}),d===null&&(d=_d(),ft.updateQueue=d),d.memoCache=l,d=l.data[l.index],d===void 0)for(d=l.data[l.index]=Array(s),m=0;m<s;m++)d[m]=U;return l.index++,d}function Hi(s,l){return typeof l=="function"?l(s):l}function Pd(s){var l=pn();return fg(l,Vt,s)}function fg(s,l,d){var m=s.queue;if(m===null)throw Error(r(311));m.lastRenderedReducer=d;var b=s.baseQueue,E=m.pending;if(E!==null){if(b!==null){var A=b.next;b.next=E.next,E.next=A}l.baseQueue=b=E,m.pending=null}if(E=s.baseState,b===null)s.memoizedState=E;else{l=b.next;var _=A=null,F=null,ie=l,ge=!1;do{var xe=ie.lane&-536870913;if(xe!==ie.lane?(Ct&xe)===xe:($i&xe)===xe){var se=ie.revertLane;if(se===0)F!==null&&(F=F.next={lane:0,revertLane:0,gesture:null,action:ie.action,hasEagerState:ie.hasEagerState,eagerState:ie.eagerState,next:null}),xe===Fa&&(ge=!0);else if(($i&se)===se){ie=ie.next,se===Fa&&(ge=!0);continue}else xe={lane:0,revertLane:ie.revertLane,gesture:null,action:ie.action,hasEagerState:ie.hasEagerState,eagerState:ie.eagerState,next:null},F===null?(_=F=xe,A=E):F=F.next=xe,ft.lanes|=se,jo|=se;xe=ie.action,Fs&&d(E,xe),E=ie.hasEagerState?ie.eagerState:d(E,xe)}else se={lane:xe,revertLane:ie.revertLane,gesture:ie.gesture,action:ie.action,hasEagerState:ie.hasEagerState,eagerState:ie.eagerState,next:null},F===null?(_=F=se,A=E):F=F.next=se,ft.lanes|=xe,jo|=xe;ie=ie.next}while(ie!==null&&ie!==l);if(F===null?A=E:F.next=_,!mr(E,s.memoizedState)&&(yn=!0,ge&&(d=$a,d!==null)))throw d;s.memoizedState=E,s.baseState=A,s.baseQueue=F,m.lastRenderedState=E}return b===null&&(m.lanes=0),[s.memoizedState,m.dispatch]}function hg(s){var l=pn(),d=l.queue;if(d===null)throw Error(r(311));d.lastRenderedReducer=s;var m=d.dispatch,b=d.pending,E=l.memoizedState;if(b!==null){d.pending=null;var A=b=b.next;do E=s(E,A.action),A=A.next;while(A!==b);mr(E,l.memoizedState)||(yn=!0),l.memoizedState=E,l.baseQueue===null&&(l.baseState=E),d.lastRenderedState=E}return[E,m]}function aw(s,l,d){var m=ft,b=pn(),E=Nt;if(E){if(d===void 0)throw Error(r(407));d=d()}else d=l();var A=!mr((Vt||b).memoizedState,d);if(A&&(b.memoizedState=d,yn=!0),b=b.queue,gg(uw.bind(null,m,b,s),[s]),b.getSnapshot!==l||A||gn!==null&&gn.memoizedState.tag&1){if(m.flags|=2048,Wa(9,{destroy:void 0},cw.bind(null,m,b,d,l),null),Yt===null)throw Error(r(349));E||($i&127)!==0||lw(m,l,d)}return d}function lw(s,l,d){s.flags|=16384,s={getSnapshot:l,value:d},l=ft.updateQueue,l===null?(l=_d(),ft.updateQueue=l,l.stores=[s]):(d=l.stores,d===null?l.stores=[s]:d.push(s))}function cw(s,l,d,m){l.value=d,l.getSnapshot=m,dw(l)&&fw(s)}function uw(s,l,d){return d(function(){dw(l)&&fw(s)})}function dw(s){var l=s.getSnapshot;s=s.value;try{var d=l();return!mr(s,d)}catch{return!0}}function fw(s){var l=Ms(s,2);l!==null&&ur(l,s,2)}function pg(s){var l=Jn();if(typeof s=="function"){var d=s;if(s=d(),Fs){ut(!0);try{d()}finally{ut(!1)}}}return l.memoizedState=l.baseState=s,l.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Hi,lastRenderedState:s},l}function hw(s,l,d,m){return s.baseState=d,fg(s,Vt,typeof m=="function"?m:Hi)}function XI(s,l,d,m,b){if(Fd(s))throw Error(r(485));if(s=l.action,s!==null){var E={payload:b,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(A){E.listeners.push(A)}};L.T!==null?d(!0):E.isTransition=!1,m(E),d=l.pending,d===null?(E.next=l.pending=E,pw(l,E)):(E.next=d.next,l.pending=d.next=E)}}function pw(s,l){var d=l.action,m=l.payload,b=s.state;if(l.isTransition){var E=L.T,A={};L.T=A;try{var _=d(b,m),F=L.S;F!==null&&F(A,_),mw(s,l,_)}catch(ie){mg(s,l,ie)}finally{E!==null&&A.types!==null&&(E.types=A.types),L.T=E}}else try{E=d(b,m),mw(s,l,E)}catch(ie){mg(s,l,ie)}}function mw(s,l,d){d!==null&&typeof d=="object"&&typeof d.then=="function"?d.then(function(m){gw(s,l,m)},function(m){return mg(s,l,m)}):gw(s,l,d)}function gw(s,l,d){l.status="fulfilled",l.value=d,yw(l),s.state=d,l=s.pending,l!==null&&(d=l.next,d===l?s.pending=null:(d=d.next,l.next=d,pw(s,d)))}function mg(s,l,d){var m=s.pending;if(s.pending=null,m!==null){m=m.next;do l.status="rejected",l.reason=d,yw(l),l=l.next;while(l!==m)}s.action=null}function yw(s){s=s.listeners;for(var l=0;l<s.length;l++)(0,s[l])()}function vw(s,l){return l}function xw(s,l){if(Nt){var d=Yt.formState;if(d!==null){e:{var m=ft;if(Nt){if(Jt){t:{for(var b=Jt,E=_r;b.nodeType!==8;){if(!E){b=null;break t}if(b=Pr(b.nextSibling),b===null){b=null;break t}}E=b.data,b=E==="F!"||E==="F"?b:null}if(b){Jt=Pr(b.nextSibling),m=b.data==="F!";break e}}Co(m)}m=!1}m&&(l=d[0])}}return d=Jn(),d.memoizedState=d.baseState=l,m={pending:null,lanes:0,dispatch:null,lastRenderedReducer:vw,lastRenderedState:l},d.queue=m,d=zw.bind(null,ft,m),m.dispatch=d,m=pg(!1),E=wg.bind(null,ft,!1,m.queue),m=Jn(),b={state:l,dispatch:null,action:s,pending:null},m.queue=b,d=XI.bind(null,ft,b,E,d),b.dispatch=d,m.memoizedState=s,[l,d,!1]}function bw(s){var l=pn();return ww(l,Vt,s)}function ww(s,l,d){if(l=fg(s,l,vw)[0],s=Pd(Hi)[0],typeof l=="object"&&l!==null&&typeof l.then=="function")try{var m=Sc(l)}catch(A){throw A===Ha?Ad:A}else m=l;l=pn();var b=l.queue,E=b.dispatch;return d!==l.memoizedState&&(ft.flags|=2048,Wa(9,{destroy:void 0},JI.bind(null,b,d),null)),[m,E,s]}function JI(s,l){s.action=l}function Sw(s){var l=pn(),d=Vt;if(d!==null)return ww(l,d,s);pn(),l=l.memoizedState,d=pn();var m=d.queue.dispatch;return d.memoizedState=s,[l,m,!1]}function Wa(s,l,d,m){return s={tag:s,create:d,deps:m,inst:l,next:null},l=ft.updateQueue,l===null&&(l=_d(),ft.updateQueue=l),d=l.lastEffect,d===null?l.lastEffect=s.next=s:(m=d.next,d.next=s,s.next=m,l.lastEffect=s),s}function Ew(){return pn().memoizedState}function zd(s,l,d,m){var b=Jn();ft.flags|=s,b.memoizedState=Wa(1|l,{destroy:void 0},d,m===void 0?null:m)}function Bd(s,l,d,m){var b=pn();m=m===void 0?null:m;var E=b.memoizedState.inst;Vt!==null&&m!==null&&sg(m,Vt.memoizedState.deps)?b.memoizedState=Wa(l,E,d,m):(ft.flags|=s,b.memoizedState=Wa(1|l,E,d,m))}function Cw(s,l){zd(8390656,8,s,l)}function gg(s,l){Bd(2048,8,s,l)}function QI(s){ft.flags|=4;var l=ft.updateQueue;if(l===null)l=_d(),ft.updateQueue=l,l.events=[s];else{var d=l.events;d===null?l.events=[s]:d.push(s)}}function Tw(s){var l=pn().memoizedState;return QI({ref:l,nextImpl:s}),function(){if((It&2)!==0)throw Error(r(440));return l.impl.apply(void 0,arguments)}}function Nw(s,l){return Bd(4,2,s,l)}function Aw(s,l){return Bd(4,4,s,l)}function kw(s,l){if(typeof l=="function"){s=s();var d=l(s);return function(){typeof d=="function"?d():l(null)}}if(l!=null)return s=s(),l.current=s,function(){l.current=null}}function Dw(s,l,d){d=d!=null?d.concat([s]):null,Bd(4,4,kw.bind(null,l,s),d)}function yg(){}function Ow(s,l){var d=pn();l=l===void 0?null:l;var m=d.memoizedState;return l!==null&&sg(l,m[1])?m[0]:(d.memoizedState=[s,l],s)}function Mw(s,l){var d=pn();l=l===void 0?null:l;var m=d.memoizedState;if(l!==null&&sg(l,m[1]))return m[0];if(m=s(),Fs){ut(!0);try{s()}finally{ut(!1)}}return d.memoizedState=[m,l],m}function vg(s,l,d){return d===void 0||($i&1073741824)!==0&&(Ct&261930)===0?s.memoizedState=l:(s.memoizedState=d,s=RS(),ft.lanes|=s,jo|=s,d)}function Rw(s,l,d,m){return mr(d,l)?d:Va.current!==null?(s=vg(s,d,m),mr(s,l)||(yn=!0),s):($i&42)===0||($i&1073741824)!==0&&(Ct&261930)===0?(yn=!0,s.memoizedState=d):(s=RS(),ft.lanes|=s,jo|=s,l)}function jw(s,l,d,m,b){var E=$.p;$.p=E!==0&&8>E?E:8;var A=L.T,_={};L.T=_,wg(s,!1,l,d);try{var F=b(),ie=L.S;if(ie!==null&&ie(_,F),F!==null&&typeof F=="object"&&typeof F.then=="function"){var ge=WI(F,m);Ec(s,l,ge,wr(s))}else Ec(s,l,m,wr(s))}catch(xe){Ec(s,l,{then:function(){},status:"rejected",reason:xe},wr())}finally{$.p=E,A!==null&&_.types!==null&&(A.types=_.types),L.T=A}}function ZI(){}function xg(s,l,d,m){if(s.tag!==5)throw Error(r(476));var b=Iw(s).queue;jw(s,b,l,V,d===null?ZI:function(){return _w(s),d(m)})}function Iw(s){var l=s.memoizedState;if(l!==null)return l;l={memoizedState:V,baseState:V,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Hi,lastRenderedState:V},next:null};var d={};return l.next={memoizedState:d,baseState:d,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Hi,lastRenderedState:d},next:null},s.memoizedState=l,s=s.alternate,s!==null&&(s.memoizedState=l),l}function _w(s){var l=Iw(s);l.next===null&&(l=s.alternate.memoizedState),Ec(s,l.next.queue,{},wr())}function bg(){return _n(Fc)}function Lw(){return pn().memoizedState}function Pw(){return pn().memoizedState}function e_(s){for(var l=s.return;l!==null;){switch(l.tag){case 24:case 3:var d=wr();s=Ao(d);var m=ko(l,s,d);m!==null&&(ur(m,l,d),vc(m,l,d)),l={cache:Km()},s.payload=l;return}l=l.return}}function t_(s,l,d){var m=wr();d={lane:m,revertLane:0,gesture:null,action:d,hasEagerState:!1,eagerState:null,next:null},Fd(s)?Bw(l,d):(d=zm(s,l,d,m),d!==null&&(ur(d,s,m),Fw(d,l,m)))}function zw(s,l,d){var m=wr();Ec(s,l,d,m)}function Ec(s,l,d,m){var b={lane:m,revertLane:0,gesture:null,action:d,hasEagerState:!1,eagerState:null,next:null};if(Fd(s))Bw(l,b);else{var E=s.alternate;if(s.lanes===0&&(E===null||E.lanes===0)&&(E=l.lastRenderedReducer,E!==null))try{var A=l.lastRenderedState,_=E(A,d);if(b.hasEagerState=!0,b.eagerState=_,mr(_,A))return bd(s,l,b,0),Yt===null&&xd(),!1}catch{}if(d=zm(s,l,b,m),d!==null)return ur(d,s,m),Fw(d,l,m),!0}return!1}function wg(s,l,d,m){if(m={lane:2,revertLane:Zg(),gesture:null,action:m,hasEagerState:!1,eagerState:null,next:null},Fd(s)){if(l)throw Error(r(479))}else l=zm(s,d,m,2),l!==null&&ur(l,s,2)}function Fd(s){var l=s.alternate;return s===ft||l!==null&&l===ft}function Bw(s,l){qa=jd=!0;var d=s.pending;d===null?l.next=l:(l.next=d.next,d.next=l),s.pending=l}function Fw(s,l,d){if((d&4194048)!==0){var m=l.lanes;m&=s.pendingLanes,d|=m,l.lanes=d,nr(s,d)}}var Cc={readContext:_n,use:Ld,useCallback:ln,useContext:ln,useEffect:ln,useImperativeHandle:ln,useLayoutEffect:ln,useInsertionEffect:ln,useMemo:ln,useReducer:ln,useRef:ln,useState:ln,useDebugValue:ln,useDeferredValue:ln,useTransition:ln,useSyncExternalStore:ln,useId:ln,useHostTransitionStatus:ln,useFormState:ln,useActionState:ln,useOptimistic:ln,useMemoCache:ln,useCacheRefresh:ln};Cc.useEffectEvent=ln;var $w={readContext:_n,use:Ld,useCallback:function(s,l){return Jn().memoizedState=[s,l===void 0?null:l],s},useContext:_n,useEffect:Cw,useImperativeHandle:function(s,l,d){d=d!=null?d.concat([s]):null,zd(4194308,4,kw.bind(null,l,s),d)},useLayoutEffect:function(s,l){return zd(4194308,4,s,l)},useInsertionEffect:function(s,l){zd(4,2,s,l)},useMemo:function(s,l){var d=Jn();l=l===void 0?null:l;var m=s();if(Fs){ut(!0);try{s()}finally{ut(!1)}}return d.memoizedState=[m,l],m},useReducer:function(s,l,d){var m=Jn();if(d!==void 0){var b=d(l);if(Fs){ut(!0);try{d(l)}finally{ut(!1)}}}else b=l;return m.memoizedState=m.baseState=b,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:b},m.queue=s,s=s.dispatch=t_.bind(null,ft,s),[m.memoizedState,s]},useRef:function(s){var l=Jn();return s={current:s},l.memoizedState=s},useState:function(s){s=pg(s);var l=s.queue,d=zw.bind(null,ft,l);return l.dispatch=d,[s.memoizedState,d]},useDebugValue:yg,useDeferredValue:function(s,l){var d=Jn();return vg(d,s,l)},useTransition:function(){var s=pg(!1);return s=jw.bind(null,ft,s.queue,!0,!1),Jn().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,l,d){var m=ft,b=Jn();if(Nt){if(d===void 0)throw Error(r(407));d=d()}else{if(d=l(),Yt===null)throw Error(r(349));(Ct&127)!==0||lw(m,l,d)}b.memoizedState=d;var E={value:d,getSnapshot:l};return b.queue=E,Cw(uw.bind(null,m,E,s),[s]),m.flags|=2048,Wa(9,{destroy:void 0},cw.bind(null,m,E,d,l),null),d},useId:function(){var s=Jn(),l=Yt.identifierPrefix;if(Nt){var d=pi,m=hi;d=(m&~(1<<32-Qe(m)-1)).toString(32)+d,l="_"+l+"R_"+d,d=Id++,0<d&&(l+="H"+d.toString(32)),l+="_"}else d=YI++,l="_"+l+"r_"+d.toString(32)+"_";return s.memoizedState=l},useHostTransitionStatus:bg,useFormState:xw,useActionState:xw,useOptimistic:function(s){var l=Jn();l.memoizedState=l.baseState=s;var d={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return l.queue=d,l=wg.bind(null,ft,!0,d),d.dispatch=l,[s,l]},useMemoCache:dg,useCacheRefresh:function(){return Jn().memoizedState=e_.bind(null,ft)},useEffectEvent:function(s){var l=Jn(),d={impl:s};return l.memoizedState=d,function(){if((It&2)!==0)throw Error(r(440));return d.impl.apply(void 0,arguments)}}},Sg={readContext:_n,use:Ld,useCallback:Ow,useContext:_n,useEffect:gg,useImperativeHandle:Dw,useInsertionEffect:Nw,useLayoutEffect:Aw,useMemo:Mw,useReducer:Pd,useRef:Ew,useState:function(){return Pd(Hi)},useDebugValue:yg,useDeferredValue:function(s,l){var d=pn();return Rw(d,Vt.memoizedState,s,l)},useTransition:function(){var s=Pd(Hi)[0],l=pn().memoizedState;return[typeof s=="boolean"?s:Sc(s),l]},useSyncExternalStore:aw,useId:Lw,useHostTransitionStatus:bg,useFormState:bw,useActionState:bw,useOptimistic:function(s,l){var d=pn();return hw(d,Vt,s,l)},useMemoCache:dg,useCacheRefresh:Pw};Sg.useEffectEvent=Tw;var Hw={readContext:_n,use:Ld,useCallback:Ow,useContext:_n,useEffect:gg,useImperativeHandle:Dw,useInsertionEffect:Nw,useLayoutEffect:Aw,useMemo:Mw,useReducer:hg,useRef:Ew,useState:function(){return hg(Hi)},useDebugValue:yg,useDeferredValue:function(s,l){var d=pn();return Vt===null?vg(d,s,l):Rw(d,Vt.memoizedState,s,l)},useTransition:function(){var s=hg(Hi)[0],l=pn().memoizedState;return[typeof s=="boolean"?s:Sc(s),l]},useSyncExternalStore:aw,useId:Lw,useHostTransitionStatus:bg,useFormState:Sw,useActionState:Sw,useOptimistic:function(s,l){var d=pn();return Vt!==null?hw(d,Vt,s,l):(d.baseState=s,[s,d.queue.dispatch])},useMemoCache:dg,useCacheRefresh:Pw};Hw.useEffectEvent=Tw;function Eg(s,l,d,m){l=s.memoizedState,d=d(m,l),d=d==null?l:g({},l,d),s.memoizedState=d,s.lanes===0&&(s.updateQueue.baseState=d)}var Cg={enqueueSetState:function(s,l,d){s=s._reactInternals;var m=wr(),b=Ao(m);b.payload=l,d!=null&&(b.callback=d),l=ko(s,b,m),l!==null&&(ur(l,s,m),vc(l,s,m))},enqueueReplaceState:function(s,l,d){s=s._reactInternals;var m=wr(),b=Ao(m);b.tag=1,b.payload=l,d!=null&&(b.callback=d),l=ko(s,b,m),l!==null&&(ur(l,s,m),vc(l,s,m))},enqueueForceUpdate:function(s,l){s=s._reactInternals;var d=wr(),m=Ao(d);m.tag=2,l!=null&&(m.callback=l),l=ko(s,m,d),l!==null&&(ur(l,s,d),vc(l,s,d))}};function Uw(s,l,d,m,b,E,A){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(m,E,A):l.prototype&&l.prototype.isPureReactComponent?!uc(d,m)||!uc(b,E):!0}function Vw(s,l,d,m){s=l.state,typeof l.componentWillReceiveProps=="function"&&l.componentWillReceiveProps(d,m),typeof l.UNSAFE_componentWillReceiveProps=="function"&&l.UNSAFE_componentWillReceiveProps(d,m),l.state!==s&&Cg.enqueueReplaceState(l,l.state,null)}function $s(s,l){var d=l;if("ref"in l){d={};for(var m in l)m!=="ref"&&(d[m]=l[m])}if(s=s.defaultProps){d===l&&(d=g({},d));for(var b in s)d[b]===void 0&&(d[b]=s[b])}return d}function qw(s){vd(s)}function Gw(s){console.error(s)}function Ww(s){vd(s)}function $d(s,l){try{var d=s.onUncaughtError;d(l.value,{componentStack:l.stack})}catch(m){setTimeout(function(){throw m})}}function Yw(s,l,d){try{var m=s.onCaughtError;m(d.value,{componentStack:d.stack,errorBoundary:l.tag===1?l.stateNode:null})}catch(b){setTimeout(function(){throw b})}}function Tg(s,l,d){return d=Ao(d),d.tag=3,d.payload={element:null},d.callback=function(){$d(s,l)},d}function Kw(s){return s=Ao(s),s.tag=3,s}function Xw(s,l,d,m){var b=d.type.getDerivedStateFromError;if(typeof b=="function"){var E=m.value;s.payload=function(){return b(E)},s.callback=function(){Yw(l,d,m)}}var A=d.stateNode;A!==null&&typeof A.componentDidCatch=="function"&&(s.callback=function(){Yw(l,d,m),typeof b!="function"&&(Io===null?Io=new Set([this]):Io.add(this));var _=m.stack;this.componentDidCatch(m.value,{componentStack:_!==null?_:""})})}function n_(s,l,d,m,b){if(d.flags|=32768,m!==null&&typeof m=="object"&&typeof m.then=="function"){if(l=d.alternate,l!==null&&Ba(l,d,b,!0),d=yr.current,d!==null){switch(d.tag){case 31:case 13:return Lr===null?Zd():d.alternate===null&&cn===0&&(cn=3),d.flags&=-257,d.flags|=65536,d.lanes=b,m===kd?d.flags|=16384:(l=d.updateQueue,l===null?d.updateQueue=new Set([m]):l.add(m),Xg(s,m,b)),!1;case 22:return d.flags|=65536,m===kd?d.flags|=16384:(l=d.updateQueue,l===null?(l={transitions:null,markerInstances:null,retryQueue:new Set([m])},d.updateQueue=l):(d=l.retryQueue,d===null?l.retryQueue=new Set([m]):d.add(m)),Xg(s,m,b)),!1}throw Error(r(435,d.tag))}return Xg(s,m,b),Zd(),!1}if(Nt)return l=yr.current,l!==null?((l.flags&65536)===0&&(l.flags|=256),l.flags|=65536,l.lanes=b,m!==Vm&&(s=Error(r(422),{cause:m}),hc(Rr(s,d)))):(m!==Vm&&(l=Error(r(423),{cause:m}),hc(Rr(l,d))),s=s.current.alternate,s.flags|=65536,b&=-b,s.lanes|=b,m=Rr(m,d),b=Tg(s.stateNode,m,b),tg(s,b),cn!==4&&(cn=2)),!1;var E=Error(r(520),{cause:m});if(E=Rr(E,d),Rc===null?Rc=[E]:Rc.push(E),cn!==4&&(cn=2),l===null)return!0;m=Rr(m,d),d=l;do{switch(d.tag){case 3:return d.flags|=65536,s=b&-b,d.lanes|=s,s=Tg(d.stateNode,m,s),tg(d,s),!1;case 1:if(l=d.type,E=d.stateNode,(d.flags&128)===0&&(typeof l.getDerivedStateFromError=="function"||E!==null&&typeof E.componentDidCatch=="function"&&(Io===null||!Io.has(E))))return d.flags|=65536,b&=-b,d.lanes|=b,b=Kw(b),Xw(b,s,d,m),tg(d,b),!1}d=d.return}while(d!==null);return!1}var Ng=Error(r(461)),yn=!1;function Ln(s,l,d,m){l.child=s===null?ew(l,null,d,m):Bs(l,s.child,d,m)}function Jw(s,l,d,m,b){d=d.render;var E=l.ref;if("ref"in m){var A={};for(var _ in m)_!=="ref"&&(A[_]=m[_])}else A=m;return _s(l),m=ag(s,l,d,A,E,b),_=lg(),s!==null&&!yn?(cg(s,l,b),Ui(s,l,b)):(Nt&&_&&Hm(l),l.flags|=1,Ln(s,l,m,b),l.child)}function Qw(s,l,d,m,b){if(s===null){var E=d.type;return typeof E=="function"&&!Bm(E)&&E.defaultProps===void 0&&d.compare===null?(l.tag=15,l.type=E,Zw(s,l,E,m,b)):(s=Sd(d.type,null,m,l,l.mode,b),s.ref=l.ref,s.return=l,l.child=s)}if(E=s.child,!Ig(s,b)){var A=E.memoizedProps;if(d=d.compare,d=d!==null?d:uc,d(A,m)&&s.ref===l.ref)return Ui(s,l,b)}return l.flags|=1,s=Pi(E,m),s.ref=l.ref,s.return=l,l.child=s}function Zw(s,l,d,m,b){if(s!==null){var E=s.memoizedProps;if(uc(E,m)&&s.ref===l.ref)if(yn=!1,l.pendingProps=m=E,Ig(s,b))(s.flags&131072)!==0&&(yn=!0);else return l.lanes=s.lanes,Ui(s,l,b)}return Ag(s,l,d,m,b)}function eS(s,l,d,m){var b=m.children,E=s!==null?s.memoizedState:null;if(s===null&&l.stateNode===null&&(l.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),m.mode==="hidden"){if((l.flags&128)!==0){if(E=E!==null?E.baseLanes|d:d,s!==null){for(m=l.child=s.child,b=0;m!==null;)b=b|m.lanes|m.childLanes,m=m.sibling;m=b&~E}else m=0,l.child=null;return tS(s,l,E,d,m)}if((d&536870912)!==0)l.memoizedState={baseLanes:0,cachePool:null},s!==null&&Nd(l,E!==null?E.cachePool:null),E!==null?rw(l,E):rg(),iw(l);else return m=l.lanes=536870912,tS(s,l,E!==null?E.baseLanes|d:d,d,m)}else E!==null?(Nd(l,E.cachePool),rw(l,E),Oo(),l.memoizedState=null):(s!==null&&Nd(l,null),rg(),Oo());return Ln(s,l,b,d),l.child}function Tc(s,l){return s!==null&&s.tag===22||l.stateNode!==null||(l.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),l.sibling}function tS(s,l,d,m,b){var E=Jm();return E=E===null?null:{parent:mn._currentValue,pool:E},l.memoizedState={baseLanes:d,cachePool:E},s!==null&&Nd(l,null),rg(),iw(l),s!==null&&Ba(s,l,m,!0),l.childLanes=b,null}function Hd(s,l){return l=Vd({mode:l.mode,children:l.children},s.mode),l.ref=s.ref,s.child=l,l.return=s,l}function nS(s,l,d){return Bs(l,s.child,null,d),s=Hd(l,l.pendingProps),s.flags|=2,vr(l),l.memoizedState=null,s}function r_(s,l,d){var m=l.pendingProps,b=(l.flags&128)!==0;if(l.flags&=-129,s===null){if(Nt){if(m.mode==="hidden")return s=Hd(l,m),l.lanes=536870912,Tc(null,s);if(og(l),(s=Jt)?(s=pE(s,_r),s=s!==null&&s.data==="&"?s:null,s!==null&&(l.memoizedState={dehydrated:s,treeContext:So!==null?{id:hi,overflow:pi}:null,retryLane:536870912,hydrationErrors:null},d=B1(s),d.return=l,l.child=d,In=l,Jt=null)):s=null,s===null)throw Co(l);return l.lanes=536870912,null}return Hd(l,m)}var E=s.memoizedState;if(E!==null){var A=E.dehydrated;if(og(l),b)if(l.flags&256)l.flags&=-257,l=nS(s,l,d);else if(l.memoizedState!==null)l.child=s.child,l.flags|=128,l=null;else throw Error(r(558));else if(yn||Ba(s,l,d,!1),b=(d&s.childLanes)!==0,yn||b){if(m=Yt,m!==null&&(A=rr(m,d),A!==0&&A!==E.retryLane))throw E.retryLane=A,Ms(s,A),ur(m,s,A),Ng;Zd(),l=nS(s,l,d)}else s=E.treeContext,Jt=Pr(A.nextSibling),In=l,Nt=!0,Eo=null,_r=!1,s!==null&&H1(l,s),l=Hd(l,m),l.flags|=4096;return l}return s=Pi(s.child,{mode:m.mode,children:m.children}),s.ref=l.ref,l.child=s,s.return=l,s}function Ud(s,l){var d=l.ref;if(d===null)s!==null&&s.ref!==null&&(l.flags|=4194816);else{if(typeof d!="function"&&typeof d!="object")throw Error(r(284));(s===null||s.ref!==d)&&(l.flags|=4194816)}}function Ag(s,l,d,m,b){return _s(l),d=ag(s,l,d,m,void 0,b),m=lg(),s!==null&&!yn?(cg(s,l,b),Ui(s,l,b)):(Nt&&m&&Hm(l),l.flags|=1,Ln(s,l,d,b),l.child)}function rS(s,l,d,m,b,E){return _s(l),l.updateQueue=null,d=sw(l,m,d,b),ow(s),m=lg(),s!==null&&!yn?(cg(s,l,E),Ui(s,l,E)):(Nt&&m&&Hm(l),l.flags|=1,Ln(s,l,d,E),l.child)}function iS(s,l,d,m,b){if(_s(l),l.stateNode===null){var E=_a,A=d.contextType;typeof A=="object"&&A!==null&&(E=_n(A)),E=new d(m,E),l.memoizedState=E.state!==null&&E.state!==void 0?E.state:null,E.updater=Cg,l.stateNode=E,E._reactInternals=l,E=l.stateNode,E.props=m,E.state=l.memoizedState,E.refs={},Zm(l),A=d.contextType,E.context=typeof A=="object"&&A!==null?_n(A):_a,E.state=l.memoizedState,A=d.getDerivedStateFromProps,typeof A=="function"&&(Eg(l,d,A,m),E.state=l.memoizedState),typeof d.getDerivedStateFromProps=="function"||typeof E.getSnapshotBeforeUpdate=="function"||typeof E.UNSAFE_componentWillMount!="function"&&typeof E.componentWillMount!="function"||(A=E.state,typeof E.componentWillMount=="function"&&E.componentWillMount(),typeof E.UNSAFE_componentWillMount=="function"&&E.UNSAFE_componentWillMount(),A!==E.state&&Cg.enqueueReplaceState(E,E.state,null),bc(l,m,E,b),xc(),E.state=l.memoizedState),typeof E.componentDidMount=="function"&&(l.flags|=4194308),m=!0}else if(s===null){E=l.stateNode;var _=l.memoizedProps,F=$s(d,_);E.props=F;var ie=E.context,ge=d.contextType;A=_a,typeof ge=="object"&&ge!==null&&(A=_n(ge));var xe=d.getDerivedStateFromProps;ge=typeof xe=="function"||typeof E.getSnapshotBeforeUpdate=="function",_=l.pendingProps!==_,ge||typeof E.UNSAFE_componentWillReceiveProps!="function"&&typeof E.componentWillReceiveProps!="function"||(_||ie!==A)&&Vw(l,E,m,A),No=!1;var se=l.memoizedState;E.state=se,bc(l,m,E,b),xc(),ie=l.memoizedState,_||se!==ie||No?(typeof xe=="function"&&(Eg(l,d,xe,m),ie=l.memoizedState),(F=No||Uw(l,d,F,m,se,ie,A))?(ge||typeof E.UNSAFE_componentWillMount!="function"&&typeof E.componentWillMount!="function"||(typeof E.componentWillMount=="function"&&E.componentWillMount(),typeof E.UNSAFE_componentWillMount=="function"&&E.UNSAFE_componentWillMount()),typeof E.componentDidMount=="function"&&(l.flags|=4194308)):(typeof E.componentDidMount=="function"&&(l.flags|=4194308),l.memoizedProps=m,l.memoizedState=ie),E.props=m,E.state=ie,E.context=A,m=F):(typeof E.componentDidMount=="function"&&(l.flags|=4194308),m=!1)}else{E=l.stateNode,eg(s,l),A=l.memoizedProps,ge=$s(d,A),E.props=ge,xe=l.pendingProps,se=E.context,ie=d.contextType,F=_a,typeof ie=="object"&&ie!==null&&(F=_n(ie)),_=d.getDerivedStateFromProps,(ie=typeof _=="function"||typeof E.getSnapshotBeforeUpdate=="function")||typeof E.UNSAFE_componentWillReceiveProps!="function"&&typeof E.componentWillReceiveProps!="function"||(A!==xe||se!==F)&&Vw(l,E,m,F),No=!1,se=l.memoizedState,E.state=se,bc(l,m,E,b),xc();var fe=l.memoizedState;A!==xe||se!==fe||No||s!==null&&s.dependencies!==null&&Cd(s.dependencies)?(typeof _=="function"&&(Eg(l,d,_,m),fe=l.memoizedState),(ge=No||Uw(l,d,ge,m,se,fe,F)||s!==null&&s.dependencies!==null&&Cd(s.dependencies))?(ie||typeof E.UNSAFE_componentWillUpdate!="function"&&typeof E.componentWillUpdate!="function"||(typeof E.componentWillUpdate=="function"&&E.componentWillUpdate(m,fe,F),typeof E.UNSAFE_componentWillUpdate=="function"&&E.UNSAFE_componentWillUpdate(m,fe,F)),typeof E.componentDidUpdate=="function"&&(l.flags|=4),typeof E.getSnapshotBeforeUpdate=="function"&&(l.flags|=1024)):(typeof E.componentDidUpdate!="function"||A===s.memoizedProps&&se===s.memoizedState||(l.flags|=4),typeof E.getSnapshotBeforeUpdate!="function"||A===s.memoizedProps&&se===s.memoizedState||(l.flags|=1024),l.memoizedProps=m,l.memoizedState=fe),E.props=m,E.state=fe,E.context=F,m=ge):(typeof E.componentDidUpdate!="function"||A===s.memoizedProps&&se===s.memoizedState||(l.flags|=4),typeof E.getSnapshotBeforeUpdate!="function"||A===s.memoizedProps&&se===s.memoizedState||(l.flags|=1024),m=!1)}return E=m,Ud(s,l),m=(l.flags&128)!==0,E||m?(E=l.stateNode,d=m&&typeof d.getDerivedStateFromError!="function"?null:E.render(),l.flags|=1,s!==null&&m?(l.child=Bs(l,s.child,null,b),l.child=Bs(l,null,d,b)):Ln(s,l,d,b),l.memoizedState=E.state,s=l.child):s=Ui(s,l,b),s}function oS(s,l,d,m){return js(),l.flags|=256,Ln(s,l,d,m),l.child}var kg={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Dg(s){return{baseLanes:s,cachePool:Y1()}}function Og(s,l,d){return s=s!==null?s.childLanes&~d:0,l&&(s|=br),s}function sS(s,l,d){var m=l.pendingProps,b=!1,E=(l.flags&128)!==0,A;if((A=E)||(A=s!==null&&s.memoizedState===null?!1:(hn.current&2)!==0),A&&(b=!0,l.flags&=-129),A=(l.flags&32)!==0,l.flags&=-33,s===null){if(Nt){if(b?Do(l):Oo(),(s=Jt)?(s=pE(s,_r),s=s!==null&&s.data!=="&"?s:null,s!==null&&(l.memoizedState={dehydrated:s,treeContext:So!==null?{id:hi,overflow:pi}:null,retryLane:536870912,hydrationErrors:null},d=B1(s),d.return=l,l.child=d,In=l,Jt=null)):s=null,s===null)throw Co(l);return fy(s)?l.lanes=32:l.lanes=536870912,null}var _=m.children;return m=m.fallback,b?(Oo(),b=l.mode,_=Vd({mode:"hidden",children:_},b),m=Rs(m,b,d,null),_.return=l,m.return=l,_.sibling=m,l.child=_,m=l.child,m.memoizedState=Dg(d),m.childLanes=Og(s,A,d),l.memoizedState=kg,Tc(null,m)):(Do(l),Mg(l,_))}var F=s.memoizedState;if(F!==null&&(_=F.dehydrated,_!==null)){if(E)l.flags&256?(Do(l),l.flags&=-257,l=Rg(s,l,d)):l.memoizedState!==null?(Oo(),l.child=s.child,l.flags|=128,l=null):(Oo(),_=m.fallback,b=l.mode,m=Vd({mode:"visible",children:m.children},b),_=Rs(_,b,d,null),_.flags|=2,m.return=l,_.return=l,m.sibling=_,l.child=m,Bs(l,s.child,null,d),m=l.child,m.memoizedState=Dg(d),m.childLanes=Og(s,A,d),l.memoizedState=kg,l=Tc(null,m));else if(Do(l),fy(_)){if(A=_.nextSibling&&_.nextSibling.dataset,A)var ie=A.dgst;A=ie,m=Error(r(419)),m.stack="",m.digest=A,hc({value:m,source:null,stack:null}),l=Rg(s,l,d)}else if(yn||Ba(s,l,d,!1),A=(d&s.childLanes)!==0,yn||A){if(A=Yt,A!==null&&(m=rr(A,d),m!==0&&m!==F.retryLane))throw F.retryLane=m,Ms(s,m),ur(A,s,m),Ng;dy(_)||Zd(),l=Rg(s,l,d)}else dy(_)?(l.flags|=192,l.child=s.child,l=null):(s=F.treeContext,Jt=Pr(_.nextSibling),In=l,Nt=!0,Eo=null,_r=!1,s!==null&&H1(l,s),l=Mg(l,m.children),l.flags|=4096);return l}return b?(Oo(),_=m.fallback,b=l.mode,F=s.child,ie=F.sibling,m=Pi(F,{mode:"hidden",children:m.children}),m.subtreeFlags=F.subtreeFlags&65011712,ie!==null?_=Pi(ie,_):(_=Rs(_,b,d,null),_.flags|=2),_.return=l,m.return=l,m.sibling=_,l.child=m,Tc(null,m),m=l.child,_=s.child.memoizedState,_===null?_=Dg(d):(b=_.cachePool,b!==null?(F=mn._currentValue,b=b.parent!==F?{parent:F,pool:F}:b):b=Y1(),_={baseLanes:_.baseLanes|d,cachePool:b}),m.memoizedState=_,m.childLanes=Og(s,A,d),l.memoizedState=kg,Tc(s.child,m)):(Do(l),d=s.child,s=d.sibling,d=Pi(d,{mode:"visible",children:m.children}),d.return=l,d.sibling=null,s!==null&&(A=l.deletions,A===null?(l.deletions=[s],l.flags|=16):A.push(s)),l.child=d,l.memoizedState=null,d)}function Mg(s,l){return l=Vd({mode:"visible",children:l},s.mode),l.return=s,s.child=l}function Vd(s,l){return s=gr(22,s,null,l),s.lanes=0,s}function Rg(s,l,d){return Bs(l,s.child,null,d),s=Mg(l,l.pendingProps.children),s.flags|=2,l.memoizedState=null,s}function aS(s,l,d){s.lanes|=l;var m=s.alternate;m!==null&&(m.lanes|=l),Wm(s.return,l,d)}function jg(s,l,d,m,b,E){var A=s.memoizedState;A===null?s.memoizedState={isBackwards:l,rendering:null,renderingStartTime:0,last:m,tail:d,tailMode:b,treeForkCount:E}:(A.isBackwards=l,A.rendering=null,A.renderingStartTime=0,A.last=m,A.tail=d,A.tailMode=b,A.treeForkCount=E)}function lS(s,l,d){var m=l.pendingProps,b=m.revealOrder,E=m.tail;m=m.children;var A=hn.current,_=(A&2)!==0;if(_?(A=A&1|2,l.flags|=128):A&=1,B(hn,A),Ln(s,l,m,d),m=Nt?fc:0,!_&&s!==null&&(s.flags&128)!==0)e:for(s=l.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&aS(s,d,l);else if(s.tag===19)aS(s,d,l);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===l)break e;for(;s.sibling===null;){if(s.return===null||s.return===l)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}switch(b){case"forwards":for(d=l.child,b=null;d!==null;)s=d.alternate,s!==null&&Rd(s)===null&&(b=d),d=d.sibling;d=b,d===null?(b=l.child,l.child=null):(b=d.sibling,d.sibling=null),jg(l,!1,b,d,E,m);break;case"backwards":case"unstable_legacy-backwards":for(d=null,b=l.child,l.child=null;b!==null;){if(s=b.alternate,s!==null&&Rd(s)===null){l.child=b;break}s=b.sibling,b.sibling=d,d=b,b=s}jg(l,!0,d,null,E,m);break;case"together":jg(l,!1,null,null,void 0,m);break;default:l.memoizedState=null}return l.child}function Ui(s,l,d){if(s!==null&&(l.dependencies=s.dependencies),jo|=l.lanes,(d&l.childLanes)===0)if(s!==null){if(Ba(s,l,d,!1),(d&l.childLanes)===0)return null}else return null;if(s!==null&&l.child!==s.child)throw Error(r(153));if(l.child!==null){for(s=l.child,d=Pi(s,s.pendingProps),l.child=d,d.return=l;s.sibling!==null;)s=s.sibling,d=d.sibling=Pi(s,s.pendingProps),d.return=l;d.sibling=null}return l.child}function Ig(s,l){return(s.lanes&l)!==0?!0:(s=s.dependencies,!!(s!==null&&Cd(s)))}function i_(s,l,d){switch(l.tag){case 3:ce(l,l.stateNode.containerInfo),To(l,mn,s.memoizedState.cache),js();break;case 27:case 5:me(l);break;case 4:ce(l,l.stateNode.containerInfo);break;case 10:To(l,l.type,l.memoizedProps.value);break;case 31:if(l.memoizedState!==null)return l.flags|=128,og(l),null;break;case 13:var m=l.memoizedState;if(m!==null)return m.dehydrated!==null?(Do(l),l.flags|=128,null):(d&l.child.childLanes)!==0?sS(s,l,d):(Do(l),s=Ui(s,l,d),s!==null?s.sibling:null);Do(l);break;case 19:var b=(s.flags&128)!==0;if(m=(d&l.childLanes)!==0,m||(Ba(s,l,d,!1),m=(d&l.childLanes)!==0),b){if(m)return lS(s,l,d);l.flags|=128}if(b=l.memoizedState,b!==null&&(b.rendering=null,b.tail=null,b.lastEffect=null),B(hn,hn.current),m)break;return null;case 22:return l.lanes=0,eS(s,l,d,l.pendingProps);case 24:To(l,mn,s.memoizedState.cache)}return Ui(s,l,d)}function cS(s,l,d){if(s!==null)if(s.memoizedProps!==l.pendingProps)yn=!0;else{if(!Ig(s,d)&&(l.flags&128)===0)return yn=!1,i_(s,l,d);yn=(s.flags&131072)!==0}else yn=!1,Nt&&(l.flags&1048576)!==0&&$1(l,fc,l.index);switch(l.lanes=0,l.tag){case 16:e:{var m=l.pendingProps;if(s=Ps(l.elementType),l.type=s,typeof s=="function")Bm(s)?(m=$s(s,m),l.tag=1,l=iS(null,l,s,m,d)):(l.tag=0,l=Ag(null,l,s,m,d));else{if(s!=null){var b=s.$$typeof;if(b===D){l.tag=11,l=Jw(null,l,s,m,d);break e}else if(b===O){l.tag=14,l=Qw(null,l,s,m,d);break e}}throw l=G(s)||s,Error(r(306,l,""))}}return l;case 0:return Ag(s,l,l.type,l.pendingProps,d);case 1:return m=l.type,b=$s(m,l.pendingProps),iS(s,l,m,b,d);case 3:e:{if(ce(l,l.stateNode.containerInfo),s===null)throw Error(r(387));m=l.pendingProps;var E=l.memoizedState;b=E.element,eg(s,l),bc(l,m,null,d);var A=l.memoizedState;if(m=A.cache,To(l,mn,m),m!==E.cache&&Ym(l,[mn],d,!0),xc(),m=A.element,E.isDehydrated)if(E={element:m,isDehydrated:!1,cache:A.cache},l.updateQueue.baseState=E,l.memoizedState=E,l.flags&256){l=oS(s,l,m,d);break e}else if(m!==b){b=Rr(Error(r(424)),l),hc(b),l=oS(s,l,m,d);break e}else for(s=l.stateNode.containerInfo,s.nodeType===9?s=s.body:s=s.nodeName==="HTML"?s.ownerDocument.body:s,Jt=Pr(s.firstChild),In=l,Nt=!0,Eo=null,_r=!0,d=ew(l,null,m,d),l.child=d;d;)d.flags=d.flags&-3|4096,d=d.sibling;else{if(js(),m===b){l=Ui(s,l,d);break e}Ln(s,l,m,d)}l=l.child}return l;case 26:return Ud(s,l),s===null?(d=bE(l.type,null,l.pendingProps,null))?l.memoizedState=d:Nt||(d=l.type,s=l.pendingProps,m=af(be.current).createElement(d),m[jn]=l,m[ir]=s,Pn(m,d,s),Nn(m),l.stateNode=m):l.memoizedState=bE(l.type,s.memoizedProps,l.pendingProps,s.memoizedState),null;case 27:return me(l),s===null&&Nt&&(m=l.stateNode=yE(l.type,l.pendingProps,be.current),In=l,_r=!0,b=Jt,zo(l.type)?(hy=b,Jt=Pr(m.firstChild)):Jt=b),Ln(s,l,l.pendingProps.children,d),Ud(s,l),s===null&&(l.flags|=4194304),l.child;case 5:return s===null&&Nt&&((b=m=Jt)&&(m=I_(m,l.type,l.pendingProps,_r),m!==null?(l.stateNode=m,In=l,Jt=Pr(m.firstChild),_r=!1,b=!0):b=!1),b||Co(l)),me(l),b=l.type,E=l.pendingProps,A=s!==null?s.memoizedProps:null,m=E.children,ly(b,E)?m=null:A!==null&&ly(b,A)&&(l.flags|=32),l.memoizedState!==null&&(b=ag(s,l,KI,null,null,d),Fc._currentValue=b),Ud(s,l),Ln(s,l,m,d),l.child;case 6:return s===null&&Nt&&((s=d=Jt)&&(d=__(d,l.pendingProps,_r),d!==null?(l.stateNode=d,In=l,Jt=null,s=!0):s=!1),s||Co(l)),null;case 13:return sS(s,l,d);case 4:return ce(l,l.stateNode.containerInfo),m=l.pendingProps,s===null?l.child=Bs(l,null,m,d):Ln(s,l,m,d),l.child;case 11:return Jw(s,l,l.type,l.pendingProps,d);case 7:return Ln(s,l,l.pendingProps,d),l.child;case 8:return Ln(s,l,l.pendingProps.children,d),l.child;case 12:return Ln(s,l,l.pendingProps.children,d),l.child;case 10:return m=l.pendingProps,To(l,l.type,m.value),Ln(s,l,m.children,d),l.child;case 9:return b=l.type._context,m=l.pendingProps.children,_s(l),b=_n(b),m=m(b),l.flags|=1,Ln(s,l,m,d),l.child;case 14:return Qw(s,l,l.type,l.pendingProps,d);case 15:return Zw(s,l,l.type,l.pendingProps,d);case 19:return lS(s,l,d);case 31:return r_(s,l,d);case 22:return eS(s,l,d,l.pendingProps);case 24:return _s(l),m=_n(mn),s===null?(b=Jm(),b===null&&(b=Yt,E=Km(),b.pooledCache=E,E.refCount++,E!==null&&(b.pooledCacheLanes|=d),b=E),l.memoizedState={parent:m,cache:b},Zm(l),To(l,mn,b)):((s.lanes&d)!==0&&(eg(s,l),bc(l,null,null,d),xc()),b=s.memoizedState,E=l.memoizedState,b.parent!==m?(b={parent:m,cache:m},l.memoizedState=b,l.lanes===0&&(l.memoizedState=l.updateQueue.baseState=b),To(l,mn,m)):(m=E.cache,To(l,mn,m),m!==b.cache&&Ym(l,[mn],d,!0))),Ln(s,l,l.pendingProps.children,d),l.child;case 29:throw l.pendingProps}throw Error(r(156,l.tag))}function Vi(s){s.flags|=4}function _g(s,l,d,m,b){if((l=(s.mode&32)!==0)&&(l=!1),l){if(s.flags|=16777216,(b&335544128)===b)if(s.stateNode.complete)s.flags|=8192;else if(LS())s.flags|=8192;else throw zs=kd,Qm}else s.flags&=-16777217}function uS(s,l){if(l.type!=="stylesheet"||(l.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!TE(l))if(LS())s.flags|=8192;else throw zs=kd,Qm}function qd(s,l){l!==null&&(s.flags|=4),s.flags&16384&&(l=s.tag!==22?Tn():536870912,s.lanes|=l,Ja|=l)}function Nc(s,l){if(!Nt)switch(s.tailMode){case"hidden":l=s.tail;for(var d=null;l!==null;)l.alternate!==null&&(d=l),l=l.sibling;d===null?s.tail=null:d.sibling=null;break;case"collapsed":d=s.tail;for(var m=null;d!==null;)d.alternate!==null&&(m=d),d=d.sibling;m===null?l||s.tail===null?s.tail=null:s.tail.sibling=null:m.sibling=null}}function Qt(s){var l=s.alternate!==null&&s.alternate.child===s.child,d=0,m=0;if(l)for(var b=s.child;b!==null;)d|=b.lanes|b.childLanes,m|=b.subtreeFlags&65011712,m|=b.flags&65011712,b.return=s,b=b.sibling;else for(b=s.child;b!==null;)d|=b.lanes|b.childLanes,m|=b.subtreeFlags,m|=b.flags,b.return=s,b=b.sibling;return s.subtreeFlags|=m,s.childLanes=d,l}function o_(s,l,d){var m=l.pendingProps;switch(Um(l),l.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Qt(l),null;case 1:return Qt(l),null;case 3:return d=l.stateNode,m=null,s!==null&&(m=s.memoizedState.cache),l.memoizedState.cache!==m&&(l.flags|=2048),Fi(mn),te(),d.pendingContext&&(d.context=d.pendingContext,d.pendingContext=null),(s===null||s.child===null)&&(za(l)?Vi(l):s===null||s.memoizedState.isDehydrated&&(l.flags&256)===0||(l.flags|=1024,qm())),Qt(l),null;case 26:var b=l.type,E=l.memoizedState;return s===null?(Vi(l),E!==null?(Qt(l),uS(l,E)):(Qt(l),_g(l,b,null,m,d))):E?E!==s.memoizedState?(Vi(l),Qt(l),uS(l,E)):(Qt(l),l.flags&=-16777217):(s=s.memoizedProps,s!==m&&Vi(l),Qt(l),_g(l,b,s,m,d)),null;case 27:if(Te(l),d=be.current,b=l.type,s!==null&&l.stateNode!=null)s.memoizedProps!==m&&Vi(l);else{if(!m){if(l.stateNode===null)throw Error(r(166));return Qt(l),null}s=Z.current,za(l)?U1(l):(s=yE(b,m,d),l.stateNode=s,Vi(l))}return Qt(l),null;case 5:if(Te(l),b=l.type,s!==null&&l.stateNode!=null)s.memoizedProps!==m&&Vi(l);else{if(!m){if(l.stateNode===null)throw Error(r(166));return Qt(l),null}if(E=Z.current,za(l))U1(l);else{var A=af(be.current);switch(E){case 1:E=A.createElementNS("http://www.w3.org/2000/svg",b);break;case 2:E=A.createElementNS("http://www.w3.org/1998/Math/MathML",b);break;default:switch(b){case"svg":E=A.createElementNS("http://www.w3.org/2000/svg",b);break;case"math":E=A.createElementNS("http://www.w3.org/1998/Math/MathML",b);break;case"script":E=A.createElement("div"),E.innerHTML="<script><\/script>",E=E.removeChild(E.firstChild);break;case"select":E=typeof m.is=="string"?A.createElement("select",{is:m.is}):A.createElement("select"),m.multiple?E.multiple=!0:m.size&&(E.size=m.size);break;default:E=typeof m.is=="string"?A.createElement(b,{is:m.is}):A.createElement(b)}}E[jn]=l,E[ir]=m;e:for(A=l.child;A!==null;){if(A.tag===5||A.tag===6)E.appendChild(A.stateNode);else if(A.tag!==4&&A.tag!==27&&A.child!==null){A.child.return=A,A=A.child;continue}if(A===l)break e;for(;A.sibling===null;){if(A.return===null||A.return===l)break e;A=A.return}A.sibling.return=A.return,A=A.sibling}l.stateNode=E;e:switch(Pn(E,b,m),b){case"button":case"input":case"select":case"textarea":m=!!m.autoFocus;break e;case"img":m=!0;break e;default:m=!1}m&&Vi(l)}}return Qt(l),_g(l,l.type,s===null?null:s.memoizedProps,l.pendingProps,d),null;case 6:if(s&&l.stateNode!=null)s.memoizedProps!==m&&Vi(l);else{if(typeof m!="string"&&l.stateNode===null)throw Error(r(166));if(s=be.current,za(l)){if(s=l.stateNode,d=l.memoizedProps,m=null,b=In,b!==null)switch(b.tag){case 27:case 5:m=b.memoizedProps}s[jn]=l,s=!!(s.nodeValue===d||m!==null&&m.suppressHydrationWarning===!0||sE(s.nodeValue,d)),s||Co(l,!0)}else s=af(s).createTextNode(m),s[jn]=l,l.stateNode=s}return Qt(l),null;case 31:if(d=l.memoizedState,s===null||s.memoizedState!==null){if(m=za(l),d!==null){if(s===null){if(!m)throw Error(r(318));if(s=l.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(r(557));s[jn]=l}else js(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;Qt(l),s=!1}else d=qm(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=d),s=!0;if(!s)return l.flags&256?(vr(l),l):(vr(l),null);if((l.flags&128)!==0)throw Error(r(558))}return Qt(l),null;case 13:if(m=l.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(b=za(l),m!==null&&m.dehydrated!==null){if(s===null){if(!b)throw Error(r(318));if(b=l.memoizedState,b=b!==null?b.dehydrated:null,!b)throw Error(r(317));b[jn]=l}else js(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;Qt(l),b=!1}else b=qm(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=b),b=!0;if(!b)return l.flags&256?(vr(l),l):(vr(l),null)}return vr(l),(l.flags&128)!==0?(l.lanes=d,l):(d=m!==null,s=s!==null&&s.memoizedState!==null,d&&(m=l.child,b=null,m.alternate!==null&&m.alternate.memoizedState!==null&&m.alternate.memoizedState.cachePool!==null&&(b=m.alternate.memoizedState.cachePool.pool),E=null,m.memoizedState!==null&&m.memoizedState.cachePool!==null&&(E=m.memoizedState.cachePool.pool),E!==b&&(m.flags|=2048)),d!==s&&d&&(l.child.flags|=8192),qd(l,l.updateQueue),Qt(l),null);case 4:return te(),s===null&&ry(l.stateNode.containerInfo),Qt(l),null;case 10:return Fi(l.type),Qt(l),null;case 19:if(K(hn),m=l.memoizedState,m===null)return Qt(l),null;if(b=(l.flags&128)!==0,E=m.rendering,E===null)if(b)Nc(m,!1);else{if(cn!==0||s!==null&&(s.flags&128)!==0)for(s=l.child;s!==null;){if(E=Rd(s),E!==null){for(l.flags|=128,Nc(m,!1),s=E.updateQueue,l.updateQueue=s,qd(l,s),l.subtreeFlags=0,s=d,d=l.child;d!==null;)z1(d,s),d=d.sibling;return B(hn,hn.current&1|2),Nt&&zi(l,m.treeForkCount),l.child}s=s.sibling}m.tail!==null&&Ye()>Xd&&(l.flags|=128,b=!0,Nc(m,!1),l.lanes=4194304)}else{if(!b)if(s=Rd(E),s!==null){if(l.flags|=128,b=!0,s=s.updateQueue,l.updateQueue=s,qd(l,s),Nc(m,!0),m.tail===null&&m.tailMode==="hidden"&&!E.alternate&&!Nt)return Qt(l),null}else 2*Ye()-m.renderingStartTime>Xd&&d!==536870912&&(l.flags|=128,b=!0,Nc(m,!1),l.lanes=4194304);m.isBackwards?(E.sibling=l.child,l.child=E):(s=m.last,s!==null?s.sibling=E:l.child=E,m.last=E)}return m.tail!==null?(s=m.tail,m.rendering=s,m.tail=s.sibling,m.renderingStartTime=Ye(),s.sibling=null,d=hn.current,B(hn,b?d&1|2:d&1),Nt&&zi(l,m.treeForkCount),s):(Qt(l),null);case 22:case 23:return vr(l),ig(),m=l.memoizedState!==null,s!==null?s.memoizedState!==null!==m&&(l.flags|=8192):m&&(l.flags|=8192),m?(d&536870912)!==0&&(l.flags&128)===0&&(Qt(l),l.subtreeFlags&6&&(l.flags|=8192)):Qt(l),d=l.updateQueue,d!==null&&qd(l,d.retryQueue),d=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(d=s.memoizedState.cachePool.pool),m=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(m=l.memoizedState.cachePool.pool),m!==d&&(l.flags|=2048),s!==null&&K(Ls),null;case 24:return d=null,s!==null&&(d=s.memoizedState.cache),l.memoizedState.cache!==d&&(l.flags|=2048),Fi(mn),Qt(l),null;case 25:return null;case 30:return null}throw Error(r(156,l.tag))}function s_(s,l){switch(Um(l),l.tag){case 1:return s=l.flags,s&65536?(l.flags=s&-65537|128,l):null;case 3:return Fi(mn),te(),s=l.flags,(s&65536)!==0&&(s&128)===0?(l.flags=s&-65537|128,l):null;case 26:case 27:case 5:return Te(l),null;case 31:if(l.memoizedState!==null){if(vr(l),l.alternate===null)throw Error(r(340));js()}return s=l.flags,s&65536?(l.flags=s&-65537|128,l):null;case 13:if(vr(l),s=l.memoizedState,s!==null&&s.dehydrated!==null){if(l.alternate===null)throw Error(r(340));js()}return s=l.flags,s&65536?(l.flags=s&-65537|128,l):null;case 19:return K(hn),null;case 4:return te(),null;case 10:return Fi(l.type),null;case 22:case 23:return vr(l),ig(),s!==null&&K(Ls),s=l.flags,s&65536?(l.flags=s&-65537|128,l):null;case 24:return Fi(mn),null;case 25:return null;default:return null}}function dS(s,l){switch(Um(l),l.tag){case 3:Fi(mn),te();break;case 26:case 27:case 5:Te(l);break;case 4:te();break;case 31:l.memoizedState!==null&&vr(l);break;case 13:vr(l);break;case 19:K(hn);break;case 10:Fi(l.type);break;case 22:case 23:vr(l),ig(),s!==null&&K(Ls);break;case 24:Fi(mn)}}function Ac(s,l){try{var d=l.updateQueue,m=d!==null?d.lastEffect:null;if(m!==null){var b=m.next;d=b;do{if((d.tag&s)===s){m=void 0;var E=d.create,A=d.inst;m=E(),A.destroy=m}d=d.next}while(d!==b)}}catch(_){Ht(l,l.return,_)}}function Mo(s,l,d){try{var m=l.updateQueue,b=m!==null?m.lastEffect:null;if(b!==null){var E=b.next;m=E;do{if((m.tag&s)===s){var A=m.inst,_=A.destroy;if(_!==void 0){A.destroy=void 0,b=l;var F=d,ie=_;try{ie()}catch(ge){Ht(b,F,ge)}}}m=m.next}while(m!==E)}}catch(ge){Ht(l,l.return,ge)}}function fS(s){var l=s.updateQueue;if(l!==null){var d=s.stateNode;try{nw(l,d)}catch(m){Ht(s,s.return,m)}}}function hS(s,l,d){d.props=$s(s.type,s.memoizedProps),d.state=s.memoizedState;try{d.componentWillUnmount()}catch(m){Ht(s,l,m)}}function kc(s,l){try{var d=s.ref;if(d!==null){switch(s.tag){case 26:case 27:case 5:var m=s.stateNode;break;case 30:m=s.stateNode;break;default:m=s.stateNode}typeof d=="function"?s.refCleanup=d(m):d.current=m}}catch(b){Ht(s,l,b)}}function mi(s,l){var d=s.ref,m=s.refCleanup;if(d!==null)if(typeof m=="function")try{m()}catch(b){Ht(s,l,b)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof d=="function")try{d(null)}catch(b){Ht(s,l,b)}else d.current=null}function pS(s){var l=s.type,d=s.memoizedProps,m=s.stateNode;try{e:switch(l){case"button":case"input":case"select":case"textarea":d.autoFocus&&m.focus();break e;case"img":d.src?m.src=d.src:d.srcSet&&(m.srcset=d.srcSet)}}catch(b){Ht(s,s.return,b)}}function Lg(s,l,d){try{var m=s.stateNode;k_(m,s.type,d,l),m[ir]=l}catch(b){Ht(s,s.return,b)}}function mS(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&zo(s.type)||s.tag===4}function Pg(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||mS(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&zo(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function zg(s,l,d){var m=s.tag;if(m===5||m===6)s=s.stateNode,l?(d.nodeType===9?d.body:d.nodeName==="HTML"?d.ownerDocument.body:d).insertBefore(s,l):(l=d.nodeType===9?d.body:d.nodeName==="HTML"?d.ownerDocument.body:d,l.appendChild(s),d=d._reactRootContainer,d!=null||l.onclick!==null||(l.onclick=_i));else if(m!==4&&(m===27&&zo(s.type)&&(d=s.stateNode,l=null),s=s.child,s!==null))for(zg(s,l,d),s=s.sibling;s!==null;)zg(s,l,d),s=s.sibling}function Gd(s,l,d){var m=s.tag;if(m===5||m===6)s=s.stateNode,l?d.insertBefore(s,l):d.appendChild(s);else if(m!==4&&(m===27&&zo(s.type)&&(d=s.stateNode),s=s.child,s!==null))for(Gd(s,l,d),s=s.sibling;s!==null;)Gd(s,l,d),s=s.sibling}function gS(s){var l=s.stateNode,d=s.memoizedProps;try{for(var m=s.type,b=l.attributes;b.length;)l.removeAttributeNode(b[0]);Pn(l,m,d),l[jn]=s,l[ir]=d}catch(E){Ht(s,s.return,E)}}var qi=!1,vn=!1,Bg=!1,yS=typeof WeakSet=="function"?WeakSet:Set,An=null;function a_(s,l){if(s=s.containerInfo,sy=pf,s=D1(s),Rm(s)){if("selectionStart"in s)var d={start:s.selectionStart,end:s.selectionEnd};else e:{d=(d=s.ownerDocument)&&d.defaultView||window;var m=d.getSelection&&d.getSelection();if(m&&m.rangeCount!==0){d=m.anchorNode;var b=m.anchorOffset,E=m.focusNode;m=m.focusOffset;try{d.nodeType,E.nodeType}catch{d=null;break e}var A=0,_=-1,F=-1,ie=0,ge=0,xe=s,se=null;t:for(;;){for(var fe;xe!==d||b!==0&&xe.nodeType!==3||(_=A+b),xe!==E||m!==0&&xe.nodeType!==3||(F=A+m),xe.nodeType===3&&(A+=xe.nodeValue.length),(fe=xe.firstChild)!==null;)se=xe,xe=fe;for(;;){if(xe===s)break t;if(se===d&&++ie===b&&(_=A),se===E&&++ge===m&&(F=A),(fe=xe.nextSibling)!==null)break;xe=se,se=xe.parentNode}xe=fe}d=_===-1||F===-1?null:{start:_,end:F}}else d=null}d=d||{start:0,end:0}}else d=null;for(ay={focusedElem:s,selectionRange:d},pf=!1,An=l;An!==null;)if(l=An,s=l.child,(l.subtreeFlags&1028)!==0&&s!==null)s.return=l,An=s;else for(;An!==null;){switch(l=An,E=l.alternate,s=l.flags,l.tag){case 0:if((s&4)!==0&&(s=l.updateQueue,s=s!==null?s.events:null,s!==null))for(d=0;d<s.length;d++)b=s[d],b.ref.impl=b.nextImpl;break;case 11:case 15:break;case 1:if((s&1024)!==0&&E!==null){s=void 0,d=l,b=E.memoizedProps,E=E.memoizedState,m=d.stateNode;try{var Pe=$s(d.type,b);s=m.getSnapshotBeforeUpdate(Pe,E),m.__reactInternalSnapshotBeforeUpdate=s}catch(nt){Ht(d,d.return,nt)}}break;case 3:if((s&1024)!==0){if(s=l.stateNode.containerInfo,d=s.nodeType,d===9)uy(s);else if(d===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":uy(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(r(163))}if(s=l.sibling,s!==null){s.return=l.return,An=s;break}An=l.return}}function vS(s,l,d){var m=d.flags;switch(d.tag){case 0:case 11:case 15:Wi(s,d),m&4&&Ac(5,d);break;case 1:if(Wi(s,d),m&4)if(s=d.stateNode,l===null)try{s.componentDidMount()}catch(A){Ht(d,d.return,A)}else{var b=$s(d.type,l.memoizedProps);l=l.memoizedState;try{s.componentDidUpdate(b,l,s.__reactInternalSnapshotBeforeUpdate)}catch(A){Ht(d,d.return,A)}}m&64&&fS(d),m&512&&kc(d,d.return);break;case 3:if(Wi(s,d),m&64&&(s=d.updateQueue,s!==null)){if(l=null,d.child!==null)switch(d.child.tag){case 27:case 5:l=d.child.stateNode;break;case 1:l=d.child.stateNode}try{nw(s,l)}catch(A){Ht(d,d.return,A)}}break;case 27:l===null&&m&4&&gS(d);case 26:case 5:Wi(s,d),l===null&&m&4&&pS(d),m&512&&kc(d,d.return);break;case 12:Wi(s,d);break;case 31:Wi(s,d),m&4&&wS(s,d);break;case 13:Wi(s,d),m&4&&SS(s,d),m&64&&(s=d.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(d=g_.bind(null,d),L_(s,d))));break;case 22:if(m=d.memoizedState!==null||qi,!m){l=l!==null&&l.memoizedState!==null||vn,b=qi;var E=vn;qi=m,(vn=l)&&!E?Yi(s,d,(d.subtreeFlags&8772)!==0):Wi(s,d),qi=b,vn=E}break;case 30:break;default:Wi(s,d)}}function xS(s){var l=s.alternate;l!==null&&(s.alternate=null,xS(l)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(l=s.stateNode,l!==null&&mm(l)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var en=null,sr=!1;function Gi(s,l,d){for(d=d.child;d!==null;)bS(s,l,d),d=d.sibling}function bS(s,l,d){if(Ke&&typeof Ke.onCommitFiberUnmount=="function")try{Ke.onCommitFiberUnmount(pt,d)}catch{}switch(d.tag){case 26:vn||mi(d,l),Gi(s,l,d),d.memoizedState?d.memoizedState.count--:d.stateNode&&(d=d.stateNode,d.parentNode.removeChild(d));break;case 27:vn||mi(d,l);var m=en,b=sr;zo(d.type)&&(en=d.stateNode,sr=!1),Gi(s,l,d),Pc(d.stateNode),en=m,sr=b;break;case 5:vn||mi(d,l);case 6:if(m=en,b=sr,en=null,Gi(s,l,d),en=m,sr=b,en!==null)if(sr)try{(en.nodeType===9?en.body:en.nodeName==="HTML"?en.ownerDocument.body:en).removeChild(d.stateNode)}catch(E){Ht(d,l,E)}else try{en.removeChild(d.stateNode)}catch(E){Ht(d,l,E)}break;case 18:en!==null&&(sr?(s=en,fE(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,d.stateNode),ol(s)):fE(en,d.stateNode));break;case 4:m=en,b=sr,en=d.stateNode.containerInfo,sr=!0,Gi(s,l,d),en=m,sr=b;break;case 0:case 11:case 14:case 15:Mo(2,d,l),vn||Mo(4,d,l),Gi(s,l,d);break;case 1:vn||(mi(d,l),m=d.stateNode,typeof m.componentWillUnmount=="function"&&hS(d,l,m)),Gi(s,l,d);break;case 21:Gi(s,l,d);break;case 22:vn=(m=vn)||d.memoizedState!==null,Gi(s,l,d),vn=m;break;default:Gi(s,l,d)}}function wS(s,l){if(l.memoizedState===null&&(s=l.alternate,s!==null&&(s=s.memoizedState,s!==null))){s=s.dehydrated;try{ol(s)}catch(d){Ht(l,l.return,d)}}}function SS(s,l){if(l.memoizedState===null&&(s=l.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{ol(s)}catch(d){Ht(l,l.return,d)}}function l_(s){switch(s.tag){case 31:case 13:case 19:var l=s.stateNode;return l===null&&(l=s.stateNode=new yS),l;case 22:return s=s.stateNode,l=s._retryCache,l===null&&(l=s._retryCache=new yS),l;default:throw Error(r(435,s.tag))}}function Wd(s,l){var d=l_(s);l.forEach(function(m){if(!d.has(m)){d.add(m);var b=y_.bind(null,s,m);m.then(b,b)}})}function ar(s,l){var d=l.deletions;if(d!==null)for(var m=0;m<d.length;m++){var b=d[m],E=s,A=l,_=A;e:for(;_!==null;){switch(_.tag){case 27:if(zo(_.type)){en=_.stateNode,sr=!1;break e}break;case 5:en=_.stateNode,sr=!1;break e;case 3:case 4:en=_.stateNode.containerInfo,sr=!0;break e}_=_.return}if(en===null)throw Error(r(160));bS(E,A,b),en=null,sr=!1,E=b.alternate,E!==null&&(E.return=null),b.return=null}if(l.subtreeFlags&13886)for(l=l.child;l!==null;)ES(l,s),l=l.sibling}var Jr=null;function ES(s,l){var d=s.alternate,m=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:ar(l,s),lr(s),m&4&&(Mo(3,s,s.return),Ac(3,s),Mo(5,s,s.return));break;case 1:ar(l,s),lr(s),m&512&&(vn||d===null||mi(d,d.return)),m&64&&qi&&(s=s.updateQueue,s!==null&&(m=s.callbacks,m!==null&&(d=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=d===null?m:d.concat(m))));break;case 26:var b=Jr;if(ar(l,s),lr(s),m&512&&(vn||d===null||mi(d,d.return)),m&4){var E=d!==null?d.memoizedState:null;if(m=s.memoizedState,d===null)if(m===null)if(s.stateNode===null){e:{m=s.type,d=s.memoizedProps,b=b.ownerDocument||b;t:switch(m){case"title":E=b.getElementsByTagName("title")[0],(!E||E[tc]||E[jn]||E.namespaceURI==="http://www.w3.org/2000/svg"||E.hasAttribute("itemprop"))&&(E=b.createElement(m),b.head.insertBefore(E,b.querySelector("head > title"))),Pn(E,m,d),E[jn]=s,Nn(E),m=E;break e;case"link":var A=EE("link","href",b).get(m+(d.href||""));if(A){for(var _=0;_<A.length;_++)if(E=A[_],E.getAttribute("href")===(d.href==null||d.href===""?null:d.href)&&E.getAttribute("rel")===(d.rel==null?null:d.rel)&&E.getAttribute("title")===(d.title==null?null:d.title)&&E.getAttribute("crossorigin")===(d.crossOrigin==null?null:d.crossOrigin)){A.splice(_,1);break t}}E=b.createElement(m),Pn(E,m,d),b.head.appendChild(E);break;case"meta":if(A=EE("meta","content",b).get(m+(d.content||""))){for(_=0;_<A.length;_++)if(E=A[_],E.getAttribute("content")===(d.content==null?null:""+d.content)&&E.getAttribute("name")===(d.name==null?null:d.name)&&E.getAttribute("property")===(d.property==null?null:d.property)&&E.getAttribute("http-equiv")===(d.httpEquiv==null?null:d.httpEquiv)&&E.getAttribute("charset")===(d.charSet==null?null:d.charSet)){A.splice(_,1);break t}}E=b.createElement(m),Pn(E,m,d),b.head.appendChild(E);break;default:throw Error(r(468,m))}E[jn]=s,Nn(E),m=E}s.stateNode=m}else CE(b,s.type,s.stateNode);else s.stateNode=SE(b,m,s.memoizedProps);else E!==m?(E===null?d.stateNode!==null&&(d=d.stateNode,d.parentNode.removeChild(d)):E.count--,m===null?CE(b,s.type,s.stateNode):SE(b,m,s.memoizedProps)):m===null&&s.stateNode!==null&&Lg(s,s.memoizedProps,d.memoizedProps)}break;case 27:ar(l,s),lr(s),m&512&&(vn||d===null||mi(d,d.return)),d!==null&&m&4&&Lg(s,s.memoizedProps,d.memoizedProps);break;case 5:if(ar(l,s),lr(s),m&512&&(vn||d===null||mi(d,d.return)),s.flags&32){b=s.stateNode;try{ka(b,"")}catch(Pe){Ht(s,s.return,Pe)}}m&4&&s.stateNode!=null&&(b=s.memoizedProps,Lg(s,b,d!==null?d.memoizedProps:b)),m&1024&&(Bg=!0);break;case 6:if(ar(l,s),lr(s),m&4){if(s.stateNode===null)throw Error(r(162));m=s.memoizedProps,d=s.stateNode;try{d.nodeValue=m}catch(Pe){Ht(s,s.return,Pe)}}break;case 3:if(uf=null,b=Jr,Jr=lf(l.containerInfo),ar(l,s),Jr=b,lr(s),m&4&&d!==null&&d.memoizedState.isDehydrated)try{ol(l.containerInfo)}catch(Pe){Ht(s,s.return,Pe)}Bg&&(Bg=!1,CS(s));break;case 4:m=Jr,Jr=lf(s.stateNode.containerInfo),ar(l,s),lr(s),Jr=m;break;case 12:ar(l,s),lr(s);break;case 31:ar(l,s),lr(s),m&4&&(m=s.updateQueue,m!==null&&(s.updateQueue=null,Wd(s,m)));break;case 13:ar(l,s),lr(s),s.child.flags&8192&&s.memoizedState!==null!=(d!==null&&d.memoizedState!==null)&&(Kd=Ye()),m&4&&(m=s.updateQueue,m!==null&&(s.updateQueue=null,Wd(s,m)));break;case 22:b=s.memoizedState!==null;var F=d!==null&&d.memoizedState!==null,ie=qi,ge=vn;if(qi=ie||b,vn=ge||F,ar(l,s),vn=ge,qi=ie,lr(s),m&8192)e:for(l=s.stateNode,l._visibility=b?l._visibility&-2:l._visibility|1,b&&(d===null||F||qi||vn||Hs(s)),d=null,l=s;;){if(l.tag===5||l.tag===26){if(d===null){F=d=l;try{if(E=F.stateNode,b)A=E.style,typeof A.setProperty=="function"?A.setProperty("display","none","important"):A.display="none";else{_=F.stateNode;var xe=F.memoizedProps.style,se=xe!=null&&xe.hasOwnProperty("display")?xe.display:null;_.style.display=se==null||typeof se=="boolean"?"":(""+se).trim()}}catch(Pe){Ht(F,F.return,Pe)}}}else if(l.tag===6){if(d===null){F=l;try{F.stateNode.nodeValue=b?"":F.memoizedProps}catch(Pe){Ht(F,F.return,Pe)}}}else if(l.tag===18){if(d===null){F=l;try{var fe=F.stateNode;b?hE(fe,!0):hE(F.stateNode,!1)}catch(Pe){Ht(F,F.return,Pe)}}}else if((l.tag!==22&&l.tag!==23||l.memoizedState===null||l===s)&&l.child!==null){l.child.return=l,l=l.child;continue}if(l===s)break e;for(;l.sibling===null;){if(l.return===null||l.return===s)break e;d===l&&(d=null),l=l.return}d===l&&(d=null),l.sibling.return=l.return,l=l.sibling}m&4&&(m=s.updateQueue,m!==null&&(d=m.retryQueue,d!==null&&(m.retryQueue=null,Wd(s,d))));break;case 19:ar(l,s),lr(s),m&4&&(m=s.updateQueue,m!==null&&(s.updateQueue=null,Wd(s,m)));break;case 30:break;case 21:break;default:ar(l,s),lr(s)}}function lr(s){var l=s.flags;if(l&2){try{for(var d,m=s.return;m!==null;){if(mS(m)){d=m;break}m=m.return}if(d==null)throw Error(r(160));switch(d.tag){case 27:var b=d.stateNode,E=Pg(s);Gd(s,E,b);break;case 5:var A=d.stateNode;d.flags&32&&(ka(A,""),d.flags&=-33);var _=Pg(s);Gd(s,_,A);break;case 3:case 4:var F=d.stateNode.containerInfo,ie=Pg(s);zg(s,ie,F);break;default:throw Error(r(161))}}catch(ge){Ht(s,s.return,ge)}s.flags&=-3}l&4096&&(s.flags&=-4097)}function CS(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var l=s;CS(l),l.tag===5&&l.flags&1024&&l.stateNode.reset(),s=s.sibling}}function Wi(s,l){if(l.subtreeFlags&8772)for(l=l.child;l!==null;)vS(s,l.alternate,l),l=l.sibling}function Hs(s){for(s=s.child;s!==null;){var l=s;switch(l.tag){case 0:case 11:case 14:case 15:Mo(4,l,l.return),Hs(l);break;case 1:mi(l,l.return);var d=l.stateNode;typeof d.componentWillUnmount=="function"&&hS(l,l.return,d),Hs(l);break;case 27:Pc(l.stateNode);case 26:case 5:mi(l,l.return),Hs(l);break;case 22:l.memoizedState===null&&Hs(l);break;case 30:Hs(l);break;default:Hs(l)}s=s.sibling}}function Yi(s,l,d){for(d=d&&(l.subtreeFlags&8772)!==0,l=l.child;l!==null;){var m=l.alternate,b=s,E=l,A=E.flags;switch(E.tag){case 0:case 11:case 15:Yi(b,E,d),Ac(4,E);break;case 1:if(Yi(b,E,d),m=E,b=m.stateNode,typeof b.componentDidMount=="function")try{b.componentDidMount()}catch(ie){Ht(m,m.return,ie)}if(m=E,b=m.updateQueue,b!==null){var _=m.stateNode;try{var F=b.shared.hiddenCallbacks;if(F!==null)for(b.shared.hiddenCallbacks=null,b=0;b<F.length;b++)tw(F[b],_)}catch(ie){Ht(m,m.return,ie)}}d&&A&64&&fS(E),kc(E,E.return);break;case 27:gS(E);case 26:case 5:Yi(b,E,d),d&&m===null&&A&4&&pS(E),kc(E,E.return);break;case 12:Yi(b,E,d);break;case 31:Yi(b,E,d),d&&A&4&&wS(b,E);break;case 13:Yi(b,E,d),d&&A&4&&SS(b,E);break;case 22:E.memoizedState===null&&Yi(b,E,d),kc(E,E.return);break;case 30:break;default:Yi(b,E,d)}l=l.sibling}}function Fg(s,l){var d=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(d=s.memoizedState.cachePool.pool),s=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(s=l.memoizedState.cachePool.pool),s!==d&&(s!=null&&s.refCount++,d!=null&&pc(d))}function $g(s,l){s=null,l.alternate!==null&&(s=l.alternate.memoizedState.cache),l=l.memoizedState.cache,l!==s&&(l.refCount++,s!=null&&pc(s))}function Qr(s,l,d,m){if(l.subtreeFlags&10256)for(l=l.child;l!==null;)TS(s,l,d,m),l=l.sibling}function TS(s,l,d,m){var b=l.flags;switch(l.tag){case 0:case 11:case 15:Qr(s,l,d,m),b&2048&&Ac(9,l);break;case 1:Qr(s,l,d,m);break;case 3:Qr(s,l,d,m),b&2048&&(s=null,l.alternate!==null&&(s=l.alternate.memoizedState.cache),l=l.memoizedState.cache,l!==s&&(l.refCount++,s!=null&&pc(s)));break;case 12:if(b&2048){Qr(s,l,d,m),s=l.stateNode;try{var E=l.memoizedProps,A=E.id,_=E.onPostCommit;typeof _=="function"&&_(A,l.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(F){Ht(l,l.return,F)}}else Qr(s,l,d,m);break;case 31:Qr(s,l,d,m);break;case 13:Qr(s,l,d,m);break;case 23:break;case 22:E=l.stateNode,A=l.alternate,l.memoizedState!==null?E._visibility&2?Qr(s,l,d,m):Dc(s,l):E._visibility&2?Qr(s,l,d,m):(E._visibility|=2,Ya(s,l,d,m,(l.subtreeFlags&10256)!==0||!1)),b&2048&&Fg(A,l);break;case 24:Qr(s,l,d,m),b&2048&&$g(l.alternate,l);break;default:Qr(s,l,d,m)}}function Ya(s,l,d,m,b){for(b=b&&((l.subtreeFlags&10256)!==0||!1),l=l.child;l!==null;){var E=s,A=l,_=d,F=m,ie=A.flags;switch(A.tag){case 0:case 11:case 15:Ya(E,A,_,F,b),Ac(8,A);break;case 23:break;case 22:var ge=A.stateNode;A.memoizedState!==null?ge._visibility&2?Ya(E,A,_,F,b):Dc(E,A):(ge._visibility|=2,Ya(E,A,_,F,b)),b&&ie&2048&&Fg(A.alternate,A);break;case 24:Ya(E,A,_,F,b),b&&ie&2048&&$g(A.alternate,A);break;default:Ya(E,A,_,F,b)}l=l.sibling}}function Dc(s,l){if(l.subtreeFlags&10256)for(l=l.child;l!==null;){var d=s,m=l,b=m.flags;switch(m.tag){case 22:Dc(d,m),b&2048&&Fg(m.alternate,m);break;case 24:Dc(d,m),b&2048&&$g(m.alternate,m);break;default:Dc(d,m)}l=l.sibling}}var Oc=8192;function Ka(s,l,d){if(s.subtreeFlags&Oc)for(s=s.child;s!==null;)NS(s,l,d),s=s.sibling}function NS(s,l,d){switch(s.tag){case 26:Ka(s,l,d),s.flags&Oc&&s.memoizedState!==null&&Y_(d,Jr,s.memoizedState,s.memoizedProps);break;case 5:Ka(s,l,d);break;case 3:case 4:var m=Jr;Jr=lf(s.stateNode.containerInfo),Ka(s,l,d),Jr=m;break;case 22:s.memoizedState===null&&(m=s.alternate,m!==null&&m.memoizedState!==null?(m=Oc,Oc=16777216,Ka(s,l,d),Oc=m):Ka(s,l,d));break;default:Ka(s,l,d)}}function AS(s){var l=s.alternate;if(l!==null&&(s=l.child,s!==null)){l.child=null;do l=s.sibling,s.sibling=null,s=l;while(s!==null)}}function Mc(s){var l=s.deletions;if((s.flags&16)!==0){if(l!==null)for(var d=0;d<l.length;d++){var m=l[d];An=m,DS(m,s)}AS(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)kS(s),s=s.sibling}function kS(s){switch(s.tag){case 0:case 11:case 15:Mc(s),s.flags&2048&&Mo(9,s,s.return);break;case 3:Mc(s);break;case 12:Mc(s);break;case 22:var l=s.stateNode;s.memoizedState!==null&&l._visibility&2&&(s.return===null||s.return.tag!==13)?(l._visibility&=-3,Yd(s)):Mc(s);break;default:Mc(s)}}function Yd(s){var l=s.deletions;if((s.flags&16)!==0){if(l!==null)for(var d=0;d<l.length;d++){var m=l[d];An=m,DS(m,s)}AS(s)}for(s=s.child;s!==null;){switch(l=s,l.tag){case 0:case 11:case 15:Mo(8,l,l.return),Yd(l);break;case 22:d=l.stateNode,d._visibility&2&&(d._visibility&=-3,Yd(l));break;default:Yd(l)}s=s.sibling}}function DS(s,l){for(;An!==null;){var d=An;switch(d.tag){case 0:case 11:case 15:Mo(8,d,l);break;case 23:case 22:if(d.memoizedState!==null&&d.memoizedState.cachePool!==null){var m=d.memoizedState.cachePool.pool;m!=null&&m.refCount++}break;case 24:pc(d.memoizedState.cache)}if(m=d.child,m!==null)m.return=d,An=m;else e:for(d=s;An!==null;){m=An;var b=m.sibling,E=m.return;if(xS(m),m===d){An=null;break e}if(b!==null){b.return=E,An=b;break e}An=E}}}var c_={getCacheForType:function(s){var l=_n(mn),d=l.data.get(s);return d===void 0&&(d=s(),l.data.set(s,d)),d},cacheSignal:function(){return _n(mn).controller.signal}},u_=typeof WeakMap=="function"?WeakMap:Map,It=0,Yt=null,St=null,Ct=0,$t=0,xr=null,Ro=!1,Xa=!1,Hg=!1,Ki=0,cn=0,jo=0,Us=0,Ug=0,br=0,Ja=0,Rc=null,cr=null,Vg=!1,Kd=0,OS=0,Xd=1/0,Jd=null,Io=null,En=0,_o=null,Qa=null,Xi=0,qg=0,Gg=null,MS=null,jc=0,Wg=null;function wr(){return(It&2)!==0&&Ct!==0?Ct&-Ct:L.T!==null?Zg():hm()}function RS(){if(br===0)if((Ct&536870912)===0||Nt){var s=yt;yt<<=1,(yt&3932160)===0&&(yt=262144),br=s}else br=536870912;return s=yr.current,s!==null&&(s.flags|=32),br}function ur(s,l,d){(s===Yt&&($t===2||$t===9)||s.cancelPendingCommit!==null)&&(Za(s,0),Lo(s,Ct,br,!1)),on(s,d),((It&2)===0||s!==Yt)&&(s===Yt&&((It&2)===0&&(Us|=d),cn===4&&Lo(s,Ct,br,!1)),gi(s))}function jS(s,l,d){if((It&6)!==0)throw Error(r(327));var m=!d&&(l&127)===0&&(l&s.expiredLanes)===0||Dt(s,l),b=m?h_(s,l):Kg(s,l,!0),E=m;do{if(b===0){Xa&&!m&&Lo(s,l,0,!1);break}else{if(d=s.current.alternate,E&&!d_(d)){b=Kg(s,l,!1),E=!1;continue}if(b===2){if(E=l,s.errorRecoveryDisabledLanes&E)var A=0;else A=s.pendingLanes&-536870913,A=A!==0?A:A&536870912?536870912:0;if(A!==0){l=A;e:{var _=s;b=Rc;var F=_.current.memoizedState.isDehydrated;if(F&&(Za(_,A).flags|=256),A=Kg(_,A,!1),A!==2){if(Hg&&!F){_.errorRecoveryDisabledLanes|=E,Us|=E,b=4;break e}E=cr,cr=b,E!==null&&(cr===null?cr=E:cr.push.apply(cr,E))}b=A}if(E=!1,b!==2)continue}}if(b===1){Za(s,0),Lo(s,l,0,!0);break}e:{switch(m=s,E=b,E){case 0:case 1:throw Error(r(345));case 4:if((l&4194048)!==l)break;case 6:Lo(m,l,br,!Ro);break e;case 2:cr=null;break;case 3:case 5:break;default:throw Error(r(329))}if((l&62914560)===l&&(b=Kd+300-Ye(),10<b)){if(Lo(m,l,br,!Ro),Be(m,0,!0)!==0)break e;Xi=l,m.timeoutHandle=uE(IS.bind(null,m,d,cr,Jd,Vg,l,br,Us,Ja,Ro,E,"Throttled",-0,0),b);break e}IS(m,d,cr,Jd,Vg,l,br,Us,Ja,Ro,E,null,-0,0)}}break}while(!0);gi(s)}function IS(s,l,d,m,b,E,A,_,F,ie,ge,xe,se,fe){if(s.timeoutHandle=-1,xe=l.subtreeFlags,xe&8192||(xe&16785408)===16785408){xe={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:_i},NS(l,E,xe);var Pe=(E&62914560)===E?Kd-Ye():(E&4194048)===E?OS-Ye():0;if(Pe=K_(xe,Pe),Pe!==null){Xi=E,s.cancelPendingCommit=Pe(HS.bind(null,s,l,E,d,m,b,A,_,F,ge,xe,null,se,fe)),Lo(s,E,A,!ie);return}}HS(s,l,E,d,m,b,A,_,F)}function d_(s){for(var l=s;;){var d=l.tag;if((d===0||d===11||d===15)&&l.flags&16384&&(d=l.updateQueue,d!==null&&(d=d.stores,d!==null)))for(var m=0;m<d.length;m++){var b=d[m],E=b.getSnapshot;b=b.value;try{if(!mr(E(),b))return!1}catch{return!1}}if(d=l.child,l.subtreeFlags&16384&&d!==null)d.return=l,l=d;else{if(l===s)break;for(;l.sibling===null;){if(l.return===null||l.return===s)return!0;l=l.return}l.sibling.return=l.return,l=l.sibling}}return!0}function Lo(s,l,d,m){l&=~Ug,l&=~Us,s.suspendedLanes|=l,s.pingedLanes&=~l,m&&(s.warmLanes|=l),m=s.expirationTimes;for(var b=l;0<b;){var E=31-Qe(b),A=1<<E;m[E]=-1,b&=~A}d!==0&&Ns(s,d,l)}function Qd(){return(It&6)===0?(Ic(0),!1):!0}function Yg(){if(St!==null){if($t===0)var s=St.return;else s=St,Bi=Is=null,ug(s),Ua=null,gc=0,s=St;for(;s!==null;)dS(s.alternate,s),s=s.return;St=null}}function Za(s,l){var d=s.timeoutHandle;d!==-1&&(s.timeoutHandle=-1,M_(d)),d=s.cancelPendingCommit,d!==null&&(s.cancelPendingCommit=null,d()),Xi=0,Yg(),Yt=s,St=d=Pi(s.current,null),Ct=l,$t=0,xr=null,Ro=!1,Xa=Dt(s,l),Hg=!1,Ja=br=Ug=Us=jo=cn=0,cr=Rc=null,Vg=!1,(l&8)!==0&&(l|=l&32);var m=s.entangledLanes;if(m!==0)for(s=s.entanglements,m&=l;0<m;){var b=31-Qe(m),E=1<<b;l|=s[b],m&=~E}return Ki=l,xd(),d}function _S(s,l){ft=null,L.H=Cc,l===Ha||l===Ad?(l=J1(),$t=3):l===Qm?(l=J1(),$t=4):$t=l===Ng?8:l!==null&&typeof l=="object"&&typeof l.then=="function"?6:1,xr=l,St===null&&(cn=1,$d(s,Rr(l,s.current)))}function LS(){var s=yr.current;return s===null?!0:(Ct&4194048)===Ct?Lr===null:(Ct&62914560)===Ct||(Ct&536870912)!==0?s===Lr:!1}function PS(){var s=L.H;return L.H=Cc,s===null?Cc:s}function zS(){var s=L.A;return L.A=c_,s}function Zd(){cn=4,Ro||(Ct&4194048)!==Ct&&yr.current!==null||(Xa=!0),(jo&134217727)===0&&(Us&134217727)===0||Yt===null||Lo(Yt,Ct,br,!1)}function Kg(s,l,d){var m=It;It|=2;var b=PS(),E=zS();(Yt!==s||Ct!==l)&&(Jd=null,Za(s,l)),l=!1;var A=cn;e:do try{if($t!==0&&St!==null){var _=St,F=xr;switch($t){case 8:Yg(),A=6;break e;case 3:case 2:case 9:case 6:yr.current===null&&(l=!0);var ie=$t;if($t=0,xr=null,el(s,_,F,ie),d&&Xa){A=0;break e}break;default:ie=$t,$t=0,xr=null,el(s,_,F,ie)}}f_(),A=cn;break}catch(ge){_S(s,ge)}while(!0);return l&&s.shellSuspendCounter++,Bi=Is=null,It=m,L.H=b,L.A=E,St===null&&(Yt=null,Ct=0,xd()),A}function f_(){for(;St!==null;)BS(St)}function h_(s,l){var d=It;It|=2;var m=PS(),b=zS();Yt!==s||Ct!==l?(Jd=null,Xd=Ye()+500,Za(s,l)):Xa=Dt(s,l);e:do try{if($t!==0&&St!==null){l=St;var E=xr;t:switch($t){case 1:$t=0,xr=null,el(s,l,E,1);break;case 2:case 9:if(K1(E)){$t=0,xr=null,FS(l);break}l=function(){$t!==2&&$t!==9||Yt!==s||($t=7),gi(s)},E.then(l,l);break e;case 3:$t=7;break e;case 4:$t=5;break e;case 7:K1(E)?($t=0,xr=null,FS(l)):($t=0,xr=null,el(s,l,E,7));break;case 5:var A=null;switch(St.tag){case 26:A=St.memoizedState;case 5:case 27:var _=St;if(A?TE(A):_.stateNode.complete){$t=0,xr=null;var F=_.sibling;if(F!==null)St=F;else{var ie=_.return;ie!==null?(St=ie,ef(ie)):St=null}break t}}$t=0,xr=null,el(s,l,E,5);break;case 6:$t=0,xr=null,el(s,l,E,6);break;case 8:Yg(),cn=6;break e;default:throw Error(r(462))}}p_();break}catch(ge){_S(s,ge)}while(!0);return Bi=Is=null,L.H=m,L.A=b,It=d,St!==null?0:(Yt=null,Ct=0,xd(),cn)}function p_(){for(;St!==null&&!Ce();)BS(St)}function BS(s){var l=cS(s.alternate,s,Ki);s.memoizedProps=s.pendingProps,l===null?ef(s):St=l}function FS(s){var l=s,d=l.alternate;switch(l.tag){case 15:case 0:l=rS(d,l,l.pendingProps,l.type,void 0,Ct);break;case 11:l=rS(d,l,l.pendingProps,l.type.render,l.ref,Ct);break;case 5:ug(l);default:dS(d,l),l=St=z1(l,Ki),l=cS(d,l,Ki)}s.memoizedProps=s.pendingProps,l===null?ef(s):St=l}function el(s,l,d,m){Bi=Is=null,ug(l),Ua=null,gc=0;var b=l.return;try{if(n_(s,b,l,d,Ct)){cn=1,$d(s,Rr(d,s.current)),St=null;return}}catch(E){if(b!==null)throw St=b,E;cn=1,$d(s,Rr(d,s.current)),St=null;return}l.flags&32768?(Nt||m===1?s=!0:Xa||(Ct&536870912)!==0?s=!1:(Ro=s=!0,(m===2||m===9||m===3||m===6)&&(m=yr.current,m!==null&&m.tag===13&&(m.flags|=16384))),$S(l,s)):ef(l)}function ef(s){var l=s;do{if((l.flags&32768)!==0){$S(l,Ro);return}s=l.return;var d=o_(l.alternate,l,Ki);if(d!==null){St=d;return}if(l=l.sibling,l!==null){St=l;return}St=l=s}while(l!==null);cn===0&&(cn=5)}function $S(s,l){do{var d=s_(s.alternate,s);if(d!==null){d.flags&=32767,St=d;return}if(d=s.return,d!==null&&(d.flags|=32768,d.subtreeFlags=0,d.deletions=null),!l&&(s=s.sibling,s!==null)){St=s;return}St=s=d}while(s!==null);cn=6,St=null}function HS(s,l,d,m,b,E,A,_,F){s.cancelPendingCommit=null;do tf();while(En!==0);if((It&6)!==0)throw Error(r(327));if(l!==null){if(l===s.current)throw Error(r(177));if(E=l.lanes|l.childLanes,E|=Pm,tr(s,d,E,A,_,F),s===Yt&&(St=Yt=null,Ct=0),Qa=l,_o=s,Xi=d,qg=E,Gg=b,MS=m,(l.subtreeFlags&10256)!==0||(l.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,v_(ze,function(){return WS(),null})):(s.callbackNode=null,s.callbackPriority=0),m=(l.flags&13878)!==0,(l.subtreeFlags&13878)!==0||m){m=L.T,L.T=null,b=$.p,$.p=2,A=It,It|=4;try{a_(s,l,d)}finally{It=A,$.p=b,L.T=m}}En=1,US(),VS(),qS()}}function US(){if(En===1){En=0;var s=_o,l=Qa,d=(l.flags&13878)!==0;if((l.subtreeFlags&13878)!==0||d){d=L.T,L.T=null;var m=$.p;$.p=2;var b=It;It|=4;try{ES(l,s);var E=ay,A=D1(s.containerInfo),_=E.focusedElem,F=E.selectionRange;if(A!==_&&_&&_.ownerDocument&&k1(_.ownerDocument.documentElement,_)){if(F!==null&&Rm(_)){var ie=F.start,ge=F.end;if(ge===void 0&&(ge=ie),"selectionStart"in _)_.selectionStart=ie,_.selectionEnd=Math.min(ge,_.value.length);else{var xe=_.ownerDocument||document,se=xe&&xe.defaultView||window;if(se.getSelection){var fe=se.getSelection(),Pe=_.textContent.length,nt=Math.min(F.start,Pe),Gt=F.end===void 0?nt:Math.min(F.end,Pe);!fe.extend&&nt>Gt&&(A=Gt,Gt=nt,nt=A);var Q=A1(_,nt),q=A1(_,Gt);if(Q&&q&&(fe.rangeCount!==1||fe.anchorNode!==Q.node||fe.anchorOffset!==Q.offset||fe.focusNode!==q.node||fe.focusOffset!==q.offset)){var ne=xe.createRange();ne.setStart(Q.node,Q.offset),fe.removeAllRanges(),nt>Gt?(fe.addRange(ne),fe.extend(q.node,q.offset)):(ne.setEnd(q.node,q.offset),fe.addRange(ne))}}}}for(xe=[],fe=_;fe=fe.parentNode;)fe.nodeType===1&&xe.push({element:fe,left:fe.scrollLeft,top:fe.scrollTop});for(typeof _.focus=="function"&&_.focus(),_=0;_<xe.length;_++){var ye=xe[_];ye.element.scrollLeft=ye.left,ye.element.scrollTop=ye.top}}pf=!!sy,ay=sy=null}finally{It=b,$.p=m,L.T=d}}s.current=l,En=2}}function VS(){if(En===2){En=0;var s=_o,l=Qa,d=(l.flags&8772)!==0;if((l.subtreeFlags&8772)!==0||d){d=L.T,L.T=null;var m=$.p;$.p=2;var b=It;It|=4;try{vS(s,l.alternate,l)}finally{It=b,$.p=m,L.T=d}}En=3}}function qS(){if(En===4||En===3){En=0,Oe();var s=_o,l=Qa,d=Xi,m=MS;(l.subtreeFlags&10256)!==0||(l.flags&10256)!==0?En=5:(En=0,Qa=_o=null,GS(s,s.pendingLanes));var b=s.pendingLanes;if(b===0&&(Io=null),Kr(d),l=l.stateNode,Ke&&typeof Ke.onCommitFiberRoot=="function")try{Ke.onCommitFiberRoot(pt,l,void 0,(l.current.flags&128)===128)}catch{}if(m!==null){l=L.T,b=$.p,$.p=2,L.T=null;try{for(var E=s.onRecoverableError,A=0;A<m.length;A++){var _=m[A];E(_.value,{componentStack:_.stack})}}finally{L.T=l,$.p=b}}(Xi&3)!==0&&tf(),gi(s),b=s.pendingLanes,(d&261930)!==0&&(b&42)!==0?s===Wg?jc++:(jc=0,Wg=s):jc=0,Ic(0)}}function GS(s,l){(s.pooledCacheLanes&=l)===0&&(l=s.pooledCache,l!=null&&(s.pooledCache=null,pc(l)))}function tf(){return US(),VS(),qS(),WS()}function WS(){if(En!==5)return!1;var s=_o,l=qg;qg=0;var d=Kr(Xi),m=L.T,b=$.p;try{$.p=32>d?32:d,L.T=null,d=Gg,Gg=null;var E=_o,A=Xi;if(En=0,Qa=_o=null,Xi=0,(It&6)!==0)throw Error(r(331));var _=It;if(It|=4,kS(E.current),TS(E,E.current,A,d),It=_,Ic(0,!1),Ke&&typeof Ke.onPostCommitFiberRoot=="function")try{Ke.onPostCommitFiberRoot(pt,E)}catch{}return!0}finally{$.p=b,L.T=m,GS(s,l)}}function YS(s,l,d){l=Rr(d,l),l=Tg(s.stateNode,l,2),s=ko(s,l,2),s!==null&&(on(s,2),gi(s))}function Ht(s,l,d){if(s.tag===3)YS(s,s,d);else for(;l!==null;){if(l.tag===3){YS(l,s,d);break}else if(l.tag===1){var m=l.stateNode;if(typeof l.type.getDerivedStateFromError=="function"||typeof m.componentDidCatch=="function"&&(Io===null||!Io.has(m))){s=Rr(d,s),d=Kw(2),m=ko(l,d,2),m!==null&&(Xw(d,m,l,s),on(m,2),gi(m));break}}l=l.return}}function Xg(s,l,d){var m=s.pingCache;if(m===null){m=s.pingCache=new u_;var b=new Set;m.set(l,b)}else b=m.get(l),b===void 0&&(b=new Set,m.set(l,b));b.has(d)||(Hg=!0,b.add(d),s=m_.bind(null,s,l,d),l.then(s,s))}function m_(s,l,d){var m=s.pingCache;m!==null&&m.delete(l),s.pingedLanes|=s.suspendedLanes&d,s.warmLanes&=~d,Yt===s&&(Ct&d)===d&&(cn===4||cn===3&&(Ct&62914560)===Ct&&300>Ye()-Kd?(It&2)===0&&Za(s,0):Ug|=d,Ja===Ct&&(Ja=0)),gi(s)}function KS(s,l){l===0&&(l=Tn()),s=Ms(s,l),s!==null&&(on(s,l),gi(s))}function g_(s){var l=s.memoizedState,d=0;l!==null&&(d=l.retryLane),KS(s,d)}function y_(s,l){var d=0;switch(s.tag){case 31:case 13:var m=s.stateNode,b=s.memoizedState;b!==null&&(d=b.retryLane);break;case 19:m=s.stateNode;break;case 22:m=s.stateNode._retryCache;break;default:throw Error(r(314))}m!==null&&m.delete(l),KS(s,d)}function v_(s,l){return X(s,l)}var nf=null,tl=null,Jg=!1,rf=!1,Qg=!1,Po=0;function gi(s){s!==tl&&s.next===null&&(tl===null?nf=tl=s:tl=tl.next=s),rf=!0,Jg||(Jg=!0,b_())}function Ic(s,l){if(!Qg&&rf){Qg=!0;do for(var d=!1,m=nf;m!==null;){if(s!==0){var b=m.pendingLanes;if(b===0)var E=0;else{var A=m.suspendedLanes,_=m.pingedLanes;E=(1<<31-Qe(42|s)+1)-1,E&=b&~(A&~_),E=E&201326741?E&201326741|1:E?E|2:0}E!==0&&(d=!0,ZS(m,E))}else E=Ct,E=Be(m,m===Yt?E:0,m.cancelPendingCommit!==null||m.timeoutHandle!==-1),(E&3)===0||Dt(m,E)||(d=!0,ZS(m,E));m=m.next}while(d);Qg=!1}}function x_(){XS()}function XS(){rf=Jg=!1;var s=0;Po!==0&&O_()&&(s=Po);for(var l=Ye(),d=null,m=nf;m!==null;){var b=m.next,E=JS(m,l);E===0?(m.next=null,d===null?nf=b:d.next=b,b===null&&(tl=d)):(d=m,(s!==0||(E&3)!==0)&&(rf=!0)),m=b}En!==0&&En!==5||Ic(s),Po!==0&&(Po=0)}function JS(s,l){for(var d=s.suspendedLanes,m=s.pingedLanes,b=s.expirationTimes,E=s.pendingLanes&-62914561;0<E;){var A=31-Qe(E),_=1<<A,F=b[A];F===-1?((_&d)===0||(_&m)!==0)&&(b[A]=rn(_,l)):F<=l&&(s.expiredLanes|=_),E&=~_}if(l=Yt,d=Ct,d=Be(s,s===l?d:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),m=s.callbackNode,d===0||s===l&&($t===2||$t===9)||s.cancelPendingCommit!==null)return m!==null&&m!==null&&ve(m),s.callbackNode=null,s.callbackPriority=0;if((d&3)===0||Dt(s,d)){if(l=d&-d,l===s.callbackPriority)return l;switch(m!==null&&ve(m),Kr(d)){case 2:case 8:d=ct;break;case 32:d=ze;break;case 268435456:d=ke;break;default:d=ze}return m=QS.bind(null,s),d=X(d,m),s.callbackPriority=l,s.callbackNode=d,l}return m!==null&&m!==null&&ve(m),s.callbackPriority=2,s.callbackNode=null,2}function QS(s,l){if(En!==0&&En!==5)return s.callbackNode=null,s.callbackPriority=0,null;var d=s.callbackNode;if(tf()&&s.callbackNode!==d)return null;var m=Ct;return m=Be(s,s===Yt?m:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),m===0?null:(jS(s,m,l),JS(s,Ye()),s.callbackNode!=null&&s.callbackNode===d?QS.bind(null,s):null)}function ZS(s,l){if(tf())return null;jS(s,l,!0)}function b_(){R_(function(){(It&6)!==0?X(at,x_):XS()})}function Zg(){if(Po===0){var s=Fa;s===0&&(s=De,De<<=1,(De&261888)===0&&(De=256)),Po=s}return Po}function eE(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:dd(""+s)}function tE(s,l){var d=l.ownerDocument.createElement("input");return d.name=l.name,d.value=l.value,s.id&&d.setAttribute("form",s.id),l.parentNode.insertBefore(d,l),s=new FormData(s),d.parentNode.removeChild(d),s}function w_(s,l,d,m,b){if(l==="submit"&&d&&d.stateNode===b){var E=eE((b[ir]||null).action),A=m.submitter;A&&(l=(l=A[ir]||null)?eE(l.formAction):A.getAttribute("formAction"),l!==null&&(E=l,A=null));var _=new md("action","action",null,m,b);s.push({event:_,listeners:[{instance:null,listener:function(){if(m.defaultPrevented){if(Po!==0){var F=A?tE(b,A):new FormData(b);xg(d,{pending:!0,data:F,method:b.method,action:E},null,F)}}else typeof E=="function"&&(_.preventDefault(),F=A?tE(b,A):new FormData(b),xg(d,{pending:!0,data:F,method:b.method,action:E},E,F))},currentTarget:b}]})}}for(var ey=0;ey<Lm.length;ey++){var ty=Lm[ey],S_=ty.toLowerCase(),E_=ty[0].toUpperCase()+ty.slice(1);Xr(S_,"on"+E_)}Xr(R1,"onAnimationEnd"),Xr(j1,"onAnimationIteration"),Xr(I1,"onAnimationStart"),Xr("dblclick","onDoubleClick"),Xr("focusin","onFocus"),Xr("focusout","onBlur"),Xr(BI,"onTransitionRun"),Xr(FI,"onTransitionStart"),Xr($I,"onTransitionCancel"),Xr(_1,"onTransitionEnd"),Na("onMouseEnter",["mouseout","mouseover"]),Na("onMouseLeave",["mouseout","mouseover"]),Na("onPointerEnter",["pointerout","pointerover"]),Na("onPointerLeave",["pointerout","pointerover"]),As("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),As("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),As("onBeforeInput",["compositionend","keypress","textInput","paste"]),As("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),As("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),As("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var _c="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),C_=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(_c));function nE(s,l){l=(l&4)!==0;for(var d=0;d<s.length;d++){var m=s[d],b=m.event;m=m.listeners;e:{var E=void 0;if(l)for(var A=m.length-1;0<=A;A--){var _=m[A],F=_.instance,ie=_.currentTarget;if(_=_.listener,F!==E&&b.isPropagationStopped())break e;E=_,b.currentTarget=ie;try{E(b)}catch(ge){vd(ge)}b.currentTarget=null,E=F}else for(A=0;A<m.length;A++){if(_=m[A],F=_.instance,ie=_.currentTarget,_=_.listener,F!==E&&b.isPropagationStopped())break e;E=_,b.currentTarget=ie;try{E(b)}catch(ge){vd(ge)}b.currentTarget=null,E=F}}}}function Et(s,l){var d=l[pm];d===void 0&&(d=l[pm]=new Set);var m=s+"__bubble";d.has(m)||(rE(l,s,2,!1),d.add(m))}function ny(s,l,d){var m=0;l&&(m|=4),rE(d,s,m,l)}var of="_reactListening"+Math.random().toString(36).slice(2);function ry(s){if(!s[of]){s[of]=!0,X0.forEach(function(d){d!=="selectionchange"&&(C_.has(d)||ny(d,!1,s),ny(d,!0,s))});var l=s.nodeType===9?s:s.ownerDocument;l===null||l[of]||(l[of]=!0,ny("selectionchange",!1,l))}}function rE(s,l,d,m){switch(RE(l)){case 2:var b=Q_;break;case 8:b=Z_;break;default:b=vy}d=b.bind(null,l,d,s),b=void 0,!Em||l!=="touchstart"&&l!=="touchmove"&&l!=="wheel"||(b=!0),m?b!==void 0?s.addEventListener(l,d,{capture:!0,passive:b}):s.addEventListener(l,d,!0):b!==void 0?s.addEventListener(l,d,{passive:b}):s.addEventListener(l,d,!1)}function iy(s,l,d,m,b){var E=m;if((l&1)===0&&(l&2)===0&&m!==null)e:for(;;){if(m===null)return;var A=m.tag;if(A===3||A===4){var _=m.stateNode.containerInfo;if(_===b)break;if(A===4)for(A=m.return;A!==null;){var F=A.tag;if((F===3||F===4)&&A.stateNode.containerInfo===b)return;A=A.return}for(;_!==null;){if(A=Ea(_),A===null)return;if(F=A.tag,F===5||F===6||F===26||F===27){m=E=A;continue e}_=_.parentNode}}m=m.return}l1(function(){var ie=E,ge=wm(d),xe=[];e:{var se=L1.get(s);if(se!==void 0){var fe=md,Pe=s;switch(s){case"keypress":if(hd(d)===0)break e;case"keydown":case"keyup":fe=yI;break;case"focusin":Pe="focus",fe=Am;break;case"focusout":Pe="blur",fe=Am;break;case"beforeblur":case"afterblur":fe=Am;break;case"click":if(d.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":fe=d1;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":fe=oI;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":fe=bI;break;case R1:case j1:case I1:fe=lI;break;case _1:fe=SI;break;case"scroll":case"scrollend":fe=rI;break;case"wheel":fe=CI;break;case"copy":case"cut":case"paste":fe=uI;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":fe=h1;break;case"toggle":case"beforetoggle":fe=NI}var nt=(l&4)!==0,Gt=!nt&&(s==="scroll"||s==="scrollend"),Q=nt?se!==null?se+"Capture":null:se;nt=[];for(var q=ie,ne;q!==null;){var ye=q;if(ne=ye.stateNode,ye=ye.tag,ye!==5&&ye!==26&&ye!==27||ne===null||Q===null||(ye=rc(q,Q),ye!=null&&nt.push(Lc(q,ye,ne))),Gt)break;q=q.return}0<nt.length&&(se=new fe(se,Pe,null,d,ge),xe.push({event:se,listeners:nt}))}}if((l&7)===0){e:{if(se=s==="mouseover"||s==="pointerover",fe=s==="mouseout"||s==="pointerout",se&&d!==bm&&(Pe=d.relatedTarget||d.fromElement)&&(Ea(Pe)||Pe[Sa]))break e;if((fe||se)&&(se=ge.window===ge?ge:(se=ge.ownerDocument)?se.defaultView||se.parentWindow:window,fe?(Pe=d.relatedTarget||d.toElement,fe=ie,Pe=Pe?Ea(Pe):null,Pe!==null&&(Gt=o(Pe),nt=Pe.tag,Pe!==Gt||nt!==5&&nt!==27&&nt!==6)&&(Pe=null)):(fe=null,Pe=ie),fe!==Pe)){if(nt=d1,ye="onMouseLeave",Q="onMouseEnter",q="mouse",(s==="pointerout"||s==="pointerover")&&(nt=h1,ye="onPointerLeave",Q="onPointerEnter",q="pointer"),Gt=fe==null?se:nc(fe),ne=Pe==null?se:nc(Pe),se=new nt(ye,q+"leave",fe,d,ge),se.target=Gt,se.relatedTarget=ne,ye=null,Ea(ge)===ie&&(nt=new nt(Q,q+"enter",Pe,d,ge),nt.target=ne,nt.relatedTarget=Gt,ye=nt),Gt=ye,fe&&Pe)t:{for(nt=T_,Q=fe,q=Pe,ne=0,ye=Q;ye;ye=nt(ye))ne++;ye=0;for(var Ze=q;Ze;Ze=nt(Ze))ye++;for(;0<ne-ye;)Q=nt(Q),ne--;for(;0<ye-ne;)q=nt(q),ye--;for(;ne--;){if(Q===q||q!==null&&Q===q.alternate){nt=Q;break t}Q=nt(Q),q=nt(q)}nt=null}else nt=null;fe!==null&&iE(xe,se,fe,nt,!1),Pe!==null&&Gt!==null&&iE(xe,Gt,Pe,nt,!0)}}e:{if(se=ie?nc(ie):window,fe=se.nodeName&&se.nodeName.toLowerCase(),fe==="select"||fe==="input"&&se.type==="file")var Ot=w1;else if(x1(se))if(S1)Ot=LI;else{Ot=II;var Ue=jI}else fe=se.nodeName,!fe||fe.toLowerCase()!=="input"||se.type!=="checkbox"&&se.type!=="radio"?ie&&xm(ie.elementType)&&(Ot=w1):Ot=_I;if(Ot&&(Ot=Ot(s,ie))){b1(xe,Ot,d,ge);break e}Ue&&Ue(s,se,ie),s==="focusout"&&ie&&se.type==="number"&&ie.memoizedProps.value!=null&&vm(se,"number",se.value)}switch(Ue=ie?nc(ie):window,s){case"focusin":(x1(Ue)||Ue.contentEditable==="true")&&(Ra=Ue,jm=ie,dc=null);break;case"focusout":dc=jm=Ra=null;break;case"mousedown":Im=!0;break;case"contextmenu":case"mouseup":case"dragend":Im=!1,O1(xe,d,ge);break;case"selectionchange":if(zI)break;case"keydown":case"keyup":O1(xe,d,ge)}var gt;if(Dm)e:{switch(s){case"compositionstart":var Tt="onCompositionStart";break e;case"compositionend":Tt="onCompositionEnd";break e;case"compositionupdate":Tt="onCompositionUpdate";break e}Tt=void 0}else Ma?y1(s,d)&&(Tt="onCompositionEnd"):s==="keydown"&&d.keyCode===229&&(Tt="onCompositionStart");Tt&&(p1&&d.locale!=="ko"&&(Ma||Tt!=="onCompositionStart"?Tt==="onCompositionEnd"&&Ma&&(gt=c1()):(wo=ge,Cm="value"in wo?wo.value:wo.textContent,Ma=!0)),Ue=sf(ie,Tt),0<Ue.length&&(Tt=new f1(Tt,s,null,d,ge),xe.push({event:Tt,listeners:Ue}),gt?Tt.data=gt:(gt=v1(d),gt!==null&&(Tt.data=gt)))),(gt=kI?DI(s,d):OI(s,d))&&(Tt=sf(ie,"onBeforeInput"),0<Tt.length&&(Ue=new f1("onBeforeInput","beforeinput",null,d,ge),xe.push({event:Ue,listeners:Tt}),Ue.data=gt)),w_(xe,s,ie,d,ge)}nE(xe,l)})}function Lc(s,l,d){return{instance:s,listener:l,currentTarget:d}}function sf(s,l){for(var d=l+"Capture",m=[];s!==null;){var b=s,E=b.stateNode;if(b=b.tag,b!==5&&b!==26&&b!==27||E===null||(b=rc(s,d),b!=null&&m.unshift(Lc(s,b,E)),b=rc(s,l),b!=null&&m.push(Lc(s,b,E))),s.tag===3)return m;s=s.return}return[]}function T_(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function iE(s,l,d,m,b){for(var E=l._reactName,A=[];d!==null&&d!==m;){var _=d,F=_.alternate,ie=_.stateNode;if(_=_.tag,F!==null&&F===m)break;_!==5&&_!==26&&_!==27||ie===null||(F=ie,b?(ie=rc(d,E),ie!=null&&A.unshift(Lc(d,ie,F))):b||(ie=rc(d,E),ie!=null&&A.push(Lc(d,ie,F)))),d=d.return}A.length!==0&&s.push({event:l,listeners:A})}var N_=/\r\n?/g,A_=/\u0000|\uFFFD/g;function oE(s){return(typeof s=="string"?s:""+s).replace(N_,`
`).replace(A_,"")}function sE(s,l){return l=oE(l),oE(s)===l}function qt(s,l,d,m,b,E){switch(d){case"children":typeof m=="string"?l==="body"||l==="textarea"&&m===""||ka(s,m):(typeof m=="number"||typeof m=="bigint")&&l!=="body"&&ka(s,""+m);break;case"className":cd(s,"class",m);break;case"tabIndex":cd(s,"tabindex",m);break;case"dir":case"role":case"viewBox":case"width":case"height":cd(s,d,m);break;case"style":s1(s,m,E);break;case"data":if(l!=="object"){cd(s,"data",m);break}case"src":case"href":if(m===""&&(l!=="a"||d!=="href")){s.removeAttribute(d);break}if(m==null||typeof m=="function"||typeof m=="symbol"||typeof m=="boolean"){s.removeAttribute(d);break}m=dd(""+m),s.setAttribute(d,m);break;case"action":case"formAction":if(typeof m=="function"){s.setAttribute(d,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof E=="function"&&(d==="formAction"?(l!=="input"&&qt(s,l,"name",b.name,b,null),qt(s,l,"formEncType",b.formEncType,b,null),qt(s,l,"formMethod",b.formMethod,b,null),qt(s,l,"formTarget",b.formTarget,b,null)):(qt(s,l,"encType",b.encType,b,null),qt(s,l,"method",b.method,b,null),qt(s,l,"target",b.target,b,null)));if(m==null||typeof m=="symbol"||typeof m=="boolean"){s.removeAttribute(d);break}m=dd(""+m),s.setAttribute(d,m);break;case"onClick":m!=null&&(s.onclick=_i);break;case"onScroll":m!=null&&Et("scroll",s);break;case"onScrollEnd":m!=null&&Et("scrollend",s);break;case"dangerouslySetInnerHTML":if(m!=null){if(typeof m!="object"||!("__html"in m))throw Error(r(61));if(d=m.__html,d!=null){if(b.children!=null)throw Error(r(60));s.innerHTML=d}}break;case"multiple":s.multiple=m&&typeof m!="function"&&typeof m!="symbol";break;case"muted":s.muted=m&&typeof m!="function"&&typeof m!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(m==null||typeof m=="function"||typeof m=="boolean"||typeof m=="symbol"){s.removeAttribute("xlink:href");break}d=dd(""+m),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",d);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":m!=null&&typeof m!="function"&&typeof m!="symbol"?s.setAttribute(d,""+m):s.removeAttribute(d);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":m&&typeof m!="function"&&typeof m!="symbol"?s.setAttribute(d,""):s.removeAttribute(d);break;case"capture":case"download":m===!0?s.setAttribute(d,""):m!==!1&&m!=null&&typeof m!="function"&&typeof m!="symbol"?s.setAttribute(d,m):s.removeAttribute(d);break;case"cols":case"rows":case"size":case"span":m!=null&&typeof m!="function"&&typeof m!="symbol"&&!isNaN(m)&&1<=m?s.setAttribute(d,m):s.removeAttribute(d);break;case"rowSpan":case"start":m==null||typeof m=="function"||typeof m=="symbol"||isNaN(m)?s.removeAttribute(d):s.setAttribute(d,m);break;case"popover":Et("beforetoggle",s),Et("toggle",s),ld(s,"popover",m);break;case"xlinkActuate":Ii(s,"http://www.w3.org/1999/xlink","xlink:actuate",m);break;case"xlinkArcrole":Ii(s,"http://www.w3.org/1999/xlink","xlink:arcrole",m);break;case"xlinkRole":Ii(s,"http://www.w3.org/1999/xlink","xlink:role",m);break;case"xlinkShow":Ii(s,"http://www.w3.org/1999/xlink","xlink:show",m);break;case"xlinkTitle":Ii(s,"http://www.w3.org/1999/xlink","xlink:title",m);break;case"xlinkType":Ii(s,"http://www.w3.org/1999/xlink","xlink:type",m);break;case"xmlBase":Ii(s,"http://www.w3.org/XML/1998/namespace","xml:base",m);break;case"xmlLang":Ii(s,"http://www.w3.org/XML/1998/namespace","xml:lang",m);break;case"xmlSpace":Ii(s,"http://www.w3.org/XML/1998/namespace","xml:space",m);break;case"is":ld(s,"is",m);break;case"innerText":case"textContent":break;default:(!(2<d.length)||d[0]!=="o"&&d[0]!=="O"||d[1]!=="n"&&d[1]!=="N")&&(d=tI.get(d)||d,ld(s,d,m))}}function oy(s,l,d,m,b,E){switch(d){case"style":s1(s,m,E);break;case"dangerouslySetInnerHTML":if(m!=null){if(typeof m!="object"||!("__html"in m))throw Error(r(61));if(d=m.__html,d!=null){if(b.children!=null)throw Error(r(60));s.innerHTML=d}}break;case"children":typeof m=="string"?ka(s,m):(typeof m=="number"||typeof m=="bigint")&&ka(s,""+m);break;case"onScroll":m!=null&&Et("scroll",s);break;case"onScrollEnd":m!=null&&Et("scrollend",s);break;case"onClick":m!=null&&(s.onclick=_i);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!J0.hasOwnProperty(d))e:{if(d[0]==="o"&&d[1]==="n"&&(b=d.endsWith("Capture"),l=d.slice(2,b?d.length-7:void 0),E=s[ir]||null,E=E!=null?E[d]:null,typeof E=="function"&&s.removeEventListener(l,E,b),typeof m=="function")){typeof E!="function"&&E!==null&&(d in s?s[d]=null:s.hasAttribute(d)&&s.removeAttribute(d)),s.addEventListener(l,m,b);break e}d in s?s[d]=m:m===!0?s.setAttribute(d,""):ld(s,d,m)}}}function Pn(s,l,d){switch(l){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Et("error",s),Et("load",s);var m=!1,b=!1,E;for(E in d)if(d.hasOwnProperty(E)){var A=d[E];if(A!=null)switch(E){case"src":m=!0;break;case"srcSet":b=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,l));default:qt(s,l,E,A,d,null)}}b&&qt(s,l,"srcSet",d.srcSet,d,null),m&&qt(s,l,"src",d.src,d,null);return;case"input":Et("invalid",s);var _=E=A=b=null,F=null,ie=null;for(m in d)if(d.hasOwnProperty(m)){var ge=d[m];if(ge!=null)switch(m){case"name":b=ge;break;case"type":A=ge;break;case"checked":F=ge;break;case"defaultChecked":ie=ge;break;case"value":E=ge;break;case"defaultValue":_=ge;break;case"children":case"dangerouslySetInnerHTML":if(ge!=null)throw Error(r(137,l));break;default:qt(s,l,m,ge,d,null)}}n1(s,E,_,F,ie,A,b,!1);return;case"select":Et("invalid",s),m=A=E=null;for(b in d)if(d.hasOwnProperty(b)&&(_=d[b],_!=null))switch(b){case"value":E=_;break;case"defaultValue":A=_;break;case"multiple":m=_;default:qt(s,l,b,_,d,null)}l=E,d=A,s.multiple=!!m,l!=null?Aa(s,!!m,l,!1):d!=null&&Aa(s,!!m,d,!0);return;case"textarea":Et("invalid",s),E=b=m=null;for(A in d)if(d.hasOwnProperty(A)&&(_=d[A],_!=null))switch(A){case"value":m=_;break;case"defaultValue":b=_;break;case"children":E=_;break;case"dangerouslySetInnerHTML":if(_!=null)throw Error(r(91));break;default:qt(s,l,A,_,d,null)}i1(s,m,b,E);return;case"option":for(F in d)d.hasOwnProperty(F)&&(m=d[F],m!=null)&&(F==="selected"?s.selected=m&&typeof m!="function"&&typeof m!="symbol":qt(s,l,F,m,d,null));return;case"dialog":Et("beforetoggle",s),Et("toggle",s),Et("cancel",s),Et("close",s);break;case"iframe":case"object":Et("load",s);break;case"video":case"audio":for(m=0;m<_c.length;m++)Et(_c[m],s);break;case"image":Et("error",s),Et("load",s);break;case"details":Et("toggle",s);break;case"embed":case"source":case"link":Et("error",s),Et("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ie in d)if(d.hasOwnProperty(ie)&&(m=d[ie],m!=null))switch(ie){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,l));default:qt(s,l,ie,m,d,null)}return;default:if(xm(l)){for(ge in d)d.hasOwnProperty(ge)&&(m=d[ge],m!==void 0&&oy(s,l,ge,m,d,void 0));return}}for(_ in d)d.hasOwnProperty(_)&&(m=d[_],m!=null&&qt(s,l,_,m,d,null))}function k_(s,l,d,m){switch(l){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var b=null,E=null,A=null,_=null,F=null,ie=null,ge=null;for(fe in d){var xe=d[fe];if(d.hasOwnProperty(fe)&&xe!=null)switch(fe){case"checked":break;case"value":break;case"defaultValue":F=xe;default:m.hasOwnProperty(fe)||qt(s,l,fe,null,m,xe)}}for(var se in m){var fe=m[se];if(xe=d[se],m.hasOwnProperty(se)&&(fe!=null||xe!=null))switch(se){case"type":E=fe;break;case"name":b=fe;break;case"checked":ie=fe;break;case"defaultChecked":ge=fe;break;case"value":A=fe;break;case"defaultValue":_=fe;break;case"children":case"dangerouslySetInnerHTML":if(fe!=null)throw Error(r(137,l));break;default:fe!==xe&&qt(s,l,se,fe,m,xe)}}ym(s,A,_,F,ie,ge,E,b);return;case"select":fe=A=_=se=null;for(E in d)if(F=d[E],d.hasOwnProperty(E)&&F!=null)switch(E){case"value":break;case"multiple":fe=F;default:m.hasOwnProperty(E)||qt(s,l,E,null,m,F)}for(b in m)if(E=m[b],F=d[b],m.hasOwnProperty(b)&&(E!=null||F!=null))switch(b){case"value":se=E;break;case"defaultValue":_=E;break;case"multiple":A=E;default:E!==F&&qt(s,l,b,E,m,F)}l=_,d=A,m=fe,se!=null?Aa(s,!!d,se,!1):!!m!=!!d&&(l!=null?Aa(s,!!d,l,!0):Aa(s,!!d,d?[]:"",!1));return;case"textarea":fe=se=null;for(_ in d)if(b=d[_],d.hasOwnProperty(_)&&b!=null&&!m.hasOwnProperty(_))switch(_){case"value":break;case"children":break;default:qt(s,l,_,null,m,b)}for(A in m)if(b=m[A],E=d[A],m.hasOwnProperty(A)&&(b!=null||E!=null))switch(A){case"value":se=b;break;case"defaultValue":fe=b;break;case"children":break;case"dangerouslySetInnerHTML":if(b!=null)throw Error(r(91));break;default:b!==E&&qt(s,l,A,b,m,E)}r1(s,se,fe);return;case"option":for(var Pe in d)se=d[Pe],d.hasOwnProperty(Pe)&&se!=null&&!m.hasOwnProperty(Pe)&&(Pe==="selected"?s.selected=!1:qt(s,l,Pe,null,m,se));for(F in m)se=m[F],fe=d[F],m.hasOwnProperty(F)&&se!==fe&&(se!=null||fe!=null)&&(F==="selected"?s.selected=se&&typeof se!="function"&&typeof se!="symbol":qt(s,l,F,se,m,fe));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var nt in d)se=d[nt],d.hasOwnProperty(nt)&&se!=null&&!m.hasOwnProperty(nt)&&qt(s,l,nt,null,m,se);for(ie in m)if(se=m[ie],fe=d[ie],m.hasOwnProperty(ie)&&se!==fe&&(se!=null||fe!=null))switch(ie){case"children":case"dangerouslySetInnerHTML":if(se!=null)throw Error(r(137,l));break;default:qt(s,l,ie,se,m,fe)}return;default:if(xm(l)){for(var Gt in d)se=d[Gt],d.hasOwnProperty(Gt)&&se!==void 0&&!m.hasOwnProperty(Gt)&&oy(s,l,Gt,void 0,m,se);for(ge in m)se=m[ge],fe=d[ge],!m.hasOwnProperty(ge)||se===fe||se===void 0&&fe===void 0||oy(s,l,ge,se,m,fe);return}}for(var Q in d)se=d[Q],d.hasOwnProperty(Q)&&se!=null&&!m.hasOwnProperty(Q)&&qt(s,l,Q,null,m,se);for(xe in m)se=m[xe],fe=d[xe],!m.hasOwnProperty(xe)||se===fe||se==null&&fe==null||qt(s,l,xe,se,m,fe)}function aE(s){switch(s){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function D_(){if(typeof performance.getEntriesByType=="function"){for(var s=0,l=0,d=performance.getEntriesByType("resource"),m=0;m<d.length;m++){var b=d[m],E=b.transferSize,A=b.initiatorType,_=b.duration;if(E&&_&&aE(A)){for(A=0,_=b.responseEnd,m+=1;m<d.length;m++){var F=d[m],ie=F.startTime;if(ie>_)break;var ge=F.transferSize,xe=F.initiatorType;ge&&aE(xe)&&(F=F.responseEnd,A+=ge*(F<_?1:(_-ie)/(F-ie)))}if(--m,l+=8*(E+A)/(b.duration/1e3),s++,10<s)break}}if(0<s)return l/s/1e6}return navigator.connection&&(s=navigator.connection.downlink,typeof s=="number")?s:5}var sy=null,ay=null;function af(s){return s.nodeType===9?s:s.ownerDocument}function lE(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function cE(s,l){if(s===0)switch(l){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&l==="foreignObject"?0:s}function ly(s,l){return s==="textarea"||s==="noscript"||typeof l.children=="string"||typeof l.children=="number"||typeof l.children=="bigint"||typeof l.dangerouslySetInnerHTML=="object"&&l.dangerouslySetInnerHTML!==null&&l.dangerouslySetInnerHTML.__html!=null}var cy=null;function O_(){var s=window.event;return s&&s.type==="popstate"?s===cy?!1:(cy=s,!0):(cy=null,!1)}var uE=typeof setTimeout=="function"?setTimeout:void 0,M_=typeof clearTimeout=="function"?clearTimeout:void 0,dE=typeof Promise=="function"?Promise:void 0,R_=typeof queueMicrotask=="function"?queueMicrotask:typeof dE<"u"?function(s){return dE.resolve(null).then(s).catch(j_)}:uE;function j_(s){setTimeout(function(){throw s})}function zo(s){return s==="head"}function fE(s,l){var d=l,m=0;do{var b=d.nextSibling;if(s.removeChild(d),b&&b.nodeType===8)if(d=b.data,d==="/$"||d==="/&"){if(m===0){s.removeChild(b),ol(l);return}m--}else if(d==="$"||d==="$?"||d==="$~"||d==="$!"||d==="&")m++;else if(d==="html")Pc(s.ownerDocument.documentElement);else if(d==="head"){d=s.ownerDocument.head,Pc(d);for(var E=d.firstChild;E;){var A=E.nextSibling,_=E.nodeName;E[tc]||_==="SCRIPT"||_==="STYLE"||_==="LINK"&&E.rel.toLowerCase()==="stylesheet"||d.removeChild(E),E=A}}else d==="body"&&Pc(s.ownerDocument.body);d=b}while(d);ol(l)}function hE(s,l){var d=s;s=0;do{var m=d.nextSibling;if(d.nodeType===1?l?(d._stashedDisplay=d.style.display,d.style.display="none"):(d.style.display=d._stashedDisplay||"",d.getAttribute("style")===""&&d.removeAttribute("style")):d.nodeType===3&&(l?(d._stashedText=d.nodeValue,d.nodeValue=""):d.nodeValue=d._stashedText||""),m&&m.nodeType===8)if(d=m.data,d==="/$"){if(s===0)break;s--}else d!=="$"&&d!=="$?"&&d!=="$~"&&d!=="$!"||s++;d=m}while(d)}function uy(s){var l=s.firstChild;for(l&&l.nodeType===10&&(l=l.nextSibling);l;){var d=l;switch(l=l.nextSibling,d.nodeName){case"HTML":case"HEAD":case"BODY":uy(d),mm(d);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(d.rel.toLowerCase()==="stylesheet")continue}s.removeChild(d)}}function I_(s,l,d,m){for(;s.nodeType===1;){var b=d;if(s.nodeName.toLowerCase()!==l.toLowerCase()){if(!m&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(m){if(!s[tc])switch(l){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(E=s.getAttribute("rel"),E==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(E!==b.rel||s.getAttribute("href")!==(b.href==null||b.href===""?null:b.href)||s.getAttribute("crossorigin")!==(b.crossOrigin==null?null:b.crossOrigin)||s.getAttribute("title")!==(b.title==null?null:b.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(E=s.getAttribute("src"),(E!==(b.src==null?null:b.src)||s.getAttribute("type")!==(b.type==null?null:b.type)||s.getAttribute("crossorigin")!==(b.crossOrigin==null?null:b.crossOrigin))&&E&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(l==="input"&&s.type==="hidden"){var E=b.name==null?null:""+b.name;if(b.type==="hidden"&&s.getAttribute("name")===E)return s}else return s;if(s=Pr(s.nextSibling),s===null)break}return null}function __(s,l,d){if(l==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!d||(s=Pr(s.nextSibling),s===null))return null;return s}function pE(s,l){for(;s.nodeType!==8;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!l||(s=Pr(s.nextSibling),s===null))return null;return s}function dy(s){return s.data==="$?"||s.data==="$~"}function fy(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState!=="loading"}function L_(s,l){var d=s.ownerDocument;if(s.data==="$~")s._reactRetry=l;else if(s.data!=="$?"||d.readyState!=="loading")l();else{var m=function(){l(),d.removeEventListener("DOMContentLoaded",m)};d.addEventListener("DOMContentLoaded",m),s._reactRetry=m}}function Pr(s){for(;s!=null;s=s.nextSibling){var l=s.nodeType;if(l===1||l===3)break;if(l===8){if(l=s.data,l==="$"||l==="$!"||l==="$?"||l==="$~"||l==="&"||l==="F!"||l==="F")break;if(l==="/$"||l==="/&")return null}}return s}var hy=null;function mE(s){s=s.nextSibling;for(var l=0;s;){if(s.nodeType===8){var d=s.data;if(d==="/$"||d==="/&"){if(l===0)return Pr(s.nextSibling);l--}else d!=="$"&&d!=="$!"&&d!=="$?"&&d!=="$~"&&d!=="&"||l++}s=s.nextSibling}return null}function gE(s){s=s.previousSibling;for(var l=0;s;){if(s.nodeType===8){var d=s.data;if(d==="$"||d==="$!"||d==="$?"||d==="$~"||d==="&"){if(l===0)return s;l--}else d!=="/$"&&d!=="/&"||l++}s=s.previousSibling}return null}function yE(s,l,d){switch(l=af(d),s){case"html":if(s=l.documentElement,!s)throw Error(r(452));return s;case"head":if(s=l.head,!s)throw Error(r(453));return s;case"body":if(s=l.body,!s)throw Error(r(454));return s;default:throw Error(r(451))}}function Pc(s){for(var l=s.attributes;l.length;)s.removeAttributeNode(l[0]);mm(s)}var zr=new Map,vE=new Set;function lf(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var Ji=$.d;$.d={f:P_,r:z_,D:B_,C:F_,L:$_,m:H_,X:V_,S:U_,M:q_};function P_(){var s=Ji.f(),l=Qd();return s||l}function z_(s){var l=Ca(s);l!==null&&l.tag===5&&l.type==="form"?_w(l):Ji.r(s)}var nl=typeof document>"u"?null:document;function xE(s,l,d){var m=nl;if(m&&typeof l=="string"&&l){var b=Or(l);b='link[rel="'+s+'"][href="'+b+'"]',typeof d=="string"&&(b+='[crossorigin="'+d+'"]'),vE.has(b)||(vE.add(b),s={rel:s,crossOrigin:d,href:l},m.querySelector(b)===null&&(l=m.createElement("link"),Pn(l,"link",s),Nn(l),m.head.appendChild(l)))}}function B_(s){Ji.D(s),xE("dns-prefetch",s,null)}function F_(s,l){Ji.C(s,l),xE("preconnect",s,l)}function $_(s,l,d){Ji.L(s,l,d);var m=nl;if(m&&s&&l){var b='link[rel="preload"][as="'+Or(l)+'"]';l==="image"&&d&&d.imageSrcSet?(b+='[imagesrcset="'+Or(d.imageSrcSet)+'"]',typeof d.imageSizes=="string"&&(b+='[imagesizes="'+Or(d.imageSizes)+'"]')):b+='[href="'+Or(s)+'"]';var E=b;switch(l){case"style":E=rl(s);break;case"script":E=il(s)}zr.has(E)||(s=g({rel:"preload",href:l==="image"&&d&&d.imageSrcSet?void 0:s,as:l},d),zr.set(E,s),m.querySelector(b)!==null||l==="style"&&m.querySelector(zc(E))||l==="script"&&m.querySelector(Bc(E))||(l=m.createElement("link"),Pn(l,"link",s),Nn(l),m.head.appendChild(l)))}}function H_(s,l){Ji.m(s,l);var d=nl;if(d&&s){var m=l&&typeof l.as=="string"?l.as:"script",b='link[rel="modulepreload"][as="'+Or(m)+'"][href="'+Or(s)+'"]',E=b;switch(m){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":E=il(s)}if(!zr.has(E)&&(s=g({rel:"modulepreload",href:s},l),zr.set(E,s),d.querySelector(b)===null)){switch(m){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(d.querySelector(Bc(E)))return}m=d.createElement("link"),Pn(m,"link",s),Nn(m),d.head.appendChild(m)}}}function U_(s,l,d){Ji.S(s,l,d);var m=nl;if(m&&s){var b=Ta(m).hoistableStyles,E=rl(s);l=l||"default";var A=b.get(E);if(!A){var _={loading:0,preload:null};if(A=m.querySelector(zc(E)))_.loading=5;else{s=g({rel:"stylesheet",href:s,"data-precedence":l},d),(d=zr.get(E))&&py(s,d);var F=A=m.createElement("link");Nn(F),Pn(F,"link",s),F._p=new Promise(function(ie,ge){F.onload=ie,F.onerror=ge}),F.addEventListener("load",function(){_.loading|=1}),F.addEventListener("error",function(){_.loading|=2}),_.loading|=4,cf(A,l,m)}A={type:"stylesheet",instance:A,count:1,state:_},b.set(E,A)}}}function V_(s,l){Ji.X(s,l);var d=nl;if(d&&s){var m=Ta(d).hoistableScripts,b=il(s),E=m.get(b);E||(E=d.querySelector(Bc(b)),E||(s=g({src:s,async:!0},l),(l=zr.get(b))&&my(s,l),E=d.createElement("script"),Nn(E),Pn(E,"link",s),d.head.appendChild(E)),E={type:"script",instance:E,count:1,state:null},m.set(b,E))}}function q_(s,l){Ji.M(s,l);var d=nl;if(d&&s){var m=Ta(d).hoistableScripts,b=il(s),E=m.get(b);E||(E=d.querySelector(Bc(b)),E||(s=g({src:s,async:!0,type:"module"},l),(l=zr.get(b))&&my(s,l),E=d.createElement("script"),Nn(E),Pn(E,"link",s),d.head.appendChild(E)),E={type:"script",instance:E,count:1,state:null},m.set(b,E))}}function bE(s,l,d,m){var b=(b=be.current)?lf(b):null;if(!b)throw Error(r(446));switch(s){case"meta":case"title":return null;case"style":return typeof d.precedence=="string"&&typeof d.href=="string"?(l=rl(d.href),d=Ta(b).hoistableStyles,m=d.get(l),m||(m={type:"style",instance:null,count:0,state:null},d.set(l,m)),m):{type:"void",instance:null,count:0,state:null};case"link":if(d.rel==="stylesheet"&&typeof d.href=="string"&&typeof d.precedence=="string"){s=rl(d.href);var E=Ta(b).hoistableStyles,A=E.get(s);if(A||(b=b.ownerDocument||b,A={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},E.set(s,A),(E=b.querySelector(zc(s)))&&!E._p&&(A.instance=E,A.state.loading=5),zr.has(s)||(d={rel:"preload",as:"style",href:d.href,crossOrigin:d.crossOrigin,integrity:d.integrity,media:d.media,hrefLang:d.hrefLang,referrerPolicy:d.referrerPolicy},zr.set(s,d),E||G_(b,s,d,A.state))),l&&m===null)throw Error(r(528,""));return A}if(l&&m!==null)throw Error(r(529,""));return null;case"script":return l=d.async,d=d.src,typeof d=="string"&&l&&typeof l!="function"&&typeof l!="symbol"?(l=il(d),d=Ta(b).hoistableScripts,m=d.get(l),m||(m={type:"script",instance:null,count:0,state:null},d.set(l,m)),m):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,s))}}function rl(s){return'href="'+Or(s)+'"'}function zc(s){return'link[rel="stylesheet"]['+s+"]"}function wE(s){return g({},s,{"data-precedence":s.precedence,precedence:null})}function G_(s,l,d,m){s.querySelector('link[rel="preload"][as="style"]['+l+"]")?m.loading=1:(l=s.createElement("link"),m.preload=l,l.addEventListener("load",function(){return m.loading|=1}),l.addEventListener("error",function(){return m.loading|=2}),Pn(l,"link",d),Nn(l),s.head.appendChild(l))}function il(s){return'[src="'+Or(s)+'"]'}function Bc(s){return"script[async]"+s}function SE(s,l,d){if(l.count++,l.instance===null)switch(l.type){case"style":var m=s.querySelector('style[data-href~="'+Or(d.href)+'"]');if(m)return l.instance=m,Nn(m),m;var b=g({},d,{"data-href":d.href,"data-precedence":d.precedence,href:null,precedence:null});return m=(s.ownerDocument||s).createElement("style"),Nn(m),Pn(m,"style",b),cf(m,d.precedence,s),l.instance=m;case"stylesheet":b=rl(d.href);var E=s.querySelector(zc(b));if(E)return l.state.loading|=4,l.instance=E,Nn(E),E;m=wE(d),(b=zr.get(b))&&py(m,b),E=(s.ownerDocument||s).createElement("link"),Nn(E);var A=E;return A._p=new Promise(function(_,F){A.onload=_,A.onerror=F}),Pn(E,"link",m),l.state.loading|=4,cf(E,d.precedence,s),l.instance=E;case"script":return E=il(d.src),(b=s.querySelector(Bc(E)))?(l.instance=b,Nn(b),b):(m=d,(b=zr.get(E))&&(m=g({},d),my(m,b)),s=s.ownerDocument||s,b=s.createElement("script"),Nn(b),Pn(b,"link",m),s.head.appendChild(b),l.instance=b);case"void":return null;default:throw Error(r(443,l.type))}else l.type==="stylesheet"&&(l.state.loading&4)===0&&(m=l.instance,l.state.loading|=4,cf(m,d.precedence,s));return l.instance}function cf(s,l,d){for(var m=d.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),b=m.length?m[m.length-1]:null,E=b,A=0;A<m.length;A++){var _=m[A];if(_.dataset.precedence===l)E=_;else if(E!==b)break}E?E.parentNode.insertBefore(s,E.nextSibling):(l=d.nodeType===9?d.head:d,l.insertBefore(s,l.firstChild))}function py(s,l){s.crossOrigin==null&&(s.crossOrigin=l.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=l.referrerPolicy),s.title==null&&(s.title=l.title)}function my(s,l){s.crossOrigin==null&&(s.crossOrigin=l.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=l.referrerPolicy),s.integrity==null&&(s.integrity=l.integrity)}var uf=null;function EE(s,l,d){if(uf===null){var m=new Map,b=uf=new Map;b.set(d,m)}else b=uf,m=b.get(d),m||(m=new Map,b.set(d,m));if(m.has(s))return m;for(m.set(s,null),d=d.getElementsByTagName(s),b=0;b<d.length;b++){var E=d[b];if(!(E[tc]||E[jn]||s==="link"&&E.getAttribute("rel")==="stylesheet")&&E.namespaceURI!=="http://www.w3.org/2000/svg"){var A=E.getAttribute(l)||"";A=s+A;var _=m.get(A);_?_.push(E):m.set(A,[E])}}return m}function CE(s,l,d){s=s.ownerDocument||s,s.head.insertBefore(d,l==="title"?s.querySelector("head > title"):null)}function W_(s,l,d){if(d===1||l.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof l.precedence!="string"||typeof l.href!="string"||l.href==="")break;return!0;case"link":if(typeof l.rel!="string"||typeof l.href!="string"||l.href===""||l.onLoad||l.onError)break;return l.rel==="stylesheet"?(s=l.disabled,typeof l.precedence=="string"&&s==null):!0;case"script":if(l.async&&typeof l.async!="function"&&typeof l.async!="symbol"&&!l.onLoad&&!l.onError&&l.src&&typeof l.src=="string")return!0}return!1}function TE(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}function Y_(s,l,d,m){if(d.type==="stylesheet"&&(typeof m.media!="string"||matchMedia(m.media).matches!==!1)&&(d.state.loading&4)===0){if(d.instance===null){var b=rl(m.href),E=l.querySelector(zc(b));if(E){l=E._p,l!==null&&typeof l=="object"&&typeof l.then=="function"&&(s.count++,s=df.bind(s),l.then(s,s)),d.state.loading|=4,d.instance=E,Nn(E);return}E=l.ownerDocument||l,m=wE(m),(b=zr.get(b))&&py(m,b),E=E.createElement("link"),Nn(E);var A=E;A._p=new Promise(function(_,F){A.onload=_,A.onerror=F}),Pn(E,"link",m),d.instance=E}s.stylesheets===null&&(s.stylesheets=new Map),s.stylesheets.set(d,l),(l=d.state.preload)&&(d.state.loading&3)===0&&(s.count++,d=df.bind(s),l.addEventListener("load",d),l.addEventListener("error",d))}}var gy=0;function K_(s,l){return s.stylesheets&&s.count===0&&hf(s,s.stylesheets),0<s.count||0<s.imgCount?function(d){var m=setTimeout(function(){if(s.stylesheets&&hf(s,s.stylesheets),s.unsuspend){var E=s.unsuspend;s.unsuspend=null,E()}},6e4+l);0<s.imgBytes&&gy===0&&(gy=62500*D_());var b=setTimeout(function(){if(s.waitingForImages=!1,s.count===0&&(s.stylesheets&&hf(s,s.stylesheets),s.unsuspend)){var E=s.unsuspend;s.unsuspend=null,E()}},(s.imgBytes>gy?50:800)+l);return s.unsuspend=d,function(){s.unsuspend=null,clearTimeout(m),clearTimeout(b)}}:null}function df(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)hf(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var ff=null;function hf(s,l){s.stylesheets=null,s.unsuspend!==null&&(s.count++,ff=new Map,l.forEach(X_,s),ff=null,df.call(s))}function X_(s,l){if(!(l.state.loading&4)){var d=ff.get(s);if(d)var m=d.get(null);else{d=new Map,ff.set(s,d);for(var b=s.querySelectorAll("link[data-precedence],style[data-precedence]"),E=0;E<b.length;E++){var A=b[E];(A.nodeName==="LINK"||A.getAttribute("media")!=="not all")&&(d.set(A.dataset.precedence,A),m=A)}m&&d.set(null,m)}b=l.instance,A=b.getAttribute("data-precedence"),E=d.get(A)||m,E===m&&d.set(null,b),d.set(A,b),this.count++,m=df.bind(this),b.addEventListener("load",m),b.addEventListener("error",m),E?E.parentNode.insertBefore(b,E.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(b,s.firstChild)),l.state.loading|=4}}var Fc={$$typeof:k,Provider:null,Consumer:null,_currentValue:V,_currentValue2:V,_threadCount:0};function J_(s,l,d,m,b,E,A,_,F){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=xo(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=xo(0),this.hiddenUpdates=xo(null),this.identifierPrefix=m,this.onUncaughtError=b,this.onCaughtError=E,this.onRecoverableError=A,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=F,this.incompleteTransitions=new Map}function NE(s,l,d,m,b,E,A,_,F,ie,ge,xe){return s=new J_(s,l,d,A,F,ie,ge,xe,_),l=1,E===!0&&(l|=24),E=gr(3,null,null,l),s.current=E,E.stateNode=s,l=Km(),l.refCount++,s.pooledCache=l,l.refCount++,E.memoizedState={element:m,isDehydrated:d,cache:l},Zm(E),s}function AE(s){return s?(s=_a,s):_a}function kE(s,l,d,m,b,E){b=AE(b),m.context===null?m.context=b:m.pendingContext=b,m=Ao(l),m.payload={element:d},E=E===void 0?null:E,E!==null&&(m.callback=E),d=ko(s,m,l),d!==null&&(ur(d,s,l),vc(d,s,l))}function DE(s,l){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var d=s.retryLane;s.retryLane=d!==0&&d<l?d:l}}function yy(s,l){DE(s,l),(s=s.alternate)&&DE(s,l)}function OE(s){if(s.tag===13||s.tag===31){var l=Ms(s,67108864);l!==null&&ur(l,s,67108864),yy(s,67108864)}}function ME(s){if(s.tag===13||s.tag===31){var l=wr();l=wa(l);var d=Ms(s,l);d!==null&&ur(d,s,l),yy(s,l)}}var pf=!0;function Q_(s,l,d,m){var b=L.T;L.T=null;var E=$.p;try{$.p=2,vy(s,l,d,m)}finally{$.p=E,L.T=b}}function Z_(s,l,d,m){var b=L.T;L.T=null;var E=$.p;try{$.p=8,vy(s,l,d,m)}finally{$.p=E,L.T=b}}function vy(s,l,d,m){if(pf){var b=xy(m);if(b===null)iy(s,l,m,mf,d),jE(s,m);else if(tL(b,s,l,d,m))m.stopPropagation();else if(jE(s,m),l&4&&-1<eL.indexOf(s)){for(;b!==null;){var E=Ca(b);if(E!==null)switch(E.tag){case 3:if(E=E.stateNode,E.current.memoizedState.isDehydrated){var A=We(E.pendingLanes);if(A!==0){var _=E;for(_.pendingLanes|=2,_.entangledLanes|=2;A;){var F=1<<31-Qe(A);_.entanglements[1]|=F,A&=~F}gi(E),(It&6)===0&&(Xd=Ye()+500,Ic(0))}}break;case 31:case 13:_=Ms(E,2),_!==null&&ur(_,E,2),Qd(),yy(E,2)}if(E=xy(m),E===null&&iy(s,l,m,mf,d),E===b)break;b=E}b!==null&&m.stopPropagation()}else iy(s,l,m,null,d)}}function xy(s){return s=wm(s),by(s)}var mf=null;function by(s){if(mf=null,s=Ea(s),s!==null){var l=o(s);if(l===null)s=null;else{var d=l.tag;if(d===13){if(s=a(l),s!==null)return s;s=null}else if(d===31){if(s=c(l),s!==null)return s;s=null}else if(d===3){if(l.stateNode.current.memoizedState.isDehydrated)return l.tag===3?l.stateNode.containerInfo:null;s=null}else l!==s&&(s=null)}}return mf=s,null}function RE(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(et()){case at:return 2;case ct:return 8;case ze:case He:return 32;case ke:return 268435456;default:return 32}default:return 32}}var wy=!1,Bo=null,Fo=null,$o=null,$c=new Map,Hc=new Map,Ho=[],eL="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function jE(s,l){switch(s){case"focusin":case"focusout":Bo=null;break;case"dragenter":case"dragleave":Fo=null;break;case"mouseover":case"mouseout":$o=null;break;case"pointerover":case"pointerout":$c.delete(l.pointerId);break;case"gotpointercapture":case"lostpointercapture":Hc.delete(l.pointerId)}}function Uc(s,l,d,m,b,E){return s===null||s.nativeEvent!==E?(s={blockedOn:l,domEventName:d,eventSystemFlags:m,nativeEvent:E,targetContainers:[b]},l!==null&&(l=Ca(l),l!==null&&OE(l)),s):(s.eventSystemFlags|=m,l=s.targetContainers,b!==null&&l.indexOf(b)===-1&&l.push(b),s)}function tL(s,l,d,m,b){switch(l){case"focusin":return Bo=Uc(Bo,s,l,d,m,b),!0;case"dragenter":return Fo=Uc(Fo,s,l,d,m,b),!0;case"mouseover":return $o=Uc($o,s,l,d,m,b),!0;case"pointerover":var E=b.pointerId;return $c.set(E,Uc($c.get(E)||null,s,l,d,m,b)),!0;case"gotpointercapture":return E=b.pointerId,Hc.set(E,Uc(Hc.get(E)||null,s,l,d,m,b)),!0}return!1}function IE(s){var l=Ea(s.target);if(l!==null){var d=o(l);if(d!==null){if(l=d.tag,l===13){if(l=a(d),l!==null){s.blockedOn=l,Y0(s.priority,function(){ME(d)});return}}else if(l===31){if(l=c(d),l!==null){s.blockedOn=l,Y0(s.priority,function(){ME(d)});return}}else if(l===3&&d.stateNode.current.memoizedState.isDehydrated){s.blockedOn=d.tag===3?d.stateNode.containerInfo:null;return}}}s.blockedOn=null}function gf(s){if(s.blockedOn!==null)return!1;for(var l=s.targetContainers;0<l.length;){var d=xy(s.nativeEvent);if(d===null){d=s.nativeEvent;var m=new d.constructor(d.type,d);bm=m,d.target.dispatchEvent(m),bm=null}else return l=Ca(d),l!==null&&OE(l),s.blockedOn=d,!1;l.shift()}return!0}function _E(s,l,d){gf(s)&&d.delete(l)}function nL(){wy=!1,Bo!==null&&gf(Bo)&&(Bo=null),Fo!==null&&gf(Fo)&&(Fo=null),$o!==null&&gf($o)&&($o=null),$c.forEach(_E),Hc.forEach(_E)}function yf(s,l){s.blockedOn===l&&(s.blockedOn=null,wy||(wy=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,nL)))}var vf=null;function LE(s){vf!==s&&(vf=s,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){vf===s&&(vf=null);for(var l=0;l<s.length;l+=3){var d=s[l],m=s[l+1],b=s[l+2];if(typeof m!="function"){if(by(m||d)===null)continue;break}var E=Ca(d);E!==null&&(s.splice(l,3),l-=3,xg(E,{pending:!0,data:b,method:d.method,action:m},m,b))}}))}function ol(s){function l(F){return yf(F,s)}Bo!==null&&yf(Bo,s),Fo!==null&&yf(Fo,s),$o!==null&&yf($o,s),$c.forEach(l),Hc.forEach(l);for(var d=0;d<Ho.length;d++){var m=Ho[d];m.blockedOn===s&&(m.blockedOn=null)}for(;0<Ho.length&&(d=Ho[0],d.blockedOn===null);)IE(d),d.blockedOn===null&&Ho.shift();if(d=(s.ownerDocument||s).$$reactFormReplay,d!=null)for(m=0;m<d.length;m+=3){var b=d[m],E=d[m+1],A=b[ir]||null;if(typeof E=="function")A||LE(d);else if(A){var _=null;if(E&&E.hasAttribute("formAction")){if(b=E,A=E[ir]||null)_=A.formAction;else if(by(b)!==null)continue}else _=A.action;typeof _=="function"?d[m+1]=_:(d.splice(m,3),m-=3),LE(d)}}}function PE(){function s(E){E.canIntercept&&E.info==="react-transition"&&E.intercept({handler:function(){return new Promise(function(A){return b=A})},focusReset:"manual",scroll:"manual"})}function l(){b!==null&&(b(),b=null),m||setTimeout(d,20)}function d(){if(!m&&!navigation.transition){var E=navigation.currentEntry;E&&E.url!=null&&navigation.navigate(E.url,{state:E.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var m=!1,b=null;return navigation.addEventListener("navigate",s),navigation.addEventListener("navigatesuccess",l),navigation.addEventListener("navigateerror",l),setTimeout(d,100),function(){m=!0,navigation.removeEventListener("navigate",s),navigation.removeEventListener("navigatesuccess",l),navigation.removeEventListener("navigateerror",l),b!==null&&(b(),b=null)}}}function Sy(s){this._internalRoot=s}xf.prototype.render=Sy.prototype.render=function(s){var l=this._internalRoot;if(l===null)throw Error(r(409));var d=l.current,m=wr();kE(d,m,s,l,null,null)},xf.prototype.unmount=Sy.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var l=s.containerInfo;kE(s.current,2,null,s,null,null),Qd(),l[Sa]=null}};function xf(s){this._internalRoot=s}xf.prototype.unstable_scheduleHydration=function(s){if(s){var l=hm();s={blockedOn:null,target:s,priority:l};for(var d=0;d<Ho.length&&l!==0&&l<Ho[d].priority;d++);Ho.splice(d,0,s),d===0&&IE(s)}};var zE=e.version;if(zE!=="19.2.4")throw Error(r(527,zE,"19.2.4"));$.findDOMNode=function(s){var l=s._reactInternals;if(l===void 0)throw typeof s.render=="function"?Error(r(188)):(s=Object.keys(s).join(","),Error(r(268,s)));return s=f(l),s=s!==null?p(s):null,s=s===null?null:s.stateNode,s};var rL={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:L,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var bf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!bf.isDisabled&&bf.supportsFiber)try{pt=bf.inject(rL),Ke=bf}catch{}}return qc.createRoot=function(s,l){if(!i(s))throw Error(r(299));var d=!1,m="",b=qw,E=Gw,A=Ww;return l!=null&&(l.unstable_strictMode===!0&&(d=!0),l.identifierPrefix!==void 0&&(m=l.identifierPrefix),l.onUncaughtError!==void 0&&(b=l.onUncaughtError),l.onCaughtError!==void 0&&(E=l.onCaughtError),l.onRecoverableError!==void 0&&(A=l.onRecoverableError)),l=NE(s,1,!1,null,null,d,m,null,b,E,A,PE),s[Sa]=l.current,ry(s),new Sy(l)},qc.hydrateRoot=function(s,l,d){if(!i(s))throw Error(r(299));var m=!1,b="",E=qw,A=Gw,_=Ww,F=null;return d!=null&&(d.unstable_strictMode===!0&&(m=!0),d.identifierPrefix!==void 0&&(b=d.identifierPrefix),d.onUncaughtError!==void 0&&(E=d.onUncaughtError),d.onCaughtError!==void 0&&(A=d.onCaughtError),d.onRecoverableError!==void 0&&(_=d.onRecoverableError),d.formState!==void 0&&(F=d.formState)),l=NE(s,1,!0,l,d??null,m,b,F,E,A,_,PE),l.context=AE(null),d=l.current,m=wr(),m=wa(m),b=Ao(m),b.callback=null,ko(d,b,m),d=m,l.current.lanes=d,on(l,d),gi(l),s[Sa]=l.current,ry(s),new xf(l)},qc.version="19.2.4",qc}var YE;function hL(){if(YE)return Ty.exports;YE=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),Ty.exports=fL(),Ty.exports}var pL=hL();const mL=Qx(pL),Ni=Object.create(null);Ni.open="0";Ni.close="1";Ni.ping="2";Ni.pong="3";Ni.message="4";Ni.upgrade="5";Ni.noop="6";const Jf=Object.create(null);Object.keys(Ni).forEach(t=>{Jf[Ni[t]]=t});const _v={type:"error",data:"parser error"},yA=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",vA=typeof ArrayBuffer=="function",xA=t=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(t):t&&t.buffer instanceof ArrayBuffer,eb=({type:t,data:e},n,r)=>yA&&e instanceof Blob?n?r(e):KE(e,r):vA&&(e instanceof ArrayBuffer||xA(e))?n?r(e):KE(new Blob([e]),r):r(Ni[t]+(e||"")),KE=(t,e)=>{const n=new FileReader;return n.onload=function(){const r=n.result.split(",")[1];e("b"+(r||""))},n.readAsDataURL(t)};function XE(t){return t instanceof Uint8Array?t:t instanceof ArrayBuffer?new Uint8Array(t):new Uint8Array(t.buffer,t.byteOffset,t.byteLength)}let Dy;function gL(t,e){if(yA&&t.data instanceof Blob)return t.data.arrayBuffer().then(XE).then(e);if(vA&&(t.data instanceof ArrayBuffer||xA(t.data)))return e(XE(t.data));eb(t,!1,n=>{Dy||(Dy=new TextEncoder),e(Dy.encode(n))})}const JE="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",nu=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let t=0;t<JE.length;t++)nu[JE.charCodeAt(t)]=t;const yL=t=>{let e=t.length*.75,n=t.length,r,i=0,o,a,c,u;t[t.length-1]==="="&&(e--,t[t.length-2]==="="&&e--);const f=new ArrayBuffer(e),p=new Uint8Array(f);for(r=0;r<n;r+=4)o=nu[t.charCodeAt(r)],a=nu[t.charCodeAt(r+1)],c=nu[t.charCodeAt(r+2)],u=nu[t.charCodeAt(r+3)],p[i++]=o<<2|a>>4,p[i++]=(a&15)<<4|c>>2,p[i++]=(c&3)<<6|u&63;return f},vL=typeof ArrayBuffer=="function",tb=(t,e)=>{if(typeof t!="string")return{type:"message",data:bA(t,e)};const n=t.charAt(0);return n==="b"?{type:"message",data:xL(t.substring(1),e)}:Jf[n]?t.length>1?{type:Jf[n],data:t.substring(1)}:{type:Jf[n]}:_v},xL=(t,e)=>{if(vL){const n=yL(t);return bA(n,e)}else return{base64:!0,data:t}},bA=(t,e)=>e==="blob"?t instanceof Blob?t:new Blob([t]):t instanceof ArrayBuffer?t:t.buffer,wA="",bL=(t,e)=>{const n=t.length,r=new Array(n);let i=0;t.forEach((o,a)=>{eb(o,!1,c=>{r[a]=c,++i===n&&e(r.join(wA))})})},wL=(t,e)=>{const n=t.split(wA),r=[];for(let i=0;i<n.length;i++){const o=tb(n[i],e);if(r.push(o),o.type==="error")break}return r};function SL(){return new TransformStream({transform(t,e){gL(t,n=>{const r=n.length;let i;if(r<126)i=new Uint8Array(1),new DataView(i.buffer).setUint8(0,r);else if(r<65536){i=new Uint8Array(3);const o=new DataView(i.buffer);o.setUint8(0,126),o.setUint16(1,r)}else{i=new Uint8Array(9);const o=new DataView(i.buffer);o.setUint8(0,127),o.setBigUint64(1,BigInt(r))}t.data&&typeof t.data!="string"&&(i[0]|=128),e.enqueue(i),e.enqueue(n)})}})}let Oy;function wf(t){return t.reduce((e,n)=>e+n.length,0)}function Sf(t,e){if(t[0].length===e)return t.shift();const n=new Uint8Array(e);let r=0;for(let i=0;i<e;i++)n[i]=t[0][r++],r===t[0].length&&(t.shift(),r=0);return t.length&&r<t[0].length&&(t[0]=t[0].slice(r)),n}function EL(t,e){Oy||(Oy=new TextDecoder);const n=[];let r=0,i=-1,o=!1;return new TransformStream({transform(a,c){for(n.push(a);;){if(r===0){if(wf(n)<1)break;const u=Sf(n,1);o=(u[0]&128)===128,i=u[0]&127,i<126?r=3:i===126?r=1:r=2}else if(r===1){if(wf(n)<2)break;const u=Sf(n,2);i=new DataView(u.buffer,u.byteOffset,u.length).getUint16(0),r=3}else if(r===2){if(wf(n)<8)break;const u=Sf(n,8),f=new DataView(u.buffer,u.byteOffset,u.length),p=f.getUint32(0);if(p>Math.pow(2,21)-1){c.enqueue(_v);break}i=p*Math.pow(2,32)+f.getUint32(4),r=3}else{if(wf(n)<i)break;const u=Sf(n,i);c.enqueue(tb(o?u:Oy.decode(u),e)),r=0}if(i===0||i>t){c.enqueue(_v);break}}}})}const SA=4;function xn(t){if(t)return CL(t)}function CL(t){for(var e in xn.prototype)t[e]=xn.prototype[e];return t}xn.prototype.on=xn.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this};xn.prototype.once=function(t,e){function n(){this.off(t,n),e.apply(this,arguments)}return n.fn=e,this.on(t,n),this};xn.prototype.off=xn.prototype.removeListener=xn.prototype.removeAllListeners=xn.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var n=this._callbacks["$"+t];if(!n)return this;if(arguments.length==1)return delete this._callbacks["$"+t],this;for(var r,i=0;i<n.length;i++)if(r=n[i],r===e||r.fn===e){n.splice(i,1);break}return n.length===0&&delete this._callbacks["$"+t],this};xn.prototype.emit=function(t){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),n=this._callbacks["$"+t],r=1;r<arguments.length;r++)e[r-1]=arguments[r];if(n){n=n.slice(0);for(var r=0,i=n.length;r<i;++r)n[r].apply(this,e)}return this};xn.prototype.emitReserved=xn.prototype.emit;xn.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]};xn.prototype.hasListeners=function(t){return!!this.listeners(t).length};const Sp=typeof Promise=="function"&&typeof Promise.resolve=="function"?e=>Promise.resolve().then(e):(e,n)=>n(e,0),Ur=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),TL="arraybuffer";function EA(t,...e){return e.reduce((n,r)=>(t.hasOwnProperty(r)&&(n[r]=t[r]),n),{})}const NL=Ur.setTimeout,AL=Ur.clearTimeout;function Ep(t,e){e.useNativeTimers?(t.setTimeoutFn=NL.bind(Ur),t.clearTimeoutFn=AL.bind(Ur)):(t.setTimeoutFn=Ur.setTimeout.bind(Ur),t.clearTimeoutFn=Ur.clearTimeout.bind(Ur))}const kL=1.33;function DL(t){return typeof t=="string"?OL(t):Math.ceil((t.byteLength||t.size)*kL)}function OL(t){let e=0,n=0;for(let r=0,i=t.length;r<i;r++)e=t.charCodeAt(r),e<128?n+=1:e<2048?n+=2:e<55296||e>=57344?n+=3:(r++,n+=4);return n}function CA(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function ML(t){let e="";for(let n in t)t.hasOwnProperty(n)&&(e.length&&(e+="&"),e+=encodeURIComponent(n)+"="+encodeURIComponent(t[n]));return e}function RL(t){let e={},n=t.split("&");for(let r=0,i=n.length;r<i;r++){let o=n[r].split("=");e[decodeURIComponent(o[0])]=decodeURIComponent(o[1])}return e}class jL extends Error{constructor(e,n,r){super(e),this.description=n,this.context=r,this.type="TransportError"}}class nb extends xn{constructor(e){super(),this.writable=!1,Ep(this,e),this.opts=e,this.query=e.query,this.socket=e.socket,this.supportsBinary=!e.forceBase64}onError(e,n,r){return super.emitReserved("error",new jL(e,n,r)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(e){this.readyState==="open"&&this.write(e)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){const n=tb(e,this.socket.binaryType);this.onPacket(n)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}pause(e){}createUri(e,n={}){return e+"://"+this._hostname()+this._port()+this.opts.path+this._query(n)}_hostname(){const e=this.opts.hostname;return e.indexOf(":")===-1?e:"["+e+"]"}_port(){return this.opts.port&&(this.opts.secure&&Number(this.opts.port)!==443||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(e){const n=ML(e);return n.length?"?"+n:""}}class IL extends nb{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(e){this.readyState="pausing";const n=()=>{this.readyState="paused",e()};if(this._polling||!this.writable){let r=0;this._polling&&(r++,this.once("pollComplete",function(){--r||n()})),this.writable||(r++,this.once("drain",function(){--r||n()}))}else n()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){const n=r=>{if(this.readyState==="opening"&&r.type==="open"&&this.onOpen(),r.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(r)};wL(e,this.socket.binaryType).forEach(n),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const e=()=>{this.write([{type:"close"}])};this.readyState==="open"?e():this.once("open",e)}write(e){this.writable=!1,bL(e,n=>{this.doWrite(n,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const e=this.opts.secure?"https":"http",n=this.query||{};return this.opts.timestampRequests!==!1&&(n[this.opts.timestampParam]=CA()),!this.supportsBinary&&!n.sid&&(n.b64=1),this.createUri(e,n)}}let TA=!1;try{TA=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const _L=TA;function LL(){}class PL extends IL{constructor(e){if(super(e),typeof location<"u"){const n=location.protocol==="https:";let r=location.port;r||(r=n?"443":"80"),this.xd=typeof location<"u"&&e.hostname!==location.hostname||r!==e.port}}doWrite(e,n){const r=this.request({method:"POST",data:e});r.on("success",n),r.on("error",(i,o)=>{this.onError("xhr post error",i,o)})}doPoll(){const e=this.request();e.on("data",this.onData.bind(this)),e.on("error",(n,r)=>{this.onError("xhr poll error",n,r)}),this.pollXhr=e}}class Ei extends xn{constructor(e,n,r){super(),this.createRequest=e,Ep(this,r),this._opts=r,this._method=r.method||"GET",this._uri=n,this._data=r.data!==void 0?r.data:null,this._create()}_create(){var e;const n=EA(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");n.xdomain=!!this._opts.xd;const r=this._xhr=this.createRequest(n);try{r.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){r.setDisableHeaderCheck&&r.setDisableHeaderCheck(!0);for(let i in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(i)&&r.setRequestHeader(i,this._opts.extraHeaders[i])}}catch{}if(this._method==="POST")try{r.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{r.setRequestHeader("Accept","*/*")}catch{}(e=this._opts.cookieJar)===null||e===void 0||e.addCookies(r),"withCredentials"in r&&(r.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(r.timeout=this._opts.requestTimeout),r.onreadystatechange=()=>{var i;r.readyState===3&&((i=this._opts.cookieJar)===null||i===void 0||i.parseCookies(r.getResponseHeader("set-cookie"))),r.readyState===4&&(r.status===200||r.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof r.status=="number"?r.status:0)},0))},r.send(this._data)}catch(i){this.setTimeoutFn(()=>{this._onError(i)},0);return}typeof document<"u"&&(this._index=Ei.requestsCount++,Ei.requests[this._index]=this)}_onError(e){this.emitReserved("error",e,this._xhr),this._cleanup(!0)}_cleanup(e){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=LL,e)try{this._xhr.abort()}catch{}typeof document<"u"&&delete Ei.requests[this._index],this._xhr=null}}_onLoad(){const e=this._xhr.responseText;e!==null&&(this.emitReserved("data",e),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}}Ei.requestsCount=0;Ei.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",QE);else if(typeof addEventListener=="function"){const t="onpagehide"in Ur?"pagehide":"unload";addEventListener(t,QE,!1)}}function QE(){for(let t in Ei.requests)Ei.requests.hasOwnProperty(t)&&Ei.requests[t].abort()}const zL=(function(){const t=NA({xdomain:!1});return t&&t.responseType!==null})();class BL extends PL{constructor(e){super(e);const n=e&&e.forceBase64;this.supportsBinary=zL&&!n}request(e={}){return Object.assign(e,{xd:this.xd},this.opts),new Ei(NA,this.uri(),e)}}function NA(t){const e=t.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!e||_L))return new XMLHttpRequest}catch{}if(!e)try{return new Ur[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const AA=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class FL extends nb{get name(){return"websocket"}doOpen(){const e=this.uri(),n=this.opts.protocols,r=AA?{}:EA(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(r.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(e,n,r)}catch(i){return this.emitReserved("error",i)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let n=0;n<e.length;n++){const r=e[n],i=n===e.length-1;eb(r,this.supportsBinary,o=>{try{this.doWrite(r,o)}catch{}i&&Sp(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const e=this.opts.secure?"wss":"ws",n=this.query||{};return this.opts.timestampRequests&&(n[this.opts.timestampParam]=CA()),this.supportsBinary||(n.b64=1),this.createUri(e,n)}}const My=Ur.WebSocket||Ur.MozWebSocket;let $L=class extends FL{createSocket(e,n,r){return AA?new My(e,n,r):n?new My(e,n):new My(e)}doWrite(e,n){this.ws.send(n)}};class HL extends nb{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(e){return this.emitReserved("error",e)}this._transport.closed.then(()=>{this.onClose()}).catch(e=>{this.onError("webtransport error",e)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(e=>{const n=EL(Number.MAX_SAFE_INTEGER,this.socket.binaryType),r=e.readable.pipeThrough(n).getReader(),i=SL();i.readable.pipeTo(e.writable),this._writer=i.writable.getWriter();const o=()=>{r.read().then(({done:c,value:u})=>{c||(this.onPacket(u),o())}).catch(c=>{})};o();const a={type:"open"};this.query.sid&&(a.data=`{"sid":"${this.query.sid}"}`),this._writer.write(a).then(()=>this.onOpen())})})}write(e){this.writable=!1;for(let n=0;n<e.length;n++){const r=e[n],i=n===e.length-1;this._writer.write(r).then(()=>{i&&Sp(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var e;(e=this._transport)===null||e===void 0||e.close()}}const UL={websocket:$L,webtransport:HL,polling:BL},VL=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,qL=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function Lv(t){if(t.length>8e3)throw"URI too long";const e=t,n=t.indexOf("["),r=t.indexOf("]");n!=-1&&r!=-1&&(t=t.substring(0,n)+t.substring(n,r).replace(/:/g,";")+t.substring(r,t.length));let i=VL.exec(t||""),o={},a=14;for(;a--;)o[qL[a]]=i[a]||"";return n!=-1&&r!=-1&&(o.source=e,o.host=o.host.substring(1,o.host.length-1).replace(/;/g,":"),o.authority=o.authority.replace("[","").replace("]","").replace(/;/g,":"),o.ipv6uri=!0),o.pathNames=GL(o,o.path),o.queryKey=WL(o,o.query),o}function GL(t,e){const n=/\/{2,9}/g,r=e.replace(n,"/").split("/");return(e.slice(0,1)=="/"||e.length===0)&&r.splice(0,1),e.slice(-1)=="/"&&r.splice(r.length-1,1),r}function WL(t,e){const n={};return e.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(r,i,o){i&&(n[i]=o)}),n}const Pv=typeof addEventListener=="function"&&typeof removeEventListener=="function",Qf=[];Pv&&addEventListener("offline",()=>{Qf.forEach(t=>t())},!1);class is extends xn{constructor(e,n){if(super(),this.binaryType=TL,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,e&&typeof e=="object"&&(n=e,e=null),e){const r=Lv(e);n.hostname=r.host,n.secure=r.protocol==="https"||r.protocol==="wss",n.port=r.port,r.query&&(n.query=r.query)}else n.host&&(n.hostname=Lv(n.host).host);Ep(this,n),this.secure=n.secure!=null?n.secure:typeof location<"u"&&location.protocol==="https:",n.hostname&&!n.port&&(n.port=this.secure?"443":"80"),this.hostname=n.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=n.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},n.transports.forEach(r=>{const i=r.prototype.name;this.transports.push(i),this._transportsByName[i]=r}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},n),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=RL(this.opts.query)),Pv&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},Qf.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(e){const n=Object.assign({},this.opts.query);n.EIO=SA,n.transport=e,this.id&&(n.sid=this.id);const r=Object.assign({},this.opts,{query:n,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[e]);return new this._transportsByName[e](r)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const e=this.opts.rememberUpgrade&&is.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const n=this.createTransport(e);n.open(),this.setTransport(n)}setTransport(e){this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",n=>this._onClose("transport close",n))}onOpen(){this.readyState="open",is.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(e){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const n=new Error("server error");n.code=e.data,this._onError(n);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data);break}}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this._pingInterval=e.pingInterval,this._pingTimeout=e.pingTimeout,this._maxPayload=e.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const e=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+e,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},e),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const e=this._getWritablePackets();this.transport.send(e),this._prevBufferLen=e.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let n=1;for(let r=0;r<this.writeBuffer.length;r++){const i=this.writeBuffer[r].data;if(i&&(n+=DL(i)),r>0&&n>this._maxPayload)return this.writeBuffer.slice(0,r);n+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const e=Date.now()>this._pingTimeoutTime;return e&&(this._pingTimeoutTime=0,Sp(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),e}write(e,n,r){return this._sendPacket("message",e,n,r),this}send(e,n,r){return this._sendPacket("message",e,n,r),this}_sendPacket(e,n,r,i){if(typeof n=="function"&&(i=n,n=void 0),typeof r=="function"&&(i=r,r=null),this.readyState==="closing"||this.readyState==="closed")return;r=r||{},r.compress=r.compress!==!1;const o={type:e,data:n,options:r};this.emitReserved("packetCreate",o),this.writeBuffer.push(o),i&&this.once("flush",i),this.flush()}close(){const e=()=>{this._onClose("forced close"),this.transport.close()},n=()=>{this.off("upgrade",n),this.off("upgradeError",n),e()},r=()=>{this.once("upgrade",n),this.once("upgradeError",n)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?r():e()}):this.upgrading?r():e()),this}_onError(e){if(is.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",e),this._onClose("transport error",e)}_onClose(e,n){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),Pv&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const r=Qf.indexOf(this._offlineEventListener);r!==-1&&Qf.splice(r,1)}this.readyState="closed",this.id=null,this.emitReserved("close",e,n),this.writeBuffer=[],this._prevBufferLen=0}}}is.protocol=SA;class YL extends is{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let e=0;e<this._upgrades.length;e++)this._probe(this._upgrades[e])}_probe(e){let n=this.createTransport(e),r=!1;is.priorWebsocketSuccess=!1;const i=()=>{r||(n.send([{type:"ping",data:"probe"}]),n.once("packet",g=>{if(!r)if(g.type==="pong"&&g.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",n),!n)return;is.priorWebsocketSuccess=n.name==="websocket",this.transport.pause(()=>{r||this.readyState!=="closed"&&(p(),this.setTransport(n),n.send([{type:"upgrade"}]),this.emitReserved("upgrade",n),n=null,this.upgrading=!1,this.flush())})}else{const v=new Error("probe error");v.transport=n.name,this.emitReserved("upgradeError",v)}}))};function o(){r||(r=!0,p(),n.close(),n=null)}const a=g=>{const v=new Error("probe error: "+g);v.transport=n.name,o(),this.emitReserved("upgradeError",v)};function c(){a("transport closed")}function u(){a("socket closed")}function f(g){n&&g.name!==n.name&&o()}const p=()=>{n.removeListener("open",i),n.removeListener("error",a),n.removeListener("close",c),this.off("close",u),this.off("upgrading",f)};n.once("open",i),n.once("error",a),n.once("close",c),this.once("close",u),this.once("upgrading",f),this._upgrades.indexOf("webtransport")!==-1&&e!=="webtransport"?this.setTimeoutFn(()=>{r||n.open()},200):n.open()}onHandshake(e){this._upgrades=this._filterUpgrades(e.upgrades),super.onHandshake(e)}_filterUpgrades(e){const n=[];for(let r=0;r<e.length;r++)~this.transports.indexOf(e[r])&&n.push(e[r]);return n}}let KL=class extends YL{constructor(e,n={}){const r=typeof e=="object"?e:n;(!r.transports||r.transports&&typeof r.transports[0]=="string")&&(r.transports=(r.transports||["polling","websocket","webtransport"]).map(i=>UL[i]).filter(i=>!!i)),super(e,r)}};function XL(t,e="",n){let r=t;n=n||typeof location<"u"&&location,t==null&&(t=n.protocol+"//"+n.host),typeof t=="string"&&(t.charAt(0)==="/"&&(t.charAt(1)==="/"?t=n.protocol+t:t=n.host+t),/^(https?|wss?):\/\//.test(t)||(typeof n<"u"?t=n.protocol+"//"+t:t="https://"+t),r=Lv(t)),r.port||(/^(http|ws)$/.test(r.protocol)?r.port="80":/^(http|ws)s$/.test(r.protocol)&&(r.port="443")),r.path=r.path||"/";const o=r.host.indexOf(":")!==-1?"["+r.host+"]":r.host;return r.id=r.protocol+"://"+o+":"+r.port+e,r.href=r.protocol+"://"+o+(n&&n.port===r.port?"":":"+r.port),r}const JL=typeof ArrayBuffer=="function",QL=t=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(t):t.buffer instanceof ArrayBuffer,kA=Object.prototype.toString,ZL=typeof Blob=="function"||typeof Blob<"u"&&kA.call(Blob)==="[object BlobConstructor]",eP=typeof File=="function"||typeof File<"u"&&kA.call(File)==="[object FileConstructor]";function rb(t){return JL&&(t instanceof ArrayBuffer||QL(t))||ZL&&t instanceof Blob||eP&&t instanceof File}function Zf(t,e){if(!t||typeof t!="object")return!1;if(Array.isArray(t)){for(let n=0,r=t.length;n<r;n++)if(Zf(t[n]))return!0;return!1}if(rb(t))return!0;if(t.toJSON&&typeof t.toJSON=="function"&&arguments.length===1)return Zf(t.toJSON(),!0);for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)&&Zf(t[n]))return!0;return!1}function tP(t){const e=[],n=t.data,r=t;return r.data=zv(n,e),r.attachments=e.length,{packet:r,buffers:e}}function zv(t,e){if(!t)return t;if(rb(t)){const n={_placeholder:!0,num:e.length};return e.push(t),n}else if(Array.isArray(t)){const n=new Array(t.length);for(let r=0;r<t.length;r++)n[r]=zv(t[r],e);return n}else if(typeof t=="object"&&!(t instanceof Date)){const n={};for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=zv(t[r],e));return n}return t}function nP(t,e){return t.data=Bv(t.data,e),delete t.attachments,t}function Bv(t,e){if(!t)return t;if(t&&t._placeholder===!0){if(typeof t.num=="number"&&t.num>=0&&t.num<e.length)return e[t.num];throw new Error("illegal attachments")}else if(Array.isArray(t))for(let n=0;n<t.length;n++)t[n]=Bv(t[n],e);else if(typeof t=="object")for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&(t[n]=Bv(t[n],e));return t}const rP=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"];var At;(function(t){t[t.CONNECT=0]="CONNECT",t[t.DISCONNECT=1]="DISCONNECT",t[t.EVENT=2]="EVENT",t[t.ACK=3]="ACK",t[t.CONNECT_ERROR=4]="CONNECT_ERROR",t[t.BINARY_EVENT=5]="BINARY_EVENT",t[t.BINARY_ACK=6]="BINARY_ACK"})(At||(At={}));class iP{constructor(e){this.replacer=e}encode(e){return(e.type===At.EVENT||e.type===At.ACK)&&Zf(e)?this.encodeAsBinary({type:e.type===At.EVENT?At.BINARY_EVENT:At.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id}):[this.encodeAsString(e)]}encodeAsString(e){let n=""+e.type;return(e.type===At.BINARY_EVENT||e.type===At.BINARY_ACK)&&(n+=e.attachments+"-"),e.nsp&&e.nsp!=="/"&&(n+=e.nsp+","),e.id!=null&&(n+=e.id),e.data!=null&&(n+=JSON.stringify(e.data,this.replacer)),n}encodeAsBinary(e){const n=tP(e),r=this.encodeAsString(n.packet),i=n.buffers;return i.unshift(r),i}}class ib extends xn{constructor(e){super(),this.reviver=e}add(e){let n;if(typeof e=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");n=this.decodeString(e);const r=n.type===At.BINARY_EVENT;r||n.type===At.BINARY_ACK?(n.type=r?At.EVENT:At.ACK,this.reconstructor=new oP(n),n.attachments===0&&super.emitReserved("decoded",n)):super.emitReserved("decoded",n)}else if(rb(e)||e.base64)if(this.reconstructor)n=this.reconstructor.takeBinaryData(e),n&&(this.reconstructor=null,super.emitReserved("decoded",n));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+e)}decodeString(e){let n=0;const r={type:Number(e.charAt(0))};if(At[r.type]===void 0)throw new Error("unknown packet type "+r.type);if(r.type===At.BINARY_EVENT||r.type===At.BINARY_ACK){const o=n+1;for(;e.charAt(++n)!=="-"&&n!=e.length;);const a=e.substring(o,n);if(a!=Number(a)||e.charAt(n)!=="-")throw new Error("Illegal attachments");r.attachments=Number(a)}if(e.charAt(n+1)==="/"){const o=n+1;for(;++n&&!(e.charAt(n)===","||n===e.length););r.nsp=e.substring(o,n)}else r.nsp="/";const i=e.charAt(n+1);if(i!==""&&Number(i)==i){const o=n+1;for(;++n;){const a=e.charAt(n);if(a==null||Number(a)!=a){--n;break}if(n===e.length)break}r.id=Number(e.substring(o,n+1))}if(e.charAt(++n)){const o=this.tryParse(e.substr(n));if(ib.isPayloadValid(r.type,o))r.data=o;else throw new Error("invalid payload")}return r}tryParse(e){try{return JSON.parse(e,this.reviver)}catch{return!1}}static isPayloadValid(e,n){switch(e){case At.CONNECT:return ZE(n);case At.DISCONNECT:return n===void 0;case At.CONNECT_ERROR:return typeof n=="string"||ZE(n);case At.EVENT:case At.BINARY_EVENT:return Array.isArray(n)&&(typeof n[0]=="number"||typeof n[0]=="string"&&rP.indexOf(n[0])===-1);case At.ACK:case At.BINARY_ACK:return Array.isArray(n)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class oP{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){const n=nP(this.reconPack,this.buffers);return this.finishedReconstruction(),n}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}function ZE(t){return Object.prototype.toString.call(t)==="[object Object]"}const sP=Object.freeze(Object.defineProperty({__proto__:null,Decoder:ib,Encoder:iP,get PacketType(){return At}},Symbol.toStringTag,{value:"Module"}));function ni(t,e,n){return t.on(e,n),function(){t.off(e,n)}}const aP=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class DA extends xn{constructor(e,n,r){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=n,r&&r.auth&&(this.auth=r.auth),this._opts=Object.assign({},r),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const e=this.io;this.subs=[ni(e,"open",this.onopen.bind(this)),ni(e,"packet",this.onpacket.bind(this)),ni(e,"error",this.onerror.bind(this)),ni(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...n){var r,i,o;if(aP.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');if(n.unshift(e),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(n),this;const a={type:At.EVENT,data:n};if(a.options={},a.options.compress=this.flags.compress!==!1,typeof n[n.length-1]=="function"){const p=this.ids++,g=n.pop();this._registerAckCallback(p,g),a.id=p}const c=(i=(r=this.io.engine)===null||r===void 0?void 0:r.transport)===null||i===void 0?void 0:i.writable,u=this.connected&&!(!((o=this.io.engine)===null||o===void 0)&&o._hasPingExpired());return this.flags.volatile&&!c||(u?(this.notifyOutgoingListeners(a),this.packet(a)):this.sendBuffer.push(a)),this.flags={},this}_registerAckCallback(e,n){var r;const i=(r=this.flags.timeout)!==null&&r!==void 0?r:this._opts.ackTimeout;if(i===void 0){this.acks[e]=n;return}const o=this.io.setTimeoutFn(()=>{delete this.acks[e];for(let c=0;c<this.sendBuffer.length;c++)this.sendBuffer[c].id===e&&this.sendBuffer.splice(c,1);n.call(this,new Error("operation has timed out"))},i),a=(...c)=>{this.io.clearTimeoutFn(o),n.apply(this,c)};a.withError=!0,this.acks[e]=a}emitWithAck(e,...n){return new Promise((r,i)=>{const o=(a,c)=>a?i(a):r(c);o.withError=!0,n.push(o),this.emit(e,...n)})}_addToQueue(e){let n;typeof e[e.length-1]=="function"&&(n=e.pop());const r={id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:Object.assign({fromQueue:!0},this.flags)};e.push((i,...o)=>(this._queue[0],i!==null?r.tryCount>this._opts.retries&&(this._queue.shift(),n&&n(i)):(this._queue.shift(),n&&n(null,...o)),r.pending=!1,this._drainQueue())),this._queue.push(r),this._drainQueue()}_drainQueue(e=!1){if(!this.connected||this._queue.length===0)return;const n=this._queue[0];n.pending&&!e||(n.pending=!0,n.tryCount++,this.flags=n.flags,this.emit.apply(this,n.args))}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){typeof this.auth=="function"?this.auth(e=>{this._sendConnectPacket(e)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(e){this.packet({type:At.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},e):e})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,n){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,n),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(e=>{if(!this.sendBuffer.some(r=>String(r.id)===e)){const r=this.acks[e];delete this.acks[e],r.withError&&r.call(this,new Error("socket has been disconnected"))}})}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case At.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case At.EVENT:case At.BINARY_EVENT:this.onevent(e);break;case At.ACK:case At.BINARY_ACK:this.onack(e);break;case At.DISCONNECT:this.ondisconnect();break;case At.CONNECT_ERROR:this.destroy();const r=new Error(e.data.message);r.data=e.data.data,this.emitReserved("connect_error",r);break}}onevent(e){const n=e.data||[];e.id!=null&&n.push(this.ack(e.id)),this.connected?this.emitEvent(n):this.receiveBuffer.push(Object.freeze(n))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){const n=this._anyListeners.slice();for(const r of n)r.apply(this,e)}super.emit.apply(this,e),this._pid&&e.length&&typeof e[e.length-1]=="string"&&(this._lastOffset=e[e.length-1])}ack(e){const n=this;let r=!1;return function(...i){r||(r=!0,n.packet({type:At.ACK,id:e,data:i}))}}onack(e){const n=this.acks[e.id];typeof n=="function"&&(delete this.acks[e.id],n.withError&&e.data.unshift(null),n.apply(this,e.data))}onconnect(e,n){this.id=e,this.recovered=n&&this._pid===n,this._pid=n,this.connected=!0,this.emitBuffered(),this._drainQueue(!0),this.emitReserved("connect")}emitBuffered(){this.receiveBuffer.forEach(e=>this.emitEvent(e)),this.receiveBuffer=[],this.sendBuffer.forEach(e=>{this.notifyOutgoingListeners(e),this.packet(e)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(e=>e()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:At.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){const n=this._anyListeners;for(let r=0;r<n.length;r++)if(e===n[r])return n.splice(r,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){const n=this._anyOutgoingListeners;for(let r=0;r<n.length;r++)if(e===n[r])return n.splice(r,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const n=this._anyOutgoingListeners.slice();for(const r of n)r.apply(this,e.data)}}}function $l(t){t=t||{},this.ms=t.min||100,this.max=t.max||1e4,this.factor=t.factor||2,this.jitter=t.jitter>0&&t.jitter<=1?t.jitter:0,this.attempts=0}$l.prototype.duration=function(){var t=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),n=Math.floor(e*this.jitter*t);t=(Math.floor(e*10)&1)==0?t-n:t+n}return Math.min(t,this.max)|0};$l.prototype.reset=function(){this.attempts=0};$l.prototype.setMin=function(t){this.ms=t};$l.prototype.setMax=function(t){this.max=t};$l.prototype.setJitter=function(t){this.jitter=t};class Fv extends xn{constructor(e,n){var r;super(),this.nsps={},this.subs=[],e&&typeof e=="object"&&(n=e,e=void 0),n=n||{},n.path=n.path||"/socket.io",this.opts=n,Ep(this,n),this.reconnection(n.reconnection!==!1),this.reconnectionAttempts(n.reconnectionAttempts||1/0),this.reconnectionDelay(n.reconnectionDelay||1e3),this.reconnectionDelayMax(n.reconnectionDelayMax||5e3),this.randomizationFactor((r=n.randomizationFactor)!==null&&r!==void 0?r:.5),this.backoff=new $l({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(n.timeout==null?2e4:n.timeout),this._readyState="closed",this.uri=e;const i=n.parser||sP;this.encoder=new i.Encoder,this.decoder=new i.Decoder,this._autoConnect=n.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,e||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(e){return e===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var n;return e===void 0?this._reconnectionDelay:(this._reconnectionDelay=e,(n=this.backoff)===null||n===void 0||n.setMin(e),this)}randomizationFactor(e){var n;return e===void 0?this._randomizationFactor:(this._randomizationFactor=e,(n=this.backoff)===null||n===void 0||n.setJitter(e),this)}reconnectionDelayMax(e){var n;return e===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,(n=this.backoff)===null||n===void 0||n.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(e){if(~this._readyState.indexOf("open"))return this;this.engine=new KL(this.uri,this.opts);const n=this.engine,r=this;this._readyState="opening",this.skipReconnect=!1;const i=ni(n,"open",function(){r.onopen(),e&&e()}),o=c=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",c),e?e(c):this.maybeReconnectOnOpen()},a=ni(n,"error",o);if(this._timeout!==!1){const c=this._timeout,u=this.setTimeoutFn(()=>{i(),o(new Error("timeout")),n.close()},c);this.opts.autoUnref&&u.unref(),this.subs.push(()=>{this.clearTimeoutFn(u)})}return this.subs.push(i),this.subs.push(a),this}connect(e){return this.open(e)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const e=this.engine;this.subs.push(ni(e,"ping",this.onping.bind(this)),ni(e,"data",this.ondata.bind(this)),ni(e,"error",this.onerror.bind(this)),ni(e,"close",this.onclose.bind(this)),ni(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(n){this.onclose("parse error",n)}}ondecoded(e){Sp(()=>{this.emitReserved("packet",e)},this.setTimeoutFn)}onerror(e){this.emitReserved("error",e)}socket(e,n){let r=this.nsps[e];return r?this._autoConnect&&!r.active&&r.connect():(r=new DA(this,e,n),this.nsps[e]=r),r}_destroy(e){const n=Object.keys(this.nsps);for(const r of n)if(this.nsps[r].active)return;this._close()}_packet(e){const n=this.encoder.encode(e);for(let r=0;r<n.length;r++)this.engine.write(n[r],e.options)}cleanup(){this.subs.forEach(e=>e()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(e,n){var r;this.cleanup(),(r=this.engine)===null||r===void 0||r.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,n),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const n=this.backoff.duration();this._reconnecting=!0;const r=this.setTimeoutFn(()=>{e.skipReconnect||(this.emitReserved("reconnect_attempt",e.backoff.attempts),!e.skipReconnect&&e.open(i=>{i?(e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",i)):e.onreconnect()}))},n);this.opts.autoUnref&&r.unref(),this.subs.push(()=>{this.clearTimeoutFn(r)})}}onreconnect(){const e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}const Gc={};function eh(t,e){typeof t=="object"&&(e=t,t=void 0),e=e||{};const n=XL(t,e.path||"/socket.io"),r=n.source,i=n.id,o=n.path,a=Gc[i]&&o in Gc[i].nsps,c=e.forceNew||e["force new connection"]||e.multiplex===!1||a;let u;return c?u=new Fv(r,e):(Gc[i]||(Gc[i]=new Fv(r,e)),u=Gc[i]),n.query&&!e.query&&(e.query=n.queryKey),u.socket(n.path,e)}Object.assign(eh,{Manager:Fv,Socket:DA,io:eh,connect:eh});const lP="http://localhost:5000",Lt=eh(lP,{autoConnect:!0,transports:["websocket"],auth:{token:localStorage.getItem("moduli-token")||null}}),ue={FULL_STATE:"FULL_STATE",SET_USER_ID:"SET_USER_ID",SET_GRID_ID:"SET_GRID_ID",LOGOUT:"LOGOUT",CREATE_GRID:"CREATE_GRID",UPDATE_GRID:"UPDATE_GRID",DELETE_GRID:"DELETE_GRID",SET_AVAILABLE_GRIDS:"SET_AVAILABLE_GRIDS",SET_GRID:"SET_GRID",CREATE_PANEL:"CREATE_PANEL",UPDATE_PANEL:"UPDATE_PANEL",DELETE_PANEL:"DELETE_PANEL",SET_PANELS:"SET_PANELS",CREATE_CONTAINER:"CREATE_CONTAINER",UPDATE_CONTAINER:"UPDATE_CONTAINER",DELETE_CONTAINER:"DELETE_CONTAINER",SET_CONTAINERS:"SET_CONTAINERS",UPDATE_CONTAINER_OCCURRENCES:"UPDATE_CONTAINER_OCCURRENCES",CREATE_INSTANCE:"CREATE_INSTANCE",UPDATE_INSTANCE:"UPDATE_INSTANCE",DELETE_INSTANCE:"DELETE_INSTANCE",SET_INSTANCES:"SET_INSTANCES",CREATE_INSTANCE_IN_CONTAINER:"CREATE_INSTANCE_IN_CONTAINER",CREATE_OCCURRENCE:"CREATE_OCCURRENCE",UPDATE_OCCURRENCE:"UPDATE_OCCURRENCE",DELETE_OCCURRENCE:"DELETE_OCCURRENCE",SET_OCCURRENCES:"SET_OCCURRENCES",CREATE_FIELD:"CREATE_FIELD",UPDATE_FIELD:"UPDATE_FIELD",DELETE_FIELD:"DELETE_FIELD",SET_FIELDS:"SET_FIELDS",CREATE_MANIFEST:"CREATE_MANIFEST",UPDATE_MANIFEST:"UPDATE_MANIFEST",DELETE_MANIFEST:"DELETE_MANIFEST",CREATE_VIEW:"CREATE_VIEW",UPDATE_VIEW:"UPDATE_VIEW",DELETE_VIEW:"DELETE_VIEW",CREATE_DOC:"CREATE_DOC",UPDATE_DOC:"UPDATE_DOC",DELETE_DOC:"DELETE_DOC",CREATE_FOLDER:"CREATE_FOLDER",UPDATE_FOLDER:"UPDATE_FOLDER",DELETE_FOLDER:"DELETE_FOLDER",CREATE_ARTIFACT:"CREATE_ARTIFACT",UPDATE_ARTIFACT:"UPDATE_ARTIFACT",DELETE_ARTIFACT:"DELETE_ARTIFACT",SET_ACTIVE_ID:"SET_ACTIVE_ID",SET_ACTIVE_SIZE:"SET_ACTIVE_SIZE",SOFT_TICK:"SOFT_TICK"},cP=({gridId:t,grid:e})=>({type:ue.UPDATE_GRID,payload:{gridId:t,grid:e}}),uP=t=>({type:ue.DELETE_GRID,payload:{gridId:t}}),dP=t=>({type:ue.CREATE_PANEL,payload:{panel:t}}),fP=t=>({type:ue.UPDATE_PANEL,payload:{panel:t}}),hP=t=>({type:ue.CREATE_CONTAINER,payload:{container:t}}),pP=t=>({type:ue.UPDATE_CONTAINER,payload:{container:t}}),mP=t=>({type:ue.DELETE_CONTAINER,payload:{containerId:t}}),gP=t=>({type:ue.CREATE_INSTANCE,payload:{instance:t}}),yP=t=>({type:ue.UPDATE_INSTANCE,payload:{instance:t}}),vP=t=>({type:ue.DELETE_INSTANCE,payload:{instanceId:t}}),xP=({containerId:t,instance:e})=>({type:ue.CREATE_INSTANCE_IN_CONTAINER,payload:{containerId:t,instance:e}}),bP=t=>({type:ue.CREATE_OCCURRENCE,payload:{occurrence:t}}),wP=t=>({type:ue.UPDATE_OCCURRENCE,payload:{occurrence:t}}),SP=t=>({type:ue.CREATE_FIELD,payload:{field:t}}),EP=t=>({type:ue.UPDATE_FIELD,payload:{field:t}}),CP=t=>({type:ue.CREATE_VIEW,payload:{view:t}}),TP=t=>({type:ue.UPDATE_VIEW,payload:{view:t}}),NP=t=>({type:ue.CREATE_DOC,payload:{doc:t}}),AP=t=>({type:ue.UPDATE_DOC,payload:{doc:t}}),kP=t=>({type:ue.CREATE_FOLDER,payload:{folder:t}}),DP=t=>({type:ue.UPDATE_FOLDER,payload:{folder:t}}),OP=t=>({type:ue.CREATE_ARTIFACT,payload:{artifact:t}}),MP=t=>({type:ue.UPDATE_ARTIFACT,payload:{artifact:t}});function RP(t,e){const n=j=>e({...j,_fromSocket:!0});function r(j={}){console.log("[socket] full_state received:",j),j.gridId&&localStorage.setItem("moduli-gridId",j.gridId),n({type:ue.FULL_STATE,payload:j})}t.on("full_state",r);function i({container:j}={}){j?.id&&n({type:ue.CREATE_CONTAINER,payload:{container:j}})}function o({containerId:j,items:G,occurrences:oe}={}){const L=oe||G;!j||!Array.isArray(L)||n({type:ue.UPDATE_CONTAINER_OCCURRENCES,payload:{containerId:j,occurrences:L}})}function a(j={}){const G=j.container||j,oe=G?.id||j.containerId;oe&&n({type:ue.UPDATE_CONTAINER,payload:{container:{...G,id:oe}}})}function c(j={}){const G=j.containerId||j.id;G&&n({type:ue.DELETE_CONTAINER,payload:{containerId:G}})}t.on("container_created",i),t.on("container_items_updated",o),t.on("container_updated",a),t.on("container_deleted",c);function u({containerId:j,instance:G}={}){!j||!G?.id||n({type:ue.CREATE_INSTANCE_IN_CONTAINER,payload:{containerId:j,instance:G}})}function f({instance:j}={}){j?.id&&n({type:ue.UPDATE_INSTANCE,payload:{instance:j}})}function p(j={}){const G=j.instanceId||j.id;G&&n({type:ue.DELETE_INSTANCE,payload:{instanceId:G}})}t.on("instance_created_in_container",u),t.on("instance_updated",f),t.on("instance_deleted",p);function g({occurrence:j}={}){j?.id&&n({type:ue.CREATE_OCCURRENCE,payload:{occurrence:j}})}function v({occurrence:j}={}){j?.id&&n({type:ue.UPDATE_OCCURRENCE,payload:{occurrence:j}})}function y(j={}){const G=j.occurrenceId||j.id;G&&n({type:ue.DELETE_OCCURRENCE,payload:{occurrenceId:G}})}t.on("occurrence_created",g),t.on("occurrence_updated",v),t.on("occurrence_deleted",y);function w({field:j}={}){j?.id&&n({type:ue.CREATE_FIELD,payload:{field:j}})}function S({field:j}={}){j?.id&&n({type:ue.UPDATE_FIELD,payload:{field:j}})}function C(j={}){const G=j.fieldId||j.id;G&&n({type:ue.DELETE_FIELD,payload:{fieldId:G}})}t.on("field_created",w),t.on("field_updated",S),t.on("field_deleted",C);function T(j){j?.id&&n({type:ue.UPDATE_PANEL,payload:{panel:j}})}function N(j={}){const G=j.panelId||j.id;G&&n({type:ue.DELETE_PANEL,payload:{panelId:G}})}function k(j){j?.id&&n({type:ue.UPDATE_PANEL,payload:{panel:j}})}t.on("panel_updated",T),t.on("panel_deleted",N),t.on("panel_created",k);function D(j={}){const G=j.gridId||j.id,oe=j.grid||j;G&&n({type:ue.UPDATE_GRID,payload:{gridId:G,grid:oe}})}function M(j={}){const G=j.gridId||j.id;if(!G)return;n({type:ue.DELETE_GRID,payload:{gridId:G}});const oe=localStorage.getItem("moduli-gridId");oe&&oe===G&&(localStorage.removeItem("moduli-gridId"),t.emit("request_full_state"))}function R(j={}){const G=j.grid||j;n({type:ue.CREATE_GRID,payload:{grid:G}})}t.on("grid_updated",D),t.on("grid_deleted",M),t.on("grid_created",R);function O({token:j,userId:G}={}){console.log("[socket] auth_success",{userId:G}),j&&localStorage.setItem("moduli-token",j),G&&localStorage.setItem("moduli-userId",G),n({type:ue.SET_USER_ID,payload:{userId:G}});try{t.disconnect()}catch{}t.auth={token:j},t.connect(),t.once("connect",()=>{const oe=localStorage.getItem("moduli-gridId");t.emit("request_full_state",oe?{gridId:oe}:void 0)})}function I(j){console.log("[socket] auth_error:",j),localStorage.removeItem("moduli-token"),localStorage.removeItem("moduli-userId"),localStorage.removeItem("moduli-gridId"),n({type:ue.LOGOUT})}function z(j){const G=j?.message;if(console.log("[socket] connect_error:",G),G==="INVALID_TOKEN"||G==="USER_NOT_FOUND"){localStorage.removeItem("moduli-token"),localStorage.removeItem("moduli-userId"),localStorage.removeItem("moduli-gridId"),n({type:ue.LOGOUT});try{t.disconnect()}catch{}t.auth={},t.connect()}}t.on("auth_success",O),t.on("auth_error",I),t.on("connect_error",z);const U=[{name:"manifest",createType:ue.CREATE_MANIFEST,updateType:ue.UPDATE_MANIFEST,deleteType:ue.DELETE_MANIFEST},{name:"view",createType:ue.CREATE_VIEW,updateType:ue.UPDATE_VIEW,deleteType:ue.DELETE_VIEW},{name:"doc",createType:ue.CREATE_DOC,updateType:ue.UPDATE_DOC,deleteType:ue.DELETE_DOC},{name:"folder",createType:ue.CREATE_FOLDER,updateType:ue.UPDATE_FOLDER,deleteType:ue.DELETE_FOLDER},{name:"artifact",createType:ue.CREATE_ARTIFACT,updateType:ue.UPDATE_ARTIFACT,deleteType:ue.DELETE_ARTIFACT}],Y=[];for(const{name:j,createType:G,updateType:oe,deleteType:L}of U){const $=(pe={})=>{const P=pe[j];P?.id&&n({type:G,payload:{[j]:P}})},V=(pe={})=>{const P=pe[j];P?.id&&n({type:oe,payload:{[j]:P}})},we=(pe={})=>{const P=pe[`${j}Id`]||pe.id;P&&n({type:L,payload:{[`${j}Id`]:P}})};t.on(`${j}_created`,$),t.on(`${j}_updated`,V),t.on(`${j}_deleted`,we),Y.push({name:j,onCreated:$,onUpdated:V,onDeleted:we})}function W(j){console.warn("[socket] server_error:",j),typeof j=="string"&&j.toLowerCase().includes("grid not found")&&(localStorage.removeItem("moduli-gridId"),t.emit("request_full_state"))}return t.on("server_error",W),()=>{t.off("full_state",r),t.off("container_created",i),t.off("container_items_updated",o),t.off("container_updated",a),t.off("container_deleted",c),t.off("instance_created_in_container",u),t.off("instance_updated",f),t.off("instance_deleted",p),t.off("occurrence_created",g),t.off("occurrence_updated",v),t.off("occurrence_deleted",y),t.off("field_created",w),t.off("field_updated",S),t.off("field_deleted",C),t.off("panel_updated",T),t.off("panel_deleted",N),t.off("panel_created",k),t.off("grid_updated",D),t.off("grid_deleted",M),t.off("grid_created",R),t.off("auth_success",O),t.off("auth_error",I),t.off("connect_error",z),t.off("server_error",W);for(const{name:j,onCreated:G,onUpdated:oe,onDeleted:L}of Y)t.off(`${j}_created`,G),t.off(`${j}_updated`,oe),t.off(`${j}_deleted`,L)}}const jP=({panel:t,cols:e,rows:n,onResize:r,onResizeEnd:i})=>{const o=x.useRef(null),a=x.useCallback(c=>{c.preventDefault(),c.stopPropagation();const u=c.target.closest("[data-panel-id]"),f=u?.closest('[style*="display: grid"]')||u?.parentElement?.parentElement;if(!u||!f)return;const p=c.clientX||c.touches?.[0]?.clientX,g=c.clientY||c.touches?.[0]?.clientY,v=f.getBoundingClientRect(),y=v.width/e,w=v.height/n,S=t.width||1,C=t.height||1;o.current={startX:p,startY:g,cellWidth:y,cellHeight:w,startCellWidth:S,startCellHeight:C,panelRow:t.row,panelCol:t.col,lastWidth:S,lastHeight:C};const T=k=>{if(!o.current)return;const D=k.clientX||k.touches?.[0]?.clientX,M=k.clientY||k.touches?.[0]?.clientY,R=D-o.current.startX,O=M-o.current.startY,I=Math.round(R/o.current.cellWidth),z=Math.round(O/o.current.cellHeight),U=Math.max(1,Math.min(e-o.current.panelCol,o.current.startCellWidth+I)),Y=Math.max(1,Math.min(n-o.current.panelRow,o.current.startCellHeight+z));o.current.lastWidth=U,o.current.lastHeight=Y,r?.({width:U,height:Y})},N=()=>{if(!o.current)return;const k=o.current.lastWidth,D=o.current.lastHeight;i?.({width:k,height:D}),o.current=null,document.removeEventListener("mousemove",T),document.removeEventListener("mouseup",N),document.removeEventListener("touchmove",T),document.removeEventListener("touchend",N)};document.addEventListener("mousemove",T),document.addEventListener("mouseup",N),document.addEventListener("touchmove",T),document.addEventListener("touchend",N)},[t,e,n,r,i]);return h.jsx("div",{onMouseDown:a,onTouchStart:a,style:{width:18,height:18,position:"absolute",right:6,bottom:6,cursor:"nwse-resize",background:"rgba(100, 120, 150, 0.6)",borderTopLeftRadius:6,touchAction:"none",zIndex:9999,pointerEvents:"auto",display:"flex",alignItems:"center",justifyContent:"center",opacity:.7,transition:"opacity 0.15s"},onMouseEnter:c=>{c.currentTarget.style.opacity=1},onMouseLeave:c=>{c.currentTarget.style.opacity=.7},children:h.jsx("svg",{width:"10",height:"10",viewBox:"0 0 10 10",style:{opacity:.5},children:h.jsx("path",{d:"M10 0 L10 10 L0 10 Z",fill:"white"})})})};var yo=gA();const ob=Qx(yo);const IP=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),_P=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,n,r)=>r?r.toUpperCase():n.toLowerCase()),eC=t=>{const e=_P(t);return e.charAt(0).toUpperCase()+e.slice(1)},OA=(...t)=>t.filter((e,n,r)=>!!e&&e.trim()!==""&&r.indexOf(e)===n).join(" ").trim(),LP=t=>{for(const e in t)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};var PP={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const zP=x.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:i="",children:o,iconNode:a,...c},u)=>x.createElement("svg",{ref:u,...PP,width:e,height:e,stroke:t,strokeWidth:r?Number(n)*24/Number(e):n,className:OA("lucide",i),...!o&&!LP(c)&&{"aria-hidden":"true"},...c},[...a.map(([f,p])=>x.createElement(f,p)),...Array.isArray(o)?o:[o]]));const Ie=(t,e)=>{const n=x.forwardRef(({className:r,...i},o)=>x.createElement(zP,{ref:o,iconNode:e,className:OA(`lucide-${IP(eC(t))}`,`lucide-${t}`,r),...i}));return n.displayName=eC(t),n};const BP=[["rect",{width:"14",height:"6",x:"5",y:"16",rx:"2",key:"1i8z2d"}],["rect",{width:"10",height:"6",x:"7",y:"6",rx:"2",key:"13squh"}],["path",{d:"M2 2h20",key:"1ennik"}]],FP=Ie("align-vertical-justify-start",BP);const $P=[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]],sb=Ie("arrow-down",$P);const HP=[["path",{d:"M8 3 4 7l4 4",key:"9rb6wj"}],["path",{d:"M4 7h16",key:"6tx8e3"}],["path",{d:"m16 21 4-4-4-4",key:"siv7j2"}],["path",{d:"M20 17H4",key:"h6l3hr"}]],UP=Ie("arrow-left-right",HP);const VP=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],qP=Ie("arrow-left",VP);const GP=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],WP=Ie("arrow-right",GP);const YP=[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]],KP=Ie("arrow-up-down",YP);const XP=[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]],hh=Ie("arrow-up",XP);const JP=[["path",{d:"M6 12h9a4 4 0 0 1 0 8H7a1 1 0 0 1-1-1V5a1 1 0 0 1 1-1h7a4 4 0 0 1 0 8",key:"mg9rjx"}]],QP=Ie("bold",JP);const ZP=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M12 9v6",key:"199k2o"}],["path",{d:"M16 15v6",key:"8rj2es"}],["path",{d:"M16 3v6",key:"1j6rpj"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M8 15v6",key:"1stoo3"}],["path",{d:"M8 3v6",key:"vlvjmk"}]],tC=Ie("brick-wall",ZP);const e3=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]],t3=Ie("calendar-days",e3);const n3=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],ab=Ie("calendar",n3);const r3=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],Cp=Ie("check",r3);const i3=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],Yu=Ie("chevron-down",i3);const o3=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],Cu=Ie("chevron-left",o3);const s3=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],hs=Ie("chevron-right",s3);const a3=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],l3=Ie("chevron-up",a3);const c3=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],ph=Ie("clock",c3);const u3=[["path",{d:"m16 18 6-6-6-6",key:"eg8j8"}],["path",{d:"m8 6-6 6 6 6",key:"ppft3o"}]],d3=Ie("code",u3);const f3=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M12 3v18",key:"108xh3"}]],h3=Ie("columns-2",f3);const p3=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],Tl=Ie("copy",p3);const m3=[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]],g3=Ie("database",m3);const y3=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],nC=Ie("download",y3);const v3=[["line",{x1:"5",x2:"19",y1:"9",y2:"9",key:"1nwqeh"}],["line",{x1:"5",x2:"19",y1:"15",y2:"15",key:"g8yjpy"}]],lb=Ie("equal",v3);const x3=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],Ai=Ie("file-text",x3);const b3=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}]],ss=Ie("file",b3);const w3=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M7 3v18",key:"bbkbws"}],["path",{d:"M3 7.5h4",key:"zfgn84"}],["path",{d:"M3 12h18",key:"1i2n21"}],["path",{d:"M3 16.5h4",key:"1230mu"}],["path",{d:"M17 3v18",key:"in4fa5"}],["path",{d:"M17 7.5h4",key:"myr1c1"}],["path",{d:"M17 16.5h4",key:"go4c1d"}]],Tp=Ie("film",w3);const S3=[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]],E3=Ie("folder-open",S3);const C3=[["path",{d:"M12 10v6",key:"1bos4e"}],["path",{d:"M9 13h6",key:"1uhe8q"}],["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],T3=Ie("folder-plus",C3);const N3=[["path",{d:"M20 10a1 1 0 0 0 1-1V6a1 1 0 0 0-1-1h-2.5a1 1 0 0 1-.8-.4l-.9-1.2A1 1 0 0 0 15 3h-2a1 1 0 0 0-1 1v5a1 1 0 0 0 1 1Z",key:"hod4my"}],["path",{d:"M20 21a1 1 0 0 0 1-1v-3a1 1 0 0 0-1-1h-2.9a1 1 0 0 1-.88-.55l-.42-.85a1 1 0 0 0-.92-.6H13a1 1 0 0 0-1 1v5a1 1 0 0 0 1 1Z",key:"w4yl2u"}],["path",{d:"M3 5a2 2 0 0 0 2 2h3",key:"f2jnh7"}],["path",{d:"M3 3v13a2 2 0 0 0 2 2h3",key:"k8epm1"}]],A3=Ie("folder-tree",N3);const k3=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],MA=Ie("folder",k3);const D3=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],O3=Ie("funnel",D3);const M3=[["path",{d:"M4 12h8",key:"17cfdx"}],["path",{d:"M4 18V6",key:"1rz3zl"}],["path",{d:"M12 18V6",key:"zqpxq5"}],["path",{d:"m17 12 3-2v8",key:"1hhhft"}]],R3=Ie("heading-1",M3);const j3=[["path",{d:"M4 12h8",key:"17cfdx"}],["path",{d:"M4 18V6",key:"1rz3zl"}],["path",{d:"M12 18V6",key:"zqpxq5"}],["path",{d:"M21 18h-4c0-4 4-3 4-6 0-1.5-2-2.5-4-1",key:"9jr5yi"}]],I3=Ie("heading-2",j3);const _3=[["path",{d:"M4 12h8",key:"17cfdx"}],["path",{d:"M4 18V6",key:"1rz3zl"}],["path",{d:"M12 18V6",key:"zqpxq5"}],["path",{d:"M17.5 10.5c1.7-1 3.5 0 3.5 1.5a2 2 0 0 1-2 2",key:"68ncm8"}],["path",{d:"M17 17.5c2 1.5 4 .3 4-1.5a2 2 0 0 0-2-2",key:"1ejuhz"}]],L3=Ie("heading-3",_3);const P3=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]],z3=Ie("history",P3);const B3=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],cb=Ie("image",B3);const F3=[["line",{x1:"19",x2:"10",y1:"4",y2:"4",key:"15jd3p"}],["line",{x1:"14",x2:"5",y1:"20",y2:"20",key:"bu0au3"}],["line",{x1:"15",x2:"9",y1:"4",y2:"20",key:"uljnxc"}]],$3=Ie("italic",F3);const H3=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],RA=Ie("layers",H3);const U3=[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]],ub=Ie("layout-grid",U3);const V3=[["path",{d:"M9 17H7A5 5 0 0 1 7 7h2",key:"8i5ue5"}],["path",{d:"M15 7h2a5 5 0 1 1 0 10h-2",key:"1b9ql8"}],["line",{x1:"8",x2:"16",y1:"12",y2:"12",key:"1jonct"}]],Nl=Ie("link-2",V3);const q3=[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]],jA=Ie("link",q3);const G3=[["path",{d:"M11 5h10",key:"1cz7ny"}],["path",{d:"M11 12h10",key:"1438ji"}],["path",{d:"M11 19h10",key:"11t30w"}],["path",{d:"M4 4h1v5",key:"10yrso"}],["path",{d:"M4 9h2",key:"r1h2o0"}],["path",{d:"M6.5 20H3.4c0-1 2.6-1.925 2.6-3.5a1.5 1.5 0 0 0-2.6-1.02",key:"xtkcd5"}]],W3=Ie("list-ordered",G3);const Y3=[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]],IA=Ie("list",Y3);const K3=[["path",{d:"M5 12h14",key:"1ays0h"}]],X3=Ie("minus",K3);const J3=[["path",{d:"M12 2v20",key:"t6zp3m"}],["path",{d:"m15 19-3 3-3-3",key:"11eu04"}],["path",{d:"m19 9 3 3-3 3",key:"1mg7y2"}],["path",{d:"M2 12h20",key:"9i4pu4"}],["path",{d:"m5 9-3 3 3 3",key:"j64kie"}],["path",{d:"m9 5 3-3 3 3",key:"l8vdw6"}]],mh=Ie("move",J3);const Q3=[["path",{d:"M9 18V5l12-2v13",key:"1jmyc2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]],Tu=Ie("music",Q3);const Z3=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],e5=Ie("package",Z3);const t5=[["path",{d:"m10.5 20.5 10-10a4.95 4.95 0 1 0-7-7l-10 10a4.95 4.95 0 1 0 7 7Z",key:"wa1lgi"}],["path",{d:"m8.5 8.5 7 7",key:"rvfmvr"}]],n5=Ie("pill",t5);const r5=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],li=Ie("plus",r5);const i5=[["path",{d:"M16 3a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2 1 1 0 0 1 1 1v1a2 2 0 0 1-2 2 1 1 0 0 0-1 1v2a1 1 0 0 0 1 1 6 6 0 0 0 6-6V5a2 2 0 0 0-2-2z",key:"rib7q0"}],["path",{d:"M5 3a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2 1 1 0 0 1 1 1v1a2 2 0 0 1-2 2 1 1 0 0 0-1 1v2a1 1 0 0 0 1 1 6 6 0 0 0 6-6V5a2 2 0 0 0-2-2z",key:"1ymkrd"}]],o5=Ie("quote",i5);const s5=[["path",{d:"m15 14 5-5-5-5",key:"12vg1m"}],["path",{d:"M20 9H9.5A5.5 5.5 0 0 0 4 14.5A5.5 5.5 0 0 0 9.5 20H13",key:"6uklza"}]],db=Ie("redo-2",s5);const a5=[["path",{d:"M21 7v6h-6",key:"3ptur4"}],["path",{d:"M3 17a9 9 0 0 1 9-9 9 9 0 0 1 6 2.3l3 2.7",key:"1kgawr"}]],l5=Ie("redo",a5);const c5=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],rC=Ie("refresh-cw",c5);const u5=[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]],d5=Ie("rotate-cw",u5);const f5=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],fb=Ie("search",f5);const h5=[["path",{d:"M14 17H5",key:"gfn3mx"}],["path",{d:"M19 7h-9",key:"6i9tg"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]],p5=Ie("settings-2",h5);const m5=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],oa=Ie("settings",m5);const g5=[["path",{d:"m18 14 4 4-4 4",key:"10pe0f"}],["path",{d:"m18 2 4 4-4 4",key:"pucp1d"}],["path",{d:"M2 18h1.973a4 4 0 0 0 3.3-1.7l5.454-8.6a4 4 0 0 1 3.3-1.7H22",key:"1ailkh"}],["path",{d:"M2 6h1.972a4 4 0 0 1 3.6 2.2",key:"km57vx"}],["path",{d:"M22 18h-6.041a4 4 0 0 1-3.3-1.8l-.359-.45",key:"os18l9"}]],_A=Ie("shuffle",g5);const y5=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]],iC=Ie("square-plus",y5);const v5=[["path",{d:"M16 4H9a3 3 0 0 0-2.83 4",key:"43sutm"}],["path",{d:"M14 12a4 4 0 0 1 0 8H6",key:"nlfj13"}],["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}]],x5=Ie("strikethrough",v5);const b5=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],ps=Ie("trash-2",b5);const w5=[["path",{d:"M9 14 4 9l5-5",key:"102s5s"}],["path",{d:"M4 9h10.5a5.5 5.5 0 0 1 5.5 5.5a5.5 5.5 0 0 1-5.5 5.5H11",key:"f3b9sd"}]],hb=Ie("undo-2",w5);const S5=[["path",{d:"M3 7v6h6",key:"1v2h90"}],["path",{d:"M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13",key:"1r6uu6"}]],E5=Ie("undo",S5);const C5=[["path",{d:"m18.84 12.25 1.72-1.71h-.02a5.004 5.004 0 0 0-.12-7.07 5.006 5.006 0 0 0-6.95 0l-1.72 1.71",key:"yqzxt4"}],["path",{d:"m5.17 11.75-1.71 1.71a5.004 5.004 0 0 0 .12 7.07 5.006 5.006 0 0 0 6.95 0l1.71-1.71",key:"4qinb0"}],["line",{x1:"8",x2:"8",y1:"2",y2:"5",key:"1041cp"}],["line",{x1:"2",x2:"5",y1:"8",y2:"8",key:"14m1p5"}],["line",{x1:"16",x2:"16",y1:"19",y2:"22",key:"rzdirn"}],["line",{x1:"19",x2:"22",y1:"16",y2:"16",key:"ox905f"}]],LA=Ie("unlink",C5);const T5=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],N5=Ie("upload",T5);const A5=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Hl=Ie("x",A5);const k5=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],D5=Ie("zap",k5);const O5=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],M5=Ie("zoom-in",O5);const R5=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],j5=Ie("zoom-out",R5);function sa({dragMode:t="move",onToggleDragMode:e,onSettings:n,onAddChild:r,addLabel:i="Item",items:o=null,forceDirection:a=null,handleIcon:c=null,handleTitle:u=null,onOpenChange:f=null,disabled:p=!1,size:g="sm",className:v="",handleClassName:y=""}){const[w,S]=x.useState(!1),C=x.useCallback(B=>{S(Z=>{const le=typeof B=="function"?B(Z):B;return le!==Z&&f?.(le),le})},[f]),T=x.useRef(null),N=x.useRef(null),k=x.useRef(null),D=x.useRef(null),[M,R]=x.useState({x:null,y:null}),[O,I]=x.useState(!1),[z,U]=x.useState(a||"left"),W=(B=>{switch(B){case"left":return 90;case"right":return-90;case"down":return-90;case"up":return 90;default:return 90}})(z),j=x.useCallback(()=>{const B=k.current;if(!B)return;const Z=B.getBoundingClientRect(),le=Z.left+Z.width/2,be=Z.top+Z.height/2;if(a){U(a),R({x:le,y:be});return}const H=50,ce=le,te=window.innerWidth-le;ce<H+20?U("right"):(te<H+20,U("left")),R({x:le,y:be})},[a]);x.useEffect(()=>{const B=Z=>{const le=T.current?.contains(Z.target),be=N.current?.contains(Z.target);!le&&!be&&C(!1)};return w&&(document.addEventListener("mousedown",B),document.addEventListener("touchstart",B)),()=>{document.removeEventListener("mousedown",B),document.removeEventListener("touchstart",B)}},[w]),x.useEffect(()=>(w&&(D.current=setTimeout(()=>C(!1),5e3)),()=>D.current&&clearTimeout(D.current)),[w]),x.useLayoutEffect(()=>{w&&j()},[w,j]),x.useEffect(()=>{if(!w)return;const B=()=>j(),Z=()=>j();return window.addEventListener("scroll",B,!0),window.addEventListener("resize",Z),()=>{window.removeEventListener("scroll",B,!0),window.removeEventListener("resize",Z)}},[w,j]),x.useEffect(()=>{if(!w){I(!1);return}I(!1);const B=requestAnimationFrame(()=>I(!0));return()=>cancelAnimationFrame(B)},[w]);const G=x.useCallback(B=>{B.stopPropagation(),!p&&C(Z=>{const le=!Z;return le&&j(),le})},[p,j]),oe=x.useCallback((B,Z)=>{Z?.stopPropagation(),B?.(),C(!1)},[]),L={sm:{handle:"h-5",handleIcon:"w-2.5 h-2.5",menu:"w-6 h-6",menuIcon:"w-3 h-3",radius:34},md:{handle:"h-6",handleIcon:"w-3 h-3",menu:"w-7 h-7",menuIcon:"w-3.5 h-3.5",radius:42}},$=L[g]||L.sm,V=c||(t==="copy"?Tl:mh),we=u||`${t==="copy"?"Copy":"Move"} mode - Click for menu`,pe=x.useCallback((B,Z)=>{const H={left:180,right:0,down:90,up:270}[B]||180,ce=[],te=(Z-1)*45/2;for(let me=0;me<Z;me++)ce.push(H-te+me*45);return ce},[]),P=x.useMemo(()=>{if(o&&o.length>0){const Z=pe(z,o.length);return o.map((le,be)=>({...le,angle:Z[be],color:le.color||"bg-slate-600 hover:bg-slate-500"}))}const B=pe(z,3);return[{angle:B[0],icon:oa,label:"Settings",onClick:n,color:"bg-slate-600 hover:bg-slate-500"},{angle:B[1],icon:li,label:`Add ${i}`,onClick:r,color:"bg-emerald-600 hover:bg-emerald-500"},{angle:B[2],icon:t==="move"?Tl:mh,label:t==="move"?"Set to Copy":"Set to Move",onClick:e,color:t==="move"?"bg-blue-600 hover:bg-blue-500":"bg-slate-600 hover:bg-slate-500"}]},[o,i,t,r,n,e,z,pe]),K=w&&M.x!=null&&yo.createPortal(h.jsx("div",{ref:N,style:{position:"fixed",left:M.x,top:M.y,width:$.radius*2+28,height:$.radius*2+28,transform:"translate(-50%, -50%)",pointerEvents:"none",zIndex:2147483647},onMouseDown:B=>B.stopPropagation(),onTouchStart:B=>B.stopPropagation(),children:h.jsx("div",{className:`
            radial-menu-items
            absolute inset-0
            pointer-events-none
            transition-all duration-300 ease-out
          `,style:{transformOrigin:"50% 50%",transform:`rotate(${O?0:W}deg)`,opacity:O?1:0,transitionProperty:"transform, opacity",transitionDuration:"280ms",transitionTimingFunction:"cubic-bezier(0.34, 1.56, 0.64, 1)"},children:P.map((B,Z)=>{const le=B.icon,be=B.angle*Math.PI/180,H=Math.cos(be)*$.radius,ce=Math.sin(be)*$.radius,te=Z*35;return h.jsx("button",{type:"button",onClick:me=>oe(B.onClick,me),disabled:p||!B.onClick,className:`
                  radial-menu-item
                  absolute
                  ${$.menu}
                  rounded-full
                  flex items-center justify-center
                  ${B.color}
                  border-2 border-white/80        /*  white border like handle */
                  shadow-lg
                  transition-all
                  ${O?"pointer-events-auto":"pointer-events-none"}
                  ${p||!B.onClick?"opacity-40 cursor-not-allowed":"cursor-pointer hover:scale-110"}
                `,style:{left:"50%",top:"50%",transform:`translate(calc(-50% + ${H}px), calc(-50% + ${ce}px))`,transitionDelay:`${te}ms`},title:B.label,children:h.jsx("span",{style:{display:"inline-flex",transformOrigin:"50% 50%",transform:`rotate(${O?0:-W}deg)`,transition:"transform 280ms cubic-bezier(0.34, 1.56, 0.64, 1)",transitionDelay:`${te}ms`},children:h.jsx(le,{className:`${$.menuIcon} text-white`})})},B.label)})})}),document.body);return h.jsxs("div",{ref:T,className:`radial-menu relative items-center flex-1 flex flex-col justify-center ${v}`,style:{zIndex:w?99999:1e3},children:[h.jsx("button",{ref:k,type:"button",onClick:G,disabled:p,className:`
          radial-handle
          ${$.handle}
          flex items-center justify-center
          px-2
          w-8
          flex-1
          rounded-l-[6px]
          rounded-r-none
          border-r-2 border-solid
          border-gray-700
          transition-all duration-200
          ${p?"opacity-40 cursor-not-allowed":"cursor-pointer hover:shadow-lg"}
          ${w?"brightness-105":""}
          ${y}
        `,style:{alignSelf:"center",flex:1,paddingTop:0,paddingBottom:0},title:we,children:typeof V=="function"||V&&V.$$typeof?h.jsx(V,{className:`${$.handleIcon} text-white/90`}):V}),K]})}const I5=[{kind:"list",label:"List",description:"Sortable list of items",icon:IA,color:"bg-blue-600 hover:bg-blue-500"},{kind:"doc",label:"Document",description:"Rich text with field pills",icon:Ai,color:"bg-purple-600 hover:bg-purple-500"},{kind:"log",label:"Log",description:"Time-ordered entries",icon:ph,color:"bg-amber-600 hover:bg-amber-500"},{kind:"smart",label:"Smart",description:"Auto-filtered view",icon:ub,color:"bg-teal-600 hover:bg-teal-500"}];function _5({open:t=!1,onClose:e,onSelect:n,anchorRef:r,position:i=null}){const[o,a]=x.useState({top:0,left:0}),c=x.useRef(null);x.useEffect(()=>{if(t){if(i){a(i);return}if(r?.current){const f=r.current.getBoundingClientRect();a({top:f.bottom+8,left:f.left})}}},[t,r,i]),x.useEffect(()=>{if(!t)return;const f=p=>{c.current&&!c.current.contains(p.target)&&e?.()};return document.addEventListener("mousedown",f),()=>document.removeEventListener("mousedown",f)},[t,e]),x.useEffect(()=>{if(!t)return;const f=p=>{p.key==="Escape"&&e?.()};return document.addEventListener("keydown",f),()=>document.removeEventListener("keydown",f)},[t,e]);const u=x.useCallback(f=>{n?.(f),e?.()},[n,e]);return t?yo.createPortal(h.jsxs("div",{ref:c,className:"container-kind-selector fixed z-[9999] bg-background border border-border rounded-lg shadow-xl overflow-hidden",style:{top:o.top,left:o.left,minWidth:200},children:[h.jsx("div",{className:"px-3 py-2 border-b border-border bg-muted/50",children:h.jsx("span",{className:"text-sm font-medium",children:"Container Type"})}),h.jsx("div",{className:"p-1",children:I5.map(f=>{const p=f.icon;return h.jsxs("button",{type:"button",onClick:()=>u(f.kind),className:"w-full flex items-center gap-3 px-3 py-2 rounded-md hover:bg-accent transition-colors text-left",children:[h.jsx("span",{className:`p-1.5 rounded-md ${f.color}`,children:h.jsx(p,{className:"w-4 h-4 text-white"})}),h.jsxs("div",{className:"flex-1 min-w-0",children:[h.jsx("div",{className:"text-sm font-medium",children:f.label}),h.jsx("div",{className:"text-xs text-muted-foreground truncate",children:f.description})]})]},f.kind)})})]}),document.body):null}function oC(t,e){if(typeof t=="function")return t(e);t!=null&&(t.current=e)}function ga(...t){return e=>{let n=!1;const r=t.map(i=>{const o=oC(i,e);return!n&&typeof o=="function"&&(n=!0),o});if(n)return()=>{for(let i=0;i<r.length;i++){const o=r[i];typeof o=="function"?o():oC(t[i],null)}}}}function ht(...t){return x.useCallback(ga(...t),t)}var L5=Symbol.for("react.lazy"),gh=Zx[" use ".trim().toString()];function P5(t){return typeof t=="object"&&t!==null&&"then"in t}function PA(t){return t!=null&&typeof t=="object"&&"$$typeof"in t&&t.$$typeof===L5&&"_payload"in t&&P5(t._payload)}function pb(t){const e=B5(t),n=x.forwardRef((r,i)=>{let{children:o,...a}=r;PA(o)&&typeof gh=="function"&&(o=gh(o._payload));const c=x.Children.toArray(o),u=c.find($5);if(u){const f=u.props.children,p=c.map(g=>g===u?x.Children.count(f)>1?x.Children.only(null):x.isValidElement(f)?f.props.children:null:g);return h.jsx(e,{...a,ref:i,children:x.isValidElement(f)?x.cloneElement(f,void 0,p):null})}return h.jsx(e,{...a,ref:i,children:o})});return n.displayName=`${t}.Slot`,n}var z5=pb("Slot");function B5(t){const e=x.forwardRef((n,r)=>{let{children:i,...o}=n;if(PA(i)&&typeof gh=="function"&&(i=gh(i._payload)),x.isValidElement(i)){const a=U5(i),c=H5(o,i.props);return i.type!==x.Fragment&&(c.ref=r?ga(r,a):a),x.cloneElement(i,c)}return x.Children.count(i)>1?x.Children.only(null):null});return e.displayName=`${t}.SlotClone`,e}var F5=Symbol("radix.slottable");function $5(t){return x.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===F5}function H5(t,e){const n={...e};for(const r in e){const i=t[r],o=e[r];/^on[A-Z]/.test(r)?i&&o?n[r]=(...c)=>{const u=o(...c);return i(...c),u}:i&&(n[r]=i):r==="style"?n[r]={...i,...o}:r==="className"&&(n[r]=[i,o].filter(Boolean).join(" "))}return{...t,...n}}function U5(t){let e=Object.getOwnPropertyDescriptor(t.props,"ref")?.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=Object.getOwnPropertyDescriptor(t,"ref")?.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}function zA(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t)){var i=t.length;for(e=0;e<i;e++)t[e]&&(n=zA(t[e]))&&(r&&(r+=" "),r+=n)}else for(n in t)t[n]&&(r&&(r+=" "),r+=n);return r}function BA(){for(var t,e,n=0,r="",i=arguments.length;n<i;n++)(t=arguments[n])&&(e=zA(t))&&(r&&(r+=" "),r+=e);return r}const sC=t=>typeof t=="boolean"?`${t}`:t===0?"0":t,aC=BA,V5=(t,e)=>n=>{var r;if(e?.variants==null)return aC(t,n?.class,n?.className);const{variants:i,defaultVariants:o}=e,a=Object.keys(i).map(f=>{const p=n?.[f],g=o?.[f];if(p===null)return null;const v=sC(p)||sC(g);return i[f][v]}),c=n&&Object.entries(n).reduce((f,p)=>{let[g,v]=p;return v===void 0||(f[g]=v),f},{}),u=e==null||(r=e.compoundVariants)===null||r===void 0?void 0:r.reduce((f,p)=>{let{class:g,className:v,...y}=p;return Object.entries(y).every(w=>{let[S,C]=w;return Array.isArray(C)?C.includes({...o,...c}[S]):{...o,...c}[S]===C})?[...f,g,v]:f},[]);return aC(t,a,u,n?.class,n?.className)},q5=(t,e)=>{const n=new Array(t.length+e.length);for(let r=0;r<t.length;r++)n[r]=t[r];for(let r=0;r<e.length;r++)n[t.length+r]=e[r];return n},G5=(t,e)=>({classGroupId:t,validator:e}),FA=(t=new Map,e=null,n)=>({nextPart:t,validators:e,classGroupId:n}),yh="-",lC=[],W5="arbitrary..",Y5=t=>{const e=X5(t),{conflictingClassGroups:n,conflictingClassGroupModifiers:r}=t;return{getClassGroupId:a=>{if(a.startsWith("[")&&a.endsWith("]"))return K5(a);const c=a.split(yh),u=c[0]===""&&c.length>1?1:0;return $A(c,u,e)},getConflictingClassGroupIds:(a,c)=>{if(c){const u=r[a],f=n[a];return u?f?q5(f,u):u:f||lC}return n[a]||lC}}},$A=(t,e,n)=>{if(t.length-e===0)return n.classGroupId;const i=t[e],o=n.nextPart.get(i);if(o){const f=$A(t,e+1,o);if(f)return f}const a=n.validators;if(a===null)return;const c=e===0?t.join(yh):t.slice(e).join(yh),u=a.length;for(let f=0;f<u;f++){const p=a[f];if(p.validator(c))return p.classGroupId}},K5=t=>t.slice(1,-1).indexOf(":")===-1?void 0:(()=>{const e=t.slice(1,-1),n=e.indexOf(":"),r=e.slice(0,n);return r?W5+r:void 0})(),X5=t=>{const{theme:e,classGroups:n}=t;return J5(n,e)},J5=(t,e)=>{const n=FA();for(const r in t){const i=t[r];mb(i,n,r,e)}return n},mb=(t,e,n,r)=>{const i=t.length;for(let o=0;o<i;o++){const a=t[o];Q5(a,e,n,r)}},Q5=(t,e,n,r)=>{if(typeof t=="string"){Z5(t,e,n);return}if(typeof t=="function"){e4(t,e,n,r);return}t4(t,e,n,r)},Z5=(t,e,n)=>{const r=t===""?e:HA(e,t);r.classGroupId=n},e4=(t,e,n,r)=>{if(n4(t)){mb(t(r),e,n,r);return}e.validators===null&&(e.validators=[]),e.validators.push(G5(n,t))},t4=(t,e,n,r)=>{const i=Object.entries(t),o=i.length;for(let a=0;a<o;a++){const[c,u]=i[a];mb(u,HA(e,c),n,r)}},HA=(t,e)=>{let n=t;const r=e.split(yh),i=r.length;for(let o=0;o<i;o++){const a=r[o];let c=n.nextPart.get(a);c||(c=FA(),n.nextPart.set(a,c)),n=c}return n},n4=t=>"isThemeGetter"in t&&t.isThemeGetter===!0,r4=t=>{if(t<1)return{get:()=>{},set:()=>{}};let e=0,n=Object.create(null),r=Object.create(null);const i=(o,a)=>{n[o]=a,e++,e>t&&(e=0,r=n,n=Object.create(null))};return{get(o){let a=n[o];if(a!==void 0)return a;if((a=r[o])!==void 0)return i(o,a),a},set(o,a){o in n?n[o]=a:i(o,a)}}},$v="!",cC=":",i4=[],uC=(t,e,n,r,i)=>({modifiers:t,hasImportantModifier:e,baseClassName:n,maybePostfixModifierPosition:r,isExternal:i}),o4=t=>{const{prefix:e,experimentalParseClassName:n}=t;let r=i=>{const o=[];let a=0,c=0,u=0,f;const p=i.length;for(let S=0;S<p;S++){const C=i[S];if(a===0&&c===0){if(C===cC){o.push(i.slice(u,S)),u=S+1;continue}if(C==="/"){f=S;continue}}C==="["?a++:C==="]"?a--:C==="("?c++:C===")"&&c--}const g=o.length===0?i:i.slice(u);let v=g,y=!1;g.endsWith($v)?(v=g.slice(0,-1),y=!0):g.startsWith($v)&&(v=g.slice(1),y=!0);const w=f&&f>u?f-u:void 0;return uC(o,y,v,w)};if(e){const i=e+cC,o=r;r=a=>a.startsWith(i)?o(a.slice(i.length)):uC(i4,!1,a,void 0,!0)}if(n){const i=r;r=o=>n({className:o,parseClassName:i})}return r},s4=t=>{const e=new Map;return t.orderSensitiveModifiers.forEach((n,r)=>{e.set(n,1e6+r)}),n=>{const r=[];let i=[];for(let o=0;o<n.length;o++){const a=n[o],c=a[0]==="[",u=e.has(a);c||u?(i.length>0&&(i.sort(),r.push(...i),i=[]),r.push(a)):i.push(a)}return i.length>0&&(i.sort(),r.push(...i)),r}},a4=t=>({cache:r4(t.cacheSize),parseClassName:o4(t),sortModifiers:s4(t),...Y5(t)}),l4=/\s+/,c4=(t,e)=>{const{parseClassName:n,getClassGroupId:r,getConflictingClassGroupIds:i,sortModifiers:o}=e,a=[],c=t.trim().split(l4);let u="";for(let f=c.length-1;f>=0;f-=1){const p=c[f],{isExternal:g,modifiers:v,hasImportantModifier:y,baseClassName:w,maybePostfixModifierPosition:S}=n(p);if(g){u=p+(u.length>0?" "+u:u);continue}let C=!!S,T=r(C?w.substring(0,S):w);if(!T){if(!C){u=p+(u.length>0?" "+u:u);continue}if(T=r(w),!T){u=p+(u.length>0?" "+u:u);continue}C=!1}const N=v.length===0?"":v.length===1?v[0]:o(v).join(":"),k=y?N+$v:N,D=k+T;if(a.indexOf(D)>-1)continue;a.push(D);const M=i(T,C);for(let R=0;R<M.length;++R){const O=M[R];a.push(k+O)}u=p+(u.length>0?" "+u:u)}return u},u4=(...t)=>{let e=0,n,r,i="";for(;e<t.length;)(n=t[e++])&&(r=UA(n))&&(i&&(i+=" "),i+=r);return i},UA=t=>{if(typeof t=="string")return t;let e,n="";for(let r=0;r<t.length;r++)t[r]&&(e=UA(t[r]))&&(n&&(n+=" "),n+=e);return n},d4=(t,...e)=>{let n,r,i,o;const a=u=>{const f=e.reduce((p,g)=>g(p),t());return n=a4(f),r=n.cache.get,i=n.cache.set,o=c,c(u)},c=u=>{const f=r(u);if(f)return f;const p=c4(u,n);return i(u,p),p};return o=a,(...u)=>o(u4(...u))},f4=[],Cn=t=>{const e=n=>n[t]||f4;return e.isThemeGetter=!0,e},VA=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,qA=/^\((?:(\w[\w-]*):)?(.+)\)$/i,h4=/^\d+\/\d+$/,p4=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,m4=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,g4=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,y4=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,v4=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,sl=t=>h4.test(t),bt=t=>!!t&&!Number.isNaN(Number(t)),Vo=t=>!!t&&Number.isInteger(Number(t)),Ry=t=>t.endsWith("%")&&bt(t.slice(0,-1)),Qi=t=>p4.test(t),x4=()=>!0,b4=t=>m4.test(t)&&!g4.test(t),GA=()=>!1,w4=t=>y4.test(t),S4=t=>v4.test(t),E4=t=>!Fe(t)&&!$e(t),C4=t=>Ul(t,KA,GA),Fe=t=>VA.test(t),Vs=t=>Ul(t,XA,b4),jy=t=>Ul(t,D4,bt),dC=t=>Ul(t,WA,GA),T4=t=>Ul(t,YA,S4),Ef=t=>Ul(t,JA,w4),$e=t=>qA.test(t),Wc=t=>Vl(t,XA),N4=t=>Vl(t,O4),fC=t=>Vl(t,WA),A4=t=>Vl(t,KA),k4=t=>Vl(t,YA),Cf=t=>Vl(t,JA,!0),Ul=(t,e,n)=>{const r=VA.exec(t);return r?r[1]?e(r[1]):n(r[2]):!1},Vl=(t,e,n=!1)=>{const r=qA.exec(t);return r?r[1]?e(r[1]):n:!1},WA=t=>t==="position"||t==="percentage",YA=t=>t==="image"||t==="url",KA=t=>t==="length"||t==="size"||t==="bg-size",XA=t=>t==="length",D4=t=>t==="number",O4=t=>t==="family-name",JA=t=>t==="shadow",M4=()=>{const t=Cn("color"),e=Cn("font"),n=Cn("text"),r=Cn("font-weight"),i=Cn("tracking"),o=Cn("leading"),a=Cn("breakpoint"),c=Cn("container"),u=Cn("spacing"),f=Cn("radius"),p=Cn("shadow"),g=Cn("inset-shadow"),v=Cn("text-shadow"),y=Cn("drop-shadow"),w=Cn("blur"),S=Cn("perspective"),C=Cn("aspect"),T=Cn("ease"),N=Cn("animate"),k=()=>["auto","avoid","all","avoid-page","page","left","right","column"],D=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],M=()=>[...D(),$e,Fe],R=()=>["auto","hidden","clip","visible","scroll"],O=()=>["auto","contain","none"],I=()=>[$e,Fe,u],z=()=>[sl,"full","auto",...I()],U=()=>[Vo,"none","subgrid",$e,Fe],Y=()=>["auto",{span:["full",Vo,$e,Fe]},Vo,$e,Fe],W=()=>[Vo,"auto",$e,Fe],j=()=>["auto","min","max","fr",$e,Fe],G=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],oe=()=>["start","end","center","stretch","center-safe","end-safe"],L=()=>["auto",...I()],$=()=>[sl,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...I()],V=()=>[t,$e,Fe],we=()=>[...D(),fC,dC,{position:[$e,Fe]}],pe=()=>["no-repeat",{repeat:["","x","y","space","round"]}],P=()=>["auto","cover","contain",A4,C4,{size:[$e,Fe]}],K=()=>[Ry,Wc,Vs],B=()=>["","none","full",f,$e,Fe],Z=()=>["",bt,Wc,Vs],le=()=>["solid","dashed","dotted","double"],be=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],H=()=>[bt,Ry,fC,dC],ce=()=>["","none",w,$e,Fe],te=()=>["none",bt,$e,Fe],me=()=>["none",bt,$e,Fe],Te=()=>[bt,$e,Fe],re=()=>[sl,"full",...I()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[Qi],breakpoint:[Qi],color:[x4],container:[Qi],"drop-shadow":[Qi],ease:["in","out","in-out"],font:[E4],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[Qi],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[Qi],shadow:[Qi],spacing:["px",bt],text:[Qi],"text-shadow":[Qi],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",sl,Fe,$e,C]}],container:["container"],columns:[{columns:[bt,Fe,$e,c]}],"break-after":[{"break-after":k()}],"break-before":[{"break-before":k()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:M()}],overflow:[{overflow:R()}],"overflow-x":[{"overflow-x":R()}],"overflow-y":[{"overflow-y":R()}],overscroll:[{overscroll:O()}],"overscroll-x":[{"overscroll-x":O()}],"overscroll-y":[{"overscroll-y":O()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:z()}],"inset-x":[{"inset-x":z()}],"inset-y":[{"inset-y":z()}],start:[{start:z()}],end:[{end:z()}],top:[{top:z()}],right:[{right:z()}],bottom:[{bottom:z()}],left:[{left:z()}],visibility:["visible","invisible","collapse"],z:[{z:[Vo,"auto",$e,Fe]}],basis:[{basis:[sl,"full","auto",c,...I()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[bt,sl,"auto","initial","none",Fe]}],grow:[{grow:["",bt,$e,Fe]}],shrink:[{shrink:["",bt,$e,Fe]}],order:[{order:[Vo,"first","last","none",$e,Fe]}],"grid-cols":[{"grid-cols":U()}],"col-start-end":[{col:Y()}],"col-start":[{"col-start":W()}],"col-end":[{"col-end":W()}],"grid-rows":[{"grid-rows":U()}],"row-start-end":[{row:Y()}],"row-start":[{"row-start":W()}],"row-end":[{"row-end":W()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":j()}],"auto-rows":[{"auto-rows":j()}],gap:[{gap:I()}],"gap-x":[{"gap-x":I()}],"gap-y":[{"gap-y":I()}],"justify-content":[{justify:[...G(),"normal"]}],"justify-items":[{"justify-items":[...oe(),"normal"]}],"justify-self":[{"justify-self":["auto",...oe()]}],"align-content":[{content:["normal",...G()]}],"align-items":[{items:[...oe(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...oe(),{baseline:["","last"]}]}],"place-content":[{"place-content":G()}],"place-items":[{"place-items":[...oe(),"baseline"]}],"place-self":[{"place-self":["auto",...oe()]}],p:[{p:I()}],px:[{px:I()}],py:[{py:I()}],ps:[{ps:I()}],pe:[{pe:I()}],pt:[{pt:I()}],pr:[{pr:I()}],pb:[{pb:I()}],pl:[{pl:I()}],m:[{m:L()}],mx:[{mx:L()}],my:[{my:L()}],ms:[{ms:L()}],me:[{me:L()}],mt:[{mt:L()}],mr:[{mr:L()}],mb:[{mb:L()}],ml:[{ml:L()}],"space-x":[{"space-x":I()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":I()}],"space-y-reverse":["space-y-reverse"],size:[{size:$()}],w:[{w:[c,"screen",...$()]}],"min-w":[{"min-w":[c,"screen","none",...$()]}],"max-w":[{"max-w":[c,"screen","none","prose",{screen:[a]},...$()]}],h:[{h:["screen","lh",...$()]}],"min-h":[{"min-h":["screen","lh","none",...$()]}],"max-h":[{"max-h":["screen","lh",...$()]}],"font-size":[{text:["base",n,Wc,Vs]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[r,$e,jy]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",Ry,Fe]}],"font-family":[{font:[N4,Fe,e]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[i,$e,Fe]}],"line-clamp":[{"line-clamp":[bt,"none",$e,jy]}],leading:[{leading:[o,...I()]}],"list-image":[{"list-image":["none",$e,Fe]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",$e,Fe]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:V()}],"text-color":[{text:V()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...le(),"wavy"]}],"text-decoration-thickness":[{decoration:[bt,"from-font","auto",$e,Vs]}],"text-decoration-color":[{decoration:V()}],"underline-offset":[{"underline-offset":[bt,"auto",$e,Fe]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:I()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",$e,Fe]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",$e,Fe]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:we()}],"bg-repeat":[{bg:pe()}],"bg-size":[{bg:P()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},Vo,$e,Fe],radial:["",$e,Fe],conic:[Vo,$e,Fe]},k4,T4]}],"bg-color":[{bg:V()}],"gradient-from-pos":[{from:K()}],"gradient-via-pos":[{via:K()}],"gradient-to-pos":[{to:K()}],"gradient-from":[{from:V()}],"gradient-via":[{via:V()}],"gradient-to":[{to:V()}],rounded:[{rounded:B()}],"rounded-s":[{"rounded-s":B()}],"rounded-e":[{"rounded-e":B()}],"rounded-t":[{"rounded-t":B()}],"rounded-r":[{"rounded-r":B()}],"rounded-b":[{"rounded-b":B()}],"rounded-l":[{"rounded-l":B()}],"rounded-ss":[{"rounded-ss":B()}],"rounded-se":[{"rounded-se":B()}],"rounded-ee":[{"rounded-ee":B()}],"rounded-es":[{"rounded-es":B()}],"rounded-tl":[{"rounded-tl":B()}],"rounded-tr":[{"rounded-tr":B()}],"rounded-br":[{"rounded-br":B()}],"rounded-bl":[{"rounded-bl":B()}],"border-w":[{border:Z()}],"border-w-x":[{"border-x":Z()}],"border-w-y":[{"border-y":Z()}],"border-w-s":[{"border-s":Z()}],"border-w-e":[{"border-e":Z()}],"border-w-t":[{"border-t":Z()}],"border-w-r":[{"border-r":Z()}],"border-w-b":[{"border-b":Z()}],"border-w-l":[{"border-l":Z()}],"divide-x":[{"divide-x":Z()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":Z()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...le(),"hidden","none"]}],"divide-style":[{divide:[...le(),"hidden","none"]}],"border-color":[{border:V()}],"border-color-x":[{"border-x":V()}],"border-color-y":[{"border-y":V()}],"border-color-s":[{"border-s":V()}],"border-color-e":[{"border-e":V()}],"border-color-t":[{"border-t":V()}],"border-color-r":[{"border-r":V()}],"border-color-b":[{"border-b":V()}],"border-color-l":[{"border-l":V()}],"divide-color":[{divide:V()}],"outline-style":[{outline:[...le(),"none","hidden"]}],"outline-offset":[{"outline-offset":[bt,$e,Fe]}],"outline-w":[{outline:["",bt,Wc,Vs]}],"outline-color":[{outline:V()}],shadow:[{shadow:["","none",p,Cf,Ef]}],"shadow-color":[{shadow:V()}],"inset-shadow":[{"inset-shadow":["none",g,Cf,Ef]}],"inset-shadow-color":[{"inset-shadow":V()}],"ring-w":[{ring:Z()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:V()}],"ring-offset-w":[{"ring-offset":[bt,Vs]}],"ring-offset-color":[{"ring-offset":V()}],"inset-ring-w":[{"inset-ring":Z()}],"inset-ring-color":[{"inset-ring":V()}],"text-shadow":[{"text-shadow":["none",v,Cf,Ef]}],"text-shadow-color":[{"text-shadow":V()}],opacity:[{opacity:[bt,$e,Fe]}],"mix-blend":[{"mix-blend":[...be(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":be()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[bt]}],"mask-image-linear-from-pos":[{"mask-linear-from":H()}],"mask-image-linear-to-pos":[{"mask-linear-to":H()}],"mask-image-linear-from-color":[{"mask-linear-from":V()}],"mask-image-linear-to-color":[{"mask-linear-to":V()}],"mask-image-t-from-pos":[{"mask-t-from":H()}],"mask-image-t-to-pos":[{"mask-t-to":H()}],"mask-image-t-from-color":[{"mask-t-from":V()}],"mask-image-t-to-color":[{"mask-t-to":V()}],"mask-image-r-from-pos":[{"mask-r-from":H()}],"mask-image-r-to-pos":[{"mask-r-to":H()}],"mask-image-r-from-color":[{"mask-r-from":V()}],"mask-image-r-to-color":[{"mask-r-to":V()}],"mask-image-b-from-pos":[{"mask-b-from":H()}],"mask-image-b-to-pos":[{"mask-b-to":H()}],"mask-image-b-from-color":[{"mask-b-from":V()}],"mask-image-b-to-color":[{"mask-b-to":V()}],"mask-image-l-from-pos":[{"mask-l-from":H()}],"mask-image-l-to-pos":[{"mask-l-to":H()}],"mask-image-l-from-color":[{"mask-l-from":V()}],"mask-image-l-to-color":[{"mask-l-to":V()}],"mask-image-x-from-pos":[{"mask-x-from":H()}],"mask-image-x-to-pos":[{"mask-x-to":H()}],"mask-image-x-from-color":[{"mask-x-from":V()}],"mask-image-x-to-color":[{"mask-x-to":V()}],"mask-image-y-from-pos":[{"mask-y-from":H()}],"mask-image-y-to-pos":[{"mask-y-to":H()}],"mask-image-y-from-color":[{"mask-y-from":V()}],"mask-image-y-to-color":[{"mask-y-to":V()}],"mask-image-radial":[{"mask-radial":[$e,Fe]}],"mask-image-radial-from-pos":[{"mask-radial-from":H()}],"mask-image-radial-to-pos":[{"mask-radial-to":H()}],"mask-image-radial-from-color":[{"mask-radial-from":V()}],"mask-image-radial-to-color":[{"mask-radial-to":V()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":D()}],"mask-image-conic-pos":[{"mask-conic":[bt]}],"mask-image-conic-from-pos":[{"mask-conic-from":H()}],"mask-image-conic-to-pos":[{"mask-conic-to":H()}],"mask-image-conic-from-color":[{"mask-conic-from":V()}],"mask-image-conic-to-color":[{"mask-conic-to":V()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:we()}],"mask-repeat":[{mask:pe()}],"mask-size":[{mask:P()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",$e,Fe]}],filter:[{filter:["","none",$e,Fe]}],blur:[{blur:ce()}],brightness:[{brightness:[bt,$e,Fe]}],contrast:[{contrast:[bt,$e,Fe]}],"drop-shadow":[{"drop-shadow":["","none",y,Cf,Ef]}],"drop-shadow-color":[{"drop-shadow":V()}],grayscale:[{grayscale:["",bt,$e,Fe]}],"hue-rotate":[{"hue-rotate":[bt,$e,Fe]}],invert:[{invert:["",bt,$e,Fe]}],saturate:[{saturate:[bt,$e,Fe]}],sepia:[{sepia:["",bt,$e,Fe]}],"backdrop-filter":[{"backdrop-filter":["","none",$e,Fe]}],"backdrop-blur":[{"backdrop-blur":ce()}],"backdrop-brightness":[{"backdrop-brightness":[bt,$e,Fe]}],"backdrop-contrast":[{"backdrop-contrast":[bt,$e,Fe]}],"backdrop-grayscale":[{"backdrop-grayscale":["",bt,$e,Fe]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[bt,$e,Fe]}],"backdrop-invert":[{"backdrop-invert":["",bt,$e,Fe]}],"backdrop-opacity":[{"backdrop-opacity":[bt,$e,Fe]}],"backdrop-saturate":[{"backdrop-saturate":[bt,$e,Fe]}],"backdrop-sepia":[{"backdrop-sepia":["",bt,$e,Fe]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":I()}],"border-spacing-x":[{"border-spacing-x":I()}],"border-spacing-y":[{"border-spacing-y":I()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",$e,Fe]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[bt,"initial",$e,Fe]}],ease:[{ease:["linear","initial",T,$e,Fe]}],delay:[{delay:[bt,$e,Fe]}],animate:[{animate:["none",N,$e,Fe]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[S,$e,Fe]}],"perspective-origin":[{"perspective-origin":M()}],rotate:[{rotate:te()}],"rotate-x":[{"rotate-x":te()}],"rotate-y":[{"rotate-y":te()}],"rotate-z":[{"rotate-z":te()}],scale:[{scale:me()}],"scale-x":[{"scale-x":me()}],"scale-y":[{"scale-y":me()}],"scale-z":[{"scale-z":me()}],"scale-3d":["scale-3d"],skew:[{skew:Te()}],"skew-x":[{"skew-x":Te()}],"skew-y":[{"skew-y":Te()}],transform:[{transform:[$e,Fe,"","none","gpu","cpu"]}],"transform-origin":[{origin:M()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:re()}],"translate-x":[{"translate-x":re()}],"translate-y":[{"translate-y":re()}],"translate-z":[{"translate-z":re()}],"translate-none":["translate-none"],accent:[{accent:V()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:V()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",$e,Fe]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":I()}],"scroll-mx":[{"scroll-mx":I()}],"scroll-my":[{"scroll-my":I()}],"scroll-ms":[{"scroll-ms":I()}],"scroll-me":[{"scroll-me":I()}],"scroll-mt":[{"scroll-mt":I()}],"scroll-mr":[{"scroll-mr":I()}],"scroll-mb":[{"scroll-mb":I()}],"scroll-ml":[{"scroll-ml":I()}],"scroll-p":[{"scroll-p":I()}],"scroll-px":[{"scroll-px":I()}],"scroll-py":[{"scroll-py":I()}],"scroll-ps":[{"scroll-ps":I()}],"scroll-pe":[{"scroll-pe":I()}],"scroll-pt":[{"scroll-pt":I()}],"scroll-pr":[{"scroll-pr":I()}],"scroll-pb":[{"scroll-pb":I()}],"scroll-pl":[{"scroll-pl":I()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",$e,Fe]}],fill:[{fill:["none",...V()]}],"stroke-w":[{stroke:[bt,Wc,Vs,jy]}],stroke:[{stroke:["none",...V()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}},R4=d4(M4);function Wt(...t){return R4(BA(t))}const j4=V5("inline-flex items-center justify-center rounded-md font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 text-[9px] sm:text-xs",{variants:{variant:{default:"bg-inputScale-2 text-white border border-borderScale-0 rounded cursor-pointer z-[100] touch-manipulation hover:bg-inputScale-2/90",ghost:"hover:bg-accent hover:text-accent-foreground"},size:{default:"h-9 px-1 py-2",sm:"h-auto px-1",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}});function _e({className:t,variant:e,size:n,asChild:r=!1,...i}){const o=r?z5:"button";return h.jsx(o,{className:Wt(j4({variant:e,size:n,className:t})),...i})}function Nu(t,[e,n]){return Math.min(n,Math.max(e,t))}function Ve(t,e,{checkForDefaultPrevented:n=!0}={}){return function(i){if(t?.(i),n===!1||!i.defaultPrevented)return e?.(i)}}function I4(t,e){const n=x.createContext(e),r=o=>{const{children:a,...c}=o,u=x.useMemo(()=>c,Object.values(c));return h.jsx(n.Provider,{value:u,children:a})};r.displayName=t+"Provider";function i(o){const a=x.useContext(n);if(a)return a;if(e!==void 0)return e;throw new Error(`\`${o}\` must be used within \`${t}\``)}return[r,i]}function Wr(t,e=[]){let n=[];function r(o,a){const c=x.createContext(a),u=n.length;n=[...n,a];const f=g=>{const{scope:v,children:y,...w}=g,S=v?.[t]?.[u]||c,C=x.useMemo(()=>w,Object.values(w));return h.jsx(S.Provider,{value:C,children:y})};f.displayName=o+"Provider";function p(g,v){const y=v?.[t]?.[u]||c,w=x.useContext(y);if(w)return w;if(a!==void 0)return a;throw new Error(`\`${g}\` must be used within \`${o}\``)}return[f,p]}const i=()=>{const o=n.map(a=>x.createContext(a));return function(c){const u=c?.[t]||o;return x.useMemo(()=>({[`__scope${t}`]:{...c,[t]:u}}),[c,u])}};return i.scopeName=t,[r,_4(i,...e)]}function _4(...t){const e=t[0];if(t.length===1)return e;const n=()=>{const r=t.map(i=>({useScope:i(),scopeName:i.scopeName}));return function(o){const a=r.reduce((c,{useScope:u,scopeName:f})=>{const g=u(o)[`__scope${f}`];return{...c,...g}},{});return x.useMemo(()=>({[`__scope${e.scopeName}`]:a}),[a])}};return n.scopeName=e.scopeName,n}function hC(t){const e=L4(t),n=x.forwardRef((r,i)=>{const{children:o,...a}=r,c=x.Children.toArray(o),u=c.find(z4);if(u){const f=u.props.children,p=c.map(g=>g===u?x.Children.count(f)>1?x.Children.only(null):x.isValidElement(f)?f.props.children:null:g);return h.jsx(e,{...a,ref:i,children:x.isValidElement(f)?x.cloneElement(f,void 0,p):null})}return h.jsx(e,{...a,ref:i,children:o})});return n.displayName=`${t}.Slot`,n}function L4(t){const e=x.forwardRef((n,r)=>{const{children:i,...o}=n;if(x.isValidElement(i)){const a=F4(i),c=B4(o,i.props);return i.type!==x.Fragment&&(c.ref=r?ga(r,a):a),x.cloneElement(i,c)}return x.Children.count(i)>1?x.Children.only(null):null});return e.displayName=`${t}.SlotClone`,e}var P4=Symbol("radix.slottable");function z4(t){return x.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===P4}function B4(t,e){const n={...e};for(const r in e){const i=t[r],o=e[r];/^on[A-Z]/.test(r)?i&&o?n[r]=(...c)=>{const u=o(...c);return i(...c),u}:i&&(n[r]=i):r==="style"?n[r]={...i,...o}:r==="className"&&(n[r]=[i,o].filter(Boolean).join(" "))}return{...t,...n}}function F4(t){let e=Object.getOwnPropertyDescriptor(t.props,"ref")?.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=Object.getOwnPropertyDescriptor(t,"ref")?.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}function gb(t){const e=t+"CollectionProvider",[n,r]=Wr(e),[i,o]=n(e,{collectionRef:{current:null},itemMap:new Map}),a=S=>{const{scope:C,children:T}=S,N=Se.useRef(null),k=Se.useRef(new Map).current;return h.jsx(i,{scope:C,itemMap:k,collectionRef:N,children:T})};a.displayName=e;const c=t+"CollectionSlot",u=hC(c),f=Se.forwardRef((S,C)=>{const{scope:T,children:N}=S,k=o(c,T),D=ht(C,k.collectionRef);return h.jsx(u,{ref:D,children:N})});f.displayName=c;const p=t+"CollectionItemSlot",g="data-radix-collection-item",v=hC(p),y=Se.forwardRef((S,C)=>{const{scope:T,children:N,...k}=S,D=Se.useRef(null),M=ht(C,D),R=o(p,T);return Se.useEffect(()=>(R.itemMap.set(D,{ref:D,...k}),()=>{R.itemMap.delete(D)})),h.jsx(v,{[g]:"",ref:M,children:N})});y.displayName=p;function w(S){const C=o(t+"CollectionConsumer",S);return Se.useCallback(()=>{const N=C.collectionRef.current;if(!N)return[];const k=Array.from(N.querySelectorAll(`[${g}]`));return Array.from(C.itemMap.values()).sort((R,O)=>k.indexOf(R.ref.current)-k.indexOf(O.ref.current))},[C.collectionRef,C.itemMap])}return[{Provider:a,Slot:f,ItemSlot:y},w,r]}var $4=x.createContext(void 0);function Ku(t){const e=x.useContext($4);return t||e||"ltr"}function H4(t){const e=U4(t),n=x.forwardRef((r,i)=>{const{children:o,...a}=r,c=x.Children.toArray(o),u=c.find(q4);if(u){const f=u.props.children,p=c.map(g=>g===u?x.Children.count(f)>1?x.Children.only(null):x.isValidElement(f)?f.props.children:null:g);return h.jsx(e,{...a,ref:i,children:x.isValidElement(f)?x.cloneElement(f,void 0,p):null})}return h.jsx(e,{...a,ref:i,children:o})});return n.displayName=`${t}.Slot`,n}function U4(t){const e=x.forwardRef((n,r)=>{const{children:i,...o}=n;if(x.isValidElement(i)){const a=W4(i),c=G4(o,i.props);return i.type!==x.Fragment&&(c.ref=r?ga(r,a):a),x.cloneElement(i,c)}return x.Children.count(i)>1?x.Children.only(null):null});return e.displayName=`${t}.SlotClone`,e}var V4=Symbol("radix.slottable");function q4(t){return x.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===V4}function G4(t,e){const n={...e};for(const r in e){const i=t[r],o=e[r];/^on[A-Z]/.test(r)?i&&o?n[r]=(...c)=>{const u=o(...c);return i(...c),u}:i&&(n[r]=i):r==="style"?n[r]={...i,...o}:r==="className"&&(n[r]=[i,o].filter(Boolean).join(" "))}return{...t,...n}}function W4(t){let e=Object.getOwnPropertyDescriptor(t.props,"ref")?.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=Object.getOwnPropertyDescriptor(t,"ref")?.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}var Y4=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],it=Y4.reduce((t,e)=>{const n=H4(`Primitive.${e}`),r=x.forwardRef((i,o)=>{const{asChild:a,...c}=i,u=a?n:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),h.jsx(u,{...c,ref:o})});return r.displayName=`Primitive.${e}`,{...t,[e]:r}},{});function K4(t,e){t&&yo.flushSync(()=>t.dispatchEvent(e))}function Qn(t){const e=x.useRef(t);return x.useEffect(()=>{e.current=t}),x.useMemo(()=>(...n)=>e.current?.(...n),[])}function X4(t,e=globalThis?.document){const n=Qn(t);x.useEffect(()=>{const r=i=>{i.key==="Escape"&&n(i)};return e.addEventListener("keydown",r,{capture:!0}),()=>e.removeEventListener("keydown",r,{capture:!0})},[n,e])}var J4="DismissableLayer",Hv="dismissableLayer.update",Q4="dismissableLayer.pointerDownOutside",Z4="dismissableLayer.focusOutside",pC,QA=x.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Xu=x.forwardRef((t,e)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:r,onPointerDownOutside:i,onFocusOutside:o,onInteractOutside:a,onDismiss:c,...u}=t,f=x.useContext(QA),[p,g]=x.useState(null),v=p?.ownerDocument??globalThis?.document,[,y]=x.useState({}),w=ht(e,O=>g(O)),S=Array.from(f.layers),[C]=[...f.layersWithOutsidePointerEventsDisabled].slice(-1),T=S.indexOf(C),N=p?S.indexOf(p):-1,k=f.layersWithOutsidePointerEventsDisabled.size>0,D=N>=T,M=nz(O=>{const I=O.target,z=[...f.branches].some(U=>U.contains(I));!D||z||(i?.(O),a?.(O),O.defaultPrevented||c?.())},v),R=rz(O=>{const I=O.target;[...f.branches].some(U=>U.contains(I))||(o?.(O),a?.(O),O.defaultPrevented||c?.())},v);return X4(O=>{N===f.layers.size-1&&(r?.(O),!O.defaultPrevented&&c&&(O.preventDefault(),c()))},v),x.useEffect(()=>{if(p)return n&&(f.layersWithOutsidePointerEventsDisabled.size===0&&(pC=v.body.style.pointerEvents,v.body.style.pointerEvents="none"),f.layersWithOutsidePointerEventsDisabled.add(p)),f.layers.add(p),mC(),()=>{n&&f.layersWithOutsidePointerEventsDisabled.size===1&&(v.body.style.pointerEvents=pC)}},[p,v,n,f]),x.useEffect(()=>()=>{p&&(f.layers.delete(p),f.layersWithOutsidePointerEventsDisabled.delete(p),mC())},[p,f]),x.useEffect(()=>{const O=()=>y({});return document.addEventListener(Hv,O),()=>document.removeEventListener(Hv,O)},[]),h.jsx(it.div,{...u,ref:w,style:{pointerEvents:k?D?"auto":"none":void 0,...t.style},onFocusCapture:Ve(t.onFocusCapture,R.onFocusCapture),onBlurCapture:Ve(t.onBlurCapture,R.onBlurCapture),onPointerDownCapture:Ve(t.onPointerDownCapture,M.onPointerDownCapture)})});Xu.displayName=J4;var ez="DismissableLayerBranch",tz=x.forwardRef((t,e)=>{const n=x.useContext(QA),r=x.useRef(null),i=ht(e,r);return x.useEffect(()=>{const o=r.current;if(o)return n.branches.add(o),()=>{n.branches.delete(o)}},[n.branches]),h.jsx(it.div,{...t,ref:i})});tz.displayName=ez;function nz(t,e=globalThis?.document){const n=Qn(t),r=x.useRef(!1),i=x.useRef(()=>{});return x.useEffect(()=>{const o=c=>{if(c.target&&!r.current){let u=function(){ZA(Q4,n,f,{discrete:!0})};const f={originalEvent:c};c.pointerType==="touch"?(e.removeEventListener("click",i.current),i.current=u,e.addEventListener("click",i.current,{once:!0})):u()}else e.removeEventListener("click",i.current);r.current=!1},a=window.setTimeout(()=>{e.addEventListener("pointerdown",o)},0);return()=>{window.clearTimeout(a),e.removeEventListener("pointerdown",o),e.removeEventListener("click",i.current)}},[e,n]),{onPointerDownCapture:()=>r.current=!0}}function rz(t,e=globalThis?.document){const n=Qn(t),r=x.useRef(!1);return x.useEffect(()=>{const i=o=>{o.target&&!r.current&&ZA(Z4,n,{originalEvent:o},{discrete:!1})};return e.addEventListener("focusin",i),()=>e.removeEventListener("focusin",i)},[e,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function mC(){const t=new CustomEvent(Hv);document.dispatchEvent(t)}function ZA(t,e,n,{discrete:r}){const i=n.originalEvent.target,o=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:n});e&&i.addEventListener(t,e,{once:!0}),r?K4(i,o):i.dispatchEvent(o)}var Iy=0;function yb(){x.useEffect(()=>{const t=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",t[0]??gC()),document.body.insertAdjacentElement("beforeend",t[1]??gC()),Iy++,()=>{Iy===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(e=>e.remove()),Iy--}},[])}function gC(){const t=document.createElement("span");return t.setAttribute("data-radix-focus-guard",""),t.tabIndex=0,t.style.outline="none",t.style.opacity="0",t.style.position="fixed",t.style.pointerEvents="none",t}var _y="focusScope.autoFocusOnMount",Ly="focusScope.autoFocusOnUnmount",yC={bubbles:!1,cancelable:!0},iz="FocusScope",Np=x.forwardRef((t,e)=>{const{loop:n=!1,trapped:r=!1,onMountAutoFocus:i,onUnmountAutoFocus:o,...a}=t,[c,u]=x.useState(null),f=Qn(i),p=Qn(o),g=x.useRef(null),v=ht(e,S=>u(S)),y=x.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;x.useEffect(()=>{if(r){let S=function(k){if(y.paused||!c)return;const D=k.target;c.contains(D)?g.current=D:Yo(g.current,{select:!0})},C=function(k){if(y.paused||!c)return;const D=k.relatedTarget;D!==null&&(c.contains(D)||Yo(g.current,{select:!0}))},T=function(k){if(document.activeElement===document.body)for(const M of k)M.removedNodes.length>0&&Yo(c)};document.addEventListener("focusin",S),document.addEventListener("focusout",C);const N=new MutationObserver(T);return c&&N.observe(c,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",S),document.removeEventListener("focusout",C),N.disconnect()}}},[r,c,y.paused]),x.useEffect(()=>{if(c){xC.add(y);const S=document.activeElement;if(!c.contains(S)){const T=new CustomEvent(_y,yC);c.addEventListener(_y,f),c.dispatchEvent(T),T.defaultPrevented||(oz(uz(ek(c)),{select:!0}),document.activeElement===S&&Yo(c))}return()=>{c.removeEventListener(_y,f),setTimeout(()=>{const T=new CustomEvent(Ly,yC);c.addEventListener(Ly,p),c.dispatchEvent(T),T.defaultPrevented||Yo(S??document.body,{select:!0}),c.removeEventListener(Ly,p),xC.remove(y)},0)}}},[c,f,p,y]);const w=x.useCallback(S=>{if(!n&&!r||y.paused)return;const C=S.key==="Tab"&&!S.altKey&&!S.ctrlKey&&!S.metaKey,T=document.activeElement;if(C&&T){const N=S.currentTarget,[k,D]=sz(N);k&&D?!S.shiftKey&&T===D?(S.preventDefault(),n&&Yo(k,{select:!0})):S.shiftKey&&T===k&&(S.preventDefault(),n&&Yo(D,{select:!0})):T===N&&S.preventDefault()}},[n,r,y.paused]);return h.jsx(it.div,{tabIndex:-1,...a,ref:v,onKeyDown:w})});Np.displayName=iz;function oz(t,{select:e=!1}={}){const n=document.activeElement;for(const r of t)if(Yo(r,{select:e}),document.activeElement!==n)return}function sz(t){const e=ek(t),n=vC(e,t),r=vC(e.reverse(),t);return[n,r]}function ek(t){const e=[],n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const i=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||i?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)e.push(n.currentNode);return e}function vC(t,e){for(const n of t)if(!az(n,{upTo:e}))return n}function az(t,{upTo:e}){if(getComputedStyle(t).visibility==="hidden")return!0;for(;t;){if(e!==void 0&&t===e)return!1;if(getComputedStyle(t).display==="none")return!0;t=t.parentElement}return!1}function lz(t){return t instanceof HTMLInputElement&&"select"in t}function Yo(t,{select:e=!1}={}){if(t&&t.focus){const n=document.activeElement;t.focus({preventScroll:!0}),t!==n&&lz(t)&&e&&t.select()}}var xC=cz();function cz(){let t=[];return{add(e){const n=t[0];e!==n&&n?.pause(),t=bC(t,e),t.unshift(e)},remove(e){t=bC(t,e),t[0]?.resume()}}}function bC(t,e){const n=[...t],r=n.indexOf(e);return r!==-1&&n.splice(r,1),n}function uz(t){return t.filter(e=>e.tagName!=="A")}var Hn=globalThis?.document?x.useLayoutEffect:()=>{},dz=Zx[" useId ".trim().toString()]||(()=>{}),fz=0;function Ci(t){const[e,n]=x.useState(dz());return Hn(()=>{n(r=>r??String(fz++))},[t]),e?`radix-${e}`:""}const hz=["top","right","bottom","left"],ms=Math.min,Cr=Math.max,vh=Math.round,Tf=Math.floor,Ti=t=>({x:t,y:t}),pz={left:"right",right:"left",bottom:"top",top:"bottom"},mz={start:"end",end:"start"};function Uv(t,e,n){return Cr(t,ms(e,n))}function co(t,e){return typeof t=="function"?t(e):t}function uo(t){return t.split("-")[0]}function ql(t){return t.split("-")[1]}function vb(t){return t==="x"?"y":"x"}function xb(t){return t==="y"?"height":"width"}const gz=new Set(["top","bottom"]);function Si(t){return gz.has(uo(t))?"y":"x"}function bb(t){return vb(Si(t))}function yz(t,e,n){n===void 0&&(n=!1);const r=ql(t),i=bb(t),o=xb(i);let a=i==="x"?r===(n?"end":"start")?"right":"left":r==="start"?"bottom":"top";return e.reference[o]>e.floating[o]&&(a=xh(a)),[a,xh(a)]}function vz(t){const e=xh(t);return[Vv(t),e,Vv(e)]}function Vv(t){return t.replace(/start|end/g,e=>mz[e])}const wC=["left","right"],SC=["right","left"],xz=["top","bottom"],bz=["bottom","top"];function wz(t,e,n){switch(t){case"top":case"bottom":return n?e?SC:wC:e?wC:SC;case"left":case"right":return e?xz:bz;default:return[]}}function Sz(t,e,n,r){const i=ql(t);let o=wz(uo(t),n==="start",r);return i&&(o=o.map(a=>a+"-"+i),e&&(o=o.concat(o.map(Vv)))),o}function xh(t){return t.replace(/left|right|bottom|top/g,e=>pz[e])}function Ez(t){return{top:0,right:0,bottom:0,left:0,...t}}function tk(t){return typeof t!="number"?Ez(t):{top:t,right:t,bottom:t,left:t}}function bh(t){const{x:e,y:n,width:r,height:i}=t;return{width:r,height:i,top:n,left:e,right:e+r,bottom:n+i,x:e,y:n}}function EC(t,e,n){let{reference:r,floating:i}=t;const o=Si(e),a=bb(e),c=xb(a),u=uo(e),f=o==="y",p=r.x+r.width/2-i.width/2,g=r.y+r.height/2-i.height/2,v=r[c]/2-i[c]/2;let y;switch(u){case"top":y={x:p,y:r.y-i.height};break;case"bottom":y={x:p,y:r.y+r.height};break;case"right":y={x:r.x+r.width,y:g};break;case"left":y={x:r.x-i.width,y:g};break;default:y={x:r.x,y:r.y}}switch(ql(e)){case"start":y[a]-=v*(n&&f?-1:1);break;case"end":y[a]+=v*(n&&f?-1:1);break}return y}async function Cz(t,e){var n;e===void 0&&(e={});const{x:r,y:i,platform:o,rects:a,elements:c,strategy:u}=t,{boundary:f="clippingAncestors",rootBoundary:p="viewport",elementContext:g="floating",altBoundary:v=!1,padding:y=0}=co(e,t),w=tk(y),C=c[v?g==="floating"?"reference":"floating":g],T=bh(await o.getClippingRect({element:(n=await(o.isElement==null?void 0:o.isElement(C)))==null||n?C:C.contextElement||await(o.getDocumentElement==null?void 0:o.getDocumentElement(c.floating)),boundary:f,rootBoundary:p,strategy:u})),N=g==="floating"?{x:r,y:i,width:a.floating.width,height:a.floating.height}:a.reference,k=await(o.getOffsetParent==null?void 0:o.getOffsetParent(c.floating)),D=await(o.isElement==null?void 0:o.isElement(k))?await(o.getScale==null?void 0:o.getScale(k))||{x:1,y:1}:{x:1,y:1},M=bh(o.convertOffsetParentRelativeRectToViewportRelativeRect?await o.convertOffsetParentRelativeRectToViewportRelativeRect({elements:c,rect:N,offsetParent:k,strategy:u}):N);return{top:(T.top-M.top+w.top)/D.y,bottom:(M.bottom-T.bottom+w.bottom)/D.y,left:(T.left-M.left+w.left)/D.x,right:(M.right-T.right+w.right)/D.x}}const Tz=async(t,e,n)=>{const{placement:r="bottom",strategy:i="absolute",middleware:o=[],platform:a}=n,c=o.filter(Boolean),u=await(a.isRTL==null?void 0:a.isRTL(e));let f=await a.getElementRects({reference:t,floating:e,strategy:i}),{x:p,y:g}=EC(f,r,u),v=r,y={},w=0;for(let C=0;C<c.length;C++){var S;const{name:T,fn:N}=c[C],{x:k,y:D,data:M,reset:R}=await N({x:p,y:g,initialPlacement:r,placement:v,strategy:i,middlewareData:y,rects:f,platform:{...a,detectOverflow:(S=a.detectOverflow)!=null?S:Cz},elements:{reference:t,floating:e}});p=k??p,g=D??g,y={...y,[T]:{...y[T],...M}},R&&w<=50&&(w++,typeof R=="object"&&(R.placement&&(v=R.placement),R.rects&&(f=R.rects===!0?await a.getElementRects({reference:t,floating:e,strategy:i}):R.rects),{x:p,y:g}=EC(f,v,u)),C=-1)}return{x:p,y:g,placement:v,strategy:i,middlewareData:y}},Nz=t=>({name:"arrow",options:t,async fn(e){const{x:n,y:r,placement:i,rects:o,platform:a,elements:c,middlewareData:u}=e,{element:f,padding:p=0}=co(t,e)||{};if(f==null)return{};const g=tk(p),v={x:n,y:r},y=bb(i),w=xb(y),S=await a.getDimensions(f),C=y==="y",T=C?"top":"left",N=C?"bottom":"right",k=C?"clientHeight":"clientWidth",D=o.reference[w]+o.reference[y]-v[y]-o.floating[w],M=v[y]-o.reference[y],R=await(a.getOffsetParent==null?void 0:a.getOffsetParent(f));let O=R?R[k]:0;(!O||!await(a.isElement==null?void 0:a.isElement(R)))&&(O=c.floating[k]||o.floating[w]);const I=D/2-M/2,z=O/2-S[w]/2-1,U=ms(g[T],z),Y=ms(g[N],z),W=U,j=O-S[w]-Y,G=O/2-S[w]/2+I,oe=Uv(W,G,j),L=!u.arrow&&ql(i)!=null&&G!==oe&&o.reference[w]/2-(G<W?U:Y)-S[w]/2<0,$=L?G<W?G-W:G-j:0;return{[y]:v[y]+$,data:{[y]:oe,centerOffset:G-oe-$,...L&&{alignmentOffset:$}},reset:L}}}),Az=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var n,r;const{placement:i,middlewareData:o,rects:a,initialPlacement:c,platform:u,elements:f}=e,{mainAxis:p=!0,crossAxis:g=!0,fallbackPlacements:v,fallbackStrategy:y="bestFit",fallbackAxisSideDirection:w="none",flipAlignment:S=!0,...C}=co(t,e);if((n=o.arrow)!=null&&n.alignmentOffset)return{};const T=uo(i),N=Si(c),k=uo(c)===c,D=await(u.isRTL==null?void 0:u.isRTL(f.floating)),M=v||(k||!S?[xh(c)]:vz(c)),R=w!=="none";!v&&R&&M.push(...Sz(c,S,w,D));const O=[c,...M],I=await u.detectOverflow(e,C),z=[];let U=((r=o.flip)==null?void 0:r.overflows)||[];if(p&&z.push(I[T]),g){const G=yz(i,a,D);z.push(I[G[0]],I[G[1]])}if(U=[...U,{placement:i,overflows:z}],!z.every(G=>G<=0)){var Y,W;const G=(((Y=o.flip)==null?void 0:Y.index)||0)+1,oe=O[G];if(oe&&(!(g==="alignment"?N!==Si(oe):!1)||U.every(V=>Si(V.placement)===N?V.overflows[0]>0:!0)))return{data:{index:G,overflows:U},reset:{placement:oe}};let L=(W=U.filter($=>$.overflows[0]<=0).sort(($,V)=>$.overflows[1]-V.overflows[1])[0])==null?void 0:W.placement;if(!L)switch(y){case"bestFit":{var j;const $=(j=U.filter(V=>{if(R){const we=Si(V.placement);return we===N||we==="y"}return!0}).map(V=>[V.placement,V.overflows.filter(we=>we>0).reduce((we,pe)=>we+pe,0)]).sort((V,we)=>V[1]-we[1])[0])==null?void 0:j[0];$&&(L=$);break}case"initialPlacement":L=c;break}if(i!==L)return{reset:{placement:L}}}return{}}}};function CC(t,e){return{top:t.top-e.height,right:t.right-e.width,bottom:t.bottom-e.height,left:t.left-e.width}}function TC(t){return hz.some(e=>t[e]>=0)}const kz=function(t){return t===void 0&&(t={}),{name:"hide",options:t,async fn(e){const{rects:n,platform:r}=e,{strategy:i="referenceHidden",...o}=co(t,e);switch(i){case"referenceHidden":{const a=await r.detectOverflow(e,{...o,elementContext:"reference"}),c=CC(a,n.reference);return{data:{referenceHiddenOffsets:c,referenceHidden:TC(c)}}}case"escaped":{const a=await r.detectOverflow(e,{...o,altBoundary:!0}),c=CC(a,n.floating);return{data:{escapedOffsets:c,escaped:TC(c)}}}default:return{}}}}},nk=new Set(["left","top"]);async function Dz(t,e){const{placement:n,platform:r,elements:i}=t,o=await(r.isRTL==null?void 0:r.isRTL(i.floating)),a=uo(n),c=ql(n),u=Si(n)==="y",f=nk.has(a)?-1:1,p=o&&u?-1:1,g=co(e,t);let{mainAxis:v,crossAxis:y,alignmentAxis:w}=typeof g=="number"?{mainAxis:g,crossAxis:0,alignmentAxis:null}:{mainAxis:g.mainAxis||0,crossAxis:g.crossAxis||0,alignmentAxis:g.alignmentAxis};return c&&typeof w=="number"&&(y=c==="end"?w*-1:w),u?{x:y*p,y:v*f}:{x:v*f,y:y*p}}const Oz=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){var n,r;const{x:i,y:o,placement:a,middlewareData:c}=e,u=await Dz(e,t);return a===((n=c.offset)==null?void 0:n.placement)&&(r=c.arrow)!=null&&r.alignmentOffset?{}:{x:i+u.x,y:o+u.y,data:{...u,placement:a}}}}},Mz=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){const{x:n,y:r,placement:i,platform:o}=e,{mainAxis:a=!0,crossAxis:c=!1,limiter:u={fn:T=>{let{x:N,y:k}=T;return{x:N,y:k}}},...f}=co(t,e),p={x:n,y:r},g=await o.detectOverflow(e,f),v=Si(uo(i)),y=vb(v);let w=p[y],S=p[v];if(a){const T=y==="y"?"top":"left",N=y==="y"?"bottom":"right",k=w+g[T],D=w-g[N];w=Uv(k,w,D)}if(c){const T=v==="y"?"top":"left",N=v==="y"?"bottom":"right",k=S+g[T],D=S-g[N];S=Uv(k,S,D)}const C=u.fn({...e,[y]:w,[v]:S});return{...C,data:{x:C.x-n,y:C.y-r,enabled:{[y]:a,[v]:c}}}}}},Rz=function(t){return t===void 0&&(t={}),{options:t,fn(e){const{x:n,y:r,placement:i,rects:o,middlewareData:a}=e,{offset:c=0,mainAxis:u=!0,crossAxis:f=!0}=co(t,e),p={x:n,y:r},g=Si(i),v=vb(g);let y=p[v],w=p[g];const S=co(c,e),C=typeof S=="number"?{mainAxis:S,crossAxis:0}:{mainAxis:0,crossAxis:0,...S};if(u){const k=v==="y"?"height":"width",D=o.reference[v]-o.floating[k]+C.mainAxis,M=o.reference[v]+o.reference[k]-C.mainAxis;y<D?y=D:y>M&&(y=M)}if(f){var T,N;const k=v==="y"?"width":"height",D=nk.has(uo(i)),M=o.reference[g]-o.floating[k]+(D&&((T=a.offset)==null?void 0:T[g])||0)+(D?0:C.crossAxis),R=o.reference[g]+o.reference[k]+(D?0:((N=a.offset)==null?void 0:N[g])||0)-(D?C.crossAxis:0);w<M?w=M:w>R&&(w=R)}return{[v]:y,[g]:w}}}},jz=function(t){return t===void 0&&(t={}),{name:"size",options:t,async fn(e){var n,r;const{placement:i,rects:o,platform:a,elements:c}=e,{apply:u=()=>{},...f}=co(t,e),p=await a.detectOverflow(e,f),g=uo(i),v=ql(i),y=Si(i)==="y",{width:w,height:S}=o.floating;let C,T;g==="top"||g==="bottom"?(C=g,T=v===(await(a.isRTL==null?void 0:a.isRTL(c.floating))?"start":"end")?"left":"right"):(T=g,C=v==="end"?"top":"bottom");const N=S-p.top-p.bottom,k=w-p.left-p.right,D=ms(S-p[C],N),M=ms(w-p[T],k),R=!e.middlewareData.shift;let O=D,I=M;if((n=e.middlewareData.shift)!=null&&n.enabled.x&&(I=k),(r=e.middlewareData.shift)!=null&&r.enabled.y&&(O=N),R&&!v){const U=Cr(p.left,0),Y=Cr(p.right,0),W=Cr(p.top,0),j=Cr(p.bottom,0);y?I=w-2*(U!==0||Y!==0?U+Y:Cr(p.left,p.right)):O=S-2*(W!==0||j!==0?W+j:Cr(p.top,p.bottom))}await u({...e,availableWidth:I,availableHeight:O});const z=await a.getDimensions(c.floating);return w!==z.width||S!==z.height?{reset:{rects:!0}}:{}}}};function Ap(){return typeof window<"u"}function Gl(t){return rk(t)?(t.nodeName||"").toLowerCase():"#document"}function Ar(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function Ri(t){var e;return(e=(rk(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function rk(t){return Ap()?t instanceof Node||t instanceof Ar(t).Node:!1}function ci(t){return Ap()?t instanceof Element||t instanceof Ar(t).Element:!1}function ki(t){return Ap()?t instanceof HTMLElement||t instanceof Ar(t).HTMLElement:!1}function NC(t){return!Ap()||typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof Ar(t).ShadowRoot}const Iz=new Set(["inline","contents"]);function Ju(t){const{overflow:e,overflowX:n,overflowY:r,display:i}=ui(t);return/auto|scroll|overlay|hidden|clip/.test(e+r+n)&&!Iz.has(i)}const _z=new Set(["table","td","th"]);function Lz(t){return _z.has(Gl(t))}const Pz=[":popover-open",":modal"];function kp(t){return Pz.some(e=>{try{return t.matches(e)}catch{return!1}})}const zz=["transform","translate","scale","rotate","perspective"],Bz=["transform","translate","scale","rotate","perspective","filter"],Fz=["paint","layout","strict","content"];function wb(t){const e=Sb(),n=ci(t)?ui(t):t;return zz.some(r=>n[r]?n[r]!=="none":!1)||(n.containerType?n.containerType!=="normal":!1)||!e&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!e&&(n.filter?n.filter!=="none":!1)||Bz.some(r=>(n.willChange||"").includes(r))||Fz.some(r=>(n.contain||"").includes(r))}function $z(t){let e=gs(t);for(;ki(e)&&!Al(e);){if(wb(e))return e;if(kp(e))return null;e=gs(e)}return null}function Sb(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const Hz=new Set(["html","body","#document"]);function Al(t){return Hz.has(Gl(t))}function ui(t){return Ar(t).getComputedStyle(t)}function Dp(t){return ci(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function gs(t){if(Gl(t)==="html")return t;const e=t.assignedSlot||t.parentNode||NC(t)&&t.host||Ri(t);return NC(e)?e.host:e}function ik(t){const e=gs(t);return Al(e)?t.ownerDocument?t.ownerDocument.body:t.body:ki(e)&&Ju(e)?e:ik(e)}function Au(t,e,n){var r;e===void 0&&(e=[]),n===void 0&&(n=!0);const i=ik(t),o=i===((r=t.ownerDocument)==null?void 0:r.body),a=Ar(i);if(o){const c=qv(a);return e.concat(a,a.visualViewport||[],Ju(i)?i:[],c&&n?Au(c):[])}return e.concat(i,Au(i,[],n))}function qv(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function ok(t){const e=ui(t);let n=parseFloat(e.width)||0,r=parseFloat(e.height)||0;const i=ki(t),o=i?t.offsetWidth:n,a=i?t.offsetHeight:r,c=vh(n)!==o||vh(r)!==a;return c&&(n=o,r=a),{width:n,height:r,$:c}}function Eb(t){return ci(t)?t:t.contextElement}function wl(t){const e=Eb(t);if(!ki(e))return Ti(1);const n=e.getBoundingClientRect(),{width:r,height:i,$:o}=ok(e);let a=(o?vh(n.width):n.width)/r,c=(o?vh(n.height):n.height)/i;return(!a||!Number.isFinite(a))&&(a=1),(!c||!Number.isFinite(c))&&(c=1),{x:a,y:c}}const Uz=Ti(0);function sk(t){const e=Ar(t);return!Sb()||!e.visualViewport?Uz:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function Vz(t,e,n){return e===void 0&&(e=!1),!n||e&&n!==Ar(t)?!1:e}function aa(t,e,n,r){e===void 0&&(e=!1),n===void 0&&(n=!1);const i=t.getBoundingClientRect(),o=Eb(t);let a=Ti(1);e&&(r?ci(r)&&(a=wl(r)):a=wl(t));const c=Vz(o,n,r)?sk(o):Ti(0);let u=(i.left+c.x)/a.x,f=(i.top+c.y)/a.y,p=i.width/a.x,g=i.height/a.y;if(o){const v=Ar(o),y=r&&ci(r)?Ar(r):r;let w=v,S=qv(w);for(;S&&r&&y!==w;){const C=wl(S),T=S.getBoundingClientRect(),N=ui(S),k=T.left+(S.clientLeft+parseFloat(N.paddingLeft))*C.x,D=T.top+(S.clientTop+parseFloat(N.paddingTop))*C.y;u*=C.x,f*=C.y,p*=C.x,g*=C.y,u+=k,f+=D,w=Ar(S),S=qv(w)}}return bh({width:p,height:g,x:u,y:f})}function Op(t,e){const n=Dp(t).scrollLeft;return e?e.left+n:aa(Ri(t)).left+n}function ak(t,e){const n=t.getBoundingClientRect(),r=n.left+e.scrollLeft-Op(t,n),i=n.top+e.scrollTop;return{x:r,y:i}}function qz(t){let{elements:e,rect:n,offsetParent:r,strategy:i}=t;const o=i==="fixed",a=Ri(r),c=e?kp(e.floating):!1;if(r===a||c&&o)return n;let u={scrollLeft:0,scrollTop:0},f=Ti(1);const p=Ti(0),g=ki(r);if((g||!g&&!o)&&((Gl(r)!=="body"||Ju(a))&&(u=Dp(r)),ki(r))){const y=aa(r);f=wl(r),p.x=y.x+r.clientLeft,p.y=y.y+r.clientTop}const v=a&&!g&&!o?ak(a,u):Ti(0);return{width:n.width*f.x,height:n.height*f.y,x:n.x*f.x-u.scrollLeft*f.x+p.x+v.x,y:n.y*f.y-u.scrollTop*f.y+p.y+v.y}}function Gz(t){return Array.from(t.getClientRects())}function Wz(t){const e=Ri(t),n=Dp(t),r=t.ownerDocument.body,i=Cr(e.scrollWidth,e.clientWidth,r.scrollWidth,r.clientWidth),o=Cr(e.scrollHeight,e.clientHeight,r.scrollHeight,r.clientHeight);let a=-n.scrollLeft+Op(t);const c=-n.scrollTop;return ui(r).direction==="rtl"&&(a+=Cr(e.clientWidth,r.clientWidth)-i),{width:i,height:o,x:a,y:c}}const AC=25;function Yz(t,e){const n=Ar(t),r=Ri(t),i=n.visualViewport;let o=r.clientWidth,a=r.clientHeight,c=0,u=0;if(i){o=i.width,a=i.height;const p=Sb();(!p||p&&e==="fixed")&&(c=i.offsetLeft,u=i.offsetTop)}const f=Op(r);if(f<=0){const p=r.ownerDocument,g=p.body,v=getComputedStyle(g),y=p.compatMode==="CSS1Compat"&&parseFloat(v.marginLeft)+parseFloat(v.marginRight)||0,w=Math.abs(r.clientWidth-g.clientWidth-y);w<=AC&&(o-=w)}else f<=AC&&(o+=f);return{width:o,height:a,x:c,y:u}}const Kz=new Set(["absolute","fixed"]);function Xz(t,e){const n=aa(t,!0,e==="fixed"),r=n.top+t.clientTop,i=n.left+t.clientLeft,o=ki(t)?wl(t):Ti(1),a=t.clientWidth*o.x,c=t.clientHeight*o.y,u=i*o.x,f=r*o.y;return{width:a,height:c,x:u,y:f}}function kC(t,e,n){let r;if(e==="viewport")r=Yz(t,n);else if(e==="document")r=Wz(Ri(t));else if(ci(e))r=Xz(e,n);else{const i=sk(t);r={x:e.x-i.x,y:e.y-i.y,width:e.width,height:e.height}}return bh(r)}function lk(t,e){const n=gs(t);return n===e||!ci(n)||Al(n)?!1:ui(n).position==="fixed"||lk(n,e)}function Jz(t,e){const n=e.get(t);if(n)return n;let r=Au(t,[],!1).filter(c=>ci(c)&&Gl(c)!=="body"),i=null;const o=ui(t).position==="fixed";let a=o?gs(t):t;for(;ci(a)&&!Al(a);){const c=ui(a),u=wb(a);!u&&c.position==="fixed"&&(i=null),(o?!u&&!i:!u&&c.position==="static"&&!!i&&Kz.has(i.position)||Ju(a)&&!u&&lk(t,a))?r=r.filter(p=>p!==a):i=c,a=gs(a)}return e.set(t,r),r}function Qz(t){let{element:e,boundary:n,rootBoundary:r,strategy:i}=t;const a=[...n==="clippingAncestors"?kp(e)?[]:Jz(e,this._c):[].concat(n),r],c=a[0],u=a.reduce((f,p)=>{const g=kC(e,p,i);return f.top=Cr(g.top,f.top),f.right=ms(g.right,f.right),f.bottom=ms(g.bottom,f.bottom),f.left=Cr(g.left,f.left),f},kC(e,c,i));return{width:u.right-u.left,height:u.bottom-u.top,x:u.left,y:u.top}}function Zz(t){const{width:e,height:n}=ok(t);return{width:e,height:n}}function eB(t,e,n){const r=ki(e),i=Ri(e),o=n==="fixed",a=aa(t,!0,o,e);let c={scrollLeft:0,scrollTop:0};const u=Ti(0);function f(){u.x=Op(i)}if(r||!r&&!o)if((Gl(e)!=="body"||Ju(i))&&(c=Dp(e)),r){const y=aa(e,!0,o,e);u.x=y.x+e.clientLeft,u.y=y.y+e.clientTop}else i&&f();o&&!r&&i&&f();const p=i&&!r&&!o?ak(i,c):Ti(0),g=a.left+c.scrollLeft-u.x-p.x,v=a.top+c.scrollTop-u.y-p.y;return{x:g,y:v,width:a.width,height:a.height}}function Py(t){return ui(t).position==="static"}function DC(t,e){if(!ki(t)||ui(t).position==="fixed")return null;if(e)return e(t);let n=t.offsetParent;return Ri(t)===n&&(n=n.ownerDocument.body),n}function ck(t,e){const n=Ar(t);if(kp(t))return n;if(!ki(t)){let i=gs(t);for(;i&&!Al(i);){if(ci(i)&&!Py(i))return i;i=gs(i)}return n}let r=DC(t,e);for(;r&&Lz(r)&&Py(r);)r=DC(r,e);return r&&Al(r)&&Py(r)&&!wb(r)?n:r||$z(t)||n}const tB=async function(t){const e=this.getOffsetParent||ck,n=this.getDimensions,r=await n(t.floating);return{reference:eB(t.reference,await e(t.floating),t.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function nB(t){return ui(t).direction==="rtl"}const rB={convertOffsetParentRelativeRectToViewportRelativeRect:qz,getDocumentElement:Ri,getClippingRect:Qz,getOffsetParent:ck,getElementRects:tB,getClientRects:Gz,getDimensions:Zz,getScale:wl,isElement:ci,isRTL:nB};function uk(t,e){return t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height}function iB(t,e){let n=null,r;const i=Ri(t);function o(){var c;clearTimeout(r),(c=n)==null||c.disconnect(),n=null}function a(c,u){c===void 0&&(c=!1),u===void 0&&(u=1),o();const f=t.getBoundingClientRect(),{left:p,top:g,width:v,height:y}=f;if(c||e(),!v||!y)return;const w=Tf(g),S=Tf(i.clientWidth-(p+v)),C=Tf(i.clientHeight-(g+y)),T=Tf(p),k={rootMargin:-w+"px "+-S+"px "+-C+"px "+-T+"px",threshold:Cr(0,ms(1,u))||1};let D=!0;function M(R){const O=R[0].intersectionRatio;if(O!==u){if(!D)return a();O?a(!1,O):r=setTimeout(()=>{a(!1,1e-7)},1e3)}O===1&&!uk(f,t.getBoundingClientRect())&&a(),D=!1}try{n=new IntersectionObserver(M,{...k,root:i.ownerDocument})}catch{n=new IntersectionObserver(M,k)}n.observe(t)}return a(!0),o}function oB(t,e,n,r){r===void 0&&(r={});const{ancestorScroll:i=!0,ancestorResize:o=!0,elementResize:a=typeof ResizeObserver=="function",layoutShift:c=typeof IntersectionObserver=="function",animationFrame:u=!1}=r,f=Eb(t),p=i||o?[...f?Au(f):[],...Au(e)]:[];p.forEach(T=>{i&&T.addEventListener("scroll",n,{passive:!0}),o&&T.addEventListener("resize",n)});const g=f&&c?iB(f,n):null;let v=-1,y=null;a&&(y=new ResizeObserver(T=>{let[N]=T;N&&N.target===f&&y&&(y.unobserve(e),cancelAnimationFrame(v),v=requestAnimationFrame(()=>{var k;(k=y)==null||k.observe(e)})),n()}),f&&!u&&y.observe(f),y.observe(e));let w,S=u?aa(t):null;u&&C();function C(){const T=aa(t);S&&!uk(S,T)&&n(),S=T,w=requestAnimationFrame(C)}return n(),()=>{var T;p.forEach(N=>{i&&N.removeEventListener("scroll",n),o&&N.removeEventListener("resize",n)}),g?.(),(T=y)==null||T.disconnect(),y=null,u&&cancelAnimationFrame(w)}}const sB=Oz,aB=Mz,lB=Az,cB=jz,uB=kz,OC=Nz,dB=Rz,fB=(t,e,n)=>{const r=new Map,i={platform:rB,...n},o={...i.platform,_c:r};return Tz(t,e,{...i,platform:o})};var hB=typeof document<"u",pB=function(){},th=hB?x.useLayoutEffect:pB;function wh(t,e){if(t===e)return!0;if(typeof t!=typeof e)return!1;if(typeof t=="function"&&t.toString()===e.toString())return!0;let n,r,i;if(t&&e&&typeof t=="object"){if(Array.isArray(t)){if(n=t.length,n!==e.length)return!1;for(r=n;r--!==0;)if(!wh(t[r],e[r]))return!1;return!0}if(i=Object.keys(t),n=i.length,n!==Object.keys(e).length)return!1;for(r=n;r--!==0;)if(!{}.hasOwnProperty.call(e,i[r]))return!1;for(r=n;r--!==0;){const o=i[r];if(!(o==="_owner"&&t.$$typeof)&&!wh(t[o],e[o]))return!1}return!0}return t!==t&&e!==e}function dk(t){return typeof window>"u"?1:(t.ownerDocument.defaultView||window).devicePixelRatio||1}function MC(t,e){const n=dk(t);return Math.round(e*n)/n}function zy(t){const e=x.useRef(t);return th(()=>{e.current=t}),e}function mB(t){t===void 0&&(t={});const{placement:e="bottom",strategy:n="absolute",middleware:r=[],platform:i,elements:{reference:o,floating:a}={},transform:c=!0,whileElementsMounted:u,open:f}=t,[p,g]=x.useState({x:0,y:0,strategy:n,placement:e,middlewareData:{},isPositioned:!1}),[v,y]=x.useState(r);wh(v,r)||y(r);const[w,S]=x.useState(null),[C,T]=x.useState(null),N=x.useCallback(V=>{V!==R.current&&(R.current=V,S(V))},[]),k=x.useCallback(V=>{V!==O.current&&(O.current=V,T(V))},[]),D=o||w,M=a||C,R=x.useRef(null),O=x.useRef(null),I=x.useRef(p),z=u!=null,U=zy(u),Y=zy(i),W=zy(f),j=x.useCallback(()=>{if(!R.current||!O.current)return;const V={placement:e,strategy:n,middleware:v};Y.current&&(V.platform=Y.current),fB(R.current,O.current,V).then(we=>{const pe={...we,isPositioned:W.current!==!1};G.current&&!wh(I.current,pe)&&(I.current=pe,yo.flushSync(()=>{g(pe)}))})},[v,e,n,Y,W]);th(()=>{f===!1&&I.current.isPositioned&&(I.current.isPositioned=!1,g(V=>({...V,isPositioned:!1})))},[f]);const G=x.useRef(!1);th(()=>(G.current=!0,()=>{G.current=!1}),[]),th(()=>{if(D&&(R.current=D),M&&(O.current=M),D&&M){if(U.current)return U.current(D,M,j);j()}},[D,M,j,U,z]);const oe=x.useMemo(()=>({reference:R,floating:O,setReference:N,setFloating:k}),[N,k]),L=x.useMemo(()=>({reference:D,floating:M}),[D,M]),$=x.useMemo(()=>{const V={position:n,left:0,top:0};if(!L.floating)return V;const we=MC(L.floating,p.x),pe=MC(L.floating,p.y);return c?{...V,transform:"translate("+we+"px, "+pe+"px)",...dk(L.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:we,top:pe}},[n,c,L.floating,p.x,p.y]);return x.useMemo(()=>({...p,update:j,refs:oe,elements:L,floatingStyles:$}),[p,j,oe,L,$])}const gB=t=>{function e(n){return{}.hasOwnProperty.call(n,"current")}return{name:"arrow",options:t,fn(n){const{element:r,padding:i}=typeof t=="function"?t(n):t;return r&&e(r)?r.current!=null?OC({element:r.current,padding:i}).fn(n):{}:r?OC({element:r,padding:i}).fn(n):{}}}},yB=(t,e)=>({...sB(t),options:[t,e]}),vB=(t,e)=>({...aB(t),options:[t,e]}),xB=(t,e)=>({...dB(t),options:[t,e]}),bB=(t,e)=>({...lB(t),options:[t,e]}),wB=(t,e)=>({...cB(t),options:[t,e]}),SB=(t,e)=>({...uB(t),options:[t,e]}),EB=(t,e)=>({...gB(t),options:[t,e]});var CB="Arrow",fk=x.forwardRef((t,e)=>{const{children:n,width:r=10,height:i=5,...o}=t;return h.jsx(it.svg,{...o,ref:e,width:r,height:i,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:t.asChild?n:h.jsx("polygon",{points:"0,0 30,0 15,10"})})});fk.displayName=CB;var TB=fk;function Mp(t){const[e,n]=x.useState(void 0);return Hn(()=>{if(t){n({width:t.offsetWidth,height:t.offsetHeight});const r=new ResizeObserver(i=>{if(!Array.isArray(i)||!i.length)return;const o=i[0];let a,c;if("borderBoxSize"in o){const u=o.borderBoxSize,f=Array.isArray(u)?u[0]:u;a=f.inlineSize,c=f.blockSize}else a=t.offsetWidth,c=t.offsetHeight;n({width:a,height:c})});return r.observe(t,{box:"border-box"}),()=>r.unobserve(t)}else n(void 0)},[t]),e}var Cb="Popper",[hk,Wl]=Wr(Cb),[NB,pk]=hk(Cb),mk=t=>{const{__scopePopper:e,children:n}=t,[r,i]=x.useState(null);return h.jsx(NB,{scope:e,anchor:r,onAnchorChange:i,children:n})};mk.displayName=Cb;var gk="PopperAnchor",yk=x.forwardRef((t,e)=>{const{__scopePopper:n,virtualRef:r,...i}=t,o=pk(gk,n),a=x.useRef(null),c=ht(e,a),u=x.useRef(null);return x.useEffect(()=>{const f=u.current;u.current=r?.current||a.current,f!==u.current&&o.onAnchorChange(u.current)}),r?null:h.jsx(it.div,{...i,ref:c})});yk.displayName=gk;var Tb="PopperContent",[AB,kB]=hk(Tb),vk=x.forwardRef((t,e)=>{const{__scopePopper:n,side:r="bottom",sideOffset:i=0,align:o="center",alignOffset:a=0,arrowPadding:c=0,avoidCollisions:u=!0,collisionBoundary:f=[],collisionPadding:p=0,sticky:g="partial",hideWhenDetached:v=!1,updatePositionStrategy:y="optimized",onPlaced:w,...S}=t,C=pk(Tb,n),[T,N]=x.useState(null),k=ht(e,H=>N(H)),[D,M]=x.useState(null),R=Mp(D),O=R?.width??0,I=R?.height??0,z=r+(o!=="center"?"-"+o:""),U=typeof p=="number"?p:{top:0,right:0,bottom:0,left:0,...p},Y=Array.isArray(f)?f:[f],W=Y.length>0,j={padding:U,boundary:Y.filter(OB),altBoundary:W},{refs:G,floatingStyles:oe,placement:L,isPositioned:$,middlewareData:V}=mB({strategy:"fixed",placement:z,whileElementsMounted:(...H)=>oB(...H,{animationFrame:y==="always"}),elements:{reference:C.anchor},middleware:[yB({mainAxis:i+I,alignmentAxis:a}),u&&vB({mainAxis:!0,crossAxis:!1,limiter:g==="partial"?xB():void 0,...j}),u&&bB({...j}),wB({...j,apply:({elements:H,rects:ce,availableWidth:te,availableHeight:me})=>{const{width:Te,height:re}=ce.reference,he=H.floating.style;he.setProperty("--radix-popper-available-width",`${te}px`),he.setProperty("--radix-popper-available-height",`${me}px`),he.setProperty("--radix-popper-anchor-width",`${Te}px`),he.setProperty("--radix-popper-anchor-height",`${re}px`)}}),D&&EB({element:D,padding:c}),MB({arrowWidth:O,arrowHeight:I}),v&&SB({strategy:"referenceHidden",...j})]}),[we,pe]=wk(L),P=Qn(w);Hn(()=>{$&&P?.()},[$,P]);const K=V.arrow?.x,B=V.arrow?.y,Z=V.arrow?.centerOffset!==0,[le,be]=x.useState();return Hn(()=>{T&&be(window.getComputedStyle(T).zIndex)},[T]),h.jsx("div",{ref:G.setFloating,"data-radix-popper-content-wrapper":"",style:{...oe,transform:$?oe.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:le,"--radix-popper-transform-origin":[V.transformOrigin?.x,V.transformOrigin?.y].join(" "),...V.hide?.referenceHidden&&{visibility:"hidden",pointerEvents:"none"}},dir:t.dir,children:h.jsx(AB,{scope:n,placedSide:we,onArrowChange:M,arrowX:K,arrowY:B,shouldHideArrow:Z,children:h.jsx(it.div,{"data-side":we,"data-align":pe,...S,ref:k,style:{...S.style,animation:$?void 0:"none"}})})})});vk.displayName=Tb;var xk="PopperArrow",DB={top:"bottom",right:"left",bottom:"top",left:"right"},bk=x.forwardRef(function(e,n){const{__scopePopper:r,...i}=e,o=kB(xk,r),a=DB[o.placedSide];return h.jsx("span",{ref:o.onArrowChange,style:{position:"absolute",left:o.arrowX,top:o.arrowY,[a]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[o.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[o.placedSide],visibility:o.shouldHideArrow?"hidden":void 0},children:h.jsx(TB,{...i,ref:n,style:{...i.style,display:"block"}})})});bk.displayName=xk;function OB(t){return t!==null}var MB=t=>({name:"transformOrigin",options:t,fn(e){const{placement:n,rects:r,middlewareData:i}=e,a=i.arrow?.centerOffset!==0,c=a?0:t.arrowWidth,u=a?0:t.arrowHeight,[f,p]=wk(n),g={start:"0%",center:"50%",end:"100%"}[p],v=(i.arrow?.x??0)+c/2,y=(i.arrow?.y??0)+u/2;let w="",S="";return f==="bottom"?(w=a?g:`${v}px`,S=`${-u}px`):f==="top"?(w=a?g:`${v}px`,S=`${r.floating.height+u}px`):f==="right"?(w=`${-u}px`,S=a?g:`${y}px`):f==="left"&&(w=`${r.floating.width+u}px`,S=a?g:`${y}px`),{data:{x:w,y:S}}}});function wk(t){const[e,n="center"]=t.split("-");return[e,n]}var Nb=mk,Rp=yk,Ab=vk,kb=bk,RB="Portal",Qu=x.forwardRef((t,e)=>{const{container:n,...r}=t,[i,o]=x.useState(!1);Hn(()=>o(!0),[]);const a=n||i&&globalThis?.document?.body;return a?ob.createPortal(h.jsx(it.div,{...r,ref:e}),a):null});Qu.displayName=RB;function jB(t){const e=IB(t),n=x.forwardRef((r,i)=>{const{children:o,...a}=r,c=x.Children.toArray(o),u=c.find(LB);if(u){const f=u.props.children,p=c.map(g=>g===u?x.Children.count(f)>1?x.Children.only(null):x.isValidElement(f)?f.props.children:null:g);return h.jsx(e,{...a,ref:i,children:x.isValidElement(f)?x.cloneElement(f,void 0,p):null})}return h.jsx(e,{...a,ref:i,children:o})});return n.displayName=`${t}.Slot`,n}function IB(t){const e=x.forwardRef((n,r)=>{const{children:i,...o}=n;if(x.isValidElement(i)){const a=zB(i),c=PB(o,i.props);return i.type!==x.Fragment&&(c.ref=r?ga(r,a):a),x.cloneElement(i,c)}return x.Children.count(i)>1?x.Children.only(null):null});return e.displayName=`${t}.SlotClone`,e}var _B=Symbol("radix.slottable");function LB(t){return x.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===_B}function PB(t,e){const n={...e};for(const r in e){const i=t[r],o=e[r];/^on[A-Z]/.test(r)?i&&o?n[r]=(...c)=>{const u=o(...c);return i(...c),u}:i&&(n[r]=i):r==="style"?n[r]={...i,...o}:r==="className"&&(n[r]=[i,o].filter(Boolean).join(" "))}return{...t,...n}}function zB(t){let e=Object.getOwnPropertyDescriptor(t.props,"ref")?.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=Object.getOwnPropertyDescriptor(t,"ref")?.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}var BB=Zx[" useInsertionEffect ".trim().toString()]||Hn;function Di({prop:t,defaultProp:e,onChange:n=()=>{},caller:r}){const[i,o,a]=FB({defaultProp:e,onChange:n}),c=t!==void 0,u=c?t:i;{const p=x.useRef(t!==void 0);x.useEffect(()=>{const g=p.current;g!==c&&console.warn(`${r} is changing from ${g?"controlled":"uncontrolled"} to ${c?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),p.current=c},[c,r])}const f=x.useCallback(p=>{if(c){const g=$B(p)?p(t):p;g!==t&&a.current?.(g)}else o(p)},[c,t,o,a]);return[u,f]}function FB({defaultProp:t,onChange:e}){const[n,r]=x.useState(t),i=x.useRef(n),o=x.useRef(e);return BB(()=>{o.current=e},[e]),x.useEffect(()=>{i.current!==n&&(o.current?.(n),i.current=n)},[n,i]),[n,r,o]}function $B(t){return typeof t=="function"}function jp(t){const e=x.useRef({value:t,previous:t});return x.useMemo(()=>(e.current.value!==t&&(e.current.previous=e.current.value,e.current.value=t),e.current.previous),[t])}var Sk=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),HB="VisuallyHidden",Ek=x.forwardRef((t,e)=>h.jsx(it.span,{...t,ref:e,style:{...Sk,...t.style}}));Ek.displayName=HB;var UB=Ek,VB=function(t){if(typeof document>"u")return null;var e=Array.isArray(t)?t[0]:t;return e.ownerDocument.body},al=new WeakMap,Nf=new WeakMap,Af={},By=0,Ck=function(t){return t&&(t.host||Ck(t.parentNode))},qB=function(t,e){return e.map(function(n){if(t.contains(n))return n;var r=Ck(n);return r&&t.contains(r)?r:(console.error("aria-hidden",n,"in not contained inside",t,". Doing nothing"),null)}).filter(function(n){return!!n})},GB=function(t,e,n,r){var i=qB(e,Array.isArray(t)?t:[t]);Af[n]||(Af[n]=new WeakMap);var o=Af[n],a=[],c=new Set,u=new Set(i),f=function(g){!g||c.has(g)||(c.add(g),f(g.parentNode))};i.forEach(f);var p=function(g){!g||u.has(g)||Array.prototype.forEach.call(g.children,function(v){if(c.has(v))p(v);else try{var y=v.getAttribute(r),w=y!==null&&y!=="false",S=(al.get(v)||0)+1,C=(o.get(v)||0)+1;al.set(v,S),o.set(v,C),a.push(v),S===1&&w&&Nf.set(v,!0),C===1&&v.setAttribute(n,"true"),w||v.setAttribute(r,"true")}catch(T){console.error("aria-hidden: cannot operate on ",v,T)}})};return p(e),c.clear(),By++,function(){a.forEach(function(g){var v=al.get(g)-1,y=o.get(g)-1;al.set(g,v),o.set(g,y),v||(Nf.has(g)||g.removeAttribute(r),Nf.delete(g)),y||g.removeAttribute(n)}),By--,By||(al=new WeakMap,al=new WeakMap,Nf=new WeakMap,Af={})}},Db=function(t,e,n){n===void 0&&(n="data-aria-hidden");var r=Array.from(Array.isArray(t)?t:[t]),i=VB(t);return i?(r.push.apply(r,Array.from(i.querySelectorAll("[aria-live], script"))),GB(r,i,n,"aria-hidden")):function(){return null}},wi=function(){return wi=Object.assign||function(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},wi.apply(this,arguments)};function Tk(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n}function WB(t,e,n){if(n||arguments.length===2)for(var r=0,i=e.length,o;r<i;r++)(o||!(r in e))&&(o||(o=Array.prototype.slice.call(e,0,r)),o[r]=e[r]);return t.concat(o||Array.prototype.slice.call(e))}var nh="right-scroll-bar-position",rh="width-before-scroll-bar",YB="with-scroll-bars-hidden",KB="--removed-body-scroll-bar-size";function Fy(t,e){return typeof t=="function"?t(e):t&&(t.current=e),t}function XB(t,e){var n=x.useState(function(){return{value:t,callback:e,facade:{get current(){return n.value},set current(r){var i=n.value;i!==r&&(n.value=r,n.callback(r,i))}}}})[0];return n.callback=e,n.facade}var JB=typeof window<"u"?x.useLayoutEffect:x.useEffect,RC=new WeakMap;function QB(t,e){var n=XB(null,function(r){return t.forEach(function(i){return Fy(i,r)})});return JB(function(){var r=RC.get(n);if(r){var i=new Set(r),o=new Set(t),a=n.current;i.forEach(function(c){o.has(c)||Fy(c,null)}),o.forEach(function(c){i.has(c)||Fy(c,a)})}RC.set(n,t)},[t]),n}function ZB(t){return t}function e6(t,e){e===void 0&&(e=ZB);var n=[],r=!1,i={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:t},useMedium:function(o){var a=e(o,r);return n.push(a),function(){n=n.filter(function(c){return c!==a})}},assignSyncMedium:function(o){for(r=!0;n.length;){var a=n;n=[],a.forEach(o)}n={push:function(c){return o(c)},filter:function(){return n}}},assignMedium:function(o){r=!0;var a=[];if(n.length){var c=n;n=[],c.forEach(o),a=n}var u=function(){var p=a;a=[],p.forEach(o)},f=function(){return Promise.resolve().then(u)};f(),n={push:function(p){a.push(p),f()},filter:function(p){return a=a.filter(p),n}}}};return i}function t6(t){t===void 0&&(t={});var e=e6(null);return e.options=wi({async:!0,ssr:!1},t),e}var Nk=function(t){var e=t.sideCar,n=Tk(t,["sideCar"]);if(!e)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var r=e.read();if(!r)throw new Error("Sidecar medium not found");return x.createElement(r,wi({},n))};Nk.isSideCarExport=!0;function n6(t,e){return t.useMedium(e),Nk}var Ak=t6(),$y=function(){},Ip=x.forwardRef(function(t,e){var n=x.useRef(null),r=x.useState({onScrollCapture:$y,onWheelCapture:$y,onTouchMoveCapture:$y}),i=r[0],o=r[1],a=t.forwardProps,c=t.children,u=t.className,f=t.removeScrollBar,p=t.enabled,g=t.shards,v=t.sideCar,y=t.noRelative,w=t.noIsolation,S=t.inert,C=t.allowPinchZoom,T=t.as,N=T===void 0?"div":T,k=t.gapMode,D=Tk(t,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),M=v,R=QB([n,e]),O=wi(wi({},D),i);return x.createElement(x.Fragment,null,p&&x.createElement(M,{sideCar:Ak,removeScrollBar:f,shards:g,noRelative:y,noIsolation:w,inert:S,setCallbacks:o,allowPinchZoom:!!C,lockRef:n,gapMode:k}),a?x.cloneElement(x.Children.only(c),wi(wi({},O),{ref:R})):x.createElement(N,wi({},O,{className:u,ref:R}),c))});Ip.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};Ip.classNames={fullWidth:rh,zeroRight:nh};var r6=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function i6(){if(!document)return null;var t=document.createElement("style");t.type="text/css";var e=r6();return e&&t.setAttribute("nonce",e),t}function o6(t,e){t.styleSheet?t.styleSheet.cssText=e:t.appendChild(document.createTextNode(e))}function s6(t){var e=document.head||document.getElementsByTagName("head")[0];e.appendChild(t)}var a6=function(){var t=0,e=null;return{add:function(n){t==0&&(e=i6())&&(o6(e,n),s6(e)),t++},remove:function(){t--,!t&&e&&(e.parentNode&&e.parentNode.removeChild(e),e=null)}}},l6=function(){var t=a6();return function(e,n){x.useEffect(function(){return t.add(e),function(){t.remove()}},[e&&n])}},kk=function(){var t=l6(),e=function(n){var r=n.styles,i=n.dynamic;return t(r,i),null};return e},c6={left:0,top:0,right:0,gap:0},Hy=function(t){return parseInt(t||"",10)||0},u6=function(t){var e=window.getComputedStyle(document.body),n=e[t==="padding"?"paddingLeft":"marginLeft"],r=e[t==="padding"?"paddingTop":"marginTop"],i=e[t==="padding"?"paddingRight":"marginRight"];return[Hy(n),Hy(r),Hy(i)]},d6=function(t){if(t===void 0&&(t="margin"),typeof window>"u")return c6;var e=u6(t),n=document.documentElement.clientWidth,r=window.innerWidth;return{left:e[0],top:e[1],right:e[2],gap:Math.max(0,r-n+e[2]-e[0])}},f6=kk(),Sl="data-scroll-locked",h6=function(t,e,n,r){var i=t.left,o=t.top,a=t.right,c=t.gap;return n===void 0&&(n="margin"),`
  .`.concat(YB,` {
   overflow: hidden `).concat(r,`;
   padding-right: `).concat(c,"px ").concat(r,`;
  }
  body[`).concat(Sl,`] {
    overflow: hidden `).concat(r,`;
    overscroll-behavior: contain;
    `).concat([e&&"position: relative ".concat(r,";"),n==="margin"&&`
    padding-left: `.concat(i,`px;
    padding-top: `).concat(o,`px;
    padding-right: `).concat(a,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(c,"px ").concat(r,`;
    `),n==="padding"&&"padding-right: ".concat(c,"px ").concat(r,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(nh,` {
    right: `).concat(c,"px ").concat(r,`;
  }
  
  .`).concat(rh,` {
    margin-right: `).concat(c,"px ").concat(r,`;
  }
  
  .`).concat(nh," .").concat(nh,` {
    right: 0 `).concat(r,`;
  }
  
  .`).concat(rh," .").concat(rh,` {
    margin-right: 0 `).concat(r,`;
  }
  
  body[`).concat(Sl,`] {
    `).concat(KB,": ").concat(c,`px;
  }
`)},jC=function(){var t=parseInt(document.body.getAttribute(Sl)||"0",10);return isFinite(t)?t:0},p6=function(){x.useEffect(function(){return document.body.setAttribute(Sl,(jC()+1).toString()),function(){var t=jC()-1;t<=0?document.body.removeAttribute(Sl):document.body.setAttribute(Sl,t.toString())}},[])},m6=function(t){var e=t.noRelative,n=t.noImportant,r=t.gapMode,i=r===void 0?"margin":r;p6();var o=x.useMemo(function(){return d6(i)},[i]);return x.createElement(f6,{styles:h6(o,!e,i,n?"":"!important")})},Gv=!1;if(typeof window<"u")try{var kf=Object.defineProperty({},"passive",{get:function(){return Gv=!0,!0}});window.addEventListener("test",kf,kf),window.removeEventListener("test",kf,kf)}catch{Gv=!1}var ll=Gv?{passive:!1}:!1,g6=function(t){return t.tagName==="TEXTAREA"},Dk=function(t,e){if(!(t instanceof Element))return!1;var n=window.getComputedStyle(t);return n[e]!=="hidden"&&!(n.overflowY===n.overflowX&&!g6(t)&&n[e]==="visible")},y6=function(t){return Dk(t,"overflowY")},v6=function(t){return Dk(t,"overflowX")},IC=function(t,e){var n=e.ownerDocument,r=e;do{typeof ShadowRoot<"u"&&r instanceof ShadowRoot&&(r=r.host);var i=Ok(t,r);if(i){var o=Mk(t,r),a=o[1],c=o[2];if(a>c)return!0}r=r.parentNode}while(r&&r!==n.body);return!1},x6=function(t){var e=t.scrollTop,n=t.scrollHeight,r=t.clientHeight;return[e,n,r]},b6=function(t){var e=t.scrollLeft,n=t.scrollWidth,r=t.clientWidth;return[e,n,r]},Ok=function(t,e){return t==="v"?y6(e):v6(e)},Mk=function(t,e){return t==="v"?x6(e):b6(e)},w6=function(t,e){return t==="h"&&e==="rtl"?-1:1},S6=function(t,e,n,r,i){var o=w6(t,window.getComputedStyle(e).direction),a=o*r,c=n.target,u=e.contains(c),f=!1,p=a>0,g=0,v=0;do{if(!c)break;var y=Mk(t,c),w=y[0],S=y[1],C=y[2],T=S-C-o*w;(w||T)&&Ok(t,c)&&(g+=T,v+=w);var N=c.parentNode;c=N&&N.nodeType===Node.DOCUMENT_FRAGMENT_NODE?N.host:N}while(!u&&c!==document.body||u&&(e.contains(c)||e===c));return(p&&Math.abs(g)<1||!p&&Math.abs(v)<1)&&(f=!0),f},Df=function(t){return"changedTouches"in t?[t.changedTouches[0].clientX,t.changedTouches[0].clientY]:[0,0]},_C=function(t){return[t.deltaX,t.deltaY]},LC=function(t){return t&&"current"in t?t.current:t},E6=function(t,e){return t[0]===e[0]&&t[1]===e[1]},C6=function(t){return`
  .block-interactivity-`.concat(t,` {pointer-events: none;}
  .allow-interactivity-`).concat(t,` {pointer-events: all;}
`)},T6=0,cl=[];function N6(t){var e=x.useRef([]),n=x.useRef([0,0]),r=x.useRef(),i=x.useState(T6++)[0],o=x.useState(kk)[0],a=x.useRef(t);x.useEffect(function(){a.current=t},[t]),x.useEffect(function(){if(t.inert){document.body.classList.add("block-interactivity-".concat(i));var S=WB([t.lockRef.current],(t.shards||[]).map(LC),!0).filter(Boolean);return S.forEach(function(C){return C.classList.add("allow-interactivity-".concat(i))}),function(){document.body.classList.remove("block-interactivity-".concat(i)),S.forEach(function(C){return C.classList.remove("allow-interactivity-".concat(i))})}}},[t.inert,t.lockRef.current,t.shards]);var c=x.useCallback(function(S,C){if("touches"in S&&S.touches.length===2||S.type==="wheel"&&S.ctrlKey)return!a.current.allowPinchZoom;var T=Df(S),N=n.current,k="deltaX"in S?S.deltaX:N[0]-T[0],D="deltaY"in S?S.deltaY:N[1]-T[1],M,R=S.target,O=Math.abs(k)>Math.abs(D)?"h":"v";if("touches"in S&&O==="h"&&R.type==="range")return!1;var I=window.getSelection(),z=I&&I.anchorNode,U=z?z===R||z.contains(R):!1;if(U)return!1;var Y=IC(O,R);if(!Y)return!0;if(Y?M=O:(M=O==="v"?"h":"v",Y=IC(O,R)),!Y)return!1;if(!r.current&&"changedTouches"in S&&(k||D)&&(r.current=M),!M)return!0;var W=r.current||M;return S6(W,C,S,W==="h"?k:D)},[]),u=x.useCallback(function(S){var C=S;if(!(!cl.length||cl[cl.length-1]!==o)){var T="deltaY"in C?_C(C):Df(C),N=e.current.filter(function(M){return M.name===C.type&&(M.target===C.target||C.target===M.shadowParent)&&E6(M.delta,T)})[0];if(N&&N.should){C.cancelable&&C.preventDefault();return}if(!N){var k=(a.current.shards||[]).map(LC).filter(Boolean).filter(function(M){return M.contains(C.target)}),D=k.length>0?c(C,k[0]):!a.current.noIsolation;D&&C.cancelable&&C.preventDefault()}}},[]),f=x.useCallback(function(S,C,T,N){var k={name:S,delta:C,target:T,should:N,shadowParent:A6(T)};e.current.push(k),setTimeout(function(){e.current=e.current.filter(function(D){return D!==k})},1)},[]),p=x.useCallback(function(S){n.current=Df(S),r.current=void 0},[]),g=x.useCallback(function(S){f(S.type,_C(S),S.target,c(S,t.lockRef.current))},[]),v=x.useCallback(function(S){f(S.type,Df(S),S.target,c(S,t.lockRef.current))},[]);x.useEffect(function(){return cl.push(o),t.setCallbacks({onScrollCapture:g,onWheelCapture:g,onTouchMoveCapture:v}),document.addEventListener("wheel",u,ll),document.addEventListener("touchmove",u,ll),document.addEventListener("touchstart",p,ll),function(){cl=cl.filter(function(S){return S!==o}),document.removeEventListener("wheel",u,ll),document.removeEventListener("touchmove",u,ll),document.removeEventListener("touchstart",p,ll)}},[]);var y=t.removeScrollBar,w=t.inert;return x.createElement(x.Fragment,null,w?x.createElement(o,{styles:C6(i)}):null,y?x.createElement(m6,{noRelative:t.noRelative,gapMode:t.gapMode}):null)}function A6(t){for(var e=null;t!==null;)t instanceof ShadowRoot&&(e=t.host,t=t.host),t=t.parentNode;return e}const k6=n6(Ak,N6);var _p=x.forwardRef(function(t,e){return x.createElement(Ip,wi({},t,{ref:e,sideCar:k6}))});_p.classNames=Ip.classNames;var D6=[" ","Enter","ArrowUp","ArrowDown"],O6=[" ","Enter"],la="Select",[Lp,Pp,M6]=gb(la),[Yl]=Wr(la,[M6,Wl]),zp=Wl(),[R6,xs]=Yl(la),[j6,I6]=Yl(la),Rk=t=>{const{__scopeSelect:e,children:n,open:r,defaultOpen:i,onOpenChange:o,value:a,defaultValue:c,onValueChange:u,dir:f,name:p,autoComplete:g,disabled:v,required:y,form:w}=t,S=zp(e),[C,T]=x.useState(null),[N,k]=x.useState(null),[D,M]=x.useState(!1),R=Ku(f),[O,I]=Di({prop:r,defaultProp:i??!1,onChange:o,caller:la}),[z,U]=Di({prop:a,defaultProp:c,onChange:u,caller:la}),Y=x.useRef(null),W=C?w||!!C.closest("form"):!0,[j,G]=x.useState(new Set),oe=Array.from(j).map(L=>L.props.value).join(";");return h.jsx(Nb,{...S,children:h.jsxs(R6,{required:y,scope:e,trigger:C,onTriggerChange:T,valueNode:N,onValueNodeChange:k,valueNodeHasChildren:D,onValueNodeHasChildrenChange:M,contentId:Ci(),value:z,onValueChange:U,open:O,onOpenChange:I,dir:R,triggerPointerDownPosRef:Y,disabled:v,children:[h.jsx(Lp.Provider,{scope:e,children:h.jsx(j6,{scope:t.__scopeSelect,onNativeOptionAdd:x.useCallback(L=>{G($=>new Set($).add(L))},[]),onNativeOptionRemove:x.useCallback(L=>{G($=>{const V=new Set($);return V.delete(L),V})},[]),children:n})}),W?h.jsxs(Xk,{"aria-hidden":!0,required:y,tabIndex:-1,name:p,autoComplete:g,value:z,onChange:L=>U(L.target.value),disabled:v,form:w,children:[z===void 0?h.jsx("option",{value:""}):null,Array.from(j)]},oe):null]})})};Rk.displayName=la;var jk="SelectTrigger",Ik=x.forwardRef((t,e)=>{const{__scopeSelect:n,disabled:r=!1,...i}=t,o=zp(n),a=xs(jk,n),c=a.disabled||r,u=ht(e,a.onTriggerChange),f=Pp(n),p=x.useRef("touch"),[g,v,y]=Qk(S=>{const C=f().filter(k=>!k.disabled),T=C.find(k=>k.value===a.value),N=Zk(C,S,T);N!==void 0&&a.onValueChange(N.value)}),w=S=>{c||(a.onOpenChange(!0),y()),S&&(a.triggerPointerDownPosRef.current={x:Math.round(S.pageX),y:Math.round(S.pageY)})};return h.jsx(Rp,{asChild:!0,...o,children:h.jsx(it.button,{type:"button",role:"combobox","aria-controls":a.contentId,"aria-expanded":a.open,"aria-required":a.required,"aria-autocomplete":"none",dir:a.dir,"data-state":a.open?"open":"closed",disabled:c,"data-disabled":c?"":void 0,"data-placeholder":Jk(a.value)?"":void 0,...i,ref:u,onClick:Ve(i.onClick,S=>{S.currentTarget.focus(),p.current!=="mouse"&&w(S)}),onPointerDown:Ve(i.onPointerDown,S=>{p.current=S.pointerType;const C=S.target;C.hasPointerCapture(S.pointerId)&&C.releasePointerCapture(S.pointerId),S.button===0&&S.ctrlKey===!1&&S.pointerType==="mouse"&&(w(S),S.preventDefault())}),onKeyDown:Ve(i.onKeyDown,S=>{const C=g.current!=="";!(S.ctrlKey||S.altKey||S.metaKey)&&S.key.length===1&&v(S.key),!(C&&S.key===" ")&&D6.includes(S.key)&&(w(),S.preventDefault())})})})});Ik.displayName=jk;var _k="SelectValue",Lk=x.forwardRef((t,e)=>{const{__scopeSelect:n,className:r,style:i,children:o,placeholder:a="",...c}=t,u=xs(_k,n),{onValueNodeHasChildrenChange:f}=u,p=o!==void 0,g=ht(e,u.onValueNodeChange);return Hn(()=>{f(p)},[f,p]),h.jsx(it.span,{...c,ref:g,style:{pointerEvents:"none"},children:Jk(u.value)?h.jsx(h.Fragment,{children:a}):o})});Lk.displayName=_k;var _6="SelectIcon",L6=x.forwardRef((t,e)=>{const{__scopeSelect:n,children:r,...i}=t;return h.jsx(it.span,{"aria-hidden":!0,...i,ref:e,children:r||""})});L6.displayName=_6;var P6="SelectPortal",Pk=t=>h.jsx(Qu,{asChild:!0,...t});Pk.displayName=P6;var ca="SelectContent",zk=x.forwardRef((t,e)=>{const n=xs(ca,t.__scopeSelect),[r,i]=x.useState();if(Hn(()=>{i(new DocumentFragment)},[]),!n.open){const o=r;return o?yo.createPortal(h.jsx(Bk,{scope:t.__scopeSelect,children:h.jsx(Lp.Slot,{scope:t.__scopeSelect,children:h.jsx("div",{children:t.children})})}),o):null}return h.jsx(Fk,{...t,ref:e})});zk.displayName=ca;var ei=10,[Bk,bs]=Yl(ca),z6="SelectContentImpl",B6=jB("SelectContent.RemoveScroll"),Fk=x.forwardRef((t,e)=>{const{__scopeSelect:n,position:r="item-aligned",onCloseAutoFocus:i,onEscapeKeyDown:o,onPointerDownOutside:a,side:c,sideOffset:u,align:f,alignOffset:p,arrowPadding:g,collisionBoundary:v,collisionPadding:y,sticky:w,hideWhenDetached:S,avoidCollisions:C,...T}=t,N=xs(ca,n),[k,D]=x.useState(null),[M,R]=x.useState(null),O=ht(e,H=>D(H)),[I,z]=x.useState(null),[U,Y]=x.useState(null),W=Pp(n),[j,G]=x.useState(!1),oe=x.useRef(!1);x.useEffect(()=>{if(k)return Db(k)},[k]),yb();const L=x.useCallback(H=>{const[ce,...te]=W().map(re=>re.ref.current),[me]=te.slice(-1),Te=document.activeElement;for(const re of H)if(re===Te||(re?.scrollIntoView({block:"nearest"}),re===ce&&M&&(M.scrollTop=0),re===me&&M&&(M.scrollTop=M.scrollHeight),re?.focus(),document.activeElement!==Te))return},[W,M]),$=x.useCallback(()=>L([I,k]),[L,I,k]);x.useEffect(()=>{j&&$()},[j,$]);const{onOpenChange:V,triggerPointerDownPosRef:we}=N;x.useEffect(()=>{if(k){let H={x:0,y:0};const ce=me=>{H={x:Math.abs(Math.round(me.pageX)-(we.current?.x??0)),y:Math.abs(Math.round(me.pageY)-(we.current?.y??0))}},te=me=>{H.x<=10&&H.y<=10?me.preventDefault():k.contains(me.target)||V(!1),document.removeEventListener("pointermove",ce),we.current=null};return we.current!==null&&(document.addEventListener("pointermove",ce),document.addEventListener("pointerup",te,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",ce),document.removeEventListener("pointerup",te,{capture:!0})}}},[k,V,we]),x.useEffect(()=>{const H=()=>V(!1);return window.addEventListener("blur",H),window.addEventListener("resize",H),()=>{window.removeEventListener("blur",H),window.removeEventListener("resize",H)}},[V]);const[pe,P]=Qk(H=>{const ce=W().filter(Te=>!Te.disabled),te=ce.find(Te=>Te.ref.current===document.activeElement),me=Zk(ce,H,te);me&&setTimeout(()=>me.ref.current.focus())}),K=x.useCallback((H,ce,te)=>{const me=!oe.current&&!te;(N.value!==void 0&&N.value===ce||me)&&(z(H),me&&(oe.current=!0))},[N.value]),B=x.useCallback(()=>k?.focus(),[k]),Z=x.useCallback((H,ce,te)=>{const me=!oe.current&&!te;(N.value!==void 0&&N.value===ce||me)&&Y(H)},[N.value]),le=r==="popper"?Wv:$k,be=le===Wv?{side:c,sideOffset:u,align:f,alignOffset:p,arrowPadding:g,collisionBoundary:v,collisionPadding:y,sticky:w,hideWhenDetached:S,avoidCollisions:C}:{};return h.jsx(Bk,{scope:n,content:k,viewport:M,onViewportChange:R,itemRefCallback:K,selectedItem:I,onItemLeave:B,itemTextRefCallback:Z,focusSelectedItem:$,selectedItemText:U,position:r,isPositioned:j,searchRef:pe,children:h.jsx(_p,{as:B6,allowPinchZoom:!0,children:h.jsx(Np,{asChild:!0,trapped:N.open,onMountAutoFocus:H=>{H.preventDefault()},onUnmountAutoFocus:Ve(i,H=>{N.trigger?.focus({preventScroll:!0}),H.preventDefault()}),children:h.jsx(Xu,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:o,onPointerDownOutside:a,onFocusOutside:H=>H.preventDefault(),onDismiss:()=>N.onOpenChange(!1),children:h.jsx(le,{role:"listbox",id:N.contentId,"data-state":N.open?"open":"closed",dir:N.dir,onContextMenu:H=>H.preventDefault(),...T,...be,onPlaced:()=>G(!0),ref:O,style:{display:"flex",flexDirection:"column",outline:"none",...T.style},onKeyDown:Ve(T.onKeyDown,H=>{const ce=H.ctrlKey||H.altKey||H.metaKey;if(H.key==="Tab"&&H.preventDefault(),!ce&&H.key.length===1&&P(H.key),["ArrowUp","ArrowDown","Home","End"].includes(H.key)){let me=W().filter(Te=>!Te.disabled).map(Te=>Te.ref.current);if(["ArrowUp","End"].includes(H.key)&&(me=me.slice().reverse()),["ArrowUp","ArrowDown"].includes(H.key)){const Te=H.target,re=me.indexOf(Te);me=me.slice(re+1)}setTimeout(()=>L(me)),H.preventDefault()}})})})})})})});Fk.displayName=z6;var F6="SelectItemAlignedPosition",$k=x.forwardRef((t,e)=>{const{__scopeSelect:n,onPlaced:r,...i}=t,o=xs(ca,n),a=bs(ca,n),[c,u]=x.useState(null),[f,p]=x.useState(null),g=ht(e,O=>p(O)),v=Pp(n),y=x.useRef(!1),w=x.useRef(!0),{viewport:S,selectedItem:C,selectedItemText:T,focusSelectedItem:N}=a,k=x.useCallback(()=>{if(o.trigger&&o.valueNode&&c&&f&&S&&C&&T){const O=o.trigger.getBoundingClientRect(),I=f.getBoundingClientRect(),z=o.valueNode.getBoundingClientRect(),U=T.getBoundingClientRect();if(o.dir!=="rtl"){const Te=U.left-I.left,re=z.left-Te,he=O.left-re,Ae=O.width+he,Re=Math.max(Ae,I.width),Le=window.innerWidth-ei,ae=Nu(re,[ei,Math.max(ei,Le-Re)]);c.style.minWidth=Ae+"px",c.style.left=ae+"px"}else{const Te=I.right-U.right,re=window.innerWidth-z.right-Te,he=window.innerWidth-O.right-re,Ae=O.width+he,Re=Math.max(Ae,I.width),Le=window.innerWidth-ei,ae=Nu(re,[ei,Math.max(ei,Le-Re)]);c.style.minWidth=Ae+"px",c.style.right=ae+"px"}const Y=v(),W=window.innerHeight-ei*2,j=S.scrollHeight,G=window.getComputedStyle(f),oe=parseInt(G.borderTopWidth,10),L=parseInt(G.paddingTop,10),$=parseInt(G.borderBottomWidth,10),V=parseInt(G.paddingBottom,10),we=oe+L+j+V+$,pe=Math.min(C.offsetHeight*5,we),P=window.getComputedStyle(S),K=parseInt(P.paddingTop,10),B=parseInt(P.paddingBottom,10),Z=O.top+O.height/2-ei,le=W-Z,be=C.offsetHeight/2,H=C.offsetTop+be,ce=oe+L+H,te=we-ce;if(ce<=Z){const Te=Y.length>0&&C===Y[Y.length-1].ref.current;c.style.bottom="0px";const re=f.clientHeight-S.offsetTop-S.offsetHeight,he=Math.max(le,be+(Te?B:0)+re+$),Ae=ce+he;c.style.height=Ae+"px"}else{const Te=Y.length>0&&C===Y[0].ref.current;c.style.top="0px";const he=Math.max(Z,oe+S.offsetTop+(Te?K:0)+be)+te;c.style.height=he+"px",S.scrollTop=ce-Z+S.offsetTop}c.style.margin=`${ei}px 0`,c.style.minHeight=pe+"px",c.style.maxHeight=W+"px",r?.(),requestAnimationFrame(()=>y.current=!0)}},[v,o.trigger,o.valueNode,c,f,S,C,T,o.dir,r]);Hn(()=>k(),[k]);const[D,M]=x.useState();Hn(()=>{f&&M(window.getComputedStyle(f).zIndex)},[f]);const R=x.useCallback(O=>{O&&w.current===!0&&(k(),N?.(),w.current=!1)},[k,N]);return h.jsx(H6,{scope:n,contentWrapper:c,shouldExpandOnScrollRef:y,onScrollButtonChange:R,children:h.jsx("div",{ref:u,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:D},children:h.jsx(it.div,{...i,ref:g,style:{boxSizing:"border-box",maxHeight:"100%",...i.style}})})})});$k.displayName=F6;var $6="SelectPopperPosition",Wv=x.forwardRef((t,e)=>{const{__scopeSelect:n,align:r="start",collisionPadding:i=ei,...o}=t,a=zp(n);return h.jsx(Ab,{...a,...o,ref:e,align:r,collisionPadding:i,style:{boxSizing:"border-box",...o.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});Wv.displayName=$6;var[H6,Ob]=Yl(ca,{}),Yv="SelectViewport",Hk=x.forwardRef((t,e)=>{const{__scopeSelect:n,nonce:r,...i}=t,o=bs(Yv,n),a=Ob(Yv,n),c=ht(e,o.onViewportChange),u=x.useRef(0);return h.jsxs(h.Fragment,{children:[h.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:r}),h.jsx(Lp.Slot,{scope:n,children:h.jsx(it.div,{"data-radix-select-viewport":"",role:"presentation",...i,ref:c,style:{position:"relative",flex:1,overflow:"hidden auto",...i.style},onScroll:Ve(i.onScroll,f=>{const p=f.currentTarget,{contentWrapper:g,shouldExpandOnScrollRef:v}=a;if(v?.current&&g){const y=Math.abs(u.current-p.scrollTop);if(y>0){const w=window.innerHeight-ei*2,S=parseFloat(g.style.minHeight),C=parseFloat(g.style.height),T=Math.max(S,C);if(T<w){const N=T+y,k=Math.min(w,N),D=N-k;g.style.height=k+"px",g.style.bottom==="0px"&&(p.scrollTop=D>0?D:0,g.style.justifyContent="flex-end")}}}u.current=p.scrollTop})})})]})});Hk.displayName=Yv;var Uk="SelectGroup",[U6,V6]=Yl(Uk),q6=x.forwardRef((t,e)=>{const{__scopeSelect:n,...r}=t,i=Ci();return h.jsx(U6,{scope:n,id:i,children:h.jsx(it.div,{role:"group","aria-labelledby":i,...r,ref:e})})});q6.displayName=Uk;var Vk="SelectLabel",G6=x.forwardRef((t,e)=>{const{__scopeSelect:n,...r}=t,i=V6(Vk,n);return h.jsx(it.div,{id:i.id,...r,ref:e})});G6.displayName=Vk;var Sh="SelectItem",[W6,qk]=Yl(Sh),Gk=x.forwardRef((t,e)=>{const{__scopeSelect:n,value:r,disabled:i=!1,textValue:o,...a}=t,c=xs(Sh,n),u=bs(Sh,n),f=c.value===r,[p,g]=x.useState(o??""),[v,y]=x.useState(!1),w=ht(e,N=>u.itemRefCallback?.(N,r,i)),S=Ci(),C=x.useRef("touch"),T=()=>{i||(c.onValueChange(r),c.onOpenChange(!1))};if(r==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return h.jsx(W6,{scope:n,value:r,disabled:i,textId:S,isSelected:f,onItemTextChange:x.useCallback(N=>{g(k=>k||(N?.textContent??"").trim())},[]),children:h.jsx(Lp.ItemSlot,{scope:n,value:r,disabled:i,textValue:p,children:h.jsx(it.div,{role:"option","aria-labelledby":S,"data-highlighted":v?"":void 0,"aria-selected":f&&v,"data-state":f?"checked":"unchecked","aria-disabled":i||void 0,"data-disabled":i?"":void 0,tabIndex:i?void 0:-1,...a,ref:w,onFocus:Ve(a.onFocus,()=>y(!0)),onBlur:Ve(a.onBlur,()=>y(!1)),onClick:Ve(a.onClick,()=>{C.current!=="mouse"&&T()}),onPointerUp:Ve(a.onPointerUp,()=>{C.current==="mouse"&&T()}),onPointerDown:Ve(a.onPointerDown,N=>{C.current=N.pointerType}),onPointerMove:Ve(a.onPointerMove,N=>{C.current=N.pointerType,i?u.onItemLeave?.():C.current==="mouse"&&N.currentTarget.focus({preventScroll:!0})}),onPointerLeave:Ve(a.onPointerLeave,N=>{N.currentTarget===document.activeElement&&u.onItemLeave?.()}),onKeyDown:Ve(a.onKeyDown,N=>{u.searchRef?.current!==""&&N.key===" "||(O6.includes(N.key)&&T(),N.key===" "&&N.preventDefault())})})})})});Gk.displayName=Sh;var ru="SelectItemText",Wk=x.forwardRef((t,e)=>{const{__scopeSelect:n,className:r,style:i,...o}=t,a=xs(ru,n),c=bs(ru,n),u=qk(ru,n),f=I6(ru,n),[p,g]=x.useState(null),v=ht(e,T=>g(T),u.onItemTextChange,T=>c.itemTextRefCallback?.(T,u.value,u.disabled)),y=p?.textContent,w=x.useMemo(()=>h.jsx("option",{value:u.value,disabled:u.disabled,children:y},u.value),[u.disabled,u.value,y]),{onNativeOptionAdd:S,onNativeOptionRemove:C}=f;return Hn(()=>(S(w),()=>C(w)),[S,C,w]),h.jsxs(h.Fragment,{children:[h.jsx(it.span,{id:u.textId,...o,ref:v}),u.isSelected&&a.valueNode&&!a.valueNodeHasChildren?yo.createPortal(o.children,a.valueNode):null]})});Wk.displayName=ru;var Yk="SelectItemIndicator",Y6=x.forwardRef((t,e)=>{const{__scopeSelect:n,...r}=t;return qk(Yk,n).isSelected?h.jsx(it.span,{"aria-hidden":!0,...r,ref:e}):null});Y6.displayName=Yk;var Kv="SelectScrollUpButton",K6=x.forwardRef((t,e)=>{const n=bs(Kv,t.__scopeSelect),r=Ob(Kv,t.__scopeSelect),[i,o]=x.useState(!1),a=ht(e,r.onScrollButtonChange);return Hn(()=>{if(n.viewport&&n.isPositioned){let c=function(){const f=u.scrollTop>0;o(f)};const u=n.viewport;return c(),u.addEventListener("scroll",c),()=>u.removeEventListener("scroll",c)}},[n.viewport,n.isPositioned]),i?h.jsx(Kk,{...t,ref:a,onAutoScroll:()=>{const{viewport:c,selectedItem:u}=n;c&&u&&(c.scrollTop=c.scrollTop-u.offsetHeight)}}):null});K6.displayName=Kv;var Xv="SelectScrollDownButton",X6=x.forwardRef((t,e)=>{const n=bs(Xv,t.__scopeSelect),r=Ob(Xv,t.__scopeSelect),[i,o]=x.useState(!1),a=ht(e,r.onScrollButtonChange);return Hn(()=>{if(n.viewport&&n.isPositioned){let c=function(){const f=u.scrollHeight-u.clientHeight,p=Math.ceil(u.scrollTop)<f;o(p)};const u=n.viewport;return c(),u.addEventListener("scroll",c),()=>u.removeEventListener("scroll",c)}},[n.viewport,n.isPositioned]),i?h.jsx(Kk,{...t,ref:a,onAutoScroll:()=>{const{viewport:c,selectedItem:u}=n;c&&u&&(c.scrollTop=c.scrollTop+u.offsetHeight)}}):null});X6.displayName=Xv;var Kk=x.forwardRef((t,e)=>{const{__scopeSelect:n,onAutoScroll:r,...i}=t,o=bs("SelectScrollButton",n),a=x.useRef(null),c=Pp(n),u=x.useCallback(()=>{a.current!==null&&(window.clearInterval(a.current),a.current=null)},[]);return x.useEffect(()=>()=>u(),[u]),Hn(()=>{c().find(p=>p.ref.current===document.activeElement)?.ref.current?.scrollIntoView({block:"nearest"})},[c]),h.jsx(it.div,{"aria-hidden":!0,...i,ref:e,style:{flexShrink:0,...i.style},onPointerDown:Ve(i.onPointerDown,()=>{a.current===null&&(a.current=window.setInterval(r,50))}),onPointerMove:Ve(i.onPointerMove,()=>{o.onItemLeave?.(),a.current===null&&(a.current=window.setInterval(r,50))}),onPointerLeave:Ve(i.onPointerLeave,()=>{u()})})}),J6="SelectSeparator",Q6=x.forwardRef((t,e)=>{const{__scopeSelect:n,...r}=t;return h.jsx(it.div,{"aria-hidden":!0,...r,ref:e})});Q6.displayName=J6;var Jv="SelectArrow",Z6=x.forwardRef((t,e)=>{const{__scopeSelect:n,...r}=t,i=zp(n),o=xs(Jv,n),a=bs(Jv,n);return o.open&&a.position==="popper"?h.jsx(kb,{...i,...r,ref:e}):null});Z6.displayName=Jv;var eF="SelectBubbleInput",Xk=x.forwardRef(({__scopeSelect:t,value:e,...n},r)=>{const i=x.useRef(null),o=ht(r,i),a=jp(e);return x.useEffect(()=>{const c=i.current;if(!c)return;const u=window.HTMLSelectElement.prototype,p=Object.getOwnPropertyDescriptor(u,"value").set;if(a!==e&&p){const g=new Event("change",{bubbles:!0});p.call(c,e),c.dispatchEvent(g)}},[a,e]),h.jsx(it.select,{...n,style:{...Sk,...n.style},ref:o,defaultValue:e})});Xk.displayName=eF;function Jk(t){return t===""||t===void 0}function Qk(t){const e=Qn(t),n=x.useRef(""),r=x.useRef(0),i=x.useCallback(a=>{const c=n.current+a;e(c),(function u(f){n.current=f,window.clearTimeout(r.current),f!==""&&(r.current=window.setTimeout(()=>u(""),1e3))})(c)},[e]),o=x.useCallback(()=>{n.current="",window.clearTimeout(r.current)},[]);return x.useEffect(()=>()=>window.clearTimeout(r.current),[]),[n,i,o]}function Zk(t,e,n){const i=e.length>1&&Array.from(e).every(f=>f===e[0])?e[0]:e,o=n?t.indexOf(n):-1;let a=tF(t,Math.max(o,0));i.length===1&&(a=a.filter(f=>f!==n));const u=a.find(f=>f.textValue.toLowerCase().startsWith(i.toLowerCase()));return u!==n?u:void 0}function tF(t,e){return t.map((n,r)=>t[(e+r)%t.length])}var nF=Rk,rF=Ik,iF=Lk,oF=Pk,sF=zk,aF=Hk,lF=Gk,cF=Wk;const Pt=nF,zt=x.forwardRef(({className:t,children:e,...n},r)=>h.jsx(rF,{ref:r,className:Wt("flex h-3 w-full items-center justify-between rounded-sm border border-borderScale-0 bg-inputScale-2 px-3 py-2 text-xs text-popover-foreground shadow-sm","focus:outline-none focus:ring-2 focus:ring-ring",t),...n,children:e})),Bt=iF,Ft=x.forwardRef(({className:t,children:e,...n},r)=>h.jsx(oF,{children:h.jsx(sF,{ref:r,className:Wt("z-[1000005] min-w-[8rem] font-mono overflow-hidden rounded-sm bg-inputScale-0 text-popover-foreground shadow-md",t),position:"popper",...n,children:h.jsx(aF,{className:"p-1 rounded border border-borderScale-0 bg-inputScale-0 text-xs",children:e})})})),wt=x.forwardRef(({className:t,children:e,...n},r)=>h.jsx(lF,{ref:r,className:Wt("relative flex w-full cursor-pointer select-none items-center rounded-sm px-2 py-1.5 text-xs outline-none bg-overlay","focus:bg-accent focus:text-accent-foreground",t),...n,children:h.jsx(cF,{className:"bg-overlay",children:e})}));function uF(t,e){return x.useReducer((n,r)=>e[n][r]??n,t)}var pr=t=>{const{present:e,children:n}=t,r=dF(e),i=typeof n=="function"?n({present:r.isPresent}):x.Children.only(n),o=ht(r.ref,fF(i));return typeof n=="function"||r.isPresent?x.cloneElement(i,{ref:o}):null};pr.displayName="Presence";function dF(t){const[e,n]=x.useState(),r=x.useRef(null),i=x.useRef(t),o=x.useRef("none"),a=t?"mounted":"unmounted",[c,u]=uF(a,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return x.useEffect(()=>{const f=Of(r.current);o.current=c==="mounted"?f:"none"},[c]),Hn(()=>{const f=r.current,p=i.current;if(p!==t){const v=o.current,y=Of(f);t?u("MOUNT"):y==="none"||f?.display==="none"?u("UNMOUNT"):u(p&&v!==y?"ANIMATION_OUT":"UNMOUNT"),i.current=t}},[t,u]),Hn(()=>{if(e){let f;const p=e.ownerDocument.defaultView??window,g=y=>{const S=Of(r.current).includes(CSS.escape(y.animationName));if(y.target===e&&S&&(u("ANIMATION_END"),!i.current)){const C=e.style.animationFillMode;e.style.animationFillMode="forwards",f=p.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=C)})}},v=y=>{y.target===e&&(o.current=Of(r.current))};return e.addEventListener("animationstart",v),e.addEventListener("animationcancel",g),e.addEventListener("animationend",g),()=>{p.clearTimeout(f),e.removeEventListener("animationstart",v),e.removeEventListener("animationcancel",g),e.removeEventListener("animationend",g)}}else u("ANIMATION_END")},[e,u]),{isPresent:["mounted","unmountSuspended"].includes(c),ref:x.useCallback(f=>{r.current=f?getComputedStyle(f):null,n(f)},[])}}function Of(t){return t?.animationName||"none"}function fF(t){let e=Object.getOwnPropertyDescriptor(t.props,"ref")?.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=Object.getOwnPropertyDescriptor(t,"ref")?.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}function hF(t){const e=pF(t),n=x.forwardRef((r,i)=>{const{children:o,...a}=r,c=x.Children.toArray(o),u=c.find(gF);if(u){const f=u.props.children,p=c.map(g=>g===u?x.Children.count(f)>1?x.Children.only(null):x.isValidElement(f)?f.props.children:null:g);return h.jsx(e,{...a,ref:i,children:x.isValidElement(f)?x.cloneElement(f,void 0,p):null})}return h.jsx(e,{...a,ref:i,children:o})});return n.displayName=`${t}.Slot`,n}function pF(t){const e=x.forwardRef((n,r)=>{const{children:i,...o}=n;if(x.isValidElement(i)){const a=vF(i),c=yF(o,i.props);return i.type!==x.Fragment&&(c.ref=r?ga(r,a):a),x.cloneElement(i,c)}return x.Children.count(i)>1?x.Children.only(null):null});return e.displayName=`${t}.SlotClone`,e}var mF=Symbol("radix.slottable");function gF(t){return x.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===mF}function yF(t,e){const n={...e};for(const r in e){const i=t[r],o=e[r];/^on[A-Z]/.test(r)?i&&o?n[r]=(...c)=>{const u=o(...c);return i(...c),u}:i&&(n[r]=i):r==="style"?n[r]={...i,...o}:r==="className"&&(n[r]=[i,o].filter(Boolean).join(" "))}return{...t,...n}}function vF(t){let e=Object.getOwnPropertyDescriptor(t.props,"ref")?.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=Object.getOwnPropertyDescriptor(t,"ref")?.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}var Bp="Popover",[eD]=Wr(Bp,[Wl]),Zu=Wl(),[xF,ws]=eD(Bp),tD=t=>{const{__scopePopover:e,children:n,open:r,defaultOpen:i,onOpenChange:o,modal:a=!1}=t,c=Zu(e),u=x.useRef(null),[f,p]=x.useState(!1),[g,v]=Di({prop:r,defaultProp:i??!1,onChange:o,caller:Bp});return h.jsx(Nb,{...c,children:h.jsx(xF,{scope:e,contentId:Ci(),triggerRef:u,open:g,onOpenChange:v,onOpenToggle:x.useCallback(()=>v(y=>!y),[v]),hasCustomAnchor:f,onCustomAnchorAdd:x.useCallback(()=>p(!0),[]),onCustomAnchorRemove:x.useCallback(()=>p(!1),[]),modal:a,children:n})})};tD.displayName=Bp;var nD="PopoverAnchor",bF=x.forwardRef((t,e)=>{const{__scopePopover:n,...r}=t,i=ws(nD,n),o=Zu(n),{onCustomAnchorAdd:a,onCustomAnchorRemove:c}=i;return x.useEffect(()=>(a(),()=>c()),[a,c]),h.jsx(Rp,{...o,...r,ref:e})});bF.displayName=nD;var rD="PopoverTrigger",iD=x.forwardRef((t,e)=>{const{__scopePopover:n,...r}=t,i=ws(rD,n),o=Zu(n),a=ht(e,i.triggerRef),c=h.jsx(it.button,{type:"button","aria-haspopup":"dialog","aria-expanded":i.open,"aria-controls":i.contentId,"data-state":cD(i.open),...r,ref:a,onClick:Ve(t.onClick,i.onOpenToggle)});return i.hasCustomAnchor?c:h.jsx(Rp,{asChild:!0,...o,children:c})});iD.displayName=rD;var Mb="PopoverPortal",[wF,SF]=eD(Mb,{forceMount:void 0}),oD=t=>{const{__scopePopover:e,forceMount:n,children:r,container:i}=t,o=ws(Mb,e);return h.jsx(wF,{scope:e,forceMount:n,children:h.jsx(pr,{present:n||o.open,children:h.jsx(Qu,{asChild:!0,container:i,children:r})})})};oD.displayName=Mb;var kl="PopoverContent",sD=x.forwardRef((t,e)=>{const n=SF(kl,t.__scopePopover),{forceMount:r=n.forceMount,...i}=t,o=ws(kl,t.__scopePopover);return h.jsx(pr,{present:r||o.open,children:o.modal?h.jsx(CF,{...i,ref:e}):h.jsx(TF,{...i,ref:e})})});sD.displayName=kl;var EF=hF("PopoverContent.RemoveScroll"),CF=x.forwardRef((t,e)=>{const n=ws(kl,t.__scopePopover),r=x.useRef(null),i=ht(e,r),o=x.useRef(!1);return x.useEffect(()=>{const a=r.current;if(a)return Db(a)},[]),h.jsx(_p,{as:EF,allowPinchZoom:!0,children:h.jsx(aD,{...t,ref:i,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Ve(t.onCloseAutoFocus,a=>{a.preventDefault(),o.current||n.triggerRef.current?.focus()}),onPointerDownOutside:Ve(t.onPointerDownOutside,a=>{const c=a.detail.originalEvent,u=c.button===0&&c.ctrlKey===!0,f=c.button===2||u;o.current=f},{checkForDefaultPrevented:!1}),onFocusOutside:Ve(t.onFocusOutside,a=>a.preventDefault(),{checkForDefaultPrevented:!1})})})}),TF=x.forwardRef((t,e)=>{const n=ws(kl,t.__scopePopover),r=x.useRef(!1),i=x.useRef(!1);return h.jsx(aD,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:o=>{t.onCloseAutoFocus?.(o),o.defaultPrevented||(r.current||n.triggerRef.current?.focus(),o.preventDefault()),r.current=!1,i.current=!1},onInteractOutside:o=>{t.onInteractOutside?.(o),o.defaultPrevented||(r.current=!0,o.detail.originalEvent.type==="pointerdown"&&(i.current=!0));const a=o.target;n.triggerRef.current?.contains(a)&&o.preventDefault(),o.detail.originalEvent.type==="focusin"&&i.current&&o.preventDefault()}})}),aD=x.forwardRef((t,e)=>{const{__scopePopover:n,trapFocus:r,onOpenAutoFocus:i,onCloseAutoFocus:o,disableOutsidePointerEvents:a,onEscapeKeyDown:c,onPointerDownOutside:u,onFocusOutside:f,onInteractOutside:p,...g}=t,v=ws(kl,n),y=Zu(n);return yb(),h.jsx(Np,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:i,onUnmountAutoFocus:o,children:h.jsx(Xu,{asChild:!0,disableOutsidePointerEvents:a,onInteractOutside:p,onEscapeKeyDown:c,onPointerDownOutside:u,onFocusOutside:f,onDismiss:()=>v.onOpenChange(!1),children:h.jsx(Ab,{"data-state":cD(v.open),role:"dialog",id:v.contentId,...y,...g,ref:e,style:{...g.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),lD="PopoverClose",NF=x.forwardRef((t,e)=>{const{__scopePopover:n,...r}=t,i=ws(lD,n);return h.jsx(it.button,{type:"button",...r,ref:e,onClick:Ve(t.onClick,()=>i.onOpenChange(!1))})});NF.displayName=lD;var AF="PopoverArrow",kF=x.forwardRef((t,e)=>{const{__scopePopover:n,...r}=t,i=Zu(n);return h.jsx(kb,{...i,...r,ref:e})});kF.displayName=AF;function cD(t){return t?"open":"closed"}var DF=tD,OF=iD,MF=oD,RF=sD;const fo=DF,ho=OF,po=x.forwardRef(({className:t,align:e="start",sideOffset:n=4,...r},i)=>h.jsx(MF,{children:h.jsx(RF,{ref:i,align:e,collisionPadding:16,avoidCollisions:!0,sideOffset:n,className:Wt("z-[10000] p-3 rounded border border-borderScale-0 bg-popoverScale-2 text-popover-foreground shadow-md outline-none","max-w-[calc(100vw-32px)]","w-[min(340px,calc(100vw-32px))]","max-h-[calc(100vh-32px)] overflow-auto",t),...r})})),Rn=x.createContext({socket:null,dispatch:()=>{},state:{},updatePanel:()=>{},updateGrid:()=>{},instancesById:Object.create(null),occurrencesById:Object.create(null),containersById:Object.create(null),fieldsById:Object.create(null),panelsById:Object.create(null),manifestsById:Object.create(null),viewsById:Object.create(null),docsById:Object.create(null),foldersById:Object.create(null),artifactsById:Object.create(null),addContainerToPanel:()=>{},addInstanceToContainer:()=>{},createField:()=>{},updateField:()=>{},deleteField:()=>{},canUndo:!1,canRedo:!1,undo:()=>{},redo:()=>{},isProcessing:!1});function jF(t,e){if(!t)return"";const n=new Date(t);switch(e){case"daily":return n.toLocaleDateString(void 0,{month:"short",day:"numeric"});case"weekly":{const r=new Date(n);return r.setDate(n.getDate()-n.getDay()),`Wk ${r.toLocaleDateString(void 0,{month:"short",day:"numeric"})}`}case"monthly":return n.toLocaleDateString(void 0,{month:"short",year:"2-digit"});case"yearly":return n.getFullYear().toString();default:return n.toLocaleDateString(void 0,{month:"short",day:"numeric"})}}function PC(t,e,n){const r=new Date(t),i=n==="next"?1:-1;switch(e){case"daily":r.setDate(r.getDate()+i);break;case"weekly":r.setDate(r.getDate()+i*7);break;case"monthly":r.setMonth(r.getMonth()+i);break;case"yearly":r.setFullYear(r.getFullYear()+i);break}return r}function zC(t,e,n){if(!e||e.length===0)return t;const r=e.indexOf(t),i=n==="next"?1:-1;if(r===-1)return e[0];const o=(r+i+e.length)%e.length;return e[o]}function uD({occurrence:t,onUpdate:e,showModeToggle:n=!0,compact:r=!1,alwaysExpanded:i=!1}){const o=x.useContext(Rn)||{},{iterations:a=[],selectedIterationId:c,currentIterationValue:u,categoryDimensions:f=[],selectedCategoryId:p,currentCategoryValue:g}=o,y=(t?.iteration?.inheritMode||"inherit")==="own",w=x.useMemo(()=>y&&t?.iteration?.timeFilter?t.iteration.timeFilter:(a.find(G=>G.id===c)||a[0])?.timeFilter||"daily",[y,t,a,c]),S=x.useMemo(()=>y&&(t?.iteration?.timeValue||t?.iteration?.value)?new Date(t.iteration.timeValue||t.iteration.value):u?new Date(u):new Date,[y,t,u]),C=x.useMemo(()=>y&&t?.iteration?.categoryKey?t.iteration.categoryKey:p,[y,t,p]),T=x.useMemo(()=>y&&t?.iteration?.categoryValue?t.iteration.categoryValue:g,[y,t,g]),N=x.useMemo(()=>f.find(j=>j.id===C),[f,C]),k=x.useCallback(()=>{const j=y?"inherit":"own";e?.({iteration:{...t?.iteration||{},inheritMode:j,...j==="own"?{timeValue:S,timeFilter:w,categoryKey:C,categoryValue:T}:{}}})},[y,t,e,S,w,C,T]),D=x.useCallback(()=>{if(!y)return;const j=PC(S,w,"prev");e?.({iteration:{...t?.iteration||{},timeValue:j}})},[y,t,e,S,w]),M=x.useCallback(()=>{if(!y)return;const j=PC(S,w,"next");e?.({iteration:{...t?.iteration||{},timeValue:j}})},[y,t,e,S,w]),R=x.useCallback(()=>{if(!y||!N)return;const j=zC(T,N.values,"prev");e?.({iteration:{...t?.iteration||{},categoryValue:j}})},[y,t,e,T,N]),O=x.useCallback(()=>{if(!y||!N)return;const j=zC(T,N.values,"next");e?.({iteration:{...t?.iteration||{},categoryValue:j}})},[y,t,e,T,N]),I=jF(S,w),z=T||"All",U=r?"h-5 w-5":"h-6 w-6",Y=r?"h-3 w-3":"h-3.5 w-3.5",W=r?"text-[9px]":"text-[10px]";return h.jsxs("div",{className:"local-iteration-nav flex items-center gap-0.5",children:[n&&h.jsx(_e,{size:"sm",variant:y?"secondary":"ghost",className:`${U} p-0`,onClick:k,title:y?"Using own iteration (click to inherit)":"Inheriting from parent (click for own)",children:y?h.jsx(LA,{className:Y}):h.jsx(Nl,{className:`${Y} opacity-50`})}),(y||i)&&h.jsxs("div",{className:"flex items-center gap-0",children:[y&&h.jsx(_e,{size:"sm",variant:"ghost",className:`${U} p-0`,onClick:D,children:h.jsx(Cu,{className:Y})}),h.jsx("span",{className:`${W} min-w-[50px] text-center ${y?"text-muted-foreground":"text-muted-foreground/60"}`,children:I}),y&&h.jsx(_e,{size:"sm",variant:"ghost",className:`${U} p-0`,onClick:M,children:h.jsx(hs,{className:Y})})]}),(y||i)&&N&&N.values.length>0&&h.jsxs("div",{className:"flex items-center gap-0 ml-1 pl-1 border-l border-border",children:[y&&h.jsx(_e,{size:"sm",variant:"ghost",className:`${U} p-0`,onClick:R,children:h.jsx(Cu,{className:Y})}),h.jsx("span",{className:`${W} min-w-[40px] text-center ${y?"text-muted-foreground":"text-muted-foreground/60"}`,children:z}),y&&h.jsx(_e,{size:"sm",variant:"ghost",className:`${U} p-0`,onClick:O,children:h.jsx(hs,{className:Y})})]})]})}function kn(){return`${Date.now()}-${Math.random().toString(36).substr(2,9)}`}var Uy={exports:{}},Vy={};var BC;function IF(){if(BC)return Vy;BC=1;var t=Wu();function e(g,v){return g===v&&(g!==0||1/g===1/v)||g!==g&&v!==v}var n=typeof Object.is=="function"?Object.is:e,r=t.useState,i=t.useEffect,o=t.useLayoutEffect,a=t.useDebugValue;function c(g,v){var y=v(),w=r({inst:{value:y,getSnapshot:v}}),S=w[0].inst,C=w[1];return o(function(){S.value=y,S.getSnapshot=v,u(S)&&C({inst:S})},[g,y,v]),i(function(){return u(S)&&C({inst:S}),g(function(){u(S)&&C({inst:S})})},[g]),a(y),y}function u(g){var v=g.getSnapshot;g=g.value;try{var y=v();return!n(g,y)}catch{return!0}}function f(g,v){return v()}var p=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?f:c;return Vy.useSyncExternalStore=t.useSyncExternalStore!==void 0?t.useSyncExternalStore:p,Vy}var FC;function dD(){return FC||(FC=1,Uy.exports=IF()),Uy.exports}var fD=dD();function zn(t){this.content=t}zn.prototype={constructor:zn,find:function(t){for(var e=0;e<this.content.length;e+=2)if(this.content[e]===t)return e;return-1},get:function(t){var e=this.find(t);return e==-1?void 0:this.content[e+1]},update:function(t,e,n){var r=n&&n!=t?this.remove(n):this,i=r.find(t),o=r.content.slice();return i==-1?o.push(n||t,e):(o[i+1]=e,n&&(o[i]=n)),new zn(o)},remove:function(t){var e=this.find(t);if(e==-1)return this;var n=this.content.slice();return n.splice(e,2),new zn(n)},addToStart:function(t,e){return new zn([t,e].concat(this.remove(t).content))},addToEnd:function(t,e){var n=this.remove(t).content.slice();return n.push(t,e),new zn(n)},addBefore:function(t,e,n){var r=this.remove(e),i=r.content.slice(),o=r.find(t);return i.splice(o==-1?i.length:o,0,e,n),new zn(i)},forEach:function(t){for(var e=0;e<this.content.length;e+=2)t(this.content[e],this.content[e+1])},prepend:function(t){return t=zn.from(t),t.size?new zn(t.content.concat(this.subtract(t).content)):this},append:function(t){return t=zn.from(t),t.size?new zn(this.subtract(t).content.concat(t.content)):this},subtract:function(t){var e=this;t=zn.from(t);for(var n=0;n<t.content.length;n+=2)e=e.remove(t.content[n]);return e},toObject:function(){var t={};return this.forEach(function(e,n){t[e]=n}),t},get size(){return this.content.length>>1}};zn.from=function(t){if(t instanceof zn)return t;var e=[];if(t)for(var n in t)e.push(n,t[n]);return new zn(e)};function hD(t,e,n){for(let r=0;;r++){if(r==t.childCount||r==e.childCount)return t.childCount==e.childCount?null:n;let i=t.child(r),o=e.child(r);if(i==o){n+=i.nodeSize;continue}if(!i.sameMarkup(o))return n;if(i.isText&&i.text!=o.text){for(let a=0;i.text[a]==o.text[a];a++)n++;return n}if(i.content.size||o.content.size){let a=hD(i.content,o.content,n+1);if(a!=null)return a}n+=i.nodeSize}}function pD(t,e,n,r){for(let i=t.childCount,o=e.childCount;;){if(i==0||o==0)return i==o?null:{a:n,b:r};let a=t.child(--i),c=e.child(--o),u=a.nodeSize;if(a==c){n-=u,r-=u;continue}if(!a.sameMarkup(c))return{a:n,b:r};if(a.isText&&a.text!=c.text){let f=0,p=Math.min(a.text.length,c.text.length);for(;f<p&&a.text[a.text.length-f-1]==c.text[c.text.length-f-1];)f++,n--,r--;return{a:n,b:r}}if(a.content.size||c.content.size){let f=pD(a.content,c.content,n-1,r-1);if(f)return f}n-=u,r-=u}}class Ee{constructor(e,n){if(this.content=e,this.size=n||0,n==null)for(let r=0;r<e.length;r++)this.size+=e[r].nodeSize}nodesBetween(e,n,r,i=0,o){for(let a=0,c=0;c<n;a++){let u=this.content[a],f=c+u.nodeSize;if(f>e&&r(u,i+c,o||null,a)!==!1&&u.content.size){let p=c+1;u.nodesBetween(Math.max(0,e-p),Math.min(u.content.size,n-p),r,i+p)}c=f}}descendants(e){this.nodesBetween(0,this.size,e)}textBetween(e,n,r,i){let o="",a=!0;return this.nodesBetween(e,n,(c,u)=>{let f=c.isText?c.text.slice(Math.max(e,u)-u,n-u):c.isLeaf?i?typeof i=="function"?i(c):i:c.type.spec.leafText?c.type.spec.leafText(c):"":"";c.isBlock&&(c.isLeaf&&f||c.isTextblock)&&r&&(a?a=!1:o+=r),o+=f},0),o}append(e){if(!e.size)return this;if(!this.size)return e;let n=this.lastChild,r=e.firstChild,i=this.content.slice(),o=0;for(n.isText&&n.sameMarkup(r)&&(i[i.length-1]=n.withText(n.text+r.text),o=1);o<e.content.length;o++)i.push(e.content[o]);return new Ee(i,this.size+e.size)}cut(e,n=this.size){if(e==0&&n==this.size)return this;let r=[],i=0;if(n>e)for(let o=0,a=0;a<n;o++){let c=this.content[o],u=a+c.nodeSize;u>e&&((a<e||u>n)&&(c.isText?c=c.cut(Math.max(0,e-a),Math.min(c.text.length,n-a)):c=c.cut(Math.max(0,e-a-1),Math.min(c.content.size,n-a-1))),r.push(c),i+=c.nodeSize),a=u}return new Ee(r,i)}cutByIndex(e,n){return e==n?Ee.empty:e==0&&n==this.content.length?this:new Ee(this.content.slice(e,n))}replaceChild(e,n){let r=this.content[e];if(r==n)return this;let i=this.content.slice(),o=this.size+n.nodeSize-r.nodeSize;return i[e]=n,new Ee(i,o)}addToStart(e){return new Ee([e].concat(this.content),this.size+e.nodeSize)}addToEnd(e){return new Ee(this.content.concat(e),this.size+e.nodeSize)}eq(e){if(this.content.length!=e.content.length)return!1;for(let n=0;n<this.content.length;n++)if(!this.content[n].eq(e.content[n]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(e){let n=this.content[e];if(!n)throw new RangeError("Index "+e+" out of range for "+this);return n}maybeChild(e){return this.content[e]||null}forEach(e){for(let n=0,r=0;n<this.content.length;n++){let i=this.content[n];e(i,r,n),r+=i.nodeSize}}findDiffStart(e,n=0){return hD(this,e,n)}findDiffEnd(e,n=this.size,r=e.size){return pD(this,e,n,r)}findIndex(e){if(e==0)return Mf(0,e);if(e==this.size)return Mf(this.content.length,e);if(e>this.size||e<0)throw new RangeError(`Position ${e} outside of fragment (${this})`);for(let n=0,r=0;;n++){let i=this.child(n),o=r+i.nodeSize;if(o>=e)return o==e?Mf(n+1,o):Mf(n,r);r=o}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(e=>e.toJSON()):null}static fromJSON(e,n){if(!n)return Ee.empty;if(!Array.isArray(n))throw new RangeError("Invalid input for Fragment.fromJSON");return new Ee(n.map(e.nodeFromJSON))}static fromArray(e){if(!e.length)return Ee.empty;let n,r=0;for(let i=0;i<e.length;i++){let o=e[i];r+=o.nodeSize,i&&o.isText&&e[i-1].sameMarkup(o)?(n||(n=e.slice(0,i)),n[n.length-1]=o.withText(n[n.length-1].text+o.text)):n&&n.push(o)}return new Ee(n||e,r)}static from(e){if(!e)return Ee.empty;if(e instanceof Ee)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new Ee([e],e.nodeSize);throw new RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}Ee.empty=new Ee([],0);const qy={index:0,offset:0};function Mf(t,e){return qy.index=t,qy.offset=e,qy}function Eh(t,e){if(t===e)return!0;if(!(t&&typeof t=="object")||!(e&&typeof e=="object"))return!1;let n=Array.isArray(t);if(Array.isArray(e)!=n)return!1;if(n){if(t.length!=e.length)return!1;for(let r=0;r<t.length;r++)if(!Eh(t[r],e[r]))return!1}else{for(let r in t)if(!(r in e)||!Eh(t[r],e[r]))return!1;for(let r in e)if(!(r in t))return!1}return!0}let Xt=class Qv{constructor(e,n){this.type=e,this.attrs=n}addToSet(e){let n,r=!1;for(let i=0;i<e.length;i++){let o=e[i];if(this.eq(o))return e;if(this.type.excludes(o.type))n||(n=e.slice(0,i));else{if(o.type.excludes(this.type))return e;!r&&o.type.rank>this.type.rank&&(n||(n=e.slice(0,i)),n.push(this),r=!0),n&&n.push(o)}}return n||(n=e.slice()),r||n.push(this),n}removeFromSet(e){for(let n=0;n<e.length;n++)if(this.eq(e[n]))return e.slice(0,n).concat(e.slice(n+1));return e}isInSet(e){for(let n=0;n<e.length;n++)if(this.eq(e[n]))return!0;return!1}eq(e){return this==e||this.type==e.type&&Eh(this.attrs,e.attrs)}toJSON(){let e={type:this.type.name};for(let n in this.attrs){e.attrs=this.attrs;break}return e}static fromJSON(e,n){if(!n)throw new RangeError("Invalid input for Mark.fromJSON");let r=e.marks[n.type];if(!r)throw new RangeError(`There is no mark type ${n.type} in this schema`);let i=r.create(n.attrs);return r.checkAttrs(i.attrs),i}static sameSet(e,n){if(e==n)return!0;if(e.length!=n.length)return!1;for(let r=0;r<e.length;r++)if(!e[r].eq(n[r]))return!1;return!0}static setFrom(e){if(!e||Array.isArray(e)&&e.length==0)return Qv.none;if(e instanceof Qv)return[e];let n=e.slice();return n.sort((r,i)=>r.type.rank-i.type.rank),n}};Xt.none=[];class Ch extends Error{}class je{constructor(e,n,r){this.content=e,this.openStart=n,this.openEnd=r}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(e,n){let r=gD(this.content,e+this.openStart,n);return r&&new je(r,this.openStart,this.openEnd)}removeBetween(e,n){return new je(mD(this.content,e+this.openStart,n+this.openStart),this.openStart,this.openEnd)}eq(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e}static fromJSON(e,n){if(!n)return je.empty;let r=n.openStart||0,i=n.openEnd||0;if(typeof r!="number"||typeof i!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new je(Ee.fromJSON(e,n.content),r,i)}static maxOpen(e,n=!0){let r=0,i=0;for(let o=e.firstChild;o&&!o.isLeaf&&(n||!o.type.spec.isolating);o=o.firstChild)r++;for(let o=e.lastChild;o&&!o.isLeaf&&(n||!o.type.spec.isolating);o=o.lastChild)i++;return new je(e,r,i)}}je.empty=new je(Ee.empty,0,0);function mD(t,e,n){let{index:r,offset:i}=t.findIndex(e),o=t.maybeChild(r),{index:a,offset:c}=t.findIndex(n);if(i==e||o.isText){if(c!=n&&!t.child(a).isText)throw new RangeError("Removing non-flat range");return t.cut(0,e).append(t.cut(n))}if(r!=a)throw new RangeError("Removing non-flat range");return t.replaceChild(r,o.copy(mD(o.content,e-i-1,n-i-1)))}function gD(t,e,n,r){let{index:i,offset:o}=t.findIndex(e),a=t.maybeChild(i);if(o==e||a.isText)return r&&!r.canReplace(i,i,n)?null:t.cut(0,e).append(n).append(t.cut(e));let c=gD(a.content,e-o-1,n,a);return c&&t.replaceChild(i,a.copy(c))}function _F(t,e,n){if(n.openStart>t.depth)throw new Ch("Inserted content deeper than insertion position");if(t.depth-n.openStart!=e.depth-n.openEnd)throw new Ch("Inconsistent open depths");return yD(t,e,n,0)}function yD(t,e,n,r){let i=t.index(r),o=t.node(r);if(i==e.index(r)&&r<t.depth-n.openStart){let a=yD(t,e,n,r+1);return o.copy(o.content.replaceChild(i,a))}else if(n.content.size)if(!n.openStart&&!n.openEnd&&t.depth==r&&e.depth==r){let a=t.parent,c=a.content;return ea(a,c.cut(0,t.parentOffset).append(n.content).append(c.cut(e.parentOffset)))}else{let{start:a,end:c}=LF(n,t);return ea(o,xD(t,a,c,e,r))}else return ea(o,Th(t,e,r))}function vD(t,e){if(!e.type.compatibleContent(t.type))throw new Ch("Cannot join "+e.type.name+" onto "+t.type.name)}function Zv(t,e,n){let r=t.node(n);return vD(r,e.node(n)),r}function Zs(t,e){let n=e.length-1;n>=0&&t.isText&&t.sameMarkup(e[n])?e[n]=t.withText(e[n].text+t.text):e.push(t)}function fu(t,e,n,r){let i=(e||t).node(n),o=0,a=e?e.index(n):i.childCount;t&&(o=t.index(n),t.depth>n?o++:t.textOffset&&(Zs(t.nodeAfter,r),o++));for(let c=o;c<a;c++)Zs(i.child(c),r);e&&e.depth==n&&e.textOffset&&Zs(e.nodeBefore,r)}function ea(t,e){return t.type.checkContent(e),t.copy(e)}function xD(t,e,n,r,i){let o=t.depth>i&&Zv(t,e,i+1),a=r.depth>i&&Zv(n,r,i+1),c=[];return fu(null,t,i,c),o&&a&&e.index(i)==n.index(i)?(vD(o,a),Zs(ea(o,xD(t,e,n,r,i+1)),c)):(o&&Zs(ea(o,Th(t,e,i+1)),c),fu(e,n,i,c),a&&Zs(ea(a,Th(n,r,i+1)),c)),fu(r,null,i,c),new Ee(c)}function Th(t,e,n){let r=[];if(fu(null,t,n,r),t.depth>n){let i=Zv(t,e,n+1);Zs(ea(i,Th(t,e,n+1)),r)}return fu(e,null,n,r),new Ee(r)}function LF(t,e){let n=e.depth-t.openStart,i=e.node(n).copy(t.content);for(let o=n-1;o>=0;o--)i=e.node(o).copy(Ee.from(i));return{start:i.resolveNoCache(t.openStart+n),end:i.resolveNoCache(i.content.size-t.openEnd-n)}}class ku{constructor(e,n,r){this.pos=e,this.path=n,this.parentOffset=r,this.depth=n.length/3-1}resolveDepth(e){return e==null?this.depth:e<0?this.depth+e:e}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(e){return this.path[this.resolveDepth(e)*3]}index(e){return this.path[this.resolveDepth(e)*3+1]}indexAfter(e){return e=this.resolveDepth(e),this.index(e)+(e==this.depth&&!this.textOffset?0:1)}start(e){return e=this.resolveDepth(e),e==0?0:this.path[e*3-1]+1}end(e){return e=this.resolveDepth(e),this.start(e)+this.node(e).content.size}before(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position before the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]}after(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position after the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]+this.path[e*3].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let e=this.parent,n=this.index(this.depth);if(n==e.childCount)return null;let r=this.pos-this.path[this.path.length-1],i=e.child(n);return r?e.child(n).cut(r):i}get nodeBefore(){let e=this.index(this.depth),n=this.pos-this.path[this.path.length-1];return n?this.parent.child(e).cut(0,n):e==0?null:this.parent.child(e-1)}posAtIndex(e,n){n=this.resolveDepth(n);let r=this.path[n*3],i=n==0?0:this.path[n*3-1]+1;for(let o=0;o<e;o++)i+=r.child(o).nodeSize;return i}marks(){let e=this.parent,n=this.index();if(e.content.size==0)return Xt.none;if(this.textOffset)return e.child(n).marks;let r=e.maybeChild(n-1),i=e.maybeChild(n);if(!r){let c=r;r=i,i=c}let o=r.marks;for(var a=0;a<o.length;a++)o[a].type.spec.inclusive===!1&&(!i||!o[a].isInSet(i.marks))&&(o=o[a--].removeFromSet(o));return o}marksAcross(e){let n=this.parent.maybeChild(this.index());if(!n||!n.isInline)return null;let r=n.marks,i=e.parent.maybeChild(e.index());for(var o=0;o<r.length;o++)r[o].type.spec.inclusive===!1&&(!i||!r[o].isInSet(i.marks))&&(r=r[o--].removeFromSet(r));return r}sharedDepth(e){for(let n=this.depth;n>0;n--)if(this.start(n)<=e&&this.end(n)>=e)return n;return 0}blockRange(e=this,n){if(e.pos<this.pos)return e.blockRange(this);for(let r=this.depth-(this.parent.inlineContent||this.pos==e.pos?1:0);r>=0;r--)if(e.pos<=this.end(r)&&(!n||n(this.node(r))))return new Nh(this,e,r);return null}sameParent(e){return this.pos-this.parentOffset==e.pos-e.parentOffset}max(e){return e.pos>this.pos?e:this}min(e){return e.pos<this.pos?e:this}toString(){let e="";for(let n=1;n<=this.depth;n++)e+=(e?"/":"")+this.node(n).type.name+"_"+this.index(n-1);return e+":"+this.parentOffset}static resolve(e,n){if(!(n>=0&&n<=e.content.size))throw new RangeError("Position "+n+" out of range");let r=[],i=0,o=n;for(let a=e;;){let{index:c,offset:u}=a.content.findIndex(o),f=o-u;if(r.push(a,c,i+u),!f||(a=a.child(c),a.isText))break;o=f-1,i+=u+1}return new ku(n,r,o)}static resolveCached(e,n){let r=$C.get(e);if(r)for(let o=0;o<r.elts.length;o++){let a=r.elts[o];if(a.pos==n)return a}else $C.set(e,r=new PF);let i=r.elts[r.i]=ku.resolve(e,n);return r.i=(r.i+1)%zF,i}}class PF{constructor(){this.elts=[],this.i=0}}const zF=12,$C=new WeakMap;class Nh{constructor(e,n,r){this.$from=e,this.$to=n,this.depth=r}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const BF=Object.create(null);let as=class ex{constructor(e,n,r,i=Xt.none){this.type=e,this.attrs=n,this.marks=i,this.content=r||Ee.empty}get children(){return this.content.content}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(e){return this.content.child(e)}maybeChild(e){return this.content.maybeChild(e)}forEach(e){this.content.forEach(e)}nodesBetween(e,n,r,i=0){this.content.nodesBetween(e,n,r,i,this)}descendants(e){this.nodesBetween(0,this.content.size,e)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(e,n,r,i){return this.content.textBetween(e,n,r,i)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(e){return this==e||this.sameMarkup(e)&&this.content.eq(e.content)}sameMarkup(e){return this.hasMarkup(e.type,e.attrs,e.marks)}hasMarkup(e,n,r){return this.type==e&&Eh(this.attrs,n||e.defaultAttrs||BF)&&Xt.sameSet(this.marks,r||Xt.none)}copy(e=null){return e==this.content?this:new ex(this.type,this.attrs,e,this.marks)}mark(e){return e==this.marks?this:new ex(this.type,this.attrs,this.content,e)}cut(e,n=this.content.size){return e==0&&n==this.content.size?this:this.copy(this.content.cut(e,n))}slice(e,n=this.content.size,r=!1){if(e==n)return je.empty;let i=this.resolve(e),o=this.resolve(n),a=r?0:i.sharedDepth(n),c=i.start(a),f=i.node(a).content.cut(i.pos-c,o.pos-c);return new je(f,i.depth-a,o.depth-a)}replace(e,n,r){return _F(this.resolve(e),this.resolve(n),r)}nodeAt(e){for(let n=this;;){let{index:r,offset:i}=n.content.findIndex(e);if(n=n.maybeChild(r),!n)return null;if(i==e||n.isText)return n;e-=i+1}}childAfter(e){let{index:n,offset:r}=this.content.findIndex(e);return{node:this.content.maybeChild(n),index:n,offset:r}}childBefore(e){if(e==0)return{node:null,index:0,offset:0};let{index:n,offset:r}=this.content.findIndex(e);if(r<e)return{node:this.content.child(n),index:n,offset:r};let i=this.content.child(n-1);return{node:i,index:n-1,offset:r-i.nodeSize}}resolve(e){return ku.resolveCached(this,e)}resolveNoCache(e){return ku.resolve(this,e)}rangeHasMark(e,n,r){let i=!1;return n>e&&this.nodesBetween(e,n,o=>(r.isInSet(o.marks)&&(i=!0),!i)),i}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let e=this.type.name;return this.content.size&&(e+="("+this.content.toStringInner()+")"),bD(this.marks,e)}contentMatchAt(e){let n=this.type.contentMatch.matchFragment(this.content,0,e);if(!n)throw new Error("Called contentMatchAt on a node with invalid content");return n}canReplace(e,n,r=Ee.empty,i=0,o=r.childCount){let a=this.contentMatchAt(e).matchFragment(r,i,o),c=a&&a.matchFragment(this.content,n);if(!c||!c.validEnd)return!1;for(let u=i;u<o;u++)if(!this.type.allowsMarks(r.child(u).marks))return!1;return!0}canReplaceWith(e,n,r,i){if(i&&!this.type.allowsMarks(i))return!1;let o=this.contentMatchAt(e).matchType(r),a=o&&o.matchFragment(this.content,n);return a?a.validEnd:!1}canAppend(e){return e.content.size?this.canReplace(this.childCount,this.childCount,e.content):this.type.compatibleContent(e.type)}check(){this.type.checkContent(this.content),this.type.checkAttrs(this.attrs);let e=Xt.none;for(let n=0;n<this.marks.length;n++){let r=this.marks[n];r.type.checkAttrs(r.attrs),e=r.addToSet(e)}if(!Xt.sameSet(e,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(n=>n.type.name)}`);this.content.forEach(n=>n.check())}toJSON(){let e={type:this.type.name};for(let n in this.attrs){e.attrs=this.attrs;break}return this.content.size&&(e.content=this.content.toJSON()),this.marks.length&&(e.marks=this.marks.map(n=>n.toJSON())),e}static fromJSON(e,n){if(!n)throw new RangeError("Invalid input for Node.fromJSON");let r;if(n.marks){if(!Array.isArray(n.marks))throw new RangeError("Invalid mark data for Node.fromJSON");r=n.marks.map(e.markFromJSON)}if(n.type=="text"){if(typeof n.text!="string")throw new RangeError("Invalid text node in JSON");return e.text(n.text,r)}let i=Ee.fromJSON(e,n.content),o=e.nodeType(n.type).create(n.attrs,i,r);return o.type.checkAttrs(o.attrs),o}};as.prototype.text=void 0;class Ah extends as{constructor(e,n,r,i){if(super(e,n,null,i),!r)throw new RangeError("Empty text nodes are not allowed");this.text=r}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):bD(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(e,n){return this.text.slice(e,n)}get nodeSize(){return this.text.length}mark(e){return e==this.marks?this:new Ah(this.type,this.attrs,this.text,e)}withText(e){return e==this.text?this:new Ah(this.type,this.attrs,e,this.marks)}cut(e=0,n=this.text.length){return e==0&&n==this.text.length?this:this.withText(this.text.slice(e,n))}eq(e){return this.sameMarkup(e)&&this.text==e.text}toJSON(){let e=super.toJSON();return e.text=this.text,e}}function bD(t,e){for(let n=t.length-1;n>=0;n--)e=t[n].type.name+"("+e+")";return e}class ua{constructor(e){this.validEnd=e,this.next=[],this.wrapCache=[]}static parse(e,n){let r=new FF(e,n);if(r.next==null)return ua.empty;let i=wD(r);r.next&&r.err("Unexpected trailing text");let o=WF(GF(i));return YF(o,r),o}matchType(e){for(let n=0;n<this.next.length;n++)if(this.next[n].type==e)return this.next[n].next;return null}matchFragment(e,n=0,r=e.childCount){let i=this;for(let o=n;i&&o<r;o++)i=i.matchType(e.child(o).type);return i}get inlineContent(){return this.next.length!=0&&this.next[0].type.isInline}get defaultType(){for(let e=0;e<this.next.length;e++){let{type:n}=this.next[e];if(!(n.isText||n.hasRequiredAttrs()))return n}return null}compatible(e){for(let n=0;n<this.next.length;n++)for(let r=0;r<e.next.length;r++)if(this.next[n].type==e.next[r].type)return!0;return!1}fillBefore(e,n=!1,r=0){let i=[this];function o(a,c){let u=a.matchFragment(e,r);if(u&&(!n||u.validEnd))return Ee.from(c.map(f=>f.createAndFill()));for(let f=0;f<a.next.length;f++){let{type:p,next:g}=a.next[f];if(!(p.isText||p.hasRequiredAttrs())&&i.indexOf(g)==-1){i.push(g);let v=o(g,c.concat(p));if(v)return v}}return null}return o(this,[])}findWrapping(e){for(let r=0;r<this.wrapCache.length;r+=2)if(this.wrapCache[r]==e)return this.wrapCache[r+1];let n=this.computeWrapping(e);return this.wrapCache.push(e,n),n}computeWrapping(e){let n=Object.create(null),r=[{match:this,type:null,via:null}];for(;r.length;){let i=r.shift(),o=i.match;if(o.matchType(e)){let a=[];for(let c=i;c.type;c=c.via)a.push(c.type);return a.reverse()}for(let a=0;a<o.next.length;a++){let{type:c,next:u}=o.next[a];!c.isLeaf&&!c.hasRequiredAttrs()&&!(c.name in n)&&(!i.type||u.validEnd)&&(r.push({match:c.contentMatch,type:c,via:i}),n[c.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(e){if(e>=this.next.length)throw new RangeError(`There's no ${e}th edge in this content match`);return this.next[e]}toString(){let e=[];function n(r){e.push(r);for(let i=0;i<r.next.length;i++)e.indexOf(r.next[i].next)==-1&&n(r.next[i].next)}return n(this),e.map((r,i)=>{let o=i+(r.validEnd?"*":" ")+" ";for(let a=0;a<r.next.length;a++)o+=(a?", ":"")+r.next[a].type.name+"->"+e.indexOf(r.next[a].next);return o}).join(`
`)}}ua.empty=new ua(!0);class FF{constructor(e,n){this.string=e,this.nodeTypes=n,this.inline=null,this.pos=0,this.tokens=e.split(/\s*(?=\b|\W|$)/),this.tokens[this.tokens.length-1]==""&&this.tokens.pop(),this.tokens[0]==""&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(e){return this.next==e&&(this.pos++||!0)}err(e){throw new SyntaxError(e+" (in content expression '"+this.string+"')")}}function wD(t){let e=[];do e.push($F(t));while(t.eat("|"));return e.length==1?e[0]:{type:"choice",exprs:e}}function $F(t){let e=[];do e.push(HF(t));while(t.next&&t.next!=")"&&t.next!="|");return e.length==1?e[0]:{type:"seq",exprs:e}}function HF(t){let e=qF(t);for(;;)if(t.eat("+"))e={type:"plus",expr:e};else if(t.eat("*"))e={type:"star",expr:e};else if(t.eat("?"))e={type:"opt",expr:e};else if(t.eat("{"))e=UF(t,e);else break;return e}function HC(t){/\D/.test(t.next)&&t.err("Expected number, got '"+t.next+"'");let e=Number(t.next);return t.pos++,e}function UF(t,e){let n=HC(t),r=n;return t.eat(",")&&(t.next!="}"?r=HC(t):r=-1),t.eat("}")||t.err("Unclosed braced range"),{type:"range",min:n,max:r,expr:e}}function VF(t,e){let n=t.nodeTypes,r=n[e];if(r)return[r];let i=[];for(let o in n){let a=n[o];a.isInGroup(e)&&i.push(a)}return i.length==0&&t.err("No node type or group '"+e+"' found"),i}function qF(t){if(t.eat("(")){let e=wD(t);return t.eat(")")||t.err("Missing closing paren"),e}else if(/\W/.test(t.next))t.err("Unexpected token '"+t.next+"'");else{let e=VF(t,t.next).map(n=>(t.inline==null?t.inline=n.isInline:t.inline!=n.isInline&&t.err("Mixing inline and block content"),{type:"name",value:n}));return t.pos++,e.length==1?e[0]:{type:"choice",exprs:e}}}function GF(t){let e=[[]];return i(o(t,0),n()),e;function n(){return e.push([])-1}function r(a,c,u){let f={term:u,to:c};return e[a].push(f),f}function i(a,c){a.forEach(u=>u.to=c)}function o(a,c){if(a.type=="choice")return a.exprs.reduce((u,f)=>u.concat(o(f,c)),[]);if(a.type=="seq")for(let u=0;;u++){let f=o(a.exprs[u],c);if(u==a.exprs.length-1)return f;i(f,c=n())}else if(a.type=="star"){let u=n();return r(c,u),i(o(a.expr,u),u),[r(u)]}else if(a.type=="plus"){let u=n();return i(o(a.expr,c),u),i(o(a.expr,u),u),[r(u)]}else{if(a.type=="opt")return[r(c)].concat(o(a.expr,c));if(a.type=="range"){let u=c;for(let f=0;f<a.min;f++){let p=n();i(o(a.expr,u),p),u=p}if(a.max==-1)i(o(a.expr,u),u);else for(let f=a.min;f<a.max;f++){let p=n();r(u,p),i(o(a.expr,u),p),u=p}return[r(u)]}else{if(a.type=="name")return[r(c,void 0,a.value)];throw new Error("Unknown expr type")}}}}function SD(t,e){return e-t}function UC(t,e){let n=[];return r(e),n.sort(SD);function r(i){let o=t[i];if(o.length==1&&!o[0].term)return r(o[0].to);n.push(i);for(let a=0;a<o.length;a++){let{term:c,to:u}=o[a];!c&&n.indexOf(u)==-1&&r(u)}}}function WF(t){let e=Object.create(null);return n(UC(t,0));function n(r){let i=[];r.forEach(a=>{t[a].forEach(({term:c,to:u})=>{if(!c)return;let f;for(let p=0;p<i.length;p++)i[p][0]==c&&(f=i[p][1]);UC(t,u).forEach(p=>{f||i.push([c,f=[]]),f.indexOf(p)==-1&&f.push(p)})})});let o=e[r.join(",")]=new ua(r.indexOf(t.length-1)>-1);for(let a=0;a<i.length;a++){let c=i[a][1].sort(SD);o.next.push({type:i[a][0],next:e[c.join(",")]||n(c)})}return o}}function YF(t,e){for(let n=0,r=[t];n<r.length;n++){let i=r[n],o=!i.validEnd,a=[];for(let c=0;c<i.next.length;c++){let{type:u,next:f}=i.next[c];a.push(u.name),o&&!(u.isText||u.hasRequiredAttrs())&&(o=!1),r.indexOf(f)==-1&&r.push(f)}o&&e.err("Only non-generatable nodes ("+a.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}function ED(t){let e=Object.create(null);for(let n in t){let r=t[n];if(!r.hasDefault)return null;e[n]=r.default}return e}function CD(t,e){let n=Object.create(null);for(let r in t){let i=e&&e[r];if(i===void 0){let o=t[r];if(o.hasDefault)i=o.default;else throw new RangeError("No value supplied for attribute "+r)}n[r]=i}return n}function TD(t,e,n,r){for(let i in e)if(!(i in t))throw new RangeError(`Unsupported attribute ${i} for ${n} of type ${i}`);for(let i in t){let o=t[i];o.validate&&o.validate(e[i])}}function ND(t,e){let n=Object.create(null);if(e)for(let r in e)n[r]=new XF(t,r,e[r]);return n}let VC=class AD{constructor(e,n,r){this.name=e,this.schema=n,this.spec=r,this.markSet=null,this.groups=r.group?r.group.split(" "):[],this.attrs=ND(e,r.attrs),this.defaultAttrs=ED(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(r.inline||e=="text"),this.isText=e=="text"}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==ua.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}isInGroup(e){return this.groups.indexOf(e)>-1}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let e in this.attrs)if(this.attrs[e].isRequired)return!0;return!1}compatibleContent(e){return this==e||this.contentMatch.compatible(e.contentMatch)}computeAttrs(e){return!e&&this.defaultAttrs?this.defaultAttrs:CD(this.attrs,e)}create(e=null,n,r){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new as(this,this.computeAttrs(e),Ee.from(n),Xt.setFrom(r))}createChecked(e=null,n,r){return n=Ee.from(n),this.checkContent(n),new as(this,this.computeAttrs(e),n,Xt.setFrom(r))}createAndFill(e=null,n,r){if(e=this.computeAttrs(e),n=Ee.from(n),n.size){let a=this.contentMatch.fillBefore(n);if(!a)return null;n=a.append(n)}let i=this.contentMatch.matchFragment(n),o=i&&i.fillBefore(Ee.empty,!0);return o?new as(this,e,n.append(o),Xt.setFrom(r)):null}validContent(e){let n=this.contentMatch.matchFragment(e);if(!n||!n.validEnd)return!1;for(let r=0;r<e.childCount;r++)if(!this.allowsMarks(e.child(r).marks))return!1;return!0}checkContent(e){if(!this.validContent(e))throw new RangeError(`Invalid content for node ${this.name}: ${e.toString().slice(0,50)}`)}checkAttrs(e){TD(this.attrs,e,"node",this.name)}allowsMarkType(e){return this.markSet==null||this.markSet.indexOf(e)>-1}allowsMarks(e){if(this.markSet==null)return!0;for(let n=0;n<e.length;n++)if(!this.allowsMarkType(e[n].type))return!1;return!0}allowedMarks(e){if(this.markSet==null)return e;let n;for(let r=0;r<e.length;r++)this.allowsMarkType(e[r].type)?n&&n.push(e[r]):n||(n=e.slice(0,r));return n?n.length?n:Xt.none:e}static compile(e,n){let r=Object.create(null);e.forEach((o,a)=>r[o]=new AD(o,n,a));let i=n.spec.topNode||"doc";if(!r[i])throw new RangeError("Schema is missing its top node type ('"+i+"')");if(!r.text)throw new RangeError("Every schema needs a 'text' type");for(let o in r.text.attrs)throw new RangeError("The text node type should not have attributes");return r}};function KF(t,e,n){let r=n.split("|");return i=>{let o=i===null?"null":typeof i;if(r.indexOf(o)<0)throw new RangeError(`Expected value of type ${r} for attribute ${e} on type ${t}, got ${o}`)}}class XF{constructor(e,n,r){this.hasDefault=Object.prototype.hasOwnProperty.call(r,"default"),this.default=r.default,this.validate=typeof r.validate=="string"?KF(e,n,r.validate):r.validate}get isRequired(){return!this.hasDefault}}class Fp{constructor(e,n,r,i){this.name=e,this.rank=n,this.schema=r,this.spec=i,this.attrs=ND(e,i.attrs),this.excluded=null;let o=ED(this.attrs);this.instance=o?new Xt(this,o):null}create(e=null){return!e&&this.instance?this.instance:new Xt(this,CD(this.attrs,e))}static compile(e,n){let r=Object.create(null),i=0;return e.forEach((o,a)=>r[o]=new Fp(o,i++,n,a)),r}removeFromSet(e){for(var n=0;n<e.length;n++)e[n].type==this&&(e=e.slice(0,n).concat(e.slice(n+1)),n--);return e}isInSet(e){for(let n=0;n<e.length;n++)if(e[n].type==this)return e[n]}checkAttrs(e){TD(this.attrs,e,"mark",this.name)}excludes(e){return this.excluded.indexOf(e)>-1}}class kD{constructor(e){this.linebreakReplacement=null,this.cached=Object.create(null);let n=this.spec={};for(let i in e)n[i]=e[i];n.nodes=zn.from(e.nodes),n.marks=zn.from(e.marks||{}),this.nodes=VC.compile(this.spec.nodes,this),this.marks=Fp.compile(this.spec.marks,this);let r=Object.create(null);for(let i in this.nodes){if(i in this.marks)throw new RangeError(i+" can not be both a node and a mark");let o=this.nodes[i],a=o.spec.content||"",c=o.spec.marks;if(o.contentMatch=r[a]||(r[a]=ua.parse(a,this.nodes)),o.inlineContent=o.contentMatch.inlineContent,o.spec.linebreakReplacement){if(this.linebreakReplacement)throw new RangeError("Multiple linebreak nodes defined");if(!o.isInline||!o.isLeaf)throw new RangeError("Linebreak replacement nodes must be inline leaf nodes");this.linebreakReplacement=o}o.markSet=c=="_"?null:c?qC(this,c.split(" ")):c==""||!o.inlineContent?[]:null}for(let i in this.marks){let o=this.marks[i],a=o.spec.excludes;o.excluded=a==null?[o]:a==""?[]:qC(this,a.split(" "))}this.nodeFromJSON=i=>as.fromJSON(this,i),this.markFromJSON=i=>Xt.fromJSON(this,i),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(e,n=null,r,i){if(typeof e=="string")e=this.nodeType(e);else if(e instanceof VC){if(e.schema!=this)throw new RangeError("Node type from different schema used ("+e.name+")")}else throw new RangeError("Invalid node type: "+e);return e.createChecked(n,r,i)}text(e,n){let r=this.nodes.text;return new Ah(r,r.defaultAttrs,e,Xt.setFrom(n))}mark(e,n){return typeof e=="string"&&(e=this.marks[e]),e.create(n)}nodeType(e){let n=this.nodes[e];if(!n)throw new RangeError("Unknown node type: "+e);return n}}function qC(t,e){let n=[];for(let r=0;r<e.length;r++){let i=e[r],o=t.marks[i],a=o;if(o)n.push(o);else for(let c in t.marks){let u=t.marks[c];(i=="_"||u.spec.group&&u.spec.group.split(" ").indexOf(i)>-1)&&n.push(a=u)}if(!a)throw new SyntaxError("Unknown mark type: '"+e[r]+"'")}return n}function JF(t){return t.tag!=null}function QF(t){return t.style!=null}class ls{constructor(e,n){this.schema=e,this.rules=n,this.tags=[],this.styles=[];let r=this.matchedStyles=[];n.forEach(i=>{if(JF(i))this.tags.push(i);else if(QF(i)){let o=/[^=]*/.exec(i.style)[0];r.indexOf(o)<0&&r.push(o),this.styles.push(i)}}),this.normalizeLists=!this.tags.some(i=>{if(!/^(ul|ol)\b/.test(i.tag)||!i.node)return!1;let o=e.nodes[i.node];return o.contentMatch.matchType(o)})}parse(e,n={}){let r=new WC(this,n,!1);return r.addAll(e,Xt.none,n.from,n.to),r.finish()}parseSlice(e,n={}){let r=new WC(this,n,!0);return r.addAll(e,Xt.none,n.from,n.to),je.maxOpen(r.finish())}matchTag(e,n,r){for(let i=r?this.tags.indexOf(r)+1:0;i<this.tags.length;i++){let o=this.tags[i];if(t$(e,o.tag)&&(o.namespace===void 0||e.namespaceURI==o.namespace)&&(!o.context||n.matchesContext(o.context))){if(o.getAttrs){let a=o.getAttrs(e);if(a===!1)continue;o.attrs=a||void 0}return o}}}matchStyle(e,n,r,i){for(let o=i?this.styles.indexOf(i)+1:0;o<this.styles.length;o++){let a=this.styles[o],c=a.style;if(!(c.indexOf(e)!=0||a.context&&!r.matchesContext(a.context)||c.length>e.length&&(c.charCodeAt(e.length)!=61||c.slice(e.length+1)!=n))){if(a.getAttrs){let u=a.getAttrs(n);if(u===!1)continue;a.attrs=u||void 0}return a}}}static schemaRules(e){let n=[];function r(i){let o=i.priority==null?50:i.priority,a=0;for(;a<n.length;a++){let c=n[a];if((c.priority==null?50:c.priority)<o)break}n.splice(a,0,i)}for(let i in e.marks){let o=e.marks[i].spec.parseDOM;o&&o.forEach(a=>{r(a=YC(a)),a.mark||a.ignore||a.clearMark||(a.mark=i)})}for(let i in e.nodes){let o=e.nodes[i].spec.parseDOM;o&&o.forEach(a=>{r(a=YC(a)),a.node||a.ignore||a.mark||(a.node=i)})}return n}static fromSchema(e){return e.cached.domParser||(e.cached.domParser=new ls(e,ls.schemaRules(e)))}}const DD={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},ZF={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},OD={ol:!0,ul:!0},Du=1,tx=2,hu=4;function GC(t,e,n){return e!=null?(e?Du:0)|(e==="full"?tx:0):t&&t.whitespace=="pre"?Du|tx:n&~hu}class Rf{constructor(e,n,r,i,o,a){this.type=e,this.attrs=n,this.marks=r,this.solid=i,this.options=a,this.content=[],this.activeMarks=Xt.none,this.match=o||(a&hu?null:e.contentMatch)}findWrapping(e){if(!this.match){if(!this.type)return[];let n=this.type.contentMatch.fillBefore(Ee.from(e));if(n)this.match=this.type.contentMatch.matchFragment(n);else{let r=this.type.contentMatch,i;return(i=r.findWrapping(e.type))?(this.match=r,i):null}}return this.match.findWrapping(e.type)}finish(e){if(!(this.options&Du)){let r=this.content[this.content.length-1],i;if(r&&r.isText&&(i=/[ \t\r\n\u000c]+$/.exec(r.text))){let o=r;r.text.length==i[0].length?this.content.pop():this.content[this.content.length-1]=o.withText(o.text.slice(0,o.text.length-i[0].length))}}let n=Ee.from(this.content);return!e&&this.match&&(n=n.append(this.match.fillBefore(Ee.empty,!0))),this.type?this.type.create(this.attrs,n,this.marks):n}inlineContext(e){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:e.parentNode&&!DD.hasOwnProperty(e.parentNode.nodeName.toLowerCase())}}class WC{constructor(e,n,r){this.parser=e,this.options=n,this.isOpen=r,this.open=0,this.localPreserveWS=!1;let i=n.topNode,o,a=GC(null,n.preserveWhitespace,0)|(r?hu:0);i?o=new Rf(i.type,i.attrs,Xt.none,!0,n.topMatch||i.type.contentMatch,a):r?o=new Rf(null,null,Xt.none,!0,null,a):o=new Rf(e.schema.topNodeType,null,Xt.none,!0,null,a),this.nodes=[o],this.find=n.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(e,n){e.nodeType==3?this.addTextNode(e,n):e.nodeType==1&&this.addElement(e,n)}addTextNode(e,n){let r=e.nodeValue,i=this.top,o=i.options&tx?"full":this.localPreserveWS||(i.options&Du)>0,{schema:a}=this.parser;if(o==="full"||i.inlineContext(e)||/[^ \t\r\n\u000c]/.test(r)){if(o)if(o==="full")r=r.replace(/\r\n?/g,`
`);else if(a.linebreakReplacement&&/[\r\n]/.test(r)&&this.top.findWrapping(a.linebreakReplacement.create())){let c=r.split(/\r?\n|\r/);for(let u=0;u<c.length;u++)u&&this.insertNode(a.linebreakReplacement.create(),n,!0),c[u]&&this.insertNode(a.text(c[u]),n,!/\S/.test(c[u]));r=""}else r=r.replace(/\r?\n|\r/g," ");else if(r=r.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(r)&&this.open==this.nodes.length-1){let c=i.content[i.content.length-1],u=e.previousSibling;(!c||u&&u.nodeName=="BR"||c.isText&&/[ \t\r\n\u000c]$/.test(c.text))&&(r=r.slice(1))}r&&this.insertNode(a.text(r),n,!/\S/.test(r)),this.findInText(e)}else this.findInside(e)}addElement(e,n,r){let i=this.localPreserveWS,o=this.top;(e.tagName=="PRE"||/pre/.test(e.style&&e.style.whiteSpace))&&(this.localPreserveWS=!0);let a=e.nodeName.toLowerCase(),c;OD.hasOwnProperty(a)&&this.parser.normalizeLists&&e$(e);let u=this.options.ruleFromNode&&this.options.ruleFromNode(e)||(c=this.parser.matchTag(e,this,r));e:if(u?u.ignore:ZF.hasOwnProperty(a))this.findInside(e),this.ignoreFallback(e,n);else if(!u||u.skip||u.closeParent){u&&u.closeParent?this.open=Math.max(0,this.open-1):u&&u.skip.nodeType&&(e=u.skip);let f,p=this.needsBlock;if(DD.hasOwnProperty(a))o.content.length&&o.content[0].isInline&&this.open&&(this.open--,o=this.top),f=!0,o.type||(this.needsBlock=!0);else if(!e.firstChild){this.leafFallback(e,n);break e}let g=u&&u.skip?n:this.readStyles(e,n);g&&this.addAll(e,g),f&&this.sync(o),this.needsBlock=p}else{let f=this.readStyles(e,n);f&&this.addElementByRule(e,u,f,u.consuming===!1?c:void 0)}this.localPreserveWS=i}leafFallback(e,n){e.nodeName=="BR"&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(e.ownerDocument.createTextNode(`
`),n)}ignoreFallback(e,n){e.nodeName=="BR"&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"),n,!0)}readStyles(e,n){let r=e.style;if(r&&r.length)for(let i=0;i<this.parser.matchedStyles.length;i++){let o=this.parser.matchedStyles[i],a=r.getPropertyValue(o);if(a)for(let c=void 0;;){let u=this.parser.matchStyle(o,a,this,c);if(!u)break;if(u.ignore)return null;if(u.clearMark?n=n.filter(f=>!u.clearMark(f)):n=n.concat(this.parser.schema.marks[u.mark].create(u.attrs)),u.consuming===!1)c=u;else break}}return n}addElementByRule(e,n,r,i){let o,a;if(n.node)if(a=this.parser.schema.nodes[n.node],a.isLeaf)this.insertNode(a.create(n.attrs),r,e.nodeName=="BR")||this.leafFallback(e,r);else{let u=this.enter(a,n.attrs||null,r,n.preserveWhitespace);u&&(o=!0,r=u)}else{let u=this.parser.schema.marks[n.mark];r=r.concat(u.create(n.attrs))}let c=this.top;if(a&&a.isLeaf)this.findInside(e);else if(i)this.addElement(e,r,i);else if(n.getContent)this.findInside(e),n.getContent(e,this.parser.schema).forEach(u=>this.insertNode(u,r,!1));else{let u=e;typeof n.contentElement=="string"?u=e.querySelector(n.contentElement):typeof n.contentElement=="function"?u=n.contentElement(e):n.contentElement&&(u=n.contentElement),this.findAround(e,u,!0),this.addAll(u,r),this.findAround(e,u,!1)}o&&this.sync(c)&&this.open--}addAll(e,n,r,i){let o=r||0;for(let a=r?e.childNodes[r]:e.firstChild,c=i==null?null:e.childNodes[i];a!=c;a=a.nextSibling,++o)this.findAtPoint(e,o),this.addDOM(a,n);this.findAtPoint(e,o)}findPlace(e,n,r){let i,o;for(let a=this.open,c=0;a>=0;a--){let u=this.nodes[a],f=u.findWrapping(e);if(f&&(!i||i.length>f.length+c)&&(i=f,o=u,!f.length))break;if(u.solid){if(r)break;c+=2}}if(!i)return null;this.sync(o);for(let a=0;a<i.length;a++)n=this.enterInner(i[a],null,n,!1);return n}insertNode(e,n,r){if(e.isInline&&this.needsBlock&&!this.top.type){let o=this.textblockFromContext();o&&(n=this.enterInner(o,null,n))}let i=this.findPlace(e,n,r);if(i){this.closeExtra();let o=this.top;o.match&&(o.match=o.match.matchType(e.type));let a=Xt.none;for(let c of i.concat(e.marks))(o.type?o.type.allowsMarkType(c.type):KC(c.type,e.type))&&(a=c.addToSet(a));return o.content.push(e.mark(a)),!0}return!1}enter(e,n,r,i){let o=this.findPlace(e.create(n),r,!1);return o&&(o=this.enterInner(e,n,r,!0,i)),o}enterInner(e,n,r,i=!1,o){this.closeExtra();let a=this.top;a.match=a.match&&a.match.matchType(e);let c=GC(e,o,a.options);a.options&hu&&a.content.length==0&&(c|=hu);let u=Xt.none;return r=r.filter(f=>(a.type?a.type.allowsMarkType(f.type):KC(f.type,e))?(u=f.addToSet(u),!1):!0),this.nodes.push(new Rf(e,n,u,i,null,c)),this.open++,r}closeExtra(e=!1){let n=this.nodes.length-1;if(n>this.open){for(;n>this.open;n--)this.nodes[n-1].content.push(this.nodes[n].finish(e));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(!!(this.isOpen||this.options.topOpen))}sync(e){for(let n=this.open;n>=0;n--){if(this.nodes[n]==e)return this.open=n,!0;this.localPreserveWS&&(this.nodes[n].options|=Du)}return!1}get currentPos(){this.closeExtra();let e=0;for(let n=this.open;n>=0;n--){let r=this.nodes[n].content;for(let i=r.length-1;i>=0;i--)e+=r[i].nodeSize;n&&e++}return e}findAtPoint(e,n){if(this.find)for(let r=0;r<this.find.length;r++)this.find[r].node==e&&this.find[r].offset==n&&(this.find[r].pos=this.currentPos)}findInside(e){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].pos==null&&e.nodeType==1&&e.contains(this.find[n].node)&&(this.find[n].pos=this.currentPos)}findAround(e,n,r){if(e!=n&&this.find)for(let i=0;i<this.find.length;i++)this.find[i].pos==null&&e.nodeType==1&&e.contains(this.find[i].node)&&n.compareDocumentPosition(this.find[i].node)&(r?2:4)&&(this.find[i].pos=this.currentPos)}findInText(e){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].node==e&&(this.find[n].pos=this.currentPos-(e.nodeValue.length-this.find[n].offset))}matchesContext(e){if(e.indexOf("|")>-1)return e.split(/\s*\|\s*/).some(this.matchesContext,this);let n=e.split("/"),r=this.options.context,i=!this.isOpen&&(!r||r.parent.type==this.nodes[0].type),o=-(r?r.depth+1:0)+(i?0:1),a=(c,u)=>{for(;c>=0;c--){let f=n[c];if(f==""){if(c==n.length-1||c==0)continue;for(;u>=o;u--)if(a(c-1,u))return!0;return!1}else{let p=u>0||u==0&&i?this.nodes[u].type:r&&u>=o?r.node(u-o).type:null;if(!p||p.name!=f&&!p.isInGroup(f))return!1;u--}}return!0};return a(n.length-1,this.open)}textblockFromContext(){let e=this.options.context;if(e)for(let n=e.depth;n>=0;n--){let r=e.node(n).contentMatchAt(e.indexAfter(n)).defaultType;if(r&&r.isTextblock&&r.defaultAttrs)return r}for(let n in this.parser.schema.nodes){let r=this.parser.schema.nodes[n];if(r.isTextblock&&r.defaultAttrs)return r}}}function e$(t){for(let e=t.firstChild,n=null;e;e=e.nextSibling){let r=e.nodeType==1?e.nodeName.toLowerCase():null;r&&OD.hasOwnProperty(r)&&n?(n.appendChild(e),e=n):r=="li"?n=e:r&&(n=null)}}function t$(t,e){return(t.matches||t.msMatchesSelector||t.webkitMatchesSelector||t.mozMatchesSelector).call(t,e)}function YC(t){let e={};for(let n in t)e[n]=t[n];return e}function KC(t,e){let n=e.schema.nodes;for(let r in n){let i=n[r];if(!i.allowsMarkType(t))continue;let o=[],a=c=>{o.push(c);for(let u=0;u<c.edgeCount;u++){let{type:f,next:p}=c.edge(u);if(f==e||o.indexOf(p)<0&&a(p))return!0}};if(a(i.contentMatch))return!0}}class ya{constructor(e,n){this.nodes=e,this.marks=n}serializeFragment(e,n={},r){r||(r=Gy(n).createDocumentFragment());let i=r,o=[];return e.forEach(a=>{if(o.length||a.marks.length){let c=0,u=0;for(;c<o.length&&u<a.marks.length;){let f=a.marks[u];if(!this.marks[f.type.name]){u++;continue}if(!f.eq(o[c][0])||f.type.spec.spanning===!1)break;c++,u++}for(;c<o.length;)i=o.pop()[1];for(;u<a.marks.length;){let f=a.marks[u++],p=this.serializeMark(f,a.isInline,n);p&&(o.push([f,i]),i.appendChild(p.dom),i=p.contentDOM||p.dom)}}i.appendChild(this.serializeNodeInner(a,n))}),r}serializeNodeInner(e,n){let{dom:r,contentDOM:i}=ih(Gy(n),this.nodes[e.type.name](e),null,e.attrs);if(i){if(e.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(e.content,n,i)}return r}serializeNode(e,n={}){let r=this.serializeNodeInner(e,n);for(let i=e.marks.length-1;i>=0;i--){let o=this.serializeMark(e.marks[i],e.isInline,n);o&&((o.contentDOM||o.dom).appendChild(r),r=o.dom)}return r}serializeMark(e,n,r={}){let i=this.marks[e.type.name];return i&&ih(Gy(r),i(e,n),null,e.attrs)}static renderSpec(e,n,r=null,i){return ih(e,n,r,i)}static fromSchema(e){return e.cached.domSerializer||(e.cached.domSerializer=new ya(this.nodesFromSchema(e),this.marksFromSchema(e)))}static nodesFromSchema(e){let n=XC(e.nodes);return n.text||(n.text=r=>r.text),n}static marksFromSchema(e){return XC(e.marks)}}function XC(t){let e={};for(let n in t){let r=t[n].spec.toDOM;r&&(e[n]=r)}return e}function Gy(t){return t.document||window.document}const JC=new WeakMap;function n$(t){let e=JC.get(t);return e===void 0&&JC.set(t,e=r$(t)),e}function r$(t){let e=null;function n(r){if(r&&typeof r=="object")if(Array.isArray(r))if(typeof r[0]=="string")e||(e=[]),e.push(r);else for(let i=0;i<r.length;i++)n(r[i]);else for(let i in r)n(r[i])}return n(t),e}function ih(t,e,n,r){if(typeof e=="string")return{dom:t.createTextNode(e)};if(e.nodeType!=null)return{dom:e};if(e.dom&&e.dom.nodeType!=null)return e;let i=e[0],o;if(typeof i!="string")throw new RangeError("Invalid array passed to renderSpec");if(r&&(o=n$(r))&&o.indexOf(e)>-1)throw new RangeError("Using an array from an attribute object as a DOM spec. This may be an attempted cross site scripting attack.");let a=i.indexOf(" ");a>0&&(n=i.slice(0,a),i=i.slice(a+1));let c,u=n?t.createElementNS(n,i):t.createElement(i),f=e[1],p=1;if(f&&typeof f=="object"&&f.nodeType==null&&!Array.isArray(f)){p=2;for(let g in f)if(f[g]!=null){let v=g.indexOf(" ");v>0?u.setAttributeNS(g.slice(0,v),g.slice(v+1),f[g]):g=="style"&&u.style?u.style.cssText=f[g]:u.setAttribute(g,f[g])}}for(let g=p;g<e.length;g++){let v=e[g];if(v===0){if(g<e.length-1||g>p)throw new RangeError("Content hole must be the only child of its parent node");return{dom:u,contentDOM:u}}else{let{dom:y,contentDOM:w}=ih(t,v,n,r);if(u.appendChild(y),w){if(c)throw new RangeError("Multiple content holes");c=w}}}return{dom:u,contentDOM:c}}const MD=65535,RD=Math.pow(2,16);function i$(t,e){return t+e*RD}function QC(t){return t&MD}function o$(t){return(t-(t&MD))/RD}const jD=1,ID=2,oh=4,_D=8;class nx{constructor(e,n,r){this.pos=e,this.delInfo=n,this.recover=r}get deleted(){return(this.delInfo&_D)>0}get deletedBefore(){return(this.delInfo&(jD|oh))>0}get deletedAfter(){return(this.delInfo&(ID|oh))>0}get deletedAcross(){return(this.delInfo&oh)>0}}class Tr{constructor(e,n=!1){if(this.ranges=e,this.inverted=n,!e.length&&Tr.empty)return Tr.empty}recover(e){let n=0,r=QC(e);if(!this.inverted)for(let i=0;i<r;i++)n+=this.ranges[i*3+2]-this.ranges[i*3+1];return this.ranges[r*3]+n+o$(e)}mapResult(e,n=1){return this._map(e,n,!1)}map(e,n=1){return this._map(e,n,!0)}_map(e,n,r){let i=0,o=this.inverted?2:1,a=this.inverted?1:2;for(let c=0;c<this.ranges.length;c+=3){let u=this.ranges[c]-(this.inverted?i:0);if(u>e)break;let f=this.ranges[c+o],p=this.ranges[c+a],g=u+f;if(e<=g){let v=f?e==u?-1:e==g?1:n:n,y=u+i+(v<0?0:p);if(r)return y;let w=e==(n<0?u:g)?null:i$(c/3,e-u),S=e==u?ID:e==g?jD:oh;return(n<0?e!=u:e!=g)&&(S|=_D),new nx(y,S,w)}i+=p-f}return r?e+i:new nx(e+i,0,null)}touches(e,n){let r=0,i=QC(n),o=this.inverted?2:1,a=this.inverted?1:2;for(let c=0;c<this.ranges.length;c+=3){let u=this.ranges[c]-(this.inverted?r:0);if(u>e)break;let f=this.ranges[c+o],p=u+f;if(e<=p&&c==i*3)return!0;r+=this.ranges[c+a]-f}return!1}forEach(e){let n=this.inverted?2:1,r=this.inverted?1:2;for(let i=0,o=0;i<this.ranges.length;i+=3){let a=this.ranges[i],c=a-(this.inverted?o:0),u=a+(this.inverted?0:o),f=this.ranges[i+n],p=this.ranges[i+r];e(c,c+f,u,u+p),o+=p-f}}invert(){return new Tr(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return e==0?Tr.empty:new Tr(e<0?[0,-e,0]:[0,0,e])}}Tr.empty=new Tr([]);class Ou{constructor(e,n,r=0,i=e?e.length:0){this.mirror=n,this.from=r,this.to=i,this._maps=e||[],this.ownData=!(e||n)}get maps(){return this._maps}slice(e=0,n=this.maps.length){return new Ou(this._maps,this.mirror,e,n)}appendMap(e,n){this.ownData||(this._maps=this._maps.slice(),this.mirror=this.mirror&&this.mirror.slice(),this.ownData=!0),this.to=this._maps.push(e),n!=null&&this.setMirror(this._maps.length-1,n)}appendMapping(e){for(let n=0,r=this._maps.length;n<e._maps.length;n++){let i=e.getMirror(n);this.appendMap(e._maps[n],i!=null&&i<n?r+i:void 0)}}getMirror(e){if(this.mirror){for(let n=0;n<this.mirror.length;n++)if(this.mirror[n]==e)return this.mirror[n+(n%2?-1:1)]}}setMirror(e,n){this.mirror||(this.mirror=[]),this.mirror.push(e,n)}appendMappingInverted(e){for(let n=e.maps.length-1,r=this._maps.length+e._maps.length;n>=0;n--){let i=e.getMirror(n);this.appendMap(e._maps[n].invert(),i!=null&&i>n?r-i-1:void 0)}}invert(){let e=new Ou;return e.appendMappingInverted(this),e}map(e,n=1){if(this.mirror)return this._map(e,n,!0);for(let r=this.from;r<this.to;r++)e=this._maps[r].map(e,n);return e}mapResult(e,n=1){return this._map(e,n,!1)}_map(e,n,r){let i=0;for(let o=this.from;o<this.to;o++){let a=this._maps[o],c=a.mapResult(e,n);if(c.recover!=null){let u=this.getMirror(o);if(u!=null&&u>o&&u<this.to){o=u,e=this._maps[u].recover(c.recover);continue}}i|=c.delInfo,e=c.pos}return r?e:new nx(e,i,null)}}const Wy=Object.create(null);class Kn{getMap(){return Tr.empty}merge(e){return null}static fromJSON(e,n){if(!n||!n.stepType)throw new RangeError("Invalid input for Step.fromJSON");let r=Wy[n.stepType];if(!r)throw new RangeError(`No step type ${n.stepType} defined`);return r.fromJSON(e,n)}static jsonID(e,n){if(e in Wy)throw new RangeError("Duplicate use of step JSON ID "+e);return Wy[e]=n,n.prototype.jsonID=e,n}}class bn{constructor(e,n){this.doc=e,this.failed=n}static ok(e){return new bn(e,null)}static fail(e){return new bn(null,e)}static fromReplace(e,n,r,i){try{return bn.ok(e.replace(n,r,i))}catch(o){if(o instanceof Ch)return bn.fail(o.message);throw o}}}function Rb(t,e,n){let r=[];for(let i=0;i<t.childCount;i++){let o=t.child(i);o.content.size&&(o=o.copy(Rb(o.content,e,o))),o.isInline&&(o=e(o,n,i)),r.push(o)}return Ee.fromArray(r)}class ts extends Kn{constructor(e,n,r){super(),this.from=e,this.to=n,this.mark=r}apply(e){let n=e.slice(this.from,this.to),r=e.resolve(this.from),i=r.node(r.sharedDepth(this.to)),o=new je(Rb(n.content,(a,c)=>!a.isAtom||!c.type.allowsMarkType(this.mark.type)?a:a.mark(this.mark.addToSet(a.marks)),i),n.openStart,n.openEnd);return bn.fromReplace(e,this.from,this.to,o)}invert(){return new oi(this.from,this.to,this.mark)}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return n.deleted&&r.deleted||n.pos>=r.pos?null:new ts(n.pos,r.pos,this.mark)}merge(e){return e instanceof ts&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new ts(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new ts(n.from,n.to,e.markFromJSON(n.mark))}}Kn.jsonID("addMark",ts);class oi extends Kn{constructor(e,n,r){super(),this.from=e,this.to=n,this.mark=r}apply(e){let n=e.slice(this.from,this.to),r=new je(Rb(n.content,i=>i.mark(this.mark.removeFromSet(i.marks)),e),n.openStart,n.openEnd);return bn.fromReplace(e,this.from,this.to,r)}invert(){return new ts(this.from,this.to,this.mark)}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return n.deleted&&r.deleted||n.pos>=r.pos?null:new oi(n.pos,r.pos,this.mark)}merge(e){return e instanceof oi&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new oi(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new oi(n.from,n.to,e.markFromJSON(n.mark))}}Kn.jsonID("removeMark",oi);class ns extends Kn{constructor(e,n){super(),this.pos=e,this.mark=n}apply(e){let n=e.nodeAt(this.pos);if(!n)return bn.fail("No node at mark step's position");let r=n.type.create(n.attrs,null,this.mark.addToSet(n.marks));return bn.fromReplace(e,this.pos,this.pos+1,new je(Ee.from(r),0,n.isLeaf?0:1))}invert(e){let n=e.nodeAt(this.pos);if(n){let r=this.mark.addToSet(n.marks);if(r.length==n.marks.length){for(let i=0;i<n.marks.length;i++)if(!n.marks[i].isInSet(r))return new ns(this.pos,n.marks[i]);return new ns(this.pos,this.mark)}}return new da(this.pos,this.mark)}map(e){let n=e.mapResult(this.pos,1);return n.deletedAfter?null:new ns(n.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,n){if(typeof n.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new ns(n.pos,e.markFromJSON(n.mark))}}Kn.jsonID("addNodeMark",ns);class da extends Kn{constructor(e,n){super(),this.pos=e,this.mark=n}apply(e){let n=e.nodeAt(this.pos);if(!n)return bn.fail("No node at mark step's position");let r=n.type.create(n.attrs,null,this.mark.removeFromSet(n.marks));return bn.fromReplace(e,this.pos,this.pos+1,new je(Ee.from(r),0,n.isLeaf?0:1))}invert(e){let n=e.nodeAt(this.pos);return!n||!this.mark.isInSet(n.marks)?this:new ns(this.pos,this.mark)}map(e){let n=e.mapResult(this.pos,1);return n.deletedAfter?null:new da(n.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,n){if(typeof n.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new da(n.pos,e.markFromJSON(n.mark))}}Kn.jsonID("removeNodeMark",da);class Dn extends Kn{constructor(e,n,r,i=!1){super(),this.from=e,this.to=n,this.slice=r,this.structure=i}apply(e){return this.structure&&rx(e,this.from,this.to)?bn.fail("Structure replace would overwrite content"):bn.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new Tr([this.from,this.to-this.from,this.slice.size])}invert(e){return new Dn(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return n.deletedAcross&&r.deletedAcross?null:new Dn(n.pos,Math.max(n.pos,r.pos),this.slice,this.structure)}merge(e){if(!(e instanceof Dn)||e.structure||this.structure)return null;if(this.from+this.slice.size==e.from&&!this.slice.openEnd&&!e.slice.openStart){let n=this.slice.size+e.slice.size==0?je.empty:new je(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new Dn(this.from,this.to+(e.to-e.from),n,this.structure)}else if(e.to==this.from&&!this.slice.openStart&&!e.slice.openEnd){let n=this.slice.size+e.slice.size==0?je.empty:new je(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new Dn(e.from,this.to,n,this.structure)}else return null}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new Dn(n.from,n.to,je.fromJSON(e,n.slice),!!n.structure)}}Kn.jsonID("replace",Dn);class On extends Kn{constructor(e,n,r,i,o,a,c=!1){super(),this.from=e,this.to=n,this.gapFrom=r,this.gapTo=i,this.slice=o,this.insert=a,this.structure=c}apply(e){if(this.structure&&(rx(e,this.from,this.gapFrom)||rx(e,this.gapTo,this.to)))return bn.fail("Structure gap-replace would overwrite content");let n=e.slice(this.gapFrom,this.gapTo);if(n.openStart||n.openEnd)return bn.fail("Gap is not a flat range");let r=this.slice.insertAt(this.insert,n.content);return r?bn.fromReplace(e,this.from,this.to,r):bn.fail("Content does not fit in gap")}getMap(){return new Tr([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let n=this.gapTo-this.gapFrom;return new On(this.from,this.from+this.slice.size+n,this.from+this.insert,this.from+this.insert+n,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1),i=this.from==this.gapFrom?n.pos:e.map(this.gapFrom,-1),o=this.to==this.gapTo?r.pos:e.map(this.gapTo,1);return n.deletedAcross&&r.deletedAcross||i<n.pos||o>r.pos?null:new On(n.pos,r.pos,i,o,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number"||typeof n.gapFrom!="number"||typeof n.gapTo!="number"||typeof n.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new On(n.from,n.to,n.gapFrom,n.gapTo,je.fromJSON(e,n.slice),n.insert,!!n.structure)}}Kn.jsonID("replaceAround",On);function rx(t,e,n){let r=t.resolve(e),i=n-e,o=r.depth;for(;i>0&&o>0&&r.indexAfter(o)==r.node(o).childCount;)o--,i--;if(i>0){let a=r.node(o).maybeChild(r.indexAfter(o));for(;i>0;){if(!a||a.isLeaf)return!0;a=a.firstChild,i--}}return!1}function s$(t,e,n,r){let i=[],o=[],a,c;t.doc.nodesBetween(e,n,(u,f,p)=>{if(!u.isInline)return;let g=u.marks;if(!r.isInSet(g)&&p.type.allowsMarkType(r.type)){let v=Math.max(f,e),y=Math.min(f+u.nodeSize,n),w=r.addToSet(g);for(let S=0;S<g.length;S++)g[S].isInSet(w)||(a&&a.to==v&&a.mark.eq(g[S])?a.to=y:i.push(a=new oi(v,y,g[S])));c&&c.to==v?c.to=y:o.push(c=new ts(v,y,r))}}),i.forEach(u=>t.step(u)),o.forEach(u=>t.step(u))}function a$(t,e,n,r){let i=[],o=0;t.doc.nodesBetween(e,n,(a,c)=>{if(!a.isInline)return;o++;let u=null;if(r instanceof Fp){let f=a.marks,p;for(;p=r.isInSet(f);)(u||(u=[])).push(p),f=p.removeFromSet(f)}else r?r.isInSet(a.marks)&&(u=[r]):u=a.marks;if(u&&u.length){let f=Math.min(c+a.nodeSize,n);for(let p=0;p<u.length;p++){let g=u[p],v;for(let y=0;y<i.length;y++){let w=i[y];w.step==o-1&&g.eq(i[y].style)&&(v=w)}v?(v.to=f,v.step=o):i.push({style:g,from:Math.max(c,e),to:f,step:o})}}}),i.forEach(a=>t.step(new oi(a.from,a.to,a.style)))}function jb(t,e,n,r=n.contentMatch,i=!0){let o=t.doc.nodeAt(e),a=[],c=e+1;for(let u=0;u<o.childCount;u++){let f=o.child(u),p=c+f.nodeSize,g=r.matchType(f.type);if(!g)a.push(new Dn(c,p,je.empty));else{r=g;for(let v=0;v<f.marks.length;v++)n.allowsMarkType(f.marks[v].type)||t.step(new oi(c,p,f.marks[v]));if(i&&f.isText&&n.whitespace!="pre"){let v,y=/\r?\n|\r/g,w;for(;v=y.exec(f.text);)w||(w=new je(Ee.from(n.schema.text(" ",n.allowedMarks(f.marks))),0,0)),a.push(new Dn(c+v.index,c+v.index+v[0].length,w))}}c=p}if(!r.validEnd){let u=r.fillBefore(Ee.empty,!0);t.replace(c,c,new je(u,0,0))}for(let u=a.length-1;u>=0;u--)t.step(a[u])}function l$(t,e,n){return(e==0||t.canReplace(e,t.childCount))&&(n==t.childCount||t.canReplace(0,n))}function Kl(t){let n=t.parent.content.cutByIndex(t.startIndex,t.endIndex);for(let r=t.depth,i=0,o=0;;--r){let a=t.$from.node(r),c=t.$from.index(r)+i,u=t.$to.indexAfter(r)-o;if(r<t.depth&&a.canReplace(c,u,n))return r;if(r==0||a.type.spec.isolating||!l$(a,c,u))break;c&&(i=1),u<a.childCount&&(o=1)}return null}function c$(t,e,n){let{$from:r,$to:i,depth:o}=e,a=r.before(o+1),c=i.after(o+1),u=a,f=c,p=Ee.empty,g=0;for(let w=o,S=!1;w>n;w--)S||r.index(w)>0?(S=!0,p=Ee.from(r.node(w).copy(p)),g++):u--;let v=Ee.empty,y=0;for(let w=o,S=!1;w>n;w--)S||i.after(w+1)<i.end(w)?(S=!0,v=Ee.from(i.node(w).copy(v)),y++):f++;t.step(new On(u,f,a,c,new je(p.append(v),g,y),p.size-g,!0))}function Ib(t,e,n=null,r=t){let i=u$(t,e),o=i&&d$(r,e);return o?i.map(ZC).concat({type:e,attrs:n}).concat(o.map(ZC)):null}function ZC(t){return{type:t,attrs:null}}function u$(t,e){let{parent:n,startIndex:r,endIndex:i}=t,o=n.contentMatchAt(r).findWrapping(e);if(!o)return null;let a=o.length?o[0]:e;return n.canReplaceWith(r,i,a)?o:null}function d$(t,e){let{parent:n,startIndex:r,endIndex:i}=t,o=n.child(r),a=e.contentMatch.findWrapping(o.type);if(!a)return null;let u=(a.length?a[a.length-1]:e).contentMatch;for(let f=r;u&&f<i;f++)u=u.matchType(n.child(f).type);return!u||!u.validEnd?null:a}function f$(t,e,n){let r=Ee.empty;for(let a=n.length-1;a>=0;a--){if(r.size){let c=n[a].type.contentMatch.matchFragment(r);if(!c||!c.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}r=Ee.from(n[a].type.create(n[a].attrs,r))}let i=e.start,o=e.end;t.step(new On(i,o,i,o,new je(r,0,0),n.length,!0))}function h$(t,e,n,r,i){if(!r.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let o=t.steps.length;t.doc.nodesBetween(e,n,(a,c)=>{let u=typeof i=="function"?i(a):i;if(a.isTextblock&&!a.hasMarkup(r,u)&&p$(t.doc,t.mapping.slice(o).map(c),r)){let f=null;if(r.schema.linebreakReplacement){let y=r.whitespace=="pre",w=!!r.contentMatch.matchType(r.schema.linebreakReplacement);y&&!w?f=!1:!y&&w&&(f=!0)}f===!1&&PD(t,a,c,o),jb(t,t.mapping.slice(o).map(c,1),r,void 0,f===null);let p=t.mapping.slice(o),g=p.map(c,1),v=p.map(c+a.nodeSize,1);return t.step(new On(g,v,g+1,v-1,new je(Ee.from(r.create(u,null,a.marks)),0,0),1,!0)),f===!0&&LD(t,a,c,o),!1}})}function LD(t,e,n,r){e.forEach((i,o)=>{if(i.isText){let a,c=/\r?\n|\r/g;for(;a=c.exec(i.text);){let u=t.mapping.slice(r).map(n+1+o+a.index);t.replaceWith(u,u+1,e.type.schema.linebreakReplacement.create())}}})}function PD(t,e,n,r){e.forEach((i,o)=>{if(i.type==i.type.schema.linebreakReplacement){let a=t.mapping.slice(r).map(n+1+o);t.replaceWith(a,a+1,e.type.schema.text(`
`))}})}function p$(t,e,n){let r=t.resolve(e),i=r.index();return r.parent.canReplaceWith(i,i+1,n)}function m$(t,e,n,r,i){let o=t.doc.nodeAt(e);if(!o)throw new RangeError("No node at given position");n||(n=o.type);let a=n.create(r,null,i||o.marks);if(o.isLeaf)return t.replaceWith(e,e+o.nodeSize,a);if(!n.validContent(o.content))throw new RangeError("Invalid content for node type "+n.name);t.step(new On(e,e+o.nodeSize,e+1,e+o.nodeSize-1,new je(Ee.from(a),0,0),1,!0))}function ao(t,e,n=1,r){let i=t.resolve(e),o=i.depth-n,a=r&&r[r.length-1]||i.parent;if(o<0||i.parent.type.spec.isolating||!i.parent.canReplace(i.index(),i.parent.childCount)||!a.type.validContent(i.parent.content.cutByIndex(i.index(),i.parent.childCount)))return!1;for(let f=i.depth-1,p=n-2;f>o;f--,p--){let g=i.node(f),v=i.index(f);if(g.type.spec.isolating)return!1;let y=g.content.cutByIndex(v,g.childCount),w=r&&r[p+1];w&&(y=y.replaceChild(0,w.type.create(w.attrs)));let S=r&&r[p]||g;if(!g.canReplace(v+1,g.childCount)||!S.type.validContent(y))return!1}let c=i.indexAfter(o),u=r&&r[0];return i.node(o).canReplaceWith(c,c,u?u.type:i.node(o+1).type)}function g$(t,e,n=1,r){let i=t.doc.resolve(e),o=Ee.empty,a=Ee.empty;for(let c=i.depth,u=i.depth-n,f=n-1;c>u;c--,f--){o=Ee.from(i.node(c).copy(o));let p=r&&r[f];a=Ee.from(p?p.type.create(p.attrs,a):i.node(c).copy(a))}t.step(new Dn(e,e,new je(o.append(a),n,n),!0))}function Ss(t,e){let n=t.resolve(e),r=n.index();return zD(n.nodeBefore,n.nodeAfter)&&n.parent.canReplace(r,r+1)}function y$(t,e){e.content.size||t.type.compatibleContent(e.type);let n=t.contentMatchAt(t.childCount),{linebreakReplacement:r}=t.type.schema;for(let i=0;i<e.childCount;i++){let o=e.child(i),a=o.type==r?t.type.schema.nodes.text:o.type;if(n=n.matchType(a),!n||!t.type.allowsMarks(o.marks))return!1}return n.validEnd}function zD(t,e){return!!(t&&e&&!t.isLeaf&&y$(t,e))}function $p(t,e,n=-1){let r=t.resolve(e);for(let i=r.depth;;i--){let o,a,c=r.index(i);if(i==r.depth?(o=r.nodeBefore,a=r.nodeAfter):n>0?(o=r.node(i+1),c++,a=r.node(i).maybeChild(c)):(o=r.node(i).maybeChild(c-1),a=r.node(i+1)),o&&!o.isTextblock&&zD(o,a)&&r.node(i).canReplace(c,c+1))return e;if(i==0)break;e=n<0?r.before(i):r.after(i)}}function v$(t,e,n){let r=null,{linebreakReplacement:i}=t.doc.type.schema,o=t.doc.resolve(e-n),a=o.node().type;if(i&&a.inlineContent){let p=a.whitespace=="pre",g=!!a.contentMatch.matchType(i);p&&!g?r=!1:!p&&g&&(r=!0)}let c=t.steps.length;if(r===!1){let p=t.doc.resolve(e+n);PD(t,p.node(),p.before(),c)}a.inlineContent&&jb(t,e+n-1,a,o.node().contentMatchAt(o.index()),r==null);let u=t.mapping.slice(c),f=u.map(e-n);if(t.step(new Dn(f,u.map(e+n,-1),je.empty,!0)),r===!0){let p=t.doc.resolve(f);LD(t,p.node(),p.before(),t.steps.length)}return t}function x$(t,e,n){let r=t.resolve(e);if(r.parent.canReplaceWith(r.index(),r.index(),n))return e;if(r.parentOffset==0)for(let i=r.depth-1;i>=0;i--){let o=r.index(i);if(r.node(i).canReplaceWith(o,o,n))return r.before(i+1);if(o>0)return null}if(r.parentOffset==r.parent.content.size)for(let i=r.depth-1;i>=0;i--){let o=r.indexAfter(i);if(r.node(i).canReplaceWith(o,o,n))return r.after(i+1);if(o<r.node(i).childCount)return null}return null}function BD(t,e,n){let r=t.resolve(e);if(!n.content.size)return e;let i=n.content;for(let o=0;o<n.openStart;o++)i=i.firstChild.content;for(let o=1;o<=(n.openStart==0&&n.size?2:1);o++)for(let a=r.depth;a>=0;a--){let c=a==r.depth?0:r.pos<=(r.start(a+1)+r.end(a+1))/2?-1:1,u=r.index(a)+(c>0?1:0),f=r.node(a),p=!1;if(o==1)p=f.canReplace(u,u,i);else{let g=f.contentMatchAt(u).findWrapping(i.firstChild.type);p=g&&f.canReplaceWith(u,u,g[0])}if(p)return c==0?r.pos:c<0?r.before(a+1):r.after(a+1)}return null}function Hp(t,e,n=e,r=je.empty){if(e==n&&!r.size)return null;let i=t.resolve(e),o=t.resolve(n);return FD(i,o,r)?new Dn(e,n,r):new b$(i,o,r).fit()}function FD(t,e,n){return!n.openStart&&!n.openEnd&&t.start()==e.start()&&t.parent.canReplace(t.index(),e.index(),n.content)}class b${constructor(e,n,r){this.$from=e,this.$to=n,this.unplaced=r,this.frontier=[],this.placed=Ee.empty;for(let i=0;i<=e.depth;i++){let o=e.node(i);this.frontier.push({type:o.type,match:o.contentMatchAt(e.indexAfter(i))})}for(let i=e.depth;i>0;i--)this.placed=Ee.from(e.node(i).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let f=this.findFittable();f?this.placeNodes(f):this.openMore()||this.dropNode()}let e=this.mustMoveInline(),n=this.placed.size-this.depth-this.$from.depth,r=this.$from,i=this.close(e<0?this.$to:r.doc.resolve(e));if(!i)return null;let o=this.placed,a=r.depth,c=i.depth;for(;a&&c&&o.childCount==1;)o=o.firstChild.content,a--,c--;let u=new je(o,a,c);return e>-1?new On(r.pos,e,this.$to.pos,this.$to.end(),u,n):u.size||r.pos!=this.$to.pos?new Dn(r.pos,i.pos,u):null}findFittable(){let e=this.unplaced.openStart;for(let n=this.unplaced.content,r=0,i=this.unplaced.openEnd;r<e;r++){let o=n.firstChild;if(n.childCount>1&&(i=0),o.type.spec.isolating&&i<=r){e=r;break}n=o.content}for(let n=1;n<=2;n++)for(let r=n==1?e:this.unplaced.openStart;r>=0;r--){let i,o=null;r?(o=Yy(this.unplaced.content,r-1).firstChild,i=o.content):i=this.unplaced.content;let a=i.firstChild;for(let c=this.depth;c>=0;c--){let{type:u,match:f}=this.frontier[c],p,g=null;if(n==1&&(a?f.matchType(a.type)||(g=f.fillBefore(Ee.from(a),!1)):o&&u.compatibleContent(o.type)))return{sliceDepth:r,frontierDepth:c,parent:o,inject:g};if(n==2&&a&&(p=f.findWrapping(a.type)))return{sliceDepth:r,frontierDepth:c,parent:o,wrap:p};if(o&&f.matchType(o.type))break}}}openMore(){let{content:e,openStart:n,openEnd:r}=this.unplaced,i=Yy(e,n);return!i.childCount||i.firstChild.isLeaf?!1:(this.unplaced=new je(e,n+1,Math.max(r,i.size+n>=e.size-r?n+1:0)),!0)}dropNode(){let{content:e,openStart:n,openEnd:r}=this.unplaced,i=Yy(e,n);if(i.childCount<=1&&n>0){let o=e.size-n<=n+i.size;this.unplaced=new je(iu(e,n-1,1),n-1,o?n-1:r)}else this.unplaced=new je(iu(e,n,1),n,r)}placeNodes({sliceDepth:e,frontierDepth:n,parent:r,inject:i,wrap:o}){for(;this.depth>n;)this.closeFrontierNode();if(o)for(let S=0;S<o.length;S++)this.openFrontierNode(o[S]);let a=this.unplaced,c=r?r.content:a.content,u=a.openStart-e,f=0,p=[],{match:g,type:v}=this.frontier[n];if(i){for(let S=0;S<i.childCount;S++)p.push(i.child(S));g=g.matchFragment(i)}let y=c.size+e-(a.content.size-a.openEnd);for(;f<c.childCount;){let S=c.child(f),C=g.matchType(S.type);if(!C)break;f++,(f>1||u==0||S.content.size)&&(g=C,p.push($D(S.mark(v.allowedMarks(S.marks)),f==1?u:0,f==c.childCount?y:-1)))}let w=f==c.childCount;w||(y=-1),this.placed=ou(this.placed,n,Ee.from(p)),this.frontier[n].match=g,w&&y<0&&r&&r.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let S=0,C=c;S<y;S++){let T=C.lastChild;this.frontier.push({type:T.type,match:T.contentMatchAt(T.childCount)}),C=T.content}this.unplaced=w?e==0?je.empty:new je(iu(a.content,e-1,1),e-1,y<0?a.openEnd:e-1):new je(iu(a.content,e,f),a.openStart,a.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let e=this.frontier[this.depth],n;if(!e.type.isTextblock||!Ky(this.$to,this.$to.depth,e.type,e.match,!1)||this.$to.depth==this.depth&&(n=this.findCloseLevel(this.$to))&&n.depth==this.depth)return-1;let{depth:r}=this.$to,i=this.$to.after(r);for(;r>1&&i==this.$to.end(--r);)++i;return i}findCloseLevel(e){e:for(let n=Math.min(this.depth,e.depth);n>=0;n--){let{match:r,type:i}=this.frontier[n],o=n<e.depth&&e.end(n+1)==e.pos+(e.depth-(n+1)),a=Ky(e,n,i,r,o);if(a){for(let c=n-1;c>=0;c--){let{match:u,type:f}=this.frontier[c],p=Ky(e,c,f,u,!0);if(!p||p.childCount)continue e}return{depth:n,fit:a,move:o?e.doc.resolve(e.after(n+1)):e}}}}close(e){let n=this.findCloseLevel(e);if(!n)return null;for(;this.depth>n.depth;)this.closeFrontierNode();n.fit.childCount&&(this.placed=ou(this.placed,n.depth,n.fit)),e=n.move;for(let r=n.depth+1;r<=e.depth;r++){let i=e.node(r),o=i.type.contentMatch.fillBefore(i.content,!0,e.index(r));this.openFrontierNode(i.type,i.attrs,o)}return e}openFrontierNode(e,n=null,r){let i=this.frontier[this.depth];i.match=i.match.matchType(e),this.placed=ou(this.placed,this.depth,Ee.from(e.create(n,r))),this.frontier.push({type:e,match:e.contentMatch})}closeFrontierNode(){let n=this.frontier.pop().match.fillBefore(Ee.empty,!0);n.childCount&&(this.placed=ou(this.placed,this.frontier.length,n))}}function iu(t,e,n){return e==0?t.cutByIndex(n,t.childCount):t.replaceChild(0,t.firstChild.copy(iu(t.firstChild.content,e-1,n)))}function ou(t,e,n){return e==0?t.append(n):t.replaceChild(t.childCount-1,t.lastChild.copy(ou(t.lastChild.content,e-1,n)))}function Yy(t,e){for(let n=0;n<e;n++)t=t.firstChild.content;return t}function $D(t,e,n){if(e<=0)return t;let r=t.content;return e>1&&(r=r.replaceChild(0,$D(r.firstChild,e-1,r.childCount==1?n-1:0))),e>0&&(r=t.type.contentMatch.fillBefore(r).append(r),n<=0&&(r=r.append(t.type.contentMatch.matchFragment(r).fillBefore(Ee.empty,!0)))),t.copy(r)}function Ky(t,e,n,r,i){let o=t.node(e),a=i?t.indexAfter(e):t.index(e);if(a==o.childCount&&!n.compatibleContent(o.type))return null;let c=r.fillBefore(o.content,!0,a);return c&&!w$(n,o.content,a)?c:null}function w$(t,e,n){for(let r=n;r<e.childCount;r++)if(!t.allowsMarks(e.child(r).marks))return!0;return!1}function S$(t){return t.spec.defining||t.spec.definingForContent}function E$(t,e,n,r){if(!r.size)return t.deleteRange(e,n);let i=t.doc.resolve(e),o=t.doc.resolve(n);if(FD(i,o,r))return t.step(new Dn(e,n,r));let a=UD(i,o);a[a.length-1]==0&&a.pop();let c=-(i.depth+1);a.unshift(c);for(let v=i.depth,y=i.pos-1;v>0;v--,y--){let w=i.node(v).type.spec;if(w.defining||w.definingAsContext||w.isolating)break;a.indexOf(v)>-1?c=v:i.before(v)==y&&a.splice(1,0,-v)}let u=a.indexOf(c),f=[],p=r.openStart;for(let v=r.content,y=0;;y++){let w=v.firstChild;if(f.push(w),y==r.openStart)break;v=w.content}for(let v=p-1;v>=0;v--){let y=f[v],w=S$(y.type);if(w&&!y.sameMarkup(i.node(Math.abs(c)-1)))p=v;else if(w||!y.type.isTextblock)break}for(let v=r.openStart;v>=0;v--){let y=(v+p+1)%(r.openStart+1),w=f[y];if(w)for(let S=0;S<a.length;S++){let C=a[(S+u)%a.length],T=!0;C<0&&(T=!1,C=-C);let N=i.node(C-1),k=i.index(C-1);if(N.canReplaceWith(k,k,w.type,w.marks))return t.replace(i.before(C),T?o.after(C):n,new je(HD(r.content,0,r.openStart,y),y,r.openEnd))}}let g=t.steps.length;for(let v=a.length-1;v>=0&&(t.replace(e,n,r),!(t.steps.length>g));v--){let y=a[v];y<0||(e=i.before(y),n=o.after(y))}}function HD(t,e,n,r,i){if(e<n){let o=t.firstChild;t=t.replaceChild(0,o.copy(HD(o.content,e+1,n,r,o)))}if(e>r){let o=i.contentMatchAt(0),a=o.fillBefore(t).append(t);t=a.append(o.matchFragment(a).fillBefore(Ee.empty,!0))}return t}function C$(t,e,n,r){if(!r.isInline&&e==n&&t.doc.resolve(e).parent.content.size){let i=x$(t.doc,e,r.type);i!=null&&(e=n=i)}t.replaceRange(e,n,new je(Ee.from(r),0,0))}function T$(t,e,n){let r=t.doc.resolve(e),i=t.doc.resolve(n),o=UD(r,i);for(let a=0;a<o.length;a++){let c=o[a],u=a==o.length-1;if(u&&c==0||r.node(c).type.contentMatch.validEnd)return t.delete(r.start(c),i.end(c));if(c>0&&(u||r.node(c-1).canReplace(r.index(c-1),i.indexAfter(c-1))))return t.delete(r.before(c),i.after(c))}for(let a=1;a<=r.depth&&a<=i.depth;a++)if(e-r.start(a)==r.depth-a&&n>r.end(a)&&i.end(a)-n!=i.depth-a&&r.start(a-1)==i.start(a-1)&&r.node(a-1).canReplace(r.index(a-1),i.index(a-1)))return t.delete(r.before(a),n);t.delete(e,n)}function UD(t,e){let n=[],r=Math.min(t.depth,e.depth);for(let i=r;i>=0;i--){let o=t.start(i);if(o<t.pos-(t.depth-i)||e.end(i)>e.pos+(e.depth-i)||t.node(i).type.spec.isolating||e.node(i).type.spec.isolating)break;(o==e.start(i)||i==t.depth&&i==e.depth&&t.parent.inlineContent&&e.parent.inlineContent&&i&&e.start(i-1)==o-1)&&n.push(i)}return n}class El extends Kn{constructor(e,n,r){super(),this.pos=e,this.attr=n,this.value=r}apply(e){let n=e.nodeAt(this.pos);if(!n)return bn.fail("No node at attribute step's position");let r=Object.create(null);for(let o in n.attrs)r[o]=n.attrs[o];r[this.attr]=this.value;let i=n.type.create(r,null,n.marks);return bn.fromReplace(e,this.pos,this.pos+1,new je(Ee.from(i),0,n.isLeaf?0:1))}getMap(){return Tr.empty}invert(e){return new El(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let n=e.mapResult(this.pos,1);return n.deletedAfter?null:new El(n.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,n){if(typeof n.pos!="number"||typeof n.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new El(n.pos,n.attr,n.value)}}Kn.jsonID("attr",El);class Mu extends Kn{constructor(e,n){super(),this.attr=e,this.value=n}apply(e){let n=Object.create(null);for(let i in e.attrs)n[i]=e.attrs[i];n[this.attr]=this.value;let r=e.type.create(n,e.content,e.marks);return bn.ok(r)}getMap(){return Tr.empty}invert(e){return new Mu(this.attr,e.attrs[this.attr])}map(e){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(e,n){if(typeof n.attr!="string")throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new Mu(n.attr,n.value)}}Kn.jsonID("docAttr",Mu);let Dl=class extends Error{};Dl=function t(e){let n=Error.call(this,e);return n.__proto__=t.prototype,n};Dl.prototype=Object.create(Error.prototype);Dl.prototype.constructor=Dl;Dl.prototype.name="TransformError";class VD{constructor(e){this.doc=e,this.steps=[],this.docs=[],this.mapping=new Ou}get before(){return this.docs.length?this.docs[0]:this.doc}step(e){let n=this.maybeStep(e);if(n.failed)throw new Dl(n.failed);return this}maybeStep(e){let n=e.apply(this.doc);return n.failed||this.addStep(e,n.doc),n}get docChanged(){return this.steps.length>0}changedRange(){let e=1e9,n=-1e9;for(let r=0;r<this.mapping.maps.length;r++){let i=this.mapping.maps[r];r&&(e=i.map(e,1),n=i.map(n,-1)),i.forEach((o,a,c,u)=>{e=Math.min(e,c),n=Math.max(n,u)})}return e==1e9?null:{from:e,to:n}}addStep(e,n){this.docs.push(this.doc),this.steps.push(e),this.mapping.appendMap(e.getMap()),this.doc=n}replace(e,n=e,r=je.empty){let i=Hp(this.doc,e,n,r);return i&&this.step(i),this}replaceWith(e,n,r){return this.replace(e,n,new je(Ee.from(r),0,0))}delete(e,n){return this.replace(e,n,je.empty)}insert(e,n){return this.replaceWith(e,e,n)}replaceRange(e,n,r){return E$(this,e,n,r),this}replaceRangeWith(e,n,r){return C$(this,e,n,r),this}deleteRange(e,n){return T$(this,e,n),this}lift(e,n){return c$(this,e,n),this}join(e,n=1){return v$(this,e,n),this}wrap(e,n){return f$(this,e,n),this}setBlockType(e,n=e,r,i=null){return h$(this,e,n,r,i),this}setNodeMarkup(e,n,r=null,i){return m$(this,e,n,r,i),this}setNodeAttribute(e,n,r){return this.step(new El(e,n,r)),this}setDocAttribute(e,n){return this.step(new Mu(e,n)),this}addNodeMark(e,n){return this.step(new ns(e,n)),this}removeNodeMark(e,n){let r=this.doc.nodeAt(e);if(!r)throw new RangeError("No node at position "+e);if(n instanceof Xt)n.isInSet(r.marks)&&this.step(new da(e,n));else{let i=r.marks,o,a=[];for(;o=n.isInSet(i);)a.push(new da(e,o)),i=o.removeFromSet(i);for(let c=a.length-1;c>=0;c--)this.step(a[c])}return this}split(e,n=1,r){return g$(this,e,n,r),this}addMark(e,n,r){return s$(this,e,n,r),this}removeMark(e,n,r){return a$(this,e,n,r),this}clearIncompatible(e,n,r){return jb(this,e,n,r),this}}const Xy=Object.create(null);class xt{constructor(e,n,r){this.$anchor=e,this.$head=n,this.ranges=r||[new N$(e.min(n),e.max(n))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let e=this.ranges;for(let n=0;n<e.length;n++)if(e[n].$from.pos!=e[n].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(e,n=je.empty){let r=n.content.lastChild,i=null;for(let c=0;c<n.openEnd;c++)i=r,r=r.lastChild;let o=e.steps.length,a=this.ranges;for(let c=0;c<a.length;c++){let{$from:u,$to:f}=a[c],p=e.mapping.slice(o);e.replaceRange(p.map(u.pos),p.map(f.pos),c?je.empty:n),c==0&&nT(e,o,(r?r.isInline:i&&i.isTextblock)?-1:1)}}replaceWith(e,n){let r=e.steps.length,i=this.ranges;for(let o=0;o<i.length;o++){let{$from:a,$to:c}=i[o],u=e.mapping.slice(r),f=u.map(a.pos),p=u.map(c.pos);o?e.deleteRange(f,p):(e.replaceRangeWith(f,p,n),nT(e,r,n.isInline?-1:1))}}static findFrom(e,n,r=!1){let i=e.parent.inlineContent?new st(e):pl(e.node(0),e.parent,e.pos,e.index(),n,r);if(i)return i;for(let o=e.depth-1;o>=0;o--){let a=n<0?pl(e.node(0),e.node(o),e.before(o+1),e.index(o),n,r):pl(e.node(0),e.node(o),e.after(o+1),e.index(o)+1,n,r);if(a)return a}return null}static near(e,n=1){return this.findFrom(e,n)||this.findFrom(e,-n)||new kr(e.node(0))}static atStart(e){return pl(e,e,0,0,1)||new kr(e)}static atEnd(e){return pl(e,e,e.content.size,e.childCount,-1)||new kr(e)}static fromJSON(e,n){if(!n||!n.type)throw new RangeError("Invalid input for Selection.fromJSON");let r=Xy[n.type];if(!r)throw new RangeError(`No selection type ${n.type} defined`);return r.fromJSON(e,n)}static jsonID(e,n){if(e in Xy)throw new RangeError("Duplicate use of selection JSON ID "+e);return Xy[e]=n,n.prototype.jsonID=e,n}getBookmark(){return st.between(this.$anchor,this.$head).getBookmark()}}xt.prototype.visible=!0;class N${constructor(e,n){this.$from=e,this.$to=n}}let eT=!1;function tT(t){!eT&&!t.parent.inlineContent&&(eT=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+t.parent.type.name+")"))}class st extends xt{constructor(e,n=e){tT(e),tT(n),super(e,n)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(e,n){let r=e.resolve(n.map(this.head));if(!r.parent.inlineContent)return xt.near(r);let i=e.resolve(n.map(this.anchor));return new st(i.parent.inlineContent?i:r,r)}replace(e,n=je.empty){if(super.replace(e,n),n==je.empty){let r=this.$from.marksAcross(this.$to);r&&e.ensureMarks(r)}}eq(e){return e instanceof st&&e.anchor==this.anchor&&e.head==this.head}getBookmark(){return new Up(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(e,n){if(typeof n.anchor!="number"||typeof n.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new st(e.resolve(n.anchor),e.resolve(n.head))}static create(e,n,r=n){let i=e.resolve(n);return new this(i,r==n?i:e.resolve(r))}static between(e,n,r){let i=e.pos-n.pos;if((!r||i)&&(r=i>=0?1:-1),!n.parent.inlineContent){let o=xt.findFrom(n,r,!0)||xt.findFrom(n,-r,!0);if(o)n=o.$head;else return xt.near(n,r)}return e.parent.inlineContent||(i==0?e=n:(e=(xt.findFrom(e,-r,!0)||xt.findFrom(e,r,!0)).$anchor,e.pos<n.pos!=i<0&&(e=n))),new st(e,n)}}xt.jsonID("text",st);class Up{constructor(e,n){this.anchor=e,this.head=n}map(e){return new Up(e.map(this.anchor),e.map(this.head))}resolve(e){return st.between(e.resolve(this.anchor),e.resolve(this.head))}}class Je extends xt{constructor(e){let n=e.nodeAfter,r=e.node(0).resolve(e.pos+n.nodeSize);super(e,r),this.node=n}map(e,n){let{deleted:r,pos:i}=n.mapResult(this.anchor),o=e.resolve(i);return r?xt.near(o):new Je(o)}content(){return new je(Ee.from(this.node),0,0)}eq(e){return e instanceof Je&&e.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new _b(this.anchor)}static fromJSON(e,n){if(typeof n.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new Je(e.resolve(n.anchor))}static create(e,n){return new Je(e.resolve(n))}static isSelectable(e){return!e.isText&&e.type.spec.selectable!==!1}}Je.prototype.visible=!1;xt.jsonID("node",Je);class _b{constructor(e){this.anchor=e}map(e){let{deleted:n,pos:r}=e.mapResult(this.anchor);return n?new Up(r,r):new _b(r)}resolve(e){let n=e.resolve(this.anchor),r=n.nodeAfter;return r&&Je.isSelectable(r)?new Je(n):xt.near(n)}}class kr extends xt{constructor(e){super(e.resolve(0),e.resolve(e.content.size))}replace(e,n=je.empty){if(n==je.empty){e.delete(0,e.doc.content.size);let r=xt.atStart(e.doc);r.eq(e.selection)||e.setSelection(r)}else super.replace(e,n)}toJSON(){return{type:"all"}}static fromJSON(e){return new kr(e)}map(e){return new kr(e)}eq(e){return e instanceof kr}getBookmark(){return A$}}xt.jsonID("all",kr);const A$={map(){return this},resolve(t){return new kr(t)}};function pl(t,e,n,r,i,o=!1){if(e.inlineContent)return st.create(t,n);for(let a=r-(i>0?0:1);i>0?a<e.childCount:a>=0;a+=i){let c=e.child(a);if(c.isAtom){if(!o&&Je.isSelectable(c))return Je.create(t,n-(i<0?c.nodeSize:0))}else{let u=pl(t,c,n+i,i<0?c.childCount:0,i,o);if(u)return u}n+=c.nodeSize*i}return null}function nT(t,e,n){let r=t.steps.length-1;if(r<e)return;let i=t.steps[r];if(!(i instanceof Dn||i instanceof On))return;let o=t.mapping.maps[r],a;o.forEach((c,u,f,p)=>{a==null&&(a=p)}),t.setSelection(xt.near(t.doc.resolve(a),n))}const rT=1,jf=2,iT=4;class k$ extends VD{constructor(e){super(e.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=e.selection,this.storedMarks=e.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(e){if(e.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=e,this.curSelectionFor=this.steps.length,this.updated=(this.updated|rT)&~jf,this.storedMarks=null,this}get selectionSet(){return(this.updated&rT)>0}setStoredMarks(e){return this.storedMarks=e,this.updated|=jf,this}ensureMarks(e){return Xt.sameSet(this.storedMarks||this.selection.$from.marks(),e)||this.setStoredMarks(e),this}addStoredMark(e){return this.ensureMarks(e.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(e){return this.ensureMarks(e.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(this.updated&jf)>0}addStep(e,n){super.addStep(e,n),this.updated=this.updated&~jf,this.storedMarks=null}setTime(e){return this.time=e,this}replaceSelection(e){return this.selection.replace(this,e),this}replaceSelectionWith(e,n=!0){let r=this.selection;return n&&(e=e.mark(this.storedMarks||(r.empty?r.$from.marks():r.$from.marksAcross(r.$to)||Xt.none))),r.replaceWith(this,e),this}deleteSelection(){return this.selection.replace(this),this}insertText(e,n,r){let i=this.doc.type.schema;if(n==null)return e?this.replaceSelectionWith(i.text(e),!0):this.deleteSelection();{if(r==null&&(r=n),!e)return this.deleteRange(n,r);let o=this.storedMarks;if(!o){let a=this.doc.resolve(n);o=r==n?a.marks():a.marksAcross(this.doc.resolve(r))}return this.replaceRangeWith(n,r,i.text(e,o)),!this.selection.empty&&this.selection.to==n+e.length&&this.setSelection(xt.near(this.selection.$to)),this}}setMeta(e,n){return this.meta[typeof e=="string"?e:e.key]=n,this}getMeta(e){return this.meta[typeof e=="string"?e:e.key]}get isGeneric(){for(let e in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=iT,this}get scrolledIntoView(){return(this.updated&iT)>0}}function oT(t,e){return!e||!t?t:t.bind(e)}class su{constructor(e,n,r){this.name=e,this.init=oT(n.init,r),this.apply=oT(n.apply,r)}}const D$=[new su("doc",{init(t){return t.doc||t.schema.topNodeType.createAndFill()},apply(t){return t.doc}}),new su("selection",{init(t,e){return t.selection||xt.atStart(e.doc)},apply(t){return t.selection}}),new su("storedMarks",{init(t){return t.storedMarks||null},apply(t,e,n,r){return r.selection.$cursor?t.storedMarks:null}}),new su("scrollToSelection",{init(){return 0},apply(t,e){return t.scrolledIntoView?e+1:e}})];class Jy{constructor(e,n){this.schema=e,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=D$.slice(),n&&n.forEach(r=>{if(this.pluginsByKey[r.key])throw new RangeError("Adding different instances of a keyed plugin ("+r.key+")");this.plugins.push(r),this.pluginsByKey[r.key]=r,r.spec.state&&this.fields.push(new su(r.key,r.spec.state,r))})}}class vl{constructor(e){this.config=e}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(e){return this.applyTransaction(e).state}filterTransaction(e,n=-1){for(let r=0;r<this.config.plugins.length;r++)if(r!=n){let i=this.config.plugins[r];if(i.spec.filterTransaction&&!i.spec.filterTransaction.call(i,e,this))return!1}return!0}applyTransaction(e){if(!this.filterTransaction(e))return{state:this,transactions:[]};let n=[e],r=this.applyInner(e),i=null;for(;;){let o=!1;for(let a=0;a<this.config.plugins.length;a++){let c=this.config.plugins[a];if(c.spec.appendTransaction){let u=i?i[a].n:0,f=i?i[a].state:this,p=u<n.length&&c.spec.appendTransaction.call(c,u?n.slice(u):n,f,r);if(p&&r.filterTransaction(p,a)){if(p.setMeta("appendedTransaction",e),!i){i=[];for(let g=0;g<this.config.plugins.length;g++)i.push(g<a?{state:r,n:n.length}:{state:this,n:0})}n.push(p),r=r.applyInner(p),o=!0}i&&(i[a]={state:r,n:n.length})}}if(!o)return{state:r,transactions:n}}}applyInner(e){if(!e.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let n=new vl(this.config),r=this.config.fields;for(let i=0;i<r.length;i++){let o=r[i];n[o.name]=o.apply(e,this[o.name],this,n)}return n}get tr(){return new k$(this)}static create(e){let n=new Jy(e.doc?e.doc.type.schema:e.schema,e.plugins),r=new vl(n);for(let i=0;i<n.fields.length;i++)r[n.fields[i].name]=n.fields[i].init(e,r);return r}reconfigure(e){let n=new Jy(this.schema,e.plugins),r=n.fields,i=new vl(n);for(let o=0;o<r.length;o++){let a=r[o].name;i[a]=this.hasOwnProperty(a)?this[a]:r[o].init(e,i)}return i}toJSON(e){let n={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(n.storedMarks=this.storedMarks.map(r=>r.toJSON())),e&&typeof e=="object")for(let r in e){if(r=="doc"||r=="selection")throw new RangeError("The JSON fields `doc` and `selection` are reserved");let i=e[r],o=i.spec.state;o&&o.toJSON&&(n[r]=o.toJSON.call(i,this[i.key]))}return n}static fromJSON(e,n,r){if(!n)throw new RangeError("Invalid input for EditorState.fromJSON");if(!e.schema)throw new RangeError("Required config field 'schema' missing");let i=new Jy(e.schema,e.plugins),o=new vl(i);return i.fields.forEach(a=>{if(a.name=="doc")o.doc=as.fromJSON(e.schema,n.doc);else if(a.name=="selection")o.selection=xt.fromJSON(o.doc,n.selection);else if(a.name=="storedMarks")n.storedMarks&&(o.storedMarks=n.storedMarks.map(e.schema.markFromJSON));else{if(r)for(let c in r){let u=r[c],f=u.spec.state;if(u.key==a.name&&f&&f.fromJSON&&Object.prototype.hasOwnProperty.call(n,c)){o[a.name]=f.fromJSON.call(u,e,n[c],o);return}}o[a.name]=a.init(e,o)}}),o}}function qD(t,e,n){for(let r in t){let i=t[r];i instanceof Function?i=i.bind(e):r=="handleDOMEvents"&&(i=qD(i,e,{})),n[r]=i}return n}class nn{constructor(e){this.spec=e,this.props={},e.props&&qD(e.props,this,this.props),this.key=e.key?e.key.key:GD("plugin")}getState(e){return e[this.key]}}const Qy=Object.create(null);function GD(t){return t in Qy?t+"$"+ ++Qy[t]:(Qy[t]=0,t+"$")}class Sn{constructor(e="key"){this.key=GD(e)}get(e){return e.config.pluginsByKey[this.key]}getState(e){return e[this.key]}}const Lb=(t,e)=>t.selection.empty?!1:(e&&e(t.tr.deleteSelection().scrollIntoView()),!0);function WD(t,e){let{$cursor:n}=t.selection;return!n||(e?!e.endOfTextblock("backward",t):n.parentOffset>0)?null:n}const YD=(t,e,n)=>{let r=WD(t,n);if(!r)return!1;let i=Pb(r);if(!i){let a=r.blockRange(),c=a&&Kl(a);return c==null?!1:(e&&e(t.tr.lift(a,c).scrollIntoView()),!0)}let o=i.nodeBefore;if(rO(t,i,e,-1))return!0;if(r.parent.content.size==0&&(Ol(o,"end")||Je.isSelectable(o)))for(let a=r.depth;;a--){let c=Hp(t.doc,r.before(a),r.after(a),je.empty);if(c&&c.slice.size<c.to-c.from){if(e){let u=t.tr.step(c);u.setSelection(Ol(o,"end")?xt.findFrom(u.doc.resolve(u.mapping.map(i.pos,-1)),-1):Je.create(u.doc,i.pos-o.nodeSize)),e(u.scrollIntoView())}return!0}if(a==1||r.node(a-1).childCount>1)break}return o.isAtom&&i.depth==r.depth-1?(e&&e(t.tr.delete(i.pos-o.nodeSize,i.pos).scrollIntoView()),!0):!1},O$=(t,e,n)=>{let r=WD(t,n);if(!r)return!1;let i=Pb(r);return i?KD(t,i,e):!1},M$=(t,e,n)=>{let r=JD(t,n);if(!r)return!1;let i=zb(r);return i?KD(t,i,e):!1};function KD(t,e,n){let r=e.nodeBefore,i=r,o=e.pos-1;for(;!i.isTextblock;o--){if(i.type.spec.isolating)return!1;let p=i.lastChild;if(!p)return!1;i=p}let a=e.nodeAfter,c=a,u=e.pos+1;for(;!c.isTextblock;u++){if(c.type.spec.isolating)return!1;let p=c.firstChild;if(!p)return!1;c=p}let f=Hp(t.doc,o,u,je.empty);if(!f||f.from!=o||f instanceof Dn&&f.slice.size>=u-o)return!1;if(n){let p=t.tr.step(f);p.setSelection(st.create(p.doc,o)),n(p.scrollIntoView())}return!0}function Ol(t,e,n=!1){for(let r=t;r;r=e=="start"?r.firstChild:r.lastChild){if(r.isTextblock)return!0;if(n&&r.childCount!=1)return!1}return!1}const XD=(t,e,n)=>{let{$head:r,empty:i}=t.selection,o=r;if(!i)return!1;if(r.parent.isTextblock){if(n?!n.endOfTextblock("backward",t):r.parentOffset>0)return!1;o=Pb(r)}let a=o&&o.nodeBefore;return!a||!Je.isSelectable(a)?!1:(e&&e(t.tr.setSelection(Je.create(t.doc,o.pos-a.nodeSize)).scrollIntoView()),!0)};function Pb(t){if(!t.parent.type.spec.isolating)for(let e=t.depth-1;e>=0;e--){if(t.index(e)>0)return t.doc.resolve(t.before(e+1));if(t.node(e).type.spec.isolating)break}return null}function JD(t,e){let{$cursor:n}=t.selection;return!n||(e?!e.endOfTextblock("forward",t):n.parentOffset<n.parent.content.size)?null:n}const QD=(t,e,n)=>{let r=JD(t,n);if(!r)return!1;let i=zb(r);if(!i)return!1;let o=i.nodeAfter;if(rO(t,i,e,1))return!0;if(r.parent.content.size==0&&(Ol(o,"start")||Je.isSelectable(o))){let a=Hp(t.doc,r.before(),r.after(),je.empty);if(a&&a.slice.size<a.to-a.from){if(e){let c=t.tr.step(a);c.setSelection(Ol(o,"start")?xt.findFrom(c.doc.resolve(c.mapping.map(i.pos)),1):Je.create(c.doc,c.mapping.map(i.pos))),e(c.scrollIntoView())}return!0}}return o.isAtom&&i.depth==r.depth-1?(e&&e(t.tr.delete(i.pos,i.pos+o.nodeSize).scrollIntoView()),!0):!1},ZD=(t,e,n)=>{let{$head:r,empty:i}=t.selection,o=r;if(!i)return!1;if(r.parent.isTextblock){if(n?!n.endOfTextblock("forward",t):r.parentOffset<r.parent.content.size)return!1;o=zb(r)}let a=o&&o.nodeAfter;return!a||!Je.isSelectable(a)?!1:(e&&e(t.tr.setSelection(Je.create(t.doc,o.pos)).scrollIntoView()),!0)};function zb(t){if(!t.parent.type.spec.isolating)for(let e=t.depth-1;e>=0;e--){let n=t.node(e);if(t.index(e)+1<n.childCount)return t.doc.resolve(t.after(e+1));if(n.type.spec.isolating)break}return null}const R$=(t,e)=>{let n=t.selection,r=n instanceof Je,i;if(r){if(n.node.isTextblock||!Ss(t.doc,n.from))return!1;i=n.from}else if(i=$p(t.doc,n.from,-1),i==null)return!1;if(e){let o=t.tr.join(i);r&&o.setSelection(Je.create(o.doc,i-t.doc.resolve(i).nodeBefore.nodeSize)),e(o.scrollIntoView())}return!0},j$=(t,e)=>{let n=t.selection,r;if(n instanceof Je){if(n.node.isTextblock||!Ss(t.doc,n.to))return!1;r=n.to}else if(r=$p(t.doc,n.to,1),r==null)return!1;return e&&e(t.tr.join(r).scrollIntoView()),!0},I$=(t,e)=>{let{$from:n,$to:r}=t.selection,i=n.blockRange(r),o=i&&Kl(i);return o==null?!1:(e&&e(t.tr.lift(i,o).scrollIntoView()),!0)},eO=(t,e)=>{let{$head:n,$anchor:r}=t.selection;return!n.parent.type.spec.code||!n.sameParent(r)?!1:(e&&e(t.tr.insertText(`
`).scrollIntoView()),!0)};function Bb(t){for(let e=0;e<t.edgeCount;e++){let{type:n}=t.edge(e);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}const _$=(t,e)=>{let{$head:n,$anchor:r}=t.selection;if(!n.parent.type.spec.code||!n.sameParent(r))return!1;let i=n.node(-1),o=n.indexAfter(-1),a=Bb(i.contentMatchAt(o));if(!a||!i.canReplaceWith(o,o,a))return!1;if(e){let c=n.after(),u=t.tr.replaceWith(c,c,a.createAndFill());u.setSelection(xt.near(u.doc.resolve(c),1)),e(u.scrollIntoView())}return!0},tO=(t,e)=>{let n=t.selection,{$from:r,$to:i}=n;if(n instanceof kr||r.parent.inlineContent||i.parent.inlineContent)return!1;let o=Bb(i.parent.contentMatchAt(i.indexAfter()));if(!o||!o.isTextblock)return!1;if(e){let a=(!r.parentOffset&&i.index()<i.parent.childCount?r:i).pos,c=t.tr.insert(a,o.createAndFill());c.setSelection(st.create(c.doc,a+1)),e(c.scrollIntoView())}return!0},nO=(t,e)=>{let{$cursor:n}=t.selection;if(!n||n.parent.content.size)return!1;if(n.depth>1&&n.after()!=n.end(-1)){let o=n.before();if(ao(t.doc,o))return e&&e(t.tr.split(o).scrollIntoView()),!0}let r=n.blockRange(),i=r&&Kl(r);return i==null?!1:(e&&e(t.tr.lift(r,i).scrollIntoView()),!0)};function L$(t){return(e,n)=>{let{$from:r,$to:i}=e.selection;if(e.selection instanceof Je&&e.selection.node.isBlock)return!r.parentOffset||!ao(e.doc,r.pos)?!1:(n&&n(e.tr.split(r.pos).scrollIntoView()),!0);if(!r.depth)return!1;let o=[],a,c,u=!1,f=!1;for(let y=r.depth;;y--)if(r.node(y).isBlock){u=r.end(y)==r.pos+(r.depth-y),f=r.start(y)==r.pos-(r.depth-y),c=Bb(r.node(y-1).contentMatchAt(r.indexAfter(y-1))),o.unshift(u&&c?{type:c}:null),a=y;break}else{if(y==1)return!1;o.unshift(null)}let p=e.tr;(e.selection instanceof st||e.selection instanceof kr)&&p.deleteSelection();let g=p.mapping.map(r.pos),v=ao(p.doc,g,o.length,o);if(v||(o[0]=c?{type:c}:null,v=ao(p.doc,g,o.length,o)),!v)return!1;if(p.split(g,o.length,o),!u&&f&&r.node(a).type!=c){let y=p.mapping.map(r.before(a)),w=p.doc.resolve(y);c&&r.node(a-1).canReplaceWith(w.index(),w.index()+1,c)&&p.setNodeMarkup(p.mapping.map(r.before(a)),c)}return n&&n(p.scrollIntoView()),!0}}const P$=L$(),z$=(t,e)=>{let{$from:n,to:r}=t.selection,i,o=n.sharedDepth(r);return o==0?!1:(i=n.before(o),e&&e(t.tr.setSelection(Je.create(t.doc,i))),!0)};function B$(t,e,n){let r=e.nodeBefore,i=e.nodeAfter,o=e.index();return!r||!i||!r.type.compatibleContent(i.type)?!1:!r.content.size&&e.parent.canReplace(o-1,o)?(n&&n(t.tr.delete(e.pos-r.nodeSize,e.pos).scrollIntoView()),!0):!e.parent.canReplace(o,o+1)||!(i.isTextblock||Ss(t.doc,e.pos))?!1:(n&&n(t.tr.join(e.pos).scrollIntoView()),!0)}function rO(t,e,n,r){let i=e.nodeBefore,o=e.nodeAfter,a,c,u=i.type.spec.isolating||o.type.spec.isolating;if(!u&&B$(t,e,n))return!0;let f=!u&&e.parent.canReplace(e.index(),e.index()+1);if(f&&(a=(c=i.contentMatchAt(i.childCount)).findWrapping(o.type))&&c.matchType(a[0]||o.type).validEnd){if(n){let y=e.pos+o.nodeSize,w=Ee.empty;for(let T=a.length-1;T>=0;T--)w=Ee.from(a[T].create(null,w));w=Ee.from(i.copy(w));let S=t.tr.step(new On(e.pos-1,y,e.pos,y,new je(w,1,0),a.length,!0)),C=S.doc.resolve(y+2*a.length);C.nodeAfter&&C.nodeAfter.type==i.type&&Ss(S.doc,C.pos)&&S.join(C.pos),n(S.scrollIntoView())}return!0}let p=o.type.spec.isolating||r>0&&u?null:xt.findFrom(e,1),g=p&&p.$from.blockRange(p.$to),v=g&&Kl(g);if(v!=null&&v>=e.depth)return n&&n(t.tr.lift(g,v).scrollIntoView()),!0;if(f&&Ol(o,"start",!0)&&Ol(i,"end")){let y=i,w=[];for(;w.push(y),!y.isTextblock;)y=y.lastChild;let S=o,C=1;for(;!S.isTextblock;S=S.firstChild)C++;if(y.canReplace(y.childCount,y.childCount,S.content)){if(n){let T=Ee.empty;for(let k=w.length-1;k>=0;k--)T=Ee.from(w[k].copy(T));let N=t.tr.step(new On(e.pos-w.length,e.pos+o.nodeSize,e.pos+C,e.pos+o.nodeSize-C,new je(T,w.length,0),0,!0));n(N.scrollIntoView())}return!0}}return!1}function iO(t){return function(e,n){let r=e.selection,i=t<0?r.$from:r.$to,o=i.depth;for(;i.node(o).isInline;){if(!o)return!1;o--}return i.node(o).isTextblock?(n&&n(e.tr.setSelection(st.create(e.doc,t<0?i.start(o):i.end(o)))),!0):!1}}const F$=iO(-1),$$=iO(1);function H$(t,e=null){return function(n,r){let{$from:i,$to:o}=n.selection,a=i.blockRange(o),c=a&&Ib(a,t,e);return c?(r&&r(n.tr.wrap(a,c).scrollIntoView()),!0):!1}}function sT(t,e=null){return function(n,r){let i=!1;for(let o=0;o<n.selection.ranges.length&&!i;o++){let{$from:{pos:a},$to:{pos:c}}=n.selection.ranges[o];n.doc.nodesBetween(a,c,(u,f)=>{if(i)return!1;if(!(!u.isTextblock||u.hasMarkup(t,e)))if(u.type==t)i=!0;else{let p=n.doc.resolve(f),g=p.index();i=p.parent.canReplaceWith(g,g+1,t)}})}if(!i)return!1;if(r){let o=n.tr;for(let a=0;a<n.selection.ranges.length;a++){let{$from:{pos:c},$to:{pos:u}}=n.selection.ranges[a];o.setBlockType(c,u,t,e)}r(o.scrollIntoView())}return!0}}function Fb(...t){return function(e,n,r){for(let i=0;i<t.length;i++)if(t[i](e,n,r))return!0;return!1}}Fb(Lb,YD,XD);Fb(Lb,QD,ZD);Fb(eO,tO,nO,P$);typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):typeof os<"u"&&os.platform&&os.platform()=="darwin";function U$(t,e=null){return function(n,r){let{$from:i,$to:o}=n.selection,a=i.blockRange(o);if(!a)return!1;let c=r?n.tr:null;return V$(c,a,t,e)?(r&&r(c.scrollIntoView()),!0):!1}}function V$(t,e,n,r=null){let i=!1,o=e,a=e.$from.doc;if(e.depth>=2&&e.$from.node(e.depth-1).type.compatibleContent(n)&&e.startIndex==0){if(e.$from.index(e.depth-1)==0)return!1;let u=a.resolve(e.start-2);o=new Nh(u,u,e.depth),e.endIndex<e.parent.childCount&&(e=new Nh(e.$from,a.resolve(e.$to.end(e.depth)),e.depth)),i=!0}let c=Ib(o,n,r,e);return c?(t&&q$(t,e,c,i,n),!0):!1}function q$(t,e,n,r,i){let o=Ee.empty;for(let p=n.length-1;p>=0;p--)o=Ee.from(n[p].type.create(n[p].attrs,o));t.step(new On(e.start-(r?2:0),e.end,e.start,e.end,new je(o,0,0),n.length,!0));let a=0;for(let p=0;p<n.length;p++)n[p].type==i&&(a=p+1);let c=n.length-a,u=e.start+n.length-(r?2:0),f=e.parent;for(let p=e.startIndex,g=e.endIndex,v=!0;p<g;p++,v=!1)!v&&ao(t.doc,u,c)&&(t.split(u,c),u+=2*c),u+=f.child(p).nodeSize;return t}function G$(t){return function(e,n){let{$from:r,$to:i}=e.selection,o=r.blockRange(i,a=>a.childCount>0&&a.firstChild.type==t);return o?n?r.node(o.depth-1).type==t?W$(e,n,t,o):Y$(e,n,o):!0:!1}}function W$(t,e,n,r){let i=t.tr,o=r.end,a=r.$to.end(r.depth);o<a&&(i.step(new On(o-1,a,o,a,new je(Ee.from(n.create(null,r.parent.copy())),1,0),1,!0)),r=new Nh(i.doc.resolve(r.$from.pos),i.doc.resolve(a),r.depth));const c=Kl(r);if(c==null)return!1;i.lift(r,c);let u=i.doc.resolve(i.mapping.map(o,-1)-1);return Ss(i.doc,u.pos)&&u.nodeBefore.type==u.nodeAfter.type&&i.join(u.pos),e(i.scrollIntoView()),!0}function Y$(t,e,n){let r=t.tr,i=n.parent;for(let y=n.end,w=n.endIndex-1,S=n.startIndex;w>S;w--)y-=i.child(w).nodeSize,r.delete(y-1,y+1);let o=r.doc.resolve(n.start),a=o.nodeAfter;if(r.mapping.map(n.end)!=n.start+o.nodeAfter.nodeSize)return!1;let c=n.startIndex==0,u=n.endIndex==i.childCount,f=o.node(-1),p=o.index(-1);if(!f.canReplace(p+(c?0:1),p+1,a.content.append(u?Ee.empty:Ee.from(i))))return!1;let g=o.pos,v=g+a.nodeSize;return r.step(new On(g-(c?1:0),v+(u?1:0),g+1,v-1,new je((c?Ee.empty:Ee.from(i.copy(Ee.empty))).append(u?Ee.empty:Ee.from(i.copy(Ee.empty))),c?0:1,u?0:1),c?0:1)),e(r.scrollIntoView()),!0}function K$(t){return function(e,n){let{$from:r,$to:i}=e.selection,o=r.blockRange(i,f=>f.childCount>0&&f.firstChild.type==t);if(!o)return!1;let a=o.startIndex;if(a==0)return!1;let c=o.parent,u=c.child(a-1);if(u.type!=t)return!1;if(n){let f=u.lastChild&&u.lastChild.type==c.type,p=Ee.from(f?t.create():null),g=new je(Ee.from(t.create(null,Ee.from(c.type.create(null,p)))),f?3:1,0),v=o.start,y=o.end;n(e.tr.step(new On(v-(f?3:1),y,v,y,g,1,!0)).scrollIntoView())}return!0}}const Bn=function(t){for(var e=0;;e++)if(t=t.previousSibling,!t)return e},Ml=function(t){let e=t.assignedSlot||t.parentNode;return e&&e.nodeType==11?e.host:e};let ix=null;const ro=function(t,e,n){let r=ix||(ix=document.createRange());return r.setEnd(t,n??t.nodeValue.length),r.setStart(t,e||0),r},X$=function(){ix=null},fa=function(t,e,n,r){return n&&(aT(t,e,n,r,-1)||aT(t,e,n,r,1))},J$=/^(img|br|input|textarea|hr)$/i;function aT(t,e,n,r,i){for(var o;;){if(t==n&&e==r)return!0;if(e==(i<0?0:Vr(t))){let a=t.parentNode;if(!a||a.nodeType!=1||ed(t)||J$.test(t.nodeName)||t.contentEditable=="false")return!1;e=Bn(t)+(i<0?0:1),t=a}else if(t.nodeType==1){let a=t.childNodes[e+(i<0?-1:0)];if(a.nodeType==1&&a.contentEditable=="false")if(!((o=a.pmViewDesc)===null||o===void 0)&&o.ignoreForSelection)e+=i;else return!1;else t=a,e=i<0?Vr(t):0}else return!1}}function Vr(t){return t.nodeType==3?t.nodeValue.length:t.childNodes.length}function Q$(t,e){for(;;){if(t.nodeType==3&&e)return t;if(t.nodeType==1&&e>0){if(t.contentEditable=="false")return null;t=t.childNodes[e-1],e=Vr(t)}else if(t.parentNode&&!ed(t))e=Bn(t),t=t.parentNode;else return null}}function Z$(t,e){for(;;){if(t.nodeType==3&&e<t.nodeValue.length)return t;if(t.nodeType==1&&e<t.childNodes.length){if(t.contentEditable=="false")return null;t=t.childNodes[e],e=0}else if(t.parentNode&&!ed(t))e=Bn(t)+1,t=t.parentNode;else return null}}function eH(t,e,n){for(let r=e==0,i=e==Vr(t);r||i;){if(t==n)return!0;let o=Bn(t);if(t=t.parentNode,!t)return!1;r=r&&o==0,i=i&&o==Vr(t)}}function ed(t){let e;for(let n=t;n&&!(e=n.pmViewDesc);n=n.parentNode);return e&&e.node&&e.node.isBlock&&(e.dom==t||e.contentDOM==t)}const Vp=function(t){return t.focusNode&&fa(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset)};function Ys(t,e){let n=document.createEvent("Event");return n.initEvent("keydown",!0,!0),n.keyCode=t,n.key=n.code=e,n}function tH(t){let e=t.activeElement;for(;e&&e.shadowRoot;)e=e.shadowRoot.activeElement;return e}function nH(t,e,n){if(t.caretPositionFromPoint)try{let r=t.caretPositionFromPoint(e,n);if(r)return{node:r.offsetNode,offset:Math.min(Vr(r.offsetNode),r.offset)}}catch{}if(t.caretRangeFromPoint){let r=t.caretRangeFromPoint(e,n);if(r)return{node:r.startContainer,offset:Math.min(Vr(r.startContainer),r.startOffset)}}}const Oi=typeof navigator<"u"?navigator:null,lT=typeof document<"u"?document:null,Es=Oi&&Oi.userAgent||"",ox=/Edge\/(\d+)/.exec(Es),oO=/MSIE \d/.exec(Es),sx=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Es),hr=!!(oO||sx||ox),cs=oO?document.documentMode:sx?+sx[1]:ox?+ox[1]:0,qr=!hr&&/gecko\/(\d+)/i.test(Es);qr&&+(/Firefox\/(\d+)/.exec(Es)||[0,0])[1];const ax=!hr&&/Chrome\/(\d+)/.exec(Es),$n=!!ax,sO=ax?+ax[1]:0,Yn=!hr&&!!Oi&&/Apple Computer/.test(Oi.vendor),Rl=Yn&&(/Mobile\/\w+/.test(Es)||!!Oi&&Oi.maxTouchPoints>2),Hr=Rl||(Oi?/Mac/.test(Oi.platform):!1),aO=Oi?/Win/.test(Oi.platform):!1,so=/Android \d/.test(Es),td=!!lT&&"webkitFontSmoothing"in lT.documentElement.style,rH=td?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function iH(t){let e=t.defaultView&&t.defaultView.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:t.documentElement.clientWidth,top:0,bottom:t.documentElement.clientHeight}}function Zi(t,e){return typeof t=="number"?t:t[e]}function oH(t){let e=t.getBoundingClientRect(),n=e.width/t.offsetWidth||1,r=e.height/t.offsetHeight||1;return{left:e.left,right:e.left+t.clientWidth*n,top:e.top,bottom:e.top+t.clientHeight*r}}function cT(t,e,n){let r=t.someProp("scrollThreshold")||0,i=t.someProp("scrollMargin")||5,o=t.dom.ownerDocument;for(let a=n||t.dom;a;){if(a.nodeType!=1){a=Ml(a);continue}let c=a,u=c==o.body,f=u?iH(o):oH(c),p=0,g=0;if(e.top<f.top+Zi(r,"top")?g=-(f.top-e.top+Zi(i,"top")):e.bottom>f.bottom-Zi(r,"bottom")&&(g=e.bottom-e.top>f.bottom-f.top?e.top+Zi(i,"top")-f.top:e.bottom-f.bottom+Zi(i,"bottom")),e.left<f.left+Zi(r,"left")?p=-(f.left-e.left+Zi(i,"left")):e.right>f.right-Zi(r,"right")&&(p=e.right-f.right+Zi(i,"right")),p||g)if(u)o.defaultView.scrollBy(p,g);else{let y=c.scrollLeft,w=c.scrollTop;g&&(c.scrollTop+=g),p&&(c.scrollLeft+=p);let S=c.scrollLeft-y,C=c.scrollTop-w;e={left:e.left-S,top:e.top-C,right:e.right-S,bottom:e.bottom-C}}let v=u?"fixed":getComputedStyle(a).position;if(/^(fixed|sticky)$/.test(v))break;a=v=="absolute"?a.offsetParent:Ml(a)}}function sH(t){let e=t.dom.getBoundingClientRect(),n=Math.max(0,e.top),r,i;for(let o=(e.left+e.right)/2,a=n+1;a<Math.min(innerHeight,e.bottom);a+=5){let c=t.root.elementFromPoint(o,a);if(!c||c==t.dom||!t.dom.contains(c))continue;let u=c.getBoundingClientRect();if(u.top>=n-20){r=c,i=u.top;break}}return{refDOM:r,refTop:i,stack:lO(t.dom)}}function lO(t){let e=[],n=t.ownerDocument;for(let r=t;r&&(e.push({dom:r,top:r.scrollTop,left:r.scrollLeft}),t!=n);r=Ml(r));return e}function aH({refDOM:t,refTop:e,stack:n}){let r=t?t.getBoundingClientRect().top:0;cO(n,r==0?0:r-e)}function cO(t,e){for(let n=0;n<t.length;n++){let{dom:r,top:i,left:o}=t[n];r.scrollTop!=i+e&&(r.scrollTop=i+e),r.scrollLeft!=o&&(r.scrollLeft=o)}}let ul=null;function lH(t){if(t.setActive)return t.setActive();if(ul)return t.focus(ul);let e=lO(t);t.focus(ul==null?{get preventScroll(){return ul={preventScroll:!0},!0}}:void 0),ul||(ul=!1,cO(e,0))}function uO(t,e){let n,r=2e8,i,o=0,a=e.top,c=e.top,u,f;for(let p=t.firstChild,g=0;p;p=p.nextSibling,g++){let v;if(p.nodeType==1)v=p.getClientRects();else if(p.nodeType==3)v=ro(p).getClientRects();else continue;for(let y=0;y<v.length;y++){let w=v[y];if(w.top<=a&&w.bottom>=c){a=Math.max(w.bottom,a),c=Math.min(w.top,c);let S=w.left>e.left?w.left-e.left:w.right<e.left?e.left-w.right:0;if(S<r){n=p,r=S,i=S&&n.nodeType==3?{left:w.right<e.left?w.right:w.left,top:e.top}:e,p.nodeType==1&&S&&(o=g+(e.left>=(w.left+w.right)/2?1:0));continue}}else w.top>e.top&&!u&&w.left<=e.left&&w.right>=e.left&&(u=p,f={left:Math.max(w.left,Math.min(w.right,e.left)),top:w.top});!n&&(e.left>=w.right&&e.top>=w.top||e.left>=w.left&&e.top>=w.bottom)&&(o=g+1)}}return!n&&u&&(n=u,i=f,r=0),n&&n.nodeType==3?cH(n,i):!n||r&&n.nodeType==1?{node:t,offset:o}:uO(n,i)}function cH(t,e){let n=t.nodeValue.length,r=document.createRange(),i;for(let o=0;o<n;o++){r.setEnd(t,o+1),r.setStart(t,o);let a=Ko(r,1);if(a.top!=a.bottom&&$b(e,a)){i={node:t,offset:o+(e.left>=(a.left+a.right)/2?1:0)};break}}return r.detach(),i||{node:t,offset:0}}function $b(t,e){return t.left>=e.left-1&&t.left<=e.right+1&&t.top>=e.top-1&&t.top<=e.bottom+1}function uH(t,e){let n=t.parentNode;return n&&/^li$/i.test(n.nodeName)&&e.left<t.getBoundingClientRect().left?n:t}function dH(t,e,n){let{node:r,offset:i}=uO(e,n),o=-1;if(r.nodeType==1&&!r.firstChild){let a=r.getBoundingClientRect();o=a.left!=a.right&&n.left>(a.left+a.right)/2?1:-1}return t.docView.posFromDOM(r,i,o)}function fH(t,e,n,r){let i=-1;for(let o=e,a=!1;o!=t.dom;){let c=t.docView.nearestDesc(o,!0),u;if(!c)return null;if(c.dom.nodeType==1&&(c.node.isBlock&&c.parent||!c.contentDOM)&&((u=c.dom.getBoundingClientRect()).width||u.height)&&(c.node.isBlock&&c.parent&&!/^T(R|BODY|HEAD|FOOT)$/.test(c.dom.nodeName)&&(!a&&u.left>r.left||u.top>r.top?i=c.posBefore:(!a&&u.right<r.left||u.bottom<r.top)&&(i=c.posAfter),a=!0),!c.contentDOM&&i<0&&!c.node.isText))return(c.node.isBlock?r.top<(u.top+u.bottom)/2:r.left<(u.left+u.right)/2)?c.posBefore:c.posAfter;o=c.dom.parentNode}return i>-1?i:t.docView.posFromDOM(e,n,-1)}function dO(t,e,n){let r=t.childNodes.length;if(r&&n.top<n.bottom)for(let i=Math.max(0,Math.min(r-1,Math.floor(r*(e.top-n.top)/(n.bottom-n.top))-2)),o=i;;){let a=t.childNodes[o];if(a.nodeType==1){let c=a.getClientRects();for(let u=0;u<c.length;u++){let f=c[u];if($b(e,f))return dO(a,e,f)}}if((o=(o+1)%r)==i)break}return t}function hH(t,e){let n=t.dom.ownerDocument,r,i=0,o=nH(n,e.left,e.top);o&&({node:r,offset:i}=o);let a=(t.root.elementFromPoint?t.root:n).elementFromPoint(e.left,e.top),c;if(!a||!t.dom.contains(a.nodeType!=1?a.parentNode:a)){let f=t.dom.getBoundingClientRect();if(!$b(e,f)||(a=dO(t.dom,e,f),!a))return null}if(Yn)for(let f=a;r&&f;f=Ml(f))f.draggable&&(r=void 0);if(a=uH(a,e),r){if(qr&&r.nodeType==1&&(i=Math.min(i,r.childNodes.length),i<r.childNodes.length)){let p=r.childNodes[i],g;p.nodeName=="IMG"&&(g=p.getBoundingClientRect()).right<=e.left&&g.bottom>e.top&&i++}let f;td&&i&&r.nodeType==1&&(f=r.childNodes[i-1]).nodeType==1&&f.contentEditable=="false"&&f.getBoundingClientRect().top>=e.top&&i--,r==t.dom&&i==r.childNodes.length-1&&r.lastChild.nodeType==1&&e.top>r.lastChild.getBoundingClientRect().bottom?c=t.state.doc.content.size:(i==0||r.nodeType!=1||r.childNodes[i-1].nodeName!="BR")&&(c=fH(t,r,i,e))}c==null&&(c=dH(t,a,e));let u=t.docView.nearestDesc(a,!0);return{pos:c,inside:u?u.posAtStart-u.border:-1}}function uT(t){return t.top<t.bottom||t.left<t.right}function Ko(t,e){let n=t.getClientRects();if(n.length){let r=n[e<0?0:n.length-1];if(uT(r))return r}return Array.prototype.find.call(n,uT)||t.getBoundingClientRect()}const pH=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function fO(t,e,n){let{node:r,offset:i,atom:o}=t.docView.domFromPos(e,n<0?-1:1),a=td||qr;if(r.nodeType==3)if(a&&(pH.test(r.nodeValue)||(n<0?!i:i==r.nodeValue.length))){let u=Ko(ro(r,i,i),n);if(qr&&i&&/\s/.test(r.nodeValue[i-1])&&i<r.nodeValue.length){let f=Ko(ro(r,i-1,i-1),-1);if(f.top==u.top){let p=Ko(ro(r,i,i+1),-1);if(p.top!=u.top)return Yc(p,p.left<f.left)}}return u}else{let u=i,f=i,p=n<0?1:-1;return n<0&&!i?(f++,p=-1):n>=0&&i==r.nodeValue.length?(u--,p=1):n<0?u--:f++,Yc(Ko(ro(r,u,f),p),p<0)}if(!t.state.doc.resolve(e-(o||0)).parent.inlineContent){if(o==null&&i&&(n<0||i==Vr(r))){let u=r.childNodes[i-1];if(u.nodeType==1)return Zy(u.getBoundingClientRect(),!1)}if(o==null&&i<Vr(r)){let u=r.childNodes[i];if(u.nodeType==1)return Zy(u.getBoundingClientRect(),!0)}return Zy(r.getBoundingClientRect(),n>=0)}if(o==null&&i&&(n<0||i==Vr(r))){let u=r.childNodes[i-1],f=u.nodeType==3?ro(u,Vr(u)-(a?0:1)):u.nodeType==1&&(u.nodeName!="BR"||!u.nextSibling)?u:null;if(f)return Yc(Ko(f,1),!1)}if(o==null&&i<Vr(r)){let u=r.childNodes[i];for(;u.pmViewDesc&&u.pmViewDesc.ignoreForCoords;)u=u.nextSibling;let f=u?u.nodeType==3?ro(u,0,a?0:1):u.nodeType==1?u:null:null;if(f)return Yc(Ko(f,-1),!0)}return Yc(Ko(r.nodeType==3?ro(r):r,-n),n>=0)}function Yc(t,e){if(t.width==0)return t;let n=e?t.left:t.right;return{top:t.top,bottom:t.bottom,left:n,right:n}}function Zy(t,e){if(t.height==0)return t;let n=e?t.top:t.bottom;return{top:n,bottom:n,left:t.left,right:t.right}}function hO(t,e,n){let r=t.state,i=t.root.activeElement;r!=e&&t.updateState(e),i!=t.dom&&t.focus();try{return n()}finally{r!=e&&t.updateState(r),i!=t.dom&&i&&i.focus()}}function mH(t,e,n){let r=e.selection,i=n=="up"?r.$from:r.$to;return hO(t,e,()=>{let{node:o}=t.docView.domFromPos(i.pos,n=="up"?-1:1);for(;;){let c=t.docView.nearestDesc(o,!0);if(!c)break;if(c.node.isBlock){o=c.contentDOM||c.dom;break}o=c.dom.parentNode}let a=fO(t,i.pos,1);for(let c=o.firstChild;c;c=c.nextSibling){let u;if(c.nodeType==1)u=c.getClientRects();else if(c.nodeType==3)u=ro(c,0,c.nodeValue.length).getClientRects();else continue;for(let f=0;f<u.length;f++){let p=u[f];if(p.bottom>p.top+1&&(n=="up"?a.top-p.top>(p.bottom-a.top)*2:p.bottom-a.bottom>(a.bottom-p.top)*2))return!1}}return!0})}const gH=/[\u0590-\u08ac]/;function yH(t,e,n){let{$head:r}=e.selection;if(!r.parent.isTextblock)return!1;let i=r.parentOffset,o=!i,a=i==r.parent.content.size,c=t.domSelection();return c?!gH.test(r.parent.textContent)||!c.modify?n=="left"||n=="backward"?o:a:hO(t,e,()=>{let{focusNode:u,focusOffset:f,anchorNode:p,anchorOffset:g}=t.domSelectionRange(),v=c.caretBidiLevel;c.modify("move",n,"character");let y=r.depth?t.docView.domAfterPos(r.before()):t.dom,{focusNode:w,focusOffset:S}=t.domSelectionRange(),C=w&&!y.contains(w.nodeType==1?w:w.parentNode)||u==w&&f==S;try{c.collapse(p,g),u&&(u!=p||f!=g)&&c.extend&&c.extend(u,f)}catch{}return v!=null&&(c.caretBidiLevel=v),C}):r.pos==r.start()||r.pos==r.end()}let dT=null,fT=null,hT=!1;function vH(t,e,n){return dT==e&&fT==n?hT:(dT=e,fT=n,hT=n=="up"||n=="down"?mH(t,e,n):yH(t,e,n))}const Gr=0,pT=1,Ks=2,Mi=3;class nd{constructor(e,n,r,i){this.parent=e,this.children=n,this.dom=r,this.contentDOM=i,this.dirty=Gr,r.pmViewDesc=this}matchesWidget(e){return!1}matchesMark(e){return!1}matchesNode(e,n,r){return!1}matchesHack(e){return!1}parseRule(){return null}stopEvent(e){return!1}get size(){let e=0;for(let n=0;n<this.children.length;n++)e+=this.children[n].size;return e}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let e=0;e<this.children.length;e++)this.children[e].destroy()}posBeforeChild(e){for(let n=0,r=this.posAtStart;;n++){let i=this.children[n];if(i==e)return r;r+=i.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(e,n,r){if(this.contentDOM&&this.contentDOM.contains(e.nodeType==1?e:e.parentNode))if(r<0){let o,a;if(e==this.contentDOM)o=e.childNodes[n-1];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;o=e.previousSibling}for(;o&&!((a=o.pmViewDesc)&&a.parent==this);)o=o.previousSibling;return o?this.posBeforeChild(a)+a.size:this.posAtStart}else{let o,a;if(e==this.contentDOM)o=e.childNodes[n];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;o=e.nextSibling}for(;o&&!((a=o.pmViewDesc)&&a.parent==this);)o=o.nextSibling;return o?this.posBeforeChild(a):this.posAtEnd}let i;if(e==this.dom&&this.contentDOM)i=n>Bn(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))i=e.compareDocumentPosition(this.contentDOM)&2;else if(this.dom.firstChild){if(n==0)for(let o=e;;o=o.parentNode){if(o==this.dom){i=!1;break}if(o.previousSibling)break}if(i==null&&n==e.childNodes.length)for(let o=e;;o=o.parentNode){if(o==this.dom){i=!0;break}if(o.nextSibling)break}}return i??r>0?this.posAtEnd:this.posAtStart}nearestDesc(e,n=!1){for(let r=!0,i=e;i;i=i.parentNode){let o=this.getDesc(i),a;if(o&&(!n||o.node))if(r&&(a=o.nodeDOM)&&!(a.nodeType==1?a.contains(e.nodeType==1?e:e.parentNode):a==e))r=!1;else return o}}getDesc(e){let n=e.pmViewDesc;for(let r=n;r;r=r.parent)if(r==this)return n}posFromDOM(e,n,r){for(let i=e;i;i=i.parentNode){let o=this.getDesc(i);if(o)return o.localPosFromDOM(e,n,r)}return-1}descAt(e){for(let n=0,r=0;n<this.children.length;n++){let i=this.children[n],o=r+i.size;if(r==e&&o!=r){for(;!i.border&&i.children.length;)for(let a=0;a<i.children.length;a++){let c=i.children[a];if(c.size){i=c;break}}return i}if(e<o)return i.descAt(e-r-i.border);r=o}}domFromPos(e,n){if(!this.contentDOM)return{node:this.dom,offset:0,atom:e+1};let r=0,i=0;for(let o=0;r<this.children.length;r++){let a=this.children[r],c=o+a.size;if(c>e||a instanceof mO){i=e-o;break}o=c}if(i)return this.children[r].domFromPos(i-this.children[r].border,n);for(let o;r&&!(o=this.children[r-1]).size&&o instanceof pO&&o.side>=0;r--);if(n<=0){let o,a=!0;for(;o=r?this.children[r-1]:null,!(!o||o.dom.parentNode==this.contentDOM);r--,a=!1);return o&&n&&a&&!o.border&&!o.domAtom?o.domFromPos(o.size,n):{node:this.contentDOM,offset:o?Bn(o.dom)+1:0}}else{let o,a=!0;for(;o=r<this.children.length?this.children[r]:null,!(!o||o.dom.parentNode==this.contentDOM);r++,a=!1);return o&&a&&!o.border&&!o.domAtom?o.domFromPos(0,n):{node:this.contentDOM,offset:o?Bn(o.dom):this.contentDOM.childNodes.length}}}parseRange(e,n,r=0){if(this.children.length==0)return{node:this.contentDOM,from:e,to:n,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let i=-1,o=-1;for(let a=r,c=0;;c++){let u=this.children[c],f=a+u.size;if(i==-1&&e<=f){let p=a+u.border;if(e>=p&&n<=f-u.border&&u.node&&u.contentDOM&&this.contentDOM.contains(u.contentDOM))return u.parseRange(e,n,p);e=a;for(let g=c;g>0;g--){let v=this.children[g-1];if(v.size&&v.dom.parentNode==this.contentDOM&&!v.emptyChildAt(1)){i=Bn(v.dom)+1;break}e-=v.size}i==-1&&(i=0)}if(i>-1&&(f>n||c==this.children.length-1)){n=f;for(let p=c+1;p<this.children.length;p++){let g=this.children[p];if(g.size&&g.dom.parentNode==this.contentDOM&&!g.emptyChildAt(-1)){o=Bn(g.dom);break}n+=g.size}o==-1&&(o=this.contentDOM.childNodes.length);break}a=f}return{node:this.contentDOM,from:e,to:n,fromOffset:i,toOffset:o}}emptyChildAt(e){if(this.border||!this.contentDOM||!this.children.length)return!1;let n=this.children[e<0?0:this.children.length-1];return n.size==0||n.emptyChildAt(e)}domAfterPos(e){let{node:n,offset:r}=this.domFromPos(e,0);if(n.nodeType!=1||r==n.childNodes.length)throw new RangeError("No node after pos "+e);return n.childNodes[r]}setSelection(e,n,r,i=!1){let o=Math.min(e,n),a=Math.max(e,n);for(let y=0,w=0;y<this.children.length;y++){let S=this.children[y],C=w+S.size;if(o>w&&a<C)return S.setSelection(e-w-S.border,n-w-S.border,r,i);w=C}let c=this.domFromPos(e,e?-1:1),u=n==e?c:this.domFromPos(n,n?-1:1),f=r.root.getSelection(),p=r.domSelectionRange(),g=!1;if((qr||Yn)&&e==n){let{node:y,offset:w}=c;if(y.nodeType==3){if(g=!!(w&&y.nodeValue[w-1]==`
`),g&&w==y.nodeValue.length)for(let S=y,C;S;S=S.parentNode){if(C=S.nextSibling){C.nodeName=="BR"&&(c=u={node:C.parentNode,offset:Bn(C)+1});break}let T=S.pmViewDesc;if(T&&T.node&&T.node.isBlock)break}}else{let S=y.childNodes[w-1];g=S&&(S.nodeName=="BR"||S.contentEditable=="false")}}if(qr&&p.focusNode&&p.focusNode!=u.node&&p.focusNode.nodeType==1){let y=p.focusNode.childNodes[p.focusOffset];y&&y.contentEditable=="false"&&(i=!0)}if(!(i||g&&Yn)&&fa(c.node,c.offset,p.anchorNode,p.anchorOffset)&&fa(u.node,u.offset,p.focusNode,p.focusOffset))return;let v=!1;if((f.extend||e==n)&&!(g&&qr)){f.collapse(c.node,c.offset);try{e!=n&&f.extend(u.node,u.offset),v=!0}catch{}}if(!v){if(e>n){let w=c;c=u,u=w}let y=document.createRange();y.setEnd(u.node,u.offset),y.setStart(c.node,c.offset),f.removeAllRanges(),f.addRange(y)}}ignoreMutation(e){return!this.contentDOM&&e.type!="selection"}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(e,n){for(let r=0,i=0;i<this.children.length;i++){let o=this.children[i],a=r+o.size;if(r==a?e<=a&&n>=r:e<a&&n>r){let c=r+o.border,u=a-o.border;if(e>=c&&n<=u){this.dirty=e==r||n==a?Ks:pT,e==c&&n==u&&(o.contentLost||o.dom.parentNode!=this.contentDOM)?o.dirty=Mi:o.markDirty(e-c,n-c);return}else o.dirty=o.dom==o.contentDOM&&o.dom.parentNode==this.contentDOM&&!o.children.length?Ks:Mi}r=a}this.dirty=Ks}markParentsDirty(){let e=1;for(let n=this.parent;n;n=n.parent,e++){let r=e==1?Ks:pT;n.dirty<r&&(n.dirty=r)}}get domAtom(){return!1}get ignoreForCoords(){return!1}get ignoreForSelection(){return!1}isText(e){return!1}}class pO extends nd{constructor(e,n,r,i){let o,a=n.type.toDOM;if(typeof a=="function"&&(a=a(r,()=>{if(!o)return i;if(o.parent)return o.parent.posBeforeChild(o)})),!n.type.spec.raw){if(a.nodeType!=1){let c=document.createElement("span");c.appendChild(a),a=c}a.contentEditable="false",a.classList.add("ProseMirror-widget")}super(e,[],a,null),this.widget=n,this.widget=n,o=this}matchesWidget(e){return this.dirty==Gr&&e.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(e){let n=this.widget.spec.stopEvent;return n?n(e):!1}ignoreMutation(e){return e.type!="selection"||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get ignoreForSelection(){return!!this.widget.type.spec.relaxedSide}get side(){return this.widget.type.side}}class xH extends nd{constructor(e,n,r,i){super(e,[],n,null),this.textDOM=r,this.text=i}get size(){return this.text.length}localPosFromDOM(e,n){return e!=this.textDOM?this.posAtStart+(n?this.size:0):this.posAtStart+n}domFromPos(e){return{node:this.textDOM,offset:e}}ignoreMutation(e){return e.type==="characterData"&&e.target.nodeValue==e.oldValue}}class ha extends nd{constructor(e,n,r,i,o){super(e,[],r,i),this.mark=n,this.spec=o}static create(e,n,r,i){let o=i.nodeViews[n.type.name],a=o&&o(n,i,r);return(!a||!a.dom)&&(a=ya.renderSpec(document,n.type.spec.toDOM(n,r),null,n.attrs)),new ha(e,n,a.dom,a.contentDOM||a.dom,a)}parseRule(){return this.dirty&Mi||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}matchesMark(e){return this.dirty!=Mi&&this.mark.eq(e)}markDirty(e,n){if(super.markDirty(e,n),this.dirty!=Gr){let r=this.parent;for(;!r.node;)r=r.parent;r.dirty<this.dirty&&(r.dirty=this.dirty),this.dirty=Gr}}slice(e,n,r){let i=ha.create(this.parent,this.mark,!0,r),o=this.children,a=this.size;n<a&&(o=cx(o,n,a,r)),e>0&&(o=cx(o,0,e,r));for(let c=0;c<o.length;c++)o[c].parent=i;return i.children=o,i}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}}class us extends nd{constructor(e,n,r,i,o,a,c,u,f){super(e,[],o,a),this.node=n,this.outerDeco=r,this.innerDeco=i,this.nodeDOM=c}static create(e,n,r,i,o,a){let c=o.nodeViews[n.type.name],u,f=c&&c(n,o,()=>{if(!u)return a;if(u.parent)return u.parent.posBeforeChild(u)},r,i),p=f&&f.dom,g=f&&f.contentDOM;if(n.isText){if(!p)p=document.createTextNode(n.text);else if(p.nodeType!=3)throw new RangeError("Text must be rendered as a DOM text node")}else p||({dom:p,contentDOM:g}=ya.renderSpec(document,n.type.spec.toDOM(n),null,n.attrs));!g&&!n.isText&&p.nodeName!="BR"&&(p.hasAttribute("contenteditable")||(p.contentEditable="false"),n.type.spec.draggable&&(p.draggable=!0));let v=p;return p=vO(p,r,n),f?u=new bH(e,n,r,i,p,g||null,v,f,o,a+1):n.isText?new qp(e,n,r,i,p,v,o):new us(e,n,r,i,p,g||null,v,o,a+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let e={node:this.node.type.name,attrs:this.node.attrs};if(this.node.type.whitespace=="pre"&&(e.preserveWhitespace="full"),!this.contentDOM)e.getContent=()=>this.node.content;else if(!this.contentLost)e.contentElement=this.contentDOM;else{for(let n=this.children.length-1;n>=0;n--){let r=this.children[n];if(this.dom.contains(r.dom.parentNode)){e.contentElement=r.dom.parentNode;break}}e.contentElement||(e.getContent=()=>Ee.empty)}return e}matchesNode(e,n,r){return this.dirty==Gr&&e.eq(this.node)&&kh(n,this.outerDeco)&&r.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(e,n){let r=this.node.inlineContent,i=n,o=e.composing?this.localCompositionInfo(e,n):null,a=o&&o.pos>-1?o:null,c=o&&o.pos<0,u=new SH(this,a&&a.node,e);TH(this.node,this.innerDeco,(f,p,g)=>{f.spec.marks?u.syncToMarks(f.spec.marks,r,e,p):f.type.side>=0&&!g&&u.syncToMarks(p==this.node.childCount?Xt.none:this.node.child(p).marks,r,e,p),u.placeWidget(f,e,i)},(f,p,g,v)=>{u.syncToMarks(f.marks,r,e,v);let y;u.findNodeMatch(f,p,g,v)||c&&e.state.selection.from>i&&e.state.selection.to<i+f.nodeSize&&(y=u.findIndexWithChild(o.node))>-1&&u.updateNodeAt(f,p,g,y,e)||u.updateNextNode(f,p,g,e,v,i)||u.addNode(f,p,g,e,i),i+=f.nodeSize}),u.syncToMarks([],r,e,0),this.node.isTextblock&&u.addTextblockHacks(),u.destroyRest(),(u.changed||this.dirty==Ks)&&(a&&this.protectLocalComposition(e,a),gO(this.contentDOM,this.children,e),Rl&&NH(this.dom))}localCompositionInfo(e,n){let{from:r,to:i}=e.state.selection;if(!(e.state.selection instanceof st)||r<n||i>n+this.node.content.size)return null;let o=e.input.compositionNode;if(!o||!this.dom.contains(o.parentNode))return null;if(this.node.inlineContent){let a=o.nodeValue,c=AH(this.node.content,a,r-n,i-n);return c<0?null:{node:o,pos:c,text:a}}else return{node:o,pos:-1,text:""}}protectLocalComposition(e,{node:n,pos:r,text:i}){if(this.getDesc(n))return;let o=n;for(;o.parentNode!=this.contentDOM;o=o.parentNode){for(;o.previousSibling;)o.parentNode.removeChild(o.previousSibling);for(;o.nextSibling;)o.parentNode.removeChild(o.nextSibling);o.pmViewDesc&&(o.pmViewDesc=void 0)}let a=new xH(this,o,n,i);e.input.compositionNodes.push(a),this.children=cx(this.children,r,r+i.length,e,a)}update(e,n,r,i){return this.dirty==Mi||!e.sameMarkup(this.node)?!1:(this.updateInner(e,n,r,i),!0)}updateInner(e,n,r,i){this.updateOuterDeco(n),this.node=e,this.innerDeco=r,this.contentDOM&&this.updateChildren(i,this.posAtStart),this.dirty=Gr}updateOuterDeco(e){if(kh(e,this.outerDeco))return;let n=this.nodeDOM.nodeType!=1,r=this.dom;this.dom=yO(this.dom,this.nodeDOM,lx(this.outerDeco,this.node,n),lx(e,this.node,n)),this.dom!=r&&(r.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=e}selectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.nodeDOM.draggable=!0))}deselectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.nodeDOM.removeAttribute("draggable"))}get domAtom(){return this.node.isAtom}}function mT(t,e,n,r,i){vO(r,e,t);let o=new us(void 0,t,e,n,r,r,r,i,0);return o.contentDOM&&o.updateChildren(i,0),o}class qp extends us{constructor(e,n,r,i,o,a,c){super(e,n,r,i,o,null,a,c,0)}parseRule(){let e=this.nodeDOM.parentNode;for(;e&&e!=this.dom&&!e.pmIsDeco;)e=e.parentNode;return{skip:e||!0}}update(e,n,r,i){return this.dirty==Mi||this.dirty!=Gr&&!this.inParent()||!e.sameMarkup(this.node)?!1:(this.updateOuterDeco(n),(this.dirty!=Gr||e.text!=this.node.text)&&e.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=e.text,i.trackWrites==this.nodeDOM&&(i.trackWrites=null)),this.node=e,this.dirty=Gr,!0)}inParent(){let e=this.parent.contentDOM;for(let n=this.nodeDOM;n;n=n.parentNode)if(n==e)return!0;return!1}domFromPos(e){return{node:this.nodeDOM,offset:e}}localPosFromDOM(e,n,r){return e==this.nodeDOM?this.posAtStart+Math.min(n,this.node.text.length):super.localPosFromDOM(e,n,r)}ignoreMutation(e){return e.type!="characterData"&&e.type!="selection"}slice(e,n,r){let i=this.node.cut(e,n),o=document.createTextNode(i.text);return new qp(this.parent,i,this.outerDeco,this.innerDeco,o,o,r)}markDirty(e,n){super.markDirty(e,n),this.dom!=this.nodeDOM&&(e==0||n==this.nodeDOM.nodeValue.length)&&(this.dirty=Mi)}get domAtom(){return!1}isText(e){return this.node.text==e}}class mO extends nd{parseRule(){return{ignore:!0}}matchesHack(e){return this.dirty==Gr&&this.dom.nodeName==e}get domAtom(){return!0}get ignoreForCoords(){return this.dom.nodeName=="IMG"}}class bH extends us{constructor(e,n,r,i,o,a,c,u,f,p){super(e,n,r,i,o,a,c,f,p),this.spec=u}update(e,n,r,i){if(this.dirty==Mi)return!1;if(this.spec.update&&(this.node.type==e.type||this.spec.multiType)){let o=this.spec.update(e,n,r);return o&&this.updateInner(e,n,r,i),o}else return!this.contentDOM&&!e.isLeaf?!1:super.update(e,n,r,i)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(e,n,r,i){this.spec.setSelection?this.spec.setSelection(e,n,r.root):super.setSelection(e,n,r,i)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(e){return this.spec.stopEvent?this.spec.stopEvent(e):!1}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}}function gO(t,e,n){let r=t.firstChild,i=!1;for(let o=0;o<e.length;o++){let a=e[o],c=a.dom;if(c.parentNode==t){for(;c!=r;)r=gT(r),i=!0;r=r.nextSibling}else i=!0,t.insertBefore(c,r);if(a instanceof ha){let u=r?r.previousSibling:t.lastChild;gO(a.contentDOM,a.children,n),r=u?u.nextSibling:t.firstChild}}for(;r;)r=gT(r),i=!0;i&&n.trackWrites==t&&(n.trackWrites=null)}const pu=function(t){t&&(this.nodeName=t)};pu.prototype=Object.create(null);const Xs=[new pu];function lx(t,e,n){if(t.length==0)return Xs;let r=n?Xs[0]:new pu,i=[r];for(let o=0;o<t.length;o++){let a=t[o].type.attrs;if(a){a.nodeName&&i.push(r=new pu(a.nodeName));for(let c in a){let u=a[c];u!=null&&(n&&i.length==1&&i.push(r=new pu(e.isInline?"span":"div")),c=="class"?r.class=(r.class?r.class+" ":"")+u:c=="style"?r.style=(r.style?r.style+";":"")+u:c!="nodeName"&&(r[c]=u))}}}return i}function yO(t,e,n,r){if(n==Xs&&r==Xs)return e;let i=e;for(let o=0;o<r.length;o++){let a=r[o],c=n[o];if(o){let u;c&&c.nodeName==a.nodeName&&i!=t&&(u=i.parentNode)&&u.nodeName.toLowerCase()==a.nodeName||(u=document.createElement(a.nodeName),u.pmIsDeco=!0,u.appendChild(i),c=Xs[0]),i=u}wH(i,c||Xs[0],a)}return i}function wH(t,e,n){for(let r in e)r!="class"&&r!="style"&&r!="nodeName"&&!(r in n)&&t.removeAttribute(r);for(let r in n)r!="class"&&r!="style"&&r!="nodeName"&&n[r]!=e[r]&&t.setAttribute(r,n[r]);if(e.class!=n.class){let r=e.class?e.class.split(" ").filter(Boolean):[],i=n.class?n.class.split(" ").filter(Boolean):[];for(let o=0;o<r.length;o++)i.indexOf(r[o])==-1&&t.classList.remove(r[o]);for(let o=0;o<i.length;o++)r.indexOf(i[o])==-1&&t.classList.add(i[o]);t.classList.length==0&&t.removeAttribute("class")}if(e.style!=n.style){if(e.style){let r=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g,i;for(;i=r.exec(e.style);)t.style.removeProperty(i[1])}n.style&&(t.style.cssText+=n.style)}}function vO(t,e,n){return yO(t,t,Xs,lx(e,n,t.nodeType!=1))}function kh(t,e){if(t.length!=e.length)return!1;for(let n=0;n<t.length;n++)if(!t[n].type.eq(e[n].type))return!1;return!0}function gT(t){let e=t.nextSibling;return t.parentNode.removeChild(t),e}class SH{constructor(e,n,r){this.lock=n,this.view=r,this.index=0,this.stack=[],this.changed=!1,this.top=e,this.preMatch=EH(e.node.content,e)}destroyBetween(e,n){if(e!=n){for(let r=e;r<n;r++)this.top.children[r].destroy();this.top.children.splice(e,n-e),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(e,n,r,i){let o=0,a=this.stack.length>>1,c=Math.min(a,e.length);for(;o<c&&(o==a-1?this.top:this.stack[o+1<<1]).matchesMark(e[o])&&e[o].type.spec.spanning!==!1;)o++;for(;o<a;)this.destroyRest(),this.top.dirty=Gr,this.index=this.stack.pop(),this.top=this.stack.pop(),a--;for(;a<e.length;){this.stack.push(this.top,this.index+1);let u=-1,f=this.top.children.length;i<this.preMatch.index&&(f=Math.min(this.index+3,f));for(let p=this.index;p<f;p++){let g=this.top.children[p];if(g.matchesMark(e[a])&&!this.isLocked(g.dom)){u=p;break}}if(u>-1)u>this.index&&(this.changed=!0,this.destroyBetween(this.index,u)),this.top=this.top.children[this.index];else{let p=ha.create(this.top,e[a],n,r);this.top.children.splice(this.index,0,p),this.top=p,this.changed=!0}this.index=0,a++}}findNodeMatch(e,n,r,i){let o=-1,a;if(i>=this.preMatch.index&&(a=this.preMatch.matches[i-this.preMatch.index]).parent==this.top&&a.matchesNode(e,n,r))o=this.top.children.indexOf(a,this.index);else for(let c=this.index,u=Math.min(this.top.children.length,c+5);c<u;c++){let f=this.top.children[c];if(f.matchesNode(e,n,r)&&!this.preMatch.matched.has(f)){o=c;break}}return o<0?!1:(this.destroyBetween(this.index,o),this.index++,!0)}updateNodeAt(e,n,r,i,o){let a=this.top.children[i];return a.dirty==Mi&&a.dom==a.contentDOM&&(a.dirty=Ks),a.update(e,n,r,o)?(this.destroyBetween(this.index,i),this.index++,!0):!1}findIndexWithChild(e){for(;;){let n=e.parentNode;if(!n)return-1;if(n==this.top.contentDOM){let r=e.pmViewDesc;if(r){for(let i=this.index;i<this.top.children.length;i++)if(this.top.children[i]==r)return i}return-1}e=n}}updateNextNode(e,n,r,i,o,a){for(let c=this.index;c<this.top.children.length;c++){let u=this.top.children[c];if(u instanceof us){let f=this.preMatch.matched.get(u);if(f!=null&&f!=o)return!1;let p=u.dom,g,v=this.isLocked(p)&&!(e.isText&&u.node&&u.node.isText&&u.nodeDOM.nodeValue==e.text&&u.dirty!=Mi&&kh(n,u.outerDeco));if(!v&&u.update(e,n,r,i))return this.destroyBetween(this.index,c),u.dom!=p&&(this.changed=!0),this.index++,!0;if(!v&&(g=this.recreateWrapper(u,e,n,r,i,a)))return this.destroyBetween(this.index,c),this.top.children[this.index]=g,g.contentDOM&&(g.dirty=Ks,g.updateChildren(i,a+1),g.dirty=Gr),this.changed=!0,this.index++,!0;break}}return!1}recreateWrapper(e,n,r,i,o,a){if(e.dirty||n.isAtom||!e.children.length||!e.node.content.eq(n.content)||!kh(r,e.outerDeco)||!i.eq(e.innerDeco))return null;let c=us.create(this.top,n,r,i,o,a);if(c.contentDOM){c.children=e.children,e.children=[];for(let u of c.children)u.parent=c}return e.destroy(),c}addNode(e,n,r,i,o){let a=us.create(this.top,e,n,r,i,o);a.contentDOM&&a.updateChildren(i,o+1),this.top.children.splice(this.index++,0,a),this.changed=!0}placeWidget(e,n,r){let i=this.index<this.top.children.length?this.top.children[this.index]:null;if(i&&i.matchesWidget(e)&&(e==i.widget||!i.widget.type.toDOM.parentNode))this.index++;else{let o=new pO(this.top,e,n,r);this.top.children.splice(this.index++,0,o),this.changed=!0}}addTextblockHacks(){let e=this.top.children[this.index-1],n=this.top;for(;e instanceof ha;)n=e,e=n.children[n.children.length-1];(!e||!(e instanceof qp)||/\n$/.test(e.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(e.node.text))&&((Yn||$n)&&e&&e.dom.contentEditable=="false"&&this.addHackNode("IMG",n),this.addHackNode("BR",this.top))}addHackNode(e,n){if(n==this.top&&this.index<n.children.length&&n.children[this.index].matchesHack(e))this.index++;else{let r=document.createElement(e);e=="IMG"&&(r.className="ProseMirror-separator",r.alt=""),e=="BR"&&(r.className="ProseMirror-trailingBreak");let i=new mO(this.top,[],r,null);n!=this.top?n.children.push(i):n.children.splice(this.index++,0,i),this.changed=!0}}isLocked(e){return this.lock&&(e==this.lock||e.nodeType==1&&e.contains(this.lock.parentNode))}}function EH(t,e){let n=e,r=n.children.length,i=t.childCount,o=new Map,a=[];e:for(;i>0;){let c;for(;;)if(r){let f=n.children[r-1];if(f instanceof ha)n=f,r=f.children.length;else{c=f,r--;break}}else{if(n==e)break e;r=n.parent.children.indexOf(n),n=n.parent}let u=c.node;if(u){if(u!=t.child(i-1))break;--i,o.set(c,i),a.push(c)}}return{index:i,matched:o,matches:a.reverse()}}function CH(t,e){return t.type.side-e.type.side}function TH(t,e,n,r){let i=e.locals(t),o=0;if(i.length==0){for(let f=0;f<t.childCount;f++){let p=t.child(f);r(p,i,e.forChild(o,p),f),o+=p.nodeSize}return}let a=0,c=[],u=null;for(let f=0;;){let p,g;for(;a<i.length&&i[a].to==o;){let C=i[a++];C.widget&&(p?(g||(g=[p])).push(C):p=C)}if(p)if(g){g.sort(CH);for(let C=0;C<g.length;C++)n(g[C],f,!!u)}else n(p,f,!!u);let v,y;if(u)y=-1,v=u,u=null;else if(f<t.childCount)y=f,v=t.child(f++);else break;for(let C=0;C<c.length;C++)c[C].to<=o&&c.splice(C--,1);for(;a<i.length&&i[a].from<=o&&i[a].to>o;)c.push(i[a++]);let w=o+v.nodeSize;if(v.isText){let C=w;a<i.length&&i[a].from<C&&(C=i[a].from);for(let T=0;T<c.length;T++)c[T].to<C&&(C=c[T].to);C<w&&(u=v.cut(C-o),v=v.cut(0,C-o),w=C,y=-1)}else for(;a<i.length&&i[a].to<w;)a++;let S=v.isInline&&!v.isLeaf?c.filter(C=>!C.inline):c.slice();r(v,S,e.forChild(o,v),y),o=w}}function NH(t){if(t.nodeName=="UL"||t.nodeName=="OL"){let e=t.style.cssText;t.style.cssText=e+"; list-style: square !important",window.getComputedStyle(t).listStyle,t.style.cssText=e}}function AH(t,e,n,r){for(let i=0,o=0;i<t.childCount&&o<=r;){let a=t.child(i++),c=o;if(o+=a.nodeSize,!a.isText)continue;let u=a.text;for(;i<t.childCount;){let f=t.child(i++);if(o+=f.nodeSize,!f.isText)break;u+=f.text}if(o>=n){if(o>=r&&u.slice(r-e.length-c,r-c)==e)return r-e.length;let f=c<r?u.lastIndexOf(e,r-c-1):-1;if(f>=0&&f+e.length+c>=n)return c+f;if(n==r&&u.length>=r+e.length-c&&u.slice(r-c,r-c+e.length)==e)return r}}return-1}function cx(t,e,n,r,i){let o=[];for(let a=0,c=0;a<t.length;a++){let u=t[a],f=c,p=c+=u.size;f>=n||p<=e?o.push(u):(f<e&&o.push(u.slice(0,e-f,r)),i&&(o.push(i),i=void 0),p>n&&o.push(u.slice(n-f,u.size,r)))}return o}function Hb(t,e=null){let n=t.domSelectionRange(),r=t.state.doc;if(!n.focusNode)return null;let i=t.docView.nearestDesc(n.focusNode),o=i&&i.size==0,a=t.docView.posFromDOM(n.focusNode,n.focusOffset,1);if(a<0)return null;let c=r.resolve(a),u,f;if(Vp(n)){for(u=a;i&&!i.node;)i=i.parent;let g=i.node;if(i&&g.isAtom&&Je.isSelectable(g)&&i.parent&&!(g.isInline&&eH(n.focusNode,n.focusOffset,i.dom))){let v=i.posBefore;f=new Je(a==v?c:r.resolve(v))}}else{if(n instanceof t.dom.ownerDocument.defaultView.Selection&&n.rangeCount>1){let g=a,v=a;for(let y=0;y<n.rangeCount;y++){let w=n.getRangeAt(y);g=Math.min(g,t.docView.posFromDOM(w.startContainer,w.startOffset,1)),v=Math.max(v,t.docView.posFromDOM(w.endContainer,w.endOffset,-1))}if(g<0)return null;[u,a]=v==t.state.selection.anchor?[v,g]:[g,v],c=r.resolve(a)}else u=t.docView.posFromDOM(n.anchorNode,n.anchorOffset,1);if(u<0)return null}let p=r.resolve(u);if(!f){let g=e=="pointer"||t.state.selection.head<c.pos&&!o?1:-1;f=Ub(t,p,c,g)}return f}function xO(t){return t.editable?t.hasFocus():wO(t)&&document.activeElement&&document.activeElement.contains(t.dom)}function lo(t,e=!1){let n=t.state.selection;if(bO(t,n),!!xO(t)){if(!e&&t.input.mouseDown&&t.input.mouseDown.allowDefault&&$n){let r=t.domSelectionRange(),i=t.domObserver.currentSelection;if(r.anchorNode&&i.anchorNode&&fa(r.anchorNode,r.anchorOffset,i.anchorNode,i.anchorOffset)){t.input.mouseDown.delayedSelectionSync=!0,t.domObserver.setCurSelection();return}}if(t.domObserver.disconnectSelection(),t.cursorWrapper)DH(t);else{let{anchor:r,head:i}=n,o,a;yT&&!(n instanceof st)&&(n.$from.parent.inlineContent||(o=vT(t,n.from)),!n.empty&&!n.$from.parent.inlineContent&&(a=vT(t,n.to))),t.docView.setSelection(r,i,t,e),yT&&(o&&xT(o),a&&xT(a)),n.visible?t.dom.classList.remove("ProseMirror-hideselection"):(t.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&kH(t))}t.domObserver.setCurSelection(),t.domObserver.connectSelection()}}const yT=Yn||$n&&sO<63;function vT(t,e){let{node:n,offset:r}=t.docView.domFromPos(e,0),i=r<n.childNodes.length?n.childNodes[r]:null,o=r?n.childNodes[r-1]:null;if(Yn&&i&&i.contentEditable=="false")return ev(i);if((!i||i.contentEditable=="false")&&(!o||o.contentEditable=="false")){if(i)return ev(i);if(o)return ev(o)}}function ev(t){return t.contentEditable="true",Yn&&t.draggable&&(t.draggable=!1,t.wasDraggable=!0),t}function xT(t){t.contentEditable="false",t.wasDraggable&&(t.draggable=!0,t.wasDraggable=null)}function kH(t){let e=t.dom.ownerDocument;e.removeEventListener("selectionchange",t.input.hideSelectionGuard);let n=t.domSelectionRange(),r=n.anchorNode,i=n.anchorOffset;e.addEventListener("selectionchange",t.input.hideSelectionGuard=()=>{(n.anchorNode!=r||n.anchorOffset!=i)&&(e.removeEventListener("selectionchange",t.input.hideSelectionGuard),setTimeout(()=>{(!xO(t)||t.state.selection.visible)&&t.dom.classList.remove("ProseMirror-hideselection")},20))})}function DH(t){let e=t.domSelection();if(!e)return;let n=t.cursorWrapper.dom,r=n.nodeName=="IMG";r?e.collapse(n.parentNode,Bn(n)+1):e.collapse(n,0),!r&&!t.state.selection.visible&&hr&&cs<=11&&(n.disabled=!0,n.disabled=!1)}function bO(t,e){if(e instanceof Je){let n=t.docView.descAt(e.from);n!=t.lastSelectedViewDesc&&(bT(t),n&&n.selectNode(),t.lastSelectedViewDesc=n)}else bT(t)}function bT(t){t.lastSelectedViewDesc&&(t.lastSelectedViewDesc.parent&&t.lastSelectedViewDesc.deselectNode(),t.lastSelectedViewDesc=void 0)}function Ub(t,e,n,r){return t.someProp("createSelectionBetween",i=>i(t,e,n))||st.between(e,n,r)}function wT(t){return t.editable&&!t.hasFocus()?!1:wO(t)}function wO(t){let e=t.domSelectionRange();if(!e.anchorNode)return!1;try{return t.dom.contains(e.anchorNode.nodeType==3?e.anchorNode.parentNode:e.anchorNode)&&(t.editable||t.dom.contains(e.focusNode.nodeType==3?e.focusNode.parentNode:e.focusNode))}catch{return!1}}function OH(t){let e=t.docView.domFromPos(t.state.selection.anchor,0),n=t.domSelectionRange();return fa(e.node,e.offset,n.anchorNode,n.anchorOffset)}function ux(t,e){let{$anchor:n,$head:r}=t.selection,i=e>0?n.max(r):n.min(r),o=i.parent.inlineContent?i.depth?t.doc.resolve(e>0?i.after():i.before()):null:i;return o&&xt.findFrom(o,e)}function Xo(t,e){return t.dispatch(t.state.tr.setSelection(e).scrollIntoView()),!0}function ST(t,e,n){let r=t.state.selection;if(r instanceof st)if(n.indexOf("s")>-1){let{$head:i}=r,o=i.textOffset?null:e<0?i.nodeBefore:i.nodeAfter;if(!o||o.isText||!o.isLeaf)return!1;let a=t.state.doc.resolve(i.pos+o.nodeSize*(e<0?-1:1));return Xo(t,new st(r.$anchor,a))}else if(r.empty){if(t.endOfTextblock(e>0?"forward":"backward")){let i=ux(t.state,e);return i&&i instanceof Je?Xo(t,i):!1}else if(!(Hr&&n.indexOf("m")>-1)){let i=r.$head,o=i.textOffset?null:e<0?i.nodeBefore:i.nodeAfter,a;if(!o||o.isText)return!1;let c=e<0?i.pos-o.nodeSize:i.pos;return o.isAtom||(a=t.docView.descAt(c))&&!a.contentDOM?Je.isSelectable(o)?Xo(t,new Je(e<0?t.state.doc.resolve(i.pos-o.nodeSize):i)):td?Xo(t,new st(t.state.doc.resolve(e<0?c:c+o.nodeSize))):!1:!1}}else return!1;else{if(r instanceof Je&&r.node.isInline)return Xo(t,new st(e>0?r.$to:r.$from));{let i=ux(t.state,e);return i?Xo(t,i):!1}}}function Dh(t){return t.nodeType==3?t.nodeValue.length:t.childNodes.length}function mu(t,e){let n=t.pmViewDesc;return n&&n.size==0&&(e<0||t.nextSibling||t.nodeName!="BR")}function dl(t,e){return e<0?MH(t):RH(t)}function MH(t){let e=t.domSelectionRange(),n=e.focusNode,r=e.focusOffset;if(!n)return;let i,o,a=!1;for(qr&&n.nodeType==1&&r<Dh(n)&&mu(n.childNodes[r],-1)&&(a=!0);;)if(r>0){if(n.nodeType!=1)break;{let c=n.childNodes[r-1];if(mu(c,-1))i=n,o=--r;else if(c.nodeType==3)n=c,r=n.nodeValue.length;else break}}else{if(SO(n))break;{let c=n.previousSibling;for(;c&&mu(c,-1);)i=n.parentNode,o=Bn(c),c=c.previousSibling;if(c)n=c,r=Dh(n);else{if(n=n.parentNode,n==t.dom)break;r=0}}}a?dx(t,n,r):i&&dx(t,i,o)}function RH(t){let e=t.domSelectionRange(),n=e.focusNode,r=e.focusOffset;if(!n)return;let i=Dh(n),o,a;for(;;)if(r<i){if(n.nodeType!=1)break;let c=n.childNodes[r];if(mu(c,1))o=n,a=++r;else break}else{if(SO(n))break;{let c=n.nextSibling;for(;c&&mu(c,1);)o=c.parentNode,a=Bn(c)+1,c=c.nextSibling;if(c)n=c,r=0,i=Dh(n);else{if(n=n.parentNode,n==t.dom)break;r=i=0}}}o&&dx(t,o,a)}function SO(t){let e=t.pmViewDesc;return e&&e.node&&e.node.isBlock}function jH(t,e){for(;t&&e==t.childNodes.length&&!ed(t);)e=Bn(t)+1,t=t.parentNode;for(;t&&e<t.childNodes.length;){let n=t.childNodes[e];if(n.nodeType==3)return n;if(n.nodeType==1&&n.contentEditable=="false")break;t=n,e=0}}function IH(t,e){for(;t&&!e&&!ed(t);)e=Bn(t),t=t.parentNode;for(;t&&e;){let n=t.childNodes[e-1];if(n.nodeType==3)return n;if(n.nodeType==1&&n.contentEditable=="false")break;t=n,e=t.childNodes.length}}function dx(t,e,n){if(e.nodeType!=3){let o,a;(a=jH(e,n))?(e=a,n=0):(o=IH(e,n))&&(e=o,n=o.nodeValue.length)}let r=t.domSelection();if(!r)return;if(Vp(r)){let o=document.createRange();o.setEnd(e,n),o.setStart(e,n),r.removeAllRanges(),r.addRange(o)}else r.extend&&r.extend(e,n);t.domObserver.setCurSelection();let{state:i}=t;setTimeout(()=>{t.state==i&&lo(t)},50)}function ET(t,e){let n=t.state.doc.resolve(e);if(!($n||aO)&&n.parent.inlineContent){let i=t.coordsAtPos(e);if(e>n.start()){let o=t.coordsAtPos(e-1),a=(o.top+o.bottom)/2;if(a>i.top&&a<i.bottom&&Math.abs(o.left-i.left)>1)return o.left<i.left?"ltr":"rtl"}if(e<n.end()){let o=t.coordsAtPos(e+1),a=(o.top+o.bottom)/2;if(a>i.top&&a<i.bottom&&Math.abs(o.left-i.left)>1)return o.left>i.left?"ltr":"rtl"}}return getComputedStyle(t.dom).direction=="rtl"?"rtl":"ltr"}function CT(t,e,n){let r=t.state.selection;if(r instanceof st&&!r.empty||n.indexOf("s")>-1||Hr&&n.indexOf("m")>-1)return!1;let{$from:i,$to:o}=r;if(!i.parent.inlineContent||t.endOfTextblock(e<0?"up":"down")){let a=ux(t.state,e);if(a&&a instanceof Je)return Xo(t,a)}if(!i.parent.inlineContent){let a=e<0?i:o,c=r instanceof kr?xt.near(a,e):xt.findFrom(a,e);return c?Xo(t,c):!1}return!1}function TT(t,e){if(!(t.state.selection instanceof st))return!0;let{$head:n,$anchor:r,empty:i}=t.state.selection;if(!n.sameParent(r))return!0;if(!i)return!1;if(t.endOfTextblock(e>0?"forward":"backward"))return!0;let o=!n.textOffset&&(e<0?n.nodeBefore:n.nodeAfter);if(o&&!o.isText){let a=t.state.tr;return e<0?a.delete(n.pos-o.nodeSize,n.pos):a.delete(n.pos,n.pos+o.nodeSize),t.dispatch(a),!0}return!1}function NT(t,e,n){t.domObserver.stop(),e.contentEditable=n,t.domObserver.start()}function _H(t){if(!Yn||t.state.selection.$head.parentOffset>0)return!1;let{focusNode:e,focusOffset:n}=t.domSelectionRange();if(e&&e.nodeType==1&&n==0&&e.firstChild&&e.firstChild.contentEditable=="false"){let r=e.firstChild;NT(t,r,"true"),setTimeout(()=>NT(t,r,"false"),20)}return!1}function LH(t){let e="";return t.ctrlKey&&(e+="c"),t.metaKey&&(e+="m"),t.altKey&&(e+="a"),t.shiftKey&&(e+="s"),e}function PH(t,e){let n=e.keyCode,r=LH(e);if(n==8||Hr&&n==72&&r=="c")return TT(t,-1)||dl(t,-1);if(n==46&&!e.shiftKey||Hr&&n==68&&r=="c")return TT(t,1)||dl(t,1);if(n==13||n==27)return!0;if(n==37||Hr&&n==66&&r=="c"){let i=n==37?ET(t,t.state.selection.from)=="ltr"?-1:1:-1;return ST(t,i,r)||dl(t,i)}else if(n==39||Hr&&n==70&&r=="c"){let i=n==39?ET(t,t.state.selection.from)=="ltr"?1:-1:1;return ST(t,i,r)||dl(t,i)}else{if(n==38||Hr&&n==80&&r=="c")return CT(t,-1,r)||dl(t,-1);if(n==40||Hr&&n==78&&r=="c")return _H(t)||CT(t,1,r)||dl(t,1);if(r==(Hr?"m":"c")&&(n==66||n==73||n==89||n==90))return!0}return!1}function Vb(t,e){t.someProp("transformCopied",y=>{e=y(e,t)});let n=[],{content:r,openStart:i,openEnd:o}=e;for(;i>1&&o>1&&r.childCount==1&&r.firstChild.childCount==1;){i--,o--;let y=r.firstChild;n.push(y.type.name,y.attrs!=y.type.defaultAttrs?y.attrs:null),r=y.content}let a=t.someProp("clipboardSerializer")||ya.fromSchema(t.state.schema),c=kO(),u=c.createElement("div");u.appendChild(a.serializeFragment(r,{document:c}));let f=u.firstChild,p,g=0;for(;f&&f.nodeType==1&&(p=AO[f.nodeName.toLowerCase()]);){for(let y=p.length-1;y>=0;y--){let w=c.createElement(p[y]);for(;u.firstChild;)w.appendChild(u.firstChild);u.appendChild(w),g++}f=u.firstChild}f&&f.nodeType==1&&f.setAttribute("data-pm-slice",`${i} ${o}${g?` -${g}`:""} ${JSON.stringify(n)}`);let v=t.someProp("clipboardTextSerializer",y=>y(e,t))||e.content.textBetween(0,e.content.size,`

`);return{dom:u,text:v,slice:e}}function EO(t,e,n,r,i){let o=i.parent.type.spec.code,a,c;if(!n&&!e)return null;let u=!!e&&(r||o||!n);if(u){if(t.someProp("transformPastedText",v=>{e=v(e,o||r,t)}),o)return c=new je(Ee.from(t.state.schema.text(e.replace(/\r\n?/g,`
`))),0,0),t.someProp("transformPasted",v=>{c=v(c,t,!0)}),c;let g=t.someProp("clipboardTextParser",v=>v(e,i,r,t));if(g)c=g;else{let v=i.marks(),{schema:y}=t.state,w=ya.fromSchema(y);a=document.createElement("div"),e.split(/(?:\r\n?|\n)+/).forEach(S=>{let C=a.appendChild(document.createElement("p"));S&&C.appendChild(w.serializeNode(y.text(S,v)))})}}else t.someProp("transformPastedHTML",g=>{n=g(n,t)}),a=$H(n),td&&HH(a);let f=a&&a.querySelector("[data-pm-slice]"),p=f&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(f.getAttribute("data-pm-slice")||"");if(p&&p[3])for(let g=+p[3];g>0;g--){let v=a.firstChild;for(;v&&v.nodeType!=1;)v=v.nextSibling;if(!v)break;a=v}if(c||(c=(t.someProp("clipboardParser")||t.someProp("domParser")||ls.fromSchema(t.state.schema)).parseSlice(a,{preserveWhitespace:!!(u||p),context:i,ruleFromNode(v){return v.nodeName=="BR"&&!v.nextSibling&&v.parentNode&&!zH.test(v.parentNode.nodeName)?{ignore:!0}:null}})),p)c=UH(AT(c,+p[1],+p[2]),p[4]);else if(c=je.maxOpen(BH(c.content,i),!0),c.openStart||c.openEnd){let g=0,v=0;for(let y=c.content.firstChild;g<c.openStart&&!y.type.spec.isolating;g++,y=y.firstChild);for(let y=c.content.lastChild;v<c.openEnd&&!y.type.spec.isolating;v++,y=y.lastChild);c=AT(c,g,v)}return t.someProp("transformPasted",g=>{c=g(c,t,u)}),c}const zH=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function BH(t,e){if(t.childCount<2)return t;for(let n=e.depth;n>=0;n--){let i=e.node(n).contentMatchAt(e.index(n)),o,a=[];if(t.forEach(c=>{if(!a)return;let u=i.findWrapping(c.type),f;if(!u)return a=null;if(f=a.length&&o.length&&TO(u,o,c,a[a.length-1],0))a[a.length-1]=f;else{a.length&&(a[a.length-1]=NO(a[a.length-1],o.length));let p=CO(c,u);a.push(p),i=i.matchType(p.type),o=u}}),a)return Ee.from(a)}return t}function CO(t,e,n=0){for(let r=e.length-1;r>=n;r--)t=e[r].create(null,Ee.from(t));return t}function TO(t,e,n,r,i){if(i<t.length&&i<e.length&&t[i]==e[i]){let o=TO(t,e,n,r.lastChild,i+1);if(o)return r.copy(r.content.replaceChild(r.childCount-1,o));if(r.contentMatchAt(r.childCount).matchType(i==t.length-1?n.type:t[i+1]))return r.copy(r.content.append(Ee.from(CO(n,t,i+1))))}}function NO(t,e){if(e==0)return t;let n=t.content.replaceChild(t.childCount-1,NO(t.lastChild,e-1)),r=t.contentMatchAt(t.childCount).fillBefore(Ee.empty,!0);return t.copy(n.append(r))}function fx(t,e,n,r,i,o){let a=e<0?t.firstChild:t.lastChild,c=a.content;return t.childCount>1&&(o=0),i<r-1&&(c=fx(c,e,n,r,i+1,o)),i>=n&&(c=e<0?a.contentMatchAt(0).fillBefore(c,o<=i).append(c):c.append(a.contentMatchAt(a.childCount).fillBefore(Ee.empty,!0))),t.replaceChild(e<0?0:t.childCount-1,a.copy(c))}function AT(t,e,n){return e<t.openStart&&(t=new je(fx(t.content,-1,e,t.openStart,0,t.openEnd),e,t.openEnd)),n<t.openEnd&&(t=new je(fx(t.content,1,n,t.openEnd,0,0),t.openStart,n)),t}const AO={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let kT=null;function kO(){return kT||(kT=document.implementation.createHTMLDocument("title"))}let tv=null;function FH(t){let e=window.trustedTypes;return e?(tv||(tv=e.defaultPolicy||e.createPolicy("ProseMirrorClipboard",{createHTML:n=>n})),tv.createHTML(t)):t}function $H(t){let e=/^(\s*<meta [^>]*>)*/.exec(t);e&&(t=t.slice(e[0].length));let n=kO().createElement("div"),r=/<([a-z][^>\s]+)/i.exec(t),i;if((i=r&&AO[r[1].toLowerCase()])&&(t=i.map(o=>"<"+o+">").join("")+t+i.map(o=>"</"+o+">").reverse().join("")),n.innerHTML=FH(t),i)for(let o=0;o<i.length;o++)n=n.querySelector(i[o])||n;return n}function HH(t){let e=t.querySelectorAll($n?"span:not([class]):not([style])":"span.Apple-converted-space");for(let n=0;n<e.length;n++){let r=e[n];r.childNodes.length==1&&r.textContent==""&&r.parentNode&&r.parentNode.replaceChild(t.ownerDocument.createTextNode(" "),r)}}function UH(t,e){if(!t.size)return t;let n=t.content.firstChild.type.schema,r;try{r=JSON.parse(e)}catch{return t}let{content:i,openStart:o,openEnd:a}=t;for(let c=r.length-2;c>=0;c-=2){let u=n.nodes[r[c]];if(!u||u.hasRequiredAttrs())break;i=Ee.from(u.create(r[c+1],i)),o++,a++}return new je(i,o,a)}const Zn={},er={},VH={touchstart:!0,touchmove:!0};class qH{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:"",button:0},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastChromeDelete=0,this.composing=!1,this.compositionNode=null,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.badSafariComposition=!1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function GH(t){for(let e in Zn){let n=Zn[e];t.dom.addEventListener(e,t.input.eventHandlers[e]=r=>{YH(t,r)&&!qb(t,r)&&(t.editable||!(r.type in er))&&n(t,r)},VH[e]?{passive:!0}:void 0)}Yn&&t.dom.addEventListener("input",()=>null),hx(t)}function rs(t,e){t.input.lastSelectionOrigin=e,t.input.lastSelectionTime=Date.now()}function WH(t){t.domObserver.stop();for(let e in t.input.eventHandlers)t.dom.removeEventListener(e,t.input.eventHandlers[e]);clearTimeout(t.input.composingTimeout),clearTimeout(t.input.lastIOSEnterFallbackTimeout)}function hx(t){t.someProp("handleDOMEvents",e=>{for(let n in e)t.input.eventHandlers[n]||t.dom.addEventListener(n,t.input.eventHandlers[n]=r=>qb(t,r))})}function qb(t,e){return t.someProp("handleDOMEvents",n=>{let r=n[e.type];return r?r(t,e)||e.defaultPrevented:!1})}function YH(t,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let n=e.target;n!=t.dom;n=n.parentNode)if(!n||n.nodeType==11||n.pmViewDesc&&n.pmViewDesc.stopEvent(e))return!1;return!0}function KH(t,e){!qb(t,e)&&Zn[e.type]&&(t.editable||!(e.type in er))&&Zn[e.type](t,e)}er.keydown=(t,e)=>{let n=e;if(t.input.shiftKey=n.keyCode==16||n.shiftKey,!OO(t,n)&&(t.input.lastKeyCode=n.keyCode,t.input.lastKeyCodeTime=Date.now(),!(so&&$n&&n.keyCode==13)))if(n.keyCode!=229&&t.domObserver.forceFlush(),Rl&&n.keyCode==13&&!n.ctrlKey&&!n.altKey&&!n.metaKey){let r=Date.now();t.input.lastIOSEnter=r,t.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{t.input.lastIOSEnter==r&&(t.someProp("handleKeyDown",i=>i(t,Ys(13,"Enter"))),t.input.lastIOSEnter=0)},200)}else t.someProp("handleKeyDown",r=>r(t,n))||PH(t,n)?n.preventDefault():rs(t,"key")};er.keyup=(t,e)=>{e.keyCode==16&&(t.input.shiftKey=!1)};er.keypress=(t,e)=>{let n=e;if(OO(t,n)||!n.charCode||n.ctrlKey&&!n.altKey||Hr&&n.metaKey)return;if(t.someProp("handleKeyPress",i=>i(t,n))){n.preventDefault();return}let r=t.state.selection;if(!(r instanceof st)||!r.$from.sameParent(r.$to)){let i=String.fromCharCode(n.charCode),o=()=>t.state.tr.insertText(i).scrollIntoView();!/[\r\n]/.test(i)&&!t.someProp("handleTextInput",a=>a(t,r.$from.pos,r.$to.pos,i,o))&&t.dispatch(o()),n.preventDefault()}};function Gp(t){return{left:t.clientX,top:t.clientY}}function XH(t,e){let n=e.x-t.clientX,r=e.y-t.clientY;return n*n+r*r<100}function Gb(t,e,n,r,i){if(r==-1)return!1;let o=t.state.doc.resolve(r);for(let a=o.depth+1;a>0;a--)if(t.someProp(e,c=>a>o.depth?c(t,n,o.nodeAfter,o.before(a),i,!0):c(t,n,o.node(a),o.before(a),i,!1)))return!0;return!1}function Cl(t,e,n){if(t.focused||t.focus(),t.state.selection.eq(e))return;let r=t.state.tr.setSelection(e);r.setMeta("pointer",!0),t.dispatch(r)}function JH(t,e){if(e==-1)return!1;let n=t.state.doc.resolve(e),r=n.nodeAfter;return r&&r.isAtom&&Je.isSelectable(r)?(Cl(t,new Je(n)),!0):!1}function QH(t,e){if(e==-1)return!1;let n=t.state.selection,r,i;n instanceof Je&&(r=n.node);let o=t.state.doc.resolve(e);for(let a=o.depth+1;a>0;a--){let c=a>o.depth?o.nodeAfter:o.node(a);if(Je.isSelectable(c)){r&&n.$from.depth>0&&a>=n.$from.depth&&o.before(n.$from.depth+1)==n.$from.pos?i=o.before(n.$from.depth):i=o.before(a);break}}return i!=null?(Cl(t,Je.create(t.state.doc,i)),!0):!1}function ZH(t,e,n,r,i){return Gb(t,"handleClickOn",e,n,r)||t.someProp("handleClick",o=>o(t,e,r))||(i?QH(t,n):JH(t,n))}function eU(t,e,n,r){return Gb(t,"handleDoubleClickOn",e,n,r)||t.someProp("handleDoubleClick",i=>i(t,e,r))}function tU(t,e,n,r){return Gb(t,"handleTripleClickOn",e,n,r)||t.someProp("handleTripleClick",i=>i(t,e,r))||nU(t,n,r)}function nU(t,e,n){if(n.button!=0)return!1;let r=t.state.doc;if(e==-1)return r.inlineContent?(Cl(t,st.create(r,0,r.content.size)),!0):!1;let i=r.resolve(e);for(let o=i.depth+1;o>0;o--){let a=o>i.depth?i.nodeAfter:i.node(o),c=i.before(o);if(a.inlineContent)Cl(t,st.create(r,c+1,c+1+a.content.size));else if(Je.isSelectable(a))Cl(t,Je.create(r,c));else continue;return!0}}function Wb(t){return Oh(t)}const DO=Hr?"metaKey":"ctrlKey";Zn.mousedown=(t,e)=>{let n=e;t.input.shiftKey=n.shiftKey;let r=Wb(t),i=Date.now(),o="singleClick";i-t.input.lastClick.time<500&&XH(n,t.input.lastClick)&&!n[DO]&&t.input.lastClick.button==n.button&&(t.input.lastClick.type=="singleClick"?o="doubleClick":t.input.lastClick.type=="doubleClick"&&(o="tripleClick")),t.input.lastClick={time:i,x:n.clientX,y:n.clientY,type:o,button:n.button};let a=t.posAtCoords(Gp(n));a&&(o=="singleClick"?(t.input.mouseDown&&t.input.mouseDown.done(),t.input.mouseDown=new rU(t,a,n,!!r)):(o=="doubleClick"?eU:tU)(t,a.pos,a.inside,n)?n.preventDefault():rs(t,"pointer"))};class rU{constructor(e,n,r,i){this.view=e,this.pos=n,this.event=r,this.flushed=i,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=e.state.doc,this.selectNode=!!r[DO],this.allowDefault=r.shiftKey;let o,a;if(n.inside>-1)o=e.state.doc.nodeAt(n.inside),a=n.inside;else{let p=e.state.doc.resolve(n.pos);o=p.parent,a=p.depth?p.before():0}const c=i?null:r.target,u=c?e.docView.nearestDesc(c,!0):null;this.target=u&&u.nodeDOM.nodeType==1?u.nodeDOM:null;let{selection:f}=e.state;(r.button==0&&o.type.spec.draggable&&o.type.spec.selectable!==!1||f instanceof Je&&f.from<=a&&f.to>a)&&(this.mightDrag={node:o,pos:a,addAttr:!!(this.target&&!this.target.draggable),setUneditable:!!(this.target&&qr&&!this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),e.root.addEventListener("mouseup",this.up=this.up.bind(this)),e.root.addEventListener("mousemove",this.move=this.move.bind(this)),rs(e,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>lo(this.view)),this.view.input.mouseDown=null}up(e){if(this.done(),!this.view.dom.contains(e.target))return;let n=this.pos;this.view.state.doc!=this.startDoc&&(n=this.view.posAtCoords(Gp(e))),this.updateAllowDefault(e),this.allowDefault||!n?rs(this.view,"pointer"):ZH(this.view,n.pos,n.inside,e,this.selectNode)?e.preventDefault():e.button==0&&(this.flushed||Yn&&this.mightDrag&&!this.mightDrag.node.isAtom||$n&&!this.view.state.selection.visible&&Math.min(Math.abs(n.pos-this.view.state.selection.from),Math.abs(n.pos-this.view.state.selection.to))<=2)?(Cl(this.view,xt.near(this.view.state.doc.resolve(n.pos))),e.preventDefault()):rs(this.view,"pointer")}move(e){this.updateAllowDefault(e),rs(this.view,"pointer"),e.buttons==0&&this.done()}updateAllowDefault(e){!this.allowDefault&&(Math.abs(this.event.x-e.clientX)>4||Math.abs(this.event.y-e.clientY)>4)&&(this.allowDefault=!0)}}Zn.touchstart=t=>{t.input.lastTouch=Date.now(),Wb(t),rs(t,"pointer")};Zn.touchmove=t=>{t.input.lastTouch=Date.now(),rs(t,"pointer")};Zn.contextmenu=t=>Wb(t);function OO(t,e){return t.composing?!0:Yn&&Math.abs(e.timeStamp-t.input.compositionEndedAt)<500?(t.input.compositionEndedAt=-2e8,!0):!1}const iU=so?5e3:-1;er.compositionstart=er.compositionupdate=t=>{if(!t.composing){t.domObserver.flush();let{state:e}=t,n=e.selection.$to;if(e.selection instanceof st&&(e.storedMarks||!n.textOffset&&n.parentOffset&&n.nodeBefore.marks.some(r=>r.type.spec.inclusive===!1)||$n&&aO&&oU(t)))t.markCursor=t.state.storedMarks||n.marks(),Oh(t,!0),t.markCursor=null;else if(Oh(t,!e.selection.empty),qr&&e.selection.empty&&n.parentOffset&&!n.textOffset&&n.nodeBefore.marks.length){let r=t.domSelectionRange();for(let i=r.focusNode,o=r.focusOffset;i&&i.nodeType==1&&o!=0;){let a=o<0?i.lastChild:i.childNodes[o-1];if(!a)break;if(a.nodeType==3){let c=t.domSelection();c&&c.collapse(a,a.nodeValue.length);break}else i=a,o=-1}}t.input.composing=!0}MO(t,iU)};function oU(t){let{focusNode:e,focusOffset:n}=t.domSelectionRange();if(!e||e.nodeType!=1||n>=e.childNodes.length)return!1;let r=e.childNodes[n];return r.nodeType==1&&r.contentEditable=="false"}er.compositionend=(t,e)=>{t.composing&&(t.input.composing=!1,t.input.compositionEndedAt=e.timeStamp,t.input.compositionPendingChanges=t.domObserver.pendingRecords().length?t.input.compositionID:0,t.input.compositionNode=null,t.input.badSafariComposition?t.domObserver.forceFlush():t.input.compositionPendingChanges&&Promise.resolve().then(()=>t.domObserver.flush()),t.input.compositionID++,MO(t,20))};function MO(t,e){clearTimeout(t.input.composingTimeout),e>-1&&(t.input.composingTimeout=setTimeout(()=>Oh(t),e))}function RO(t){for(t.composing&&(t.input.composing=!1,t.input.compositionEndedAt=aU());t.input.compositionNodes.length>0;)t.input.compositionNodes.pop().markParentsDirty()}function sU(t){let e=t.domSelectionRange();if(!e.focusNode)return null;let n=Q$(e.focusNode,e.focusOffset),r=Z$(e.focusNode,e.focusOffset);if(n&&r&&n!=r){let i=r.pmViewDesc,o=t.domObserver.lastChangedTextNode;if(n==o||r==o)return o;if(!i||!i.isText(r.nodeValue))return r;if(t.input.compositionNode==r){let a=n.pmViewDesc;if(!(!a||!a.isText(n.nodeValue)))return r}}return n||r}function aU(){let t=document.createEvent("Event");return t.initEvent("event",!0,!0),t.timeStamp}function Oh(t,e=!1){if(!(so&&t.domObserver.flushingSoon>=0)){if(t.domObserver.forceFlush(),RO(t),e||t.docView&&t.docView.dirty){let n=Hb(t),r=t.state.selection;return n&&!n.eq(r)?t.dispatch(t.state.tr.setSelection(n)):(t.markCursor||e)&&!r.$from.node(r.$from.sharedDepth(r.to)).inlineContent?t.dispatch(t.state.tr.deleteSelection()):t.updateState(t.state),!0}return!1}}function lU(t,e){if(!t.dom.parentNode)return;let n=t.dom.parentNode.appendChild(document.createElement("div"));n.appendChild(e),n.style.cssText="position: fixed; left: -10000px; top: 10px";let r=getSelection(),i=document.createRange();i.selectNodeContents(e),t.dom.blur(),r.removeAllRanges(),r.addRange(i),setTimeout(()=>{n.parentNode&&n.parentNode.removeChild(n),t.focus()},50)}const Ru=hr&&cs<15||Rl&&rH<604;Zn.copy=er.cut=(t,e)=>{let n=e,r=t.state.selection,i=n.type=="cut";if(r.empty)return;let o=Ru?null:n.clipboardData,a=r.content(),{dom:c,text:u}=Vb(t,a);o?(n.preventDefault(),o.clearData(),o.setData("text/html",c.innerHTML),o.setData("text/plain",u)):lU(t,c),i&&t.dispatch(t.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))};function cU(t){return t.openStart==0&&t.openEnd==0&&t.content.childCount==1?t.content.firstChild:null}function uU(t,e){if(!t.dom.parentNode)return;let n=t.input.shiftKey||t.state.selection.$from.parent.type.spec.code,r=t.dom.parentNode.appendChild(document.createElement(n?"textarea":"div"));n||(r.contentEditable="true"),r.style.cssText="position: fixed; left: -10000px; top: 10px",r.focus();let i=t.input.shiftKey&&t.input.lastKeyCode!=45;setTimeout(()=>{t.focus(),r.parentNode&&r.parentNode.removeChild(r),n?ju(t,r.value,null,i,e):ju(t,r.textContent,r.innerHTML,i,e)},50)}function ju(t,e,n,r,i){let o=EO(t,e,n,r,t.state.selection.$from);if(t.someProp("handlePaste",u=>u(t,i,o||je.empty)))return!0;if(!o)return!1;let a=cU(o),c=a?t.state.tr.replaceSelectionWith(a,r):t.state.tr.replaceSelection(o);return t.dispatch(c.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function jO(t){let e=t.getData("text/plain")||t.getData("Text");if(e)return e;let n=t.getData("text/uri-list");return n?n.replace(/\r?\n/g," "):""}er.paste=(t,e)=>{let n=e;if(t.composing&&!so)return;let r=Ru?null:n.clipboardData,i=t.input.shiftKey&&t.input.lastKeyCode!=45;r&&ju(t,jO(r),r.getData("text/html"),i,n)?n.preventDefault():uU(t,n)};class IO{constructor(e,n,r){this.slice=e,this.move=n,this.node=r}}const dU=Hr?"altKey":"ctrlKey";function _O(t,e){let n=t.someProp("dragCopies",r=>!r(e));return n??!e[dU]}Zn.dragstart=(t,e)=>{let n=e,r=t.input.mouseDown;if(r&&r.done(),!n.dataTransfer)return;let i=t.state.selection,o=i.empty?null:t.posAtCoords(Gp(n)),a;if(!(o&&o.pos>=i.from&&o.pos<=(i instanceof Je?i.to-1:i.to))){if(r&&r.mightDrag)a=Je.create(t.state.doc,r.mightDrag.pos);else if(n.target&&n.target.nodeType==1){let g=t.docView.nearestDesc(n.target,!0);g&&g.node.type.spec.draggable&&g!=t.docView&&(a=Je.create(t.state.doc,g.posBefore))}}let c=(a||t.state.selection).content(),{dom:u,text:f,slice:p}=Vb(t,c);(!n.dataTransfer.files.length||!$n||sO>120)&&n.dataTransfer.clearData(),n.dataTransfer.setData(Ru?"Text":"text/html",u.innerHTML),n.dataTransfer.effectAllowed="copyMove",Ru||n.dataTransfer.setData("text/plain",f),t.dragging=new IO(p,_O(t,n),a)};Zn.dragend=t=>{let e=t.dragging;window.setTimeout(()=>{t.dragging==e&&(t.dragging=null)},50)};er.dragover=er.dragenter=(t,e)=>e.preventDefault();er.drop=(t,e)=>{try{fU(t,e,t.dragging)}finally{t.dragging=null}};function fU(t,e,n){if(!e.dataTransfer)return;let r=t.posAtCoords(Gp(e));if(!r)return;let i=t.state.doc.resolve(r.pos),o=n&&n.slice;o?t.someProp("transformPasted",y=>{o=y(o,t,!1)}):o=EO(t,jO(e.dataTransfer),Ru?null:e.dataTransfer.getData("text/html"),!1,i);let a=!!(n&&_O(t,e));if(t.someProp("handleDrop",y=>y(t,e,o||je.empty,a))){e.preventDefault();return}if(!o)return;e.preventDefault();let c=o?BD(t.state.doc,i.pos,o):i.pos;c==null&&(c=i.pos);let u=t.state.tr;if(a){let{node:y}=n;y?y.replace(u):u.deleteSelection()}let f=u.mapping.map(c),p=o.openStart==0&&o.openEnd==0&&o.content.childCount==1,g=u.doc;if(p?u.replaceRangeWith(f,f,o.content.firstChild):u.replaceRange(f,f,o),u.doc.eq(g))return;let v=u.doc.resolve(f);if(p&&Je.isSelectable(o.content.firstChild)&&v.nodeAfter&&v.nodeAfter.sameMarkup(o.content.firstChild))u.setSelection(new Je(v));else{let y=u.mapping.map(c);u.mapping.maps[u.mapping.maps.length-1].forEach((w,S,C,T)=>y=T),u.setSelection(Ub(t,v,u.doc.resolve(y)))}t.focus(),t.dispatch(u.setMeta("uiEvent","drop"))}Zn.focus=t=>{t.input.lastFocus=Date.now(),t.focused||(t.domObserver.stop(),t.dom.classList.add("ProseMirror-focused"),t.domObserver.start(),t.focused=!0,setTimeout(()=>{t.docView&&t.hasFocus()&&!t.domObserver.currentSelection.eq(t.domSelectionRange())&&lo(t)},20))};Zn.blur=(t,e)=>{let n=e;t.focused&&(t.domObserver.stop(),t.dom.classList.remove("ProseMirror-focused"),t.domObserver.start(),n.relatedTarget&&t.dom.contains(n.relatedTarget)&&t.domObserver.currentSelection.clear(),t.focused=!1)};Zn.beforeinput=(t,e)=>{if($n&&so&&e.inputType=="deleteContentBackward"){t.domObserver.flushSoon();let{domChangeCount:r}=t.input;setTimeout(()=>{if(t.input.domChangeCount!=r||(t.dom.blur(),t.focus(),t.someProp("handleKeyDown",o=>o(t,Ys(8,"Backspace")))))return;let{$cursor:i}=t.state.selection;i&&i.pos>0&&t.dispatch(t.state.tr.delete(i.pos-1,i.pos).scrollIntoView())},50)}};for(let t in er)Zn[t]=er[t];function Iu(t,e){if(t==e)return!0;for(let n in t)if(t[n]!==e[n])return!1;for(let n in e)if(!(n in t))return!1;return!0}class Mh{constructor(e,n){this.toDOM=e,this.spec=n||ta,this.side=this.spec.side||0}map(e,n,r,i){let{pos:o,deleted:a}=e.mapResult(n.from+i,this.side<0?-1:1);return a?null:new Gn(o-r,o-r,this)}valid(){return!0}eq(e){return this==e||e instanceof Mh&&(this.spec.key&&this.spec.key==e.spec.key||this.toDOM==e.toDOM&&Iu(this.spec,e.spec))}destroy(e){this.spec.destroy&&this.spec.destroy(e)}}class ds{constructor(e,n){this.attrs=e,this.spec=n||ta}map(e,n,r,i){let o=e.map(n.from+i,this.spec.inclusiveStart?-1:1)-r,a=e.map(n.to+i,this.spec.inclusiveEnd?1:-1)-r;return o>=a?null:new Gn(o,a,this)}valid(e,n){return n.from<n.to}eq(e){return this==e||e instanceof ds&&Iu(this.attrs,e.attrs)&&Iu(this.spec,e.spec)}static is(e){return e.type instanceof ds}destroy(){}}class Yb{constructor(e,n){this.attrs=e,this.spec=n||ta}map(e,n,r,i){let o=e.mapResult(n.from+i,1);if(o.deleted)return null;let a=e.mapResult(n.to+i,-1);return a.deleted||a.pos<=o.pos?null:new Gn(o.pos-r,a.pos-r,this)}valid(e,n){let{index:r,offset:i}=e.content.findIndex(n.from),o;return i==n.from&&!(o=e.child(r)).isText&&i+o.nodeSize==n.to}eq(e){return this==e||e instanceof Yb&&Iu(this.attrs,e.attrs)&&Iu(this.spec,e.spec)}destroy(){}}class Gn{constructor(e,n,r){this.from=e,this.to=n,this.type=r}copy(e,n){return new Gn(e,n,this.type)}eq(e,n=0){return this.type.eq(e.type)&&this.from+n==e.from&&this.to+n==e.to}map(e,n,r){return this.type.map(e,this,n,r)}static widget(e,n,r){return new Gn(e,e,new Mh(n,r))}static inline(e,n,r,i){return new Gn(e,n,new ds(r,i))}static node(e,n,r,i){return new Gn(e,n,new Yb(r,i))}get spec(){return this.type.spec}get inline(){return this.type instanceof ds}get widget(){return this.type instanceof Mh}}const ml=[],ta={};class tn{constructor(e,n){this.local=e.length?e:ml,this.children=n.length?n:ml}static create(e,n){return n.length?Rh(n,e,0,ta):Vn}find(e,n,r){let i=[];return this.findInner(e??0,n??1e9,i,0,r),i}findInner(e,n,r,i,o){for(let a=0;a<this.local.length;a++){let c=this.local[a];c.from<=n&&c.to>=e&&(!o||o(c.spec))&&r.push(c.copy(c.from+i,c.to+i))}for(let a=0;a<this.children.length;a+=3)if(this.children[a]<n&&this.children[a+1]>e){let c=this.children[a]+1;this.children[a+2].findInner(e-c,n-c,r,i+c,o)}}map(e,n,r){return this==Vn||e.maps.length==0?this:this.mapInner(e,n,0,0,r||ta)}mapInner(e,n,r,i,o){let a;for(let c=0;c<this.local.length;c++){let u=this.local[c].map(e,r,i);u&&u.type.valid(n,u)?(a||(a=[])).push(u):o.onRemove&&o.onRemove(this.local[c].spec)}return this.children.length?hU(this.children,a||[],e,n,r,i,o):a?new tn(a.sort(na),ml):Vn}add(e,n){return n.length?this==Vn?tn.create(e,n):this.addInner(e,n,0):this}addInner(e,n,r){let i,o=0;e.forEach((c,u)=>{let f=u+r,p;if(p=PO(n,c,f)){for(i||(i=this.children.slice());o<i.length&&i[o]<u;)o+=3;i[o]==u?i[o+2]=i[o+2].addInner(c,p,f+1):i.splice(o,0,u,u+c.nodeSize,Rh(p,c,f+1,ta)),o+=3}});let a=LO(o?zO(n):n,-r);for(let c=0;c<a.length;c++)a[c].type.valid(e,a[c])||a.splice(c--,1);return new tn(a.length?this.local.concat(a).sort(na):this.local,i||this.children)}remove(e){return e.length==0||this==Vn?this:this.removeInner(e,0)}removeInner(e,n){let r=this.children,i=this.local;for(let o=0;o<r.length;o+=3){let a,c=r[o]+n,u=r[o+1]+n;for(let p=0,g;p<e.length;p++)(g=e[p])&&g.from>c&&g.to<u&&(e[p]=null,(a||(a=[])).push(g));if(!a)continue;r==this.children&&(r=this.children.slice());let f=r[o+2].removeInner(a,c+1);f!=Vn?r[o+2]=f:(r.splice(o,3),o-=3)}if(i.length){for(let o=0,a;o<e.length;o++)if(a=e[o])for(let c=0;c<i.length;c++)i[c].eq(a,n)&&(i==this.local&&(i=this.local.slice()),i.splice(c--,1))}return r==this.children&&i==this.local?this:i.length||r.length?new tn(i,r):Vn}forChild(e,n){if(this==Vn)return this;if(n.isLeaf)return tn.empty;let r,i;for(let c=0;c<this.children.length;c+=3)if(this.children[c]>=e){this.children[c]==e&&(r=this.children[c+2]);break}let o=e+1,a=o+n.content.size;for(let c=0;c<this.local.length;c++){let u=this.local[c];if(u.from<a&&u.to>o&&u.type instanceof ds){let f=Math.max(o,u.from)-o,p=Math.min(a,u.to)-o;f<p&&(i||(i=[])).push(u.copy(f,p))}}if(i){let c=new tn(i.sort(na),ml);return r?new Zo([c,r]):c}return r||Vn}eq(e){if(this==e)return!0;if(!(e instanceof tn)||this.local.length!=e.local.length||this.children.length!=e.children.length)return!1;for(let n=0;n<this.local.length;n++)if(!this.local[n].eq(e.local[n]))return!1;for(let n=0;n<this.children.length;n+=3)if(this.children[n]!=e.children[n]||this.children[n+1]!=e.children[n+1]||!this.children[n+2].eq(e.children[n+2]))return!1;return!0}locals(e){return Kb(this.localsInner(e))}localsInner(e){if(this==Vn)return ml;if(e.inlineContent||!this.local.some(ds.is))return this.local;let n=[];for(let r=0;r<this.local.length;r++)this.local[r].type instanceof ds||n.push(this.local[r]);return n}forEachSet(e){e(this)}}tn.empty=new tn([],[]);tn.removeOverlap=Kb;const Vn=tn.empty;class Zo{constructor(e){this.members=e}map(e,n){const r=this.members.map(i=>i.map(e,n,ta));return Zo.from(r)}forChild(e,n){if(n.isLeaf)return tn.empty;let r=[];for(let i=0;i<this.members.length;i++){let o=this.members[i].forChild(e,n);o!=Vn&&(o instanceof Zo?r=r.concat(o.members):r.push(o))}return Zo.from(r)}eq(e){if(!(e instanceof Zo)||e.members.length!=this.members.length)return!1;for(let n=0;n<this.members.length;n++)if(!this.members[n].eq(e.members[n]))return!1;return!0}locals(e){let n,r=!0;for(let i=0;i<this.members.length;i++){let o=this.members[i].localsInner(e);if(o.length)if(!n)n=o;else{r&&(n=n.slice(),r=!1);for(let a=0;a<o.length;a++)n.push(o[a])}}return n?Kb(r?n:n.sort(na)):ml}static from(e){switch(e.length){case 0:return Vn;case 1:return e[0];default:return new Zo(e.every(n=>n instanceof tn)?e:e.reduce((n,r)=>n.concat(r instanceof tn?r:r.members),[]))}}forEachSet(e){for(let n=0;n<this.members.length;n++)this.members[n].forEachSet(e)}}function hU(t,e,n,r,i,o,a){let c=t.slice();for(let f=0,p=o;f<n.maps.length;f++){let g=0;n.maps[f].forEach((v,y,w,S)=>{let C=S-w-(y-v);for(let T=0;T<c.length;T+=3){let N=c[T+1];if(N<0||v>N+p-g)continue;let k=c[T]+p-g;y>=k?c[T+1]=v<=k?-2:-1:v>=p&&C&&(c[T]+=C,c[T+1]+=C)}g+=C}),p=n.maps[f].map(p,-1)}let u=!1;for(let f=0;f<c.length;f+=3)if(c[f+1]<0){if(c[f+1]==-2){u=!0,c[f+1]=-1;continue}let p=n.map(t[f]+o),g=p-i;if(g<0||g>=r.content.size){u=!0;continue}let v=n.map(t[f+1]+o,-1),y=v-i,{index:w,offset:S}=r.content.findIndex(g),C=r.maybeChild(w);if(C&&S==g&&S+C.nodeSize==y){let T=c[f+2].mapInner(n,C,p+1,t[f]+o+1,a);T!=Vn?(c[f]=g,c[f+1]=y,c[f+2]=T):(c[f+1]=-2,u=!0)}else u=!0}if(u){let f=pU(c,t,e,n,i,o,a),p=Rh(f,r,0,a);e=p.local;for(let g=0;g<c.length;g+=3)c[g+1]<0&&(c.splice(g,3),g-=3);for(let g=0,v=0;g<p.children.length;g+=3){let y=p.children[g];for(;v<c.length&&c[v]<y;)v+=3;c.splice(v,0,p.children[g],p.children[g+1],p.children[g+2])}}return new tn(e.sort(na),c)}function LO(t,e){if(!e||!t.length)return t;let n=[];for(let r=0;r<t.length;r++){let i=t[r];n.push(new Gn(i.from+e,i.to+e,i.type))}return n}function pU(t,e,n,r,i,o,a){function c(u,f){for(let p=0;p<u.local.length;p++){let g=u.local[p].map(r,i,f);g?n.push(g):a.onRemove&&a.onRemove(u.local[p].spec)}for(let p=0;p<u.children.length;p+=3)c(u.children[p+2],u.children[p]+f+1)}for(let u=0;u<t.length;u+=3)t[u+1]==-1&&c(t[u+2],e[u]+o+1);return n}function PO(t,e,n){if(e.isLeaf)return null;let r=n+e.nodeSize,i=null;for(let o=0,a;o<t.length;o++)(a=t[o])&&a.from>n&&a.to<r&&((i||(i=[])).push(a),t[o]=null);return i}function zO(t){let e=[];for(let n=0;n<t.length;n++)t[n]!=null&&e.push(t[n]);return e}function Rh(t,e,n,r){let i=[],o=!1;e.forEach((c,u)=>{let f=PO(t,c,u+n);if(f){o=!0;let p=Rh(f,c,n+u+1,r);p!=Vn&&i.push(u,u+c.nodeSize,p)}});let a=LO(o?zO(t):t,-n).sort(na);for(let c=0;c<a.length;c++)a[c].type.valid(e,a[c])||(r.onRemove&&r.onRemove(a[c].spec),a.splice(c--,1));return a.length||i.length?new tn(a,i):Vn}function na(t,e){return t.from-e.from||t.to-e.to}function Kb(t){let e=t;for(let n=0;n<e.length-1;n++){let r=e[n];if(r.from!=r.to)for(let i=n+1;i<e.length;i++){let o=e[i];if(o.from==r.from){o.to!=r.to&&(e==t&&(e=t.slice()),e[i]=o.copy(o.from,r.to),DT(e,i+1,o.copy(r.to,o.to)));continue}else{o.from<r.to&&(e==t&&(e=t.slice()),e[n]=r.copy(r.from,o.from),DT(e,i,r.copy(o.from,r.to)));break}}}return e}function DT(t,e,n){for(;e<t.length&&na(n,t[e])>0;)e++;t.splice(e,0,n)}function nv(t){let e=[];return t.someProp("decorations",n=>{let r=n(t.state);r&&r!=Vn&&e.push(r)}),t.cursorWrapper&&e.push(tn.create(t.state.doc,[t.cursorWrapper.deco])),Zo.from(e)}const mU={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},gU=hr&&cs<=11;class yU{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(e){this.anchorNode=e.anchorNode,this.anchorOffset=e.anchorOffset,this.focusNode=e.focusNode,this.focusOffset=e.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(e){return e.anchorNode==this.anchorNode&&e.anchorOffset==this.anchorOffset&&e.focusNode==this.focusNode&&e.focusOffset==this.focusOffset}}class vU{constructor(e,n){this.view=e,this.handleDOMChange=n,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new yU,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.lastChangedTextNode=null,this.observer=window.MutationObserver&&new window.MutationObserver(r=>{for(let i=0;i<r.length;i++)this.queue.push(r[i]);hr&&cs<=11&&r.some(i=>i.type=="childList"&&i.removedNodes.length||i.type=="characterData"&&i.oldValue.length>i.target.nodeValue.length)?this.flushSoon():Yn&&e.composing&&r.some(i=>i.type=="childList"&&i.target.nodeName=="TR")?(e.input.badSafariComposition=!0,this.flushSoon()):this.flush()}),gU&&(this.onCharData=r=>{this.queue.push({target:r.target,type:"characterData",oldValue:r.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,mU)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let e=this.observer.takeRecords();if(e.length){for(let n=0;n<e.length;n++)this.queue.push(e[n]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(wT(this.view)){if(this.suppressingSelectionUpdates)return lo(this.view);if(hr&&cs<=11&&!this.view.state.selection.empty){let e=this.view.domSelectionRange();if(e.focusNode&&fa(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(e){if(!e.focusNode)return!0;let n=new Set,r;for(let o=e.focusNode;o;o=Ml(o))n.add(o);for(let o=e.anchorNode;o;o=Ml(o))if(n.has(o)){r=o;break}let i=r&&this.view.docView.nearestDesc(r);if(i&&i.ignoreMutation({type:"selection",target:r.nodeType==3?r.parentNode:r}))return this.setCurSelection(),!0}pendingRecords(){if(this.observer)for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}flush(){let{view:e}=this;if(!e.docView||this.flushingSoon>-1)return;let n=this.pendingRecords();n.length&&(this.queue=[]);let r=e.domSelectionRange(),i=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(r)&&wT(e)&&!this.ignoreSelectionChange(r),o=-1,a=-1,c=!1,u=[];if(e.editable)for(let p=0;p<n.length;p++){let g=this.registerMutation(n[p],u);g&&(o=o<0?g.from:Math.min(g.from,o),a=a<0?g.to:Math.max(g.to,a),g.typeOver&&(c=!0))}if(u.some(p=>p.nodeName=="BR")&&(e.input.lastKeyCode==8||e.input.lastKeyCode==46)){for(let p of u)if(p.nodeName=="BR"&&p.parentNode){let g=p.nextSibling;g&&g.nodeType==1&&g.contentEditable=="false"&&p.parentNode.removeChild(p)}}else if(qr&&u.length){let p=u.filter(g=>g.nodeName=="BR");if(p.length==2){let[g,v]=p;g.parentNode&&g.parentNode.parentNode==v.parentNode?v.remove():g.remove()}else{let{focusNode:g}=this.currentSelection;for(let v of p){let y=v.parentNode;y&&y.nodeName=="LI"&&(!g||wU(e,g)!=y)&&v.remove()}}}let f=null;o<0&&i&&e.input.lastFocus>Date.now()-200&&Math.max(e.input.lastTouch,e.input.lastClick.time)<Date.now()-300&&Vp(r)&&(f=Hb(e))&&f.eq(xt.near(e.state.doc.resolve(0),1))?(e.input.lastFocus=0,lo(e),this.currentSelection.set(r),e.scrollToSelection()):(o>-1||i)&&(o>-1&&(e.docView.markDirty(o,a),xU(e)),e.input.badSafariComposition&&(e.input.badSafariComposition=!1,SU(e,u)),this.handleDOMChange(o,a,c,u),e.docView&&e.docView.dirty?e.updateState(e.state):this.currentSelection.eq(r)||lo(e),this.currentSelection.set(r))}registerMutation(e,n){if(n.indexOf(e.target)>-1)return null;let r=this.view.docView.nearestDesc(e.target);if(e.type=="attributes"&&(r==this.view.docView||e.attributeName=="contenteditable"||e.attributeName=="style"&&!e.oldValue&&!e.target.getAttribute("style"))||!r||r.ignoreMutation(e))return null;if(e.type=="childList"){for(let p=0;p<e.addedNodes.length;p++){let g=e.addedNodes[p];n.push(g),g.nodeType==3&&(this.lastChangedTextNode=g)}if(r.contentDOM&&r.contentDOM!=r.dom&&!r.contentDOM.contains(e.target))return{from:r.posBefore,to:r.posAfter};let i=e.previousSibling,o=e.nextSibling;if(hr&&cs<=11&&e.addedNodes.length)for(let p=0;p<e.addedNodes.length;p++){let{previousSibling:g,nextSibling:v}=e.addedNodes[p];(!g||Array.prototype.indexOf.call(e.addedNodes,g)<0)&&(i=g),(!v||Array.prototype.indexOf.call(e.addedNodes,v)<0)&&(o=v)}let a=i&&i.parentNode==e.target?Bn(i)+1:0,c=r.localPosFromDOM(e.target,a,-1),u=o&&o.parentNode==e.target?Bn(o):e.target.childNodes.length,f=r.localPosFromDOM(e.target,u,1);return{from:c,to:f}}else return e.type=="attributes"?{from:r.posAtStart-r.border,to:r.posAtEnd+r.border}:(this.lastChangedTextNode=e.target,{from:r.posAtStart,to:r.posAtEnd,typeOver:e.target.nodeValue==e.oldValue})}}let OT=new WeakMap,MT=!1;function xU(t){if(!OT.has(t)&&(OT.set(t,null),["normal","nowrap","pre-line"].indexOf(getComputedStyle(t.dom).whiteSpace)!==-1)){if(t.requiresGeckoHackNode=qr,MT)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),MT=!0}}function RT(t,e){let n=e.startContainer,r=e.startOffset,i=e.endContainer,o=e.endOffset,a=t.domAtPos(t.state.selection.anchor);return fa(a.node,a.offset,i,o)&&([n,r,i,o]=[i,o,n,r]),{anchorNode:n,anchorOffset:r,focusNode:i,focusOffset:o}}function bU(t,e){if(e.getComposedRanges){let i=e.getComposedRanges(t.root)[0];if(i)return RT(t,i)}let n;function r(i){i.preventDefault(),i.stopImmediatePropagation(),n=i.getTargetRanges()[0]}return t.dom.addEventListener("beforeinput",r,!0),document.execCommand("indent"),t.dom.removeEventListener("beforeinput",r,!0),n?RT(t,n):null}function wU(t,e){for(let n=e.parentNode;n&&n!=t.dom;n=n.parentNode){let r=t.docView.nearestDesc(n,!0);if(r&&r.node.isBlock)return n}return null}function SU(t,e){var n;let{focusNode:r,focusOffset:i}=t.domSelectionRange();for(let o of e)if(((n=o.parentNode)===null||n===void 0?void 0:n.nodeName)=="TR"){let a=o.nextSibling;for(;a&&a.nodeName!="TD"&&a.nodeName!="TH";)a=a.nextSibling;if(a){let c=a;for(;;){let u=c.firstChild;if(!u||u.nodeType!=1||u.contentEditable=="false"||/^(BR|IMG)$/.test(u.nodeName))break;c=u}c.insertBefore(o,c.firstChild),r==o&&t.domSelection().collapse(o,i)}else o.parentNode.removeChild(o)}}function EU(t,e,n){let{node:r,fromOffset:i,toOffset:o,from:a,to:c}=t.docView.parseRange(e,n),u=t.domSelectionRange(),f,p=u.anchorNode;if(p&&t.dom.contains(p.nodeType==1?p:p.parentNode)&&(f=[{node:p,offset:u.anchorOffset}],Vp(u)||f.push({node:u.focusNode,offset:u.focusOffset})),$n&&t.input.lastKeyCode===8)for(let C=o;C>i;C--){let T=r.childNodes[C-1],N=T.pmViewDesc;if(T.nodeName=="BR"&&!N){o=C;break}if(!N||N.size)break}let g=t.state.doc,v=t.someProp("domParser")||ls.fromSchema(t.state.schema),y=g.resolve(a),w=null,S=v.parse(r,{topNode:y.parent,topMatch:y.parent.contentMatchAt(y.index()),topOpen:!0,from:i,to:o,preserveWhitespace:y.parent.type.whitespace=="pre"?"full":!0,findPositions:f,ruleFromNode:CU,context:y});if(f&&f[0].pos!=null){let C=f[0].pos,T=f[1]&&f[1].pos;T==null&&(T=C),w={anchor:C+a,head:T+a}}return{doc:S,sel:w,from:a,to:c}}function CU(t){let e=t.pmViewDesc;if(e)return e.parseRule();if(t.nodeName=="BR"&&t.parentNode){if(Yn&&/^(ul|ol)$/i.test(t.parentNode.nodeName)){let n=document.createElement("div");return n.appendChild(document.createElement("li")),{skip:n}}else if(t.parentNode.lastChild==t||Yn&&/^(tr|table)$/i.test(t.parentNode.nodeName))return{ignore:!0}}else if(t.nodeName=="IMG"&&t.getAttribute("mark-placeholder"))return{ignore:!0};return null}const TU=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|img|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function NU(t,e,n,r,i){let o=t.input.compositionPendingChanges||(t.composing?t.input.compositionID:0);if(t.input.compositionPendingChanges=0,e<0){let O=t.input.lastSelectionTime>Date.now()-50?t.input.lastSelectionOrigin:null,I=Hb(t,O);if(I&&!t.state.selection.eq(I)){if($n&&so&&t.input.lastKeyCode===13&&Date.now()-100<t.input.lastKeyCodeTime&&t.someProp("handleKeyDown",U=>U(t,Ys(13,"Enter"))))return;let z=t.state.tr.setSelection(I);O=="pointer"?z.setMeta("pointer",!0):O=="key"&&z.scrollIntoView(),o&&z.setMeta("composition",o),t.dispatch(z)}return}let a=t.state.doc.resolve(e),c=a.sharedDepth(n);e=a.before(c+1),n=t.state.doc.resolve(n).after(c+1);let u=t.state.selection,f=EU(t,e,n),p=t.state.doc,g=p.slice(f.from,f.to),v,y;t.input.lastKeyCode===8&&Date.now()-100<t.input.lastKeyCodeTime?(v=t.state.selection.to,y="end"):(v=t.state.selection.from,y="start"),t.input.lastKeyCode=null;let w=DU(g.content,f.doc.content,f.from,v,y);if(w&&t.input.domChangeCount++,(Rl&&t.input.lastIOSEnter>Date.now()-225||so)&&i.some(O=>O.nodeType==1&&!TU.test(O.nodeName))&&(!w||w.endA>=w.endB)&&t.someProp("handleKeyDown",O=>O(t,Ys(13,"Enter")))){t.input.lastIOSEnter=0;return}if(!w)if(r&&u instanceof st&&!u.empty&&u.$head.sameParent(u.$anchor)&&!t.composing&&!(f.sel&&f.sel.anchor!=f.sel.head))w={start:u.from,endA:u.to,endB:u.to};else{if(f.sel){let O=jT(t,t.state.doc,f.sel);if(O&&!O.eq(t.state.selection)){let I=t.state.tr.setSelection(O);o&&I.setMeta("composition",o),t.dispatch(I)}}return}t.state.selection.from<t.state.selection.to&&w.start==w.endB&&t.state.selection instanceof st&&(w.start>t.state.selection.from&&w.start<=t.state.selection.from+2&&t.state.selection.from>=f.from?w.start=t.state.selection.from:w.endA<t.state.selection.to&&w.endA>=t.state.selection.to-2&&t.state.selection.to<=f.to&&(w.endB+=t.state.selection.to-w.endA,w.endA=t.state.selection.to)),hr&&cs<=11&&w.endB==w.start+1&&w.endA==w.start&&w.start>f.from&&f.doc.textBetween(w.start-f.from-1,w.start-f.from+1)==" "&&(w.start--,w.endA--,w.endB--);let S=f.doc.resolveNoCache(w.start-f.from),C=f.doc.resolveNoCache(w.endB-f.from),T=p.resolve(w.start),N=S.sameParent(C)&&S.parent.inlineContent&&T.end()>=w.endA;if((Rl&&t.input.lastIOSEnter>Date.now()-225&&(!N||i.some(O=>O.nodeName=="DIV"||O.nodeName=="P"))||!N&&S.pos<f.doc.content.size&&(!S.sameParent(C)||!S.parent.inlineContent)&&S.pos<C.pos&&!/\S/.test(f.doc.textBetween(S.pos,C.pos,"","")))&&t.someProp("handleKeyDown",O=>O(t,Ys(13,"Enter")))){t.input.lastIOSEnter=0;return}if(t.state.selection.anchor>w.start&&kU(p,w.start,w.endA,S,C)&&t.someProp("handleKeyDown",O=>O(t,Ys(8,"Backspace")))){so&&$n&&t.domObserver.suppressSelectionUpdates();return}$n&&w.endB==w.start&&(t.input.lastChromeDelete=Date.now()),so&&!N&&S.start()!=C.start()&&C.parentOffset==0&&S.depth==C.depth&&f.sel&&f.sel.anchor==f.sel.head&&f.sel.head==w.endA&&(w.endB-=2,C=f.doc.resolveNoCache(w.endB-f.from),setTimeout(()=>{t.someProp("handleKeyDown",function(O){return O(t,Ys(13,"Enter"))})},20));let k=w.start,D=w.endA,M=O=>{let I=O||t.state.tr.replace(k,D,f.doc.slice(w.start-f.from,w.endB-f.from));if(f.sel){let z=jT(t,I.doc,f.sel);z&&!($n&&t.composing&&z.empty&&(w.start!=w.endB||t.input.lastChromeDelete<Date.now()-100)&&(z.head==k||z.head==I.mapping.map(D)-1)||hr&&z.empty&&z.head==k)&&I.setSelection(z)}return o&&I.setMeta("composition",o),I.scrollIntoView()},R;if(N)if(S.pos==C.pos){hr&&cs<=11&&S.parentOffset==0&&(t.domObserver.suppressSelectionUpdates(),setTimeout(()=>lo(t),20));let O=M(t.state.tr.delete(k,D)),I=p.resolve(w.start).marksAcross(p.resolve(w.endA));I&&O.ensureMarks(I),t.dispatch(O)}else if(w.endA==w.endB&&(R=AU(S.parent.content.cut(S.parentOffset,C.parentOffset),T.parent.content.cut(T.parentOffset,w.endA-T.start())))){let O=M(t.state.tr);R.type=="add"?O.addMark(k,D,R.mark):O.removeMark(k,D,R.mark),t.dispatch(O)}else if(S.parent.child(S.index()).isText&&S.index()==C.index()-(C.textOffset?0:1)){let O=S.parent.textBetween(S.parentOffset,C.parentOffset),I=()=>M(t.state.tr.insertText(O,k,D));t.someProp("handleTextInput",z=>z(t,k,D,O,I))||t.dispatch(I())}else t.dispatch(M());else t.dispatch(M())}function jT(t,e,n){return Math.max(n.anchor,n.head)>e.content.size?null:Ub(t,e.resolve(n.anchor),e.resolve(n.head))}function AU(t,e){let n=t.firstChild.marks,r=e.firstChild.marks,i=n,o=r,a,c,u;for(let p=0;p<r.length;p++)i=r[p].removeFromSet(i);for(let p=0;p<n.length;p++)o=n[p].removeFromSet(o);if(i.length==1&&o.length==0)c=i[0],a="add",u=p=>p.mark(c.addToSet(p.marks));else if(i.length==0&&o.length==1)c=o[0],a="remove",u=p=>p.mark(c.removeFromSet(p.marks));else return null;let f=[];for(let p=0;p<e.childCount;p++)f.push(u(e.child(p)));if(Ee.from(f).eq(t))return{mark:c,type:a}}function kU(t,e,n,r,i){if(n-e<=i.pos-r.pos||rv(r,!0,!1)<i.pos)return!1;let o=t.resolve(e);if(!r.parent.isTextblock){let c=o.nodeAfter;return c!=null&&n==e+c.nodeSize}if(o.parentOffset<o.parent.content.size||!o.parent.isTextblock)return!1;let a=t.resolve(rv(o,!0,!0));return!a.parent.isTextblock||a.pos>n||rv(a,!0,!1)<n?!1:r.parent.content.cut(r.parentOffset).eq(a.parent.content)}function rv(t,e,n){let r=t.depth,i=e?t.end():t.pos;for(;r>0&&(e||t.indexAfter(r)==t.node(r).childCount);)r--,i++,e=!1;if(n){let o=t.node(r).maybeChild(t.indexAfter(r));for(;o&&!o.isLeaf;)o=o.firstChild,i++}return i}function DU(t,e,n,r,i){let o=t.findDiffStart(e,n);if(o==null)return null;let{a,b:c}=t.findDiffEnd(e,n+t.size,n+e.size);if(i=="end"){let u=Math.max(0,o-Math.min(a,c));r-=a+u-o}if(a<o&&t.size<e.size){let u=r<=o&&r>=a?o-r:0;o-=u,o&&o<e.size&&IT(e.textBetween(o-1,o+1))&&(o+=u?1:-1),c=o+(c-a),a=o}else if(c<o){let u=r<=o&&r>=c?o-r:0;o-=u,o&&o<t.size&&IT(t.textBetween(o-1,o+1))&&(o+=u?1:-1),a=o+(a-c),c=o}return{start:o,endA:a,endB:c}}function IT(t){if(t.length!=2)return!1;let e=t.charCodeAt(0),n=t.charCodeAt(1);return e>=56320&&e<=57343&&n>=55296&&n<=56319}class BO{constructor(e,n){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new qH,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=n,this.state=n.state,this.directPlugins=n.plugins||[],this.directPlugins.forEach(BT),this.dispatch=this.dispatch.bind(this),this.dom=e&&e.mount||document.createElement("div"),e&&(e.appendChild?e.appendChild(this.dom):typeof e=="function"?e(this.dom):e.mount&&(this.mounted=!0)),this.editable=PT(this),LT(this),this.nodeViews=zT(this),this.docView=mT(this.state.doc,_T(this),nv(this),this.dom,this),this.domObserver=new vU(this,(r,i,o,a)=>NU(this,r,i,o,a)),this.domObserver.start(),GH(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let e=this._props;this._props={};for(let n in e)this._props[n]=e[n];this._props.state=this.state}return this._props}update(e){e.handleDOMEvents!=this._props.handleDOMEvents&&hx(this);let n=this._props;this._props=e,e.plugins&&(e.plugins.forEach(BT),this.directPlugins=e.plugins),this.updateStateInner(e.state,n)}setProps(e){let n={};for(let r in this._props)n[r]=this._props[r];n.state=this.state;for(let r in e)n[r]=e[r];this.update(n)}updateState(e){this.updateStateInner(e,this._props)}updateStateInner(e,n){var r;let i=this.state,o=!1,a=!1;e.storedMarks&&this.composing&&(RO(this),a=!0),this.state=e;let c=i.plugins!=e.plugins||this._props.plugins!=n.plugins;if(c||this._props.plugins!=n.plugins||this._props.nodeViews!=n.nodeViews){let y=zT(this);MU(y,this.nodeViews)&&(this.nodeViews=y,o=!0)}(c||n.handleDOMEvents!=this._props.handleDOMEvents)&&hx(this),this.editable=PT(this),LT(this);let u=nv(this),f=_T(this),p=i.plugins!=e.plugins&&!i.doc.eq(e.doc)?"reset":e.scrollToSelection>i.scrollToSelection?"to selection":"preserve",g=o||!this.docView.matchesNode(e.doc,f,u);(g||!e.selection.eq(i.selection))&&(a=!0);let v=p=="preserve"&&a&&this.dom.style.overflowAnchor==null&&sH(this);if(a){this.domObserver.stop();let y=g&&(hr||$n)&&!this.composing&&!i.selection.empty&&!e.selection.empty&&OU(i.selection,e.selection);if(g){let w=$n?this.trackWrites=this.domSelectionRange().focusNode:null;this.composing&&(this.input.compositionNode=sU(this)),(o||!this.docView.update(e.doc,f,u,this))&&(this.docView.updateOuterDeco(f),this.docView.destroy(),this.docView=mT(e.doc,f,u,this.dom,this)),w&&(!this.trackWrites||!this.dom.contains(this.trackWrites))&&(y=!0)}y||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&OH(this))?lo(this,y):(bO(this,e.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(i),!((r=this.dragging)===null||r===void 0)&&r.node&&!i.doc.eq(e.doc)&&this.updateDraggedNode(this.dragging,i),p=="reset"?this.dom.scrollTop=0:p=="to selection"?this.scrollToSelection():v&&aH(v)}scrollToSelection(){let e=this.domSelectionRange().focusNode;if(!(!e||!this.dom.contains(e.nodeType==1?e:e.parentNode))){if(!this.someProp("handleScrollToSelection",n=>n(this)))if(this.state.selection instanceof Je){let n=this.docView.domAfterPos(this.state.selection.from);n.nodeType==1&&cT(this,n.getBoundingClientRect(),e)}else cT(this,this.coordsAtPos(this.state.selection.head,1),e)}}destroyPluginViews(){let e;for(;e=this.pluginViews.pop();)e.destroy&&e.destroy()}updatePluginViews(e){if(!e||e.plugins!=this.state.plugins||this.directPlugins!=this.prevDirectPlugins){this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let n=0;n<this.directPlugins.length;n++){let r=this.directPlugins[n];r.spec.view&&this.pluginViews.push(r.spec.view(this))}for(let n=0;n<this.state.plugins.length;n++){let r=this.state.plugins[n];r.spec.view&&this.pluginViews.push(r.spec.view(this))}}else for(let n=0;n<this.pluginViews.length;n++){let r=this.pluginViews[n];r.update&&r.update(this,e)}}updateDraggedNode(e,n){let r=e.node,i=-1;if(this.state.doc.nodeAt(r.from)==r.node)i=r.from;else{let o=r.from+(this.state.doc.content.size-n.doc.content.size);(o>0&&this.state.doc.nodeAt(o))==r.node&&(i=o)}this.dragging=new IO(e.slice,e.move,i<0?void 0:Je.create(this.state.doc,i))}someProp(e,n){let r=this._props&&this._props[e],i;if(r!=null&&(i=n?n(r):r))return i;for(let a=0;a<this.directPlugins.length;a++){let c=this.directPlugins[a].props[e];if(c!=null&&(i=n?n(c):c))return i}let o=this.state.plugins;if(o)for(let a=0;a<o.length;a++){let c=o[a].props[e];if(c!=null&&(i=n?n(c):c))return i}}hasFocus(){if(hr){let e=this.root.activeElement;if(e==this.dom)return!0;if(!e||!this.dom.contains(e))return!1;for(;e&&this.dom!=e&&this.dom.contains(e);){if(e.contentEditable=="false")return!1;e=e.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&lH(this.dom),lo(this),this.domObserver.start()}get root(){let e=this._root;if(e==null){for(let n=this.dom.parentNode;n;n=n.parentNode)if(n.nodeType==9||n.nodeType==11&&n.host)return n.getSelection||(Object.getPrototypeOf(n).getSelection=()=>n.ownerDocument.getSelection()),this._root=n}return e||document}updateRoot(){this._root=null}posAtCoords(e){return hH(this,e)}coordsAtPos(e,n=1){return fO(this,e,n)}domAtPos(e,n=0){return this.docView.domFromPos(e,n)}nodeDOM(e){let n=this.docView.descAt(e);return n?n.nodeDOM:null}posAtDOM(e,n,r=-1){let i=this.docView.posFromDOM(e,n,r);if(i==null)throw new RangeError("DOM position not inside the editor");return i}endOfTextblock(e,n){return vH(this,n||this.state,e)}pasteHTML(e,n){return ju(this,"",e,!1,n||new ClipboardEvent("paste"))}pasteText(e,n){return ju(this,e,null,!0,n||new ClipboardEvent("paste"))}serializeForClipboard(e){return Vb(this,e)}destroy(){this.docView&&(WH(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],nv(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null,X$())}get isDestroyed(){return this.docView==null}dispatchEvent(e){return KH(this,e)}domSelectionRange(){let e=this.domSelection();return e?Yn&&this.root.nodeType===11&&tH(this.dom.ownerDocument)==this.dom&&bU(this,e)||e:{focusNode:null,focusOffset:0,anchorNode:null,anchorOffset:0}}domSelection(){return this.root.getSelection()}}BO.prototype.dispatch=function(t){let e=this._props.dispatchTransaction;e?e.call(this,t):this.updateState(this.state.apply(t))};function _T(t){let e=Object.create(null);return e.class="ProseMirror",e.contenteditable=String(t.editable),t.someProp("attributes",n=>{if(typeof n=="function"&&(n=n(t.state)),n)for(let r in n)r=="class"?e.class+=" "+n[r]:r=="style"?e.style=(e.style?e.style+";":"")+n[r]:!e[r]&&r!="contenteditable"&&r!="nodeName"&&(e[r]=String(n[r]))}),e.translate||(e.translate="no"),[Gn.node(0,t.state.doc.content.size,e)]}function LT(t){if(t.markCursor){let e=document.createElement("img");e.className="ProseMirror-separator",e.setAttribute("mark-placeholder","true"),e.setAttribute("alt",""),t.cursorWrapper={dom:e,deco:Gn.widget(t.state.selection.from,e,{raw:!0,marks:t.markCursor})}}else t.cursorWrapper=null}function PT(t){return!t.someProp("editable",e=>e(t.state)===!1)}function OU(t,e){let n=Math.min(t.$anchor.sharedDepth(t.head),e.$anchor.sharedDepth(e.head));return t.$anchor.start(n)!=e.$anchor.start(n)}function zT(t){let e=Object.create(null);function n(r){for(let i in r)Object.prototype.hasOwnProperty.call(e,i)||(e[i]=r[i])}return t.someProp("nodeViews",n),t.someProp("markViews",n),e}function MU(t,e){let n=0,r=0;for(let i in t){if(t[i]!=e[i])return!0;n++}for(let i in e)r++;return n!=r}function BT(t){if(t.spec.state||t.spec.filterTransaction||t.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}var ys={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},jh={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},RU=typeof navigator<"u"&&/Mac/.test(navigator.platform),jU=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var Fn=0;Fn<10;Fn++)ys[48+Fn]=ys[96+Fn]=String(Fn);for(var Fn=1;Fn<=24;Fn++)ys[Fn+111]="F"+Fn;for(var Fn=65;Fn<=90;Fn++)ys[Fn]=String.fromCharCode(Fn+32),jh[Fn]=String.fromCharCode(Fn);for(var iv in ys)jh.hasOwnProperty(iv)||(jh[iv]=ys[iv]);function IU(t){var e=RU&&t.metaKey&&t.shiftKey&&!t.ctrlKey&&!t.altKey||jU&&t.shiftKey&&t.key&&t.key.length==1||t.key=="Unidentified",n=!e&&t.key||(t.shiftKey?jh:ys)[t.keyCode]||t.key||"Unidentified";return n=="Esc"&&(n="Escape"),n=="Del"&&(n="Delete"),n=="Left"&&(n="ArrowLeft"),n=="Up"&&(n="ArrowUp"),n=="Right"&&(n="ArrowRight"),n=="Down"&&(n="ArrowDown"),n}const _U=typeof navigator<"u"&&/Mac|iP(hone|[oa]d)/.test(navigator.platform),LU=typeof navigator<"u"&&/Win/.test(navigator.platform);function PU(t){let e=t.split(/-(?!$)/),n=e[e.length-1];n=="Space"&&(n=" ");let r,i,o,a;for(let c=0;c<e.length-1;c++){let u=e[c];if(/^(cmd|meta|m)$/i.test(u))a=!0;else if(/^a(lt)?$/i.test(u))r=!0;else if(/^(c|ctrl|control)$/i.test(u))i=!0;else if(/^s(hift)?$/i.test(u))o=!0;else if(/^mod$/i.test(u))_U?a=!0:i=!0;else throw new Error("Unrecognized modifier name: "+u)}return r&&(n="Alt-"+n),i&&(n="Ctrl-"+n),a&&(n="Meta-"+n),o&&(n="Shift-"+n),n}function zU(t){let e=Object.create(null);for(let n in t)e[PU(n)]=t[n];return e}function ov(t,e,n=!0){return e.altKey&&(t="Alt-"+t),e.ctrlKey&&(t="Ctrl-"+t),e.metaKey&&(t="Meta-"+t),n&&e.shiftKey&&(t="Shift-"+t),t}function BU(t){return new nn({props:{handleKeyDown:FO(t)}})}function FO(t){let e=zU(t);return function(n,r){let i=IU(r),o,a=e[ov(i,r)];if(a&&a(n.state,n.dispatch,n))return!0;if(i.length==1&&i!=" "){if(r.shiftKey){let c=e[ov(i,r,!1)];if(c&&c(n.state,n.dispatch,n))return!0}if((r.altKey||r.metaKey||r.ctrlKey)&&!(LU&&r.ctrlKey&&r.altKey)&&(o=ys[r.keyCode])&&o!=i){let c=e[ov(o,r)];if(c&&c(n.state,n.dispatch,n))return!0}}return!1}}var FU=Object.defineProperty,Xb=(t,e)=>{for(var n in e)FU(t,n,{get:e[n],enumerable:!0})};function Wp(t){const{state:e,transaction:n}=t;let{selection:r}=n,{doc:i}=n,{storedMarks:o}=n;return{...e,apply:e.apply.bind(e),applyTransaction:e.applyTransaction.bind(e),plugins:e.plugins,schema:e.schema,reconfigure:e.reconfigure.bind(e),toJSON:e.toJSON.bind(e),get storedMarks(){return o},get selection(){return r},get doc(){return i},get tr(){return r=n.selection,i=n.doc,o=n.storedMarks,n}}}var Yp=class{constructor(t){this.editor=t.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=t.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:t,editor:e,state:n}=this,{view:r}=e,{tr:i}=n,o=this.buildProps(i);return Object.fromEntries(Object.entries(t).map(([a,c])=>[a,(...f)=>{const p=c(...f)(o);return!i.getMeta("preventDispatch")&&!this.hasCustomState&&r.dispatch(i),p}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(t,e=!0){const{rawCommands:n,editor:r,state:i}=this,{view:o}=r,a=[],c=!!t,u=t||i.tr,f=()=>(!c&&e&&!u.getMeta("preventDispatch")&&!this.hasCustomState&&o.dispatch(u),a.every(g=>g===!0)),p={...Object.fromEntries(Object.entries(n).map(([g,v])=>[g,(...w)=>{const S=this.buildProps(u,e),C=v(...w)(S);return a.push(C),p}])),run:f};return p}createCan(t){const{rawCommands:e,state:n}=this,r=!1,i=t||n.tr,o=this.buildProps(i,r);return{...Object.fromEntries(Object.entries(e).map(([c,u])=>[c,(...f)=>u(...f)({...o,dispatch:void 0})])),chain:()=>this.createChain(i,r)}}buildProps(t,e=!0){const{rawCommands:n,editor:r,state:i}=this,{view:o}=r,a={tr:t,editor:r,view:o,state:Wp({state:i,transaction:t}),dispatch:e?()=>{}:void 0,chain:()=>this.createChain(t,e),can:()=>this.createCan(t),get commands(){return Object.fromEntries(Object.entries(n).map(([c,u])=>[c,(...f)=>u(...f)(a)]))}};return a}},$O={};Xb($O,{blur:()=>$U,clearContent:()=>HU,clearNodes:()=>UU,command:()=>VU,createParagraphNear:()=>qU,cut:()=>GU,deleteCurrentNode:()=>WU,deleteNode:()=>YU,deleteRange:()=>KU,deleteSelection:()=>XU,enter:()=>JU,exitCode:()=>QU,extendMarkRange:()=>ZU,first:()=>e8,focus:()=>n8,forEach:()=>r8,insertContent:()=>i8,insertContentAt:()=>a8,joinBackward:()=>u8,joinDown:()=>c8,joinForward:()=>d8,joinItemBackward:()=>f8,joinItemForward:()=>h8,joinTextblockBackward:()=>p8,joinTextblockForward:()=>m8,joinUp:()=>l8,keyboardShortcut:()=>y8,lift:()=>v8,liftEmptyBlock:()=>x8,liftListItem:()=>b8,newlineInCode:()=>w8,resetAttributes:()=>S8,scrollIntoView:()=>E8,selectAll:()=>C8,selectNodeBackward:()=>T8,selectNodeForward:()=>N8,selectParentNode:()=>A8,selectTextblockEnd:()=>k8,selectTextblockStart:()=>D8,setContent:()=>O8,setMark:()=>X8,setMeta:()=>J8,setNode:()=>Q8,setNodeSelection:()=>Z8,setTextDirection:()=>eV,setTextSelection:()=>tV,sinkListItem:()=>nV,splitBlock:()=>rV,splitListItem:()=>iV,toggleList:()=>oV,toggleMark:()=>sV,toggleNode:()=>aV,toggleWrap:()=>lV,undoInputRule:()=>cV,unsetAllMarks:()=>uV,unsetMark:()=>dV,unsetTextDirection:()=>fV,updateAttributes:()=>hV,wrapIn:()=>pV,wrapInList:()=>mV});var $U=()=>({editor:t,view:e})=>(requestAnimationFrame(()=>{var n;t.isDestroyed||(e.dom.blur(),(n=window?.getSelection())==null||n.removeAllRanges())}),!0),HU=(t=!0)=>({commands:e})=>e.setContent("",{emitUpdate:t}),UU=()=>({state:t,tr:e,dispatch:n})=>{const{selection:r}=e,{ranges:i}=r;return n&&i.forEach(({$from:o,$to:a})=>{t.doc.nodesBetween(o.pos,a.pos,(c,u)=>{if(c.type.isText)return;const{doc:f,mapping:p}=e,g=f.resolve(p.map(u)),v=f.resolve(p.map(u+c.nodeSize)),y=g.blockRange(v);if(!y)return;const w=Kl(y);if(c.type.isTextblock){const{defaultType:S}=g.parent.contentMatchAt(g.index());e.setNodeMarkup(y.start,S)}(w||w===0)&&e.lift(y,w)})}),!0},VU=t=>e=>t(e),qU=()=>({state:t,dispatch:e})=>tO(t,e),GU=(t,e)=>({editor:n,tr:r})=>{const{state:i}=n,o=i.doc.slice(t.from,t.to);r.deleteRange(t.from,t.to);const a=r.mapping.map(e);return r.insert(a,o.content),r.setSelection(new st(r.doc.resolve(Math.max(a-1,0)))),!0},WU=()=>({tr:t,dispatch:e})=>{const{selection:n}=t,r=n.$anchor.node();if(r.content.size>0)return!1;const i=t.selection.$anchor;for(let o=i.depth;o>0;o-=1)if(i.node(o).type===r.type){if(e){const c=i.before(o),u=i.after(o);t.delete(c,u).scrollIntoView()}return!0}return!1};function wn(t,e){if(typeof t=="string"){if(!e.nodes[t])throw Error(`There is no node type named '${t}'. Maybe you forgot to add the extension?`);return e.nodes[t]}return t}var YU=t=>({tr:e,state:n,dispatch:r})=>{const i=wn(t,n.schema),o=e.selection.$anchor;for(let a=o.depth;a>0;a-=1)if(o.node(a).type===i){if(r){const u=o.before(a),f=o.after(a);e.delete(u,f).scrollIntoView()}return!0}return!1},KU=t=>({tr:e,dispatch:n})=>{const{from:r,to:i}=t;return n&&e.delete(r,i),!0},XU=()=>({state:t,dispatch:e})=>Lb(t,e),JU=()=>({commands:t})=>t.keyboardShortcut("Enter"),QU=()=>({state:t,dispatch:e})=>_$(t,e);function Jb(t){return Object.prototype.toString.call(t)==="[object RegExp]"}function Ih(t,e,n={strict:!0}){const r=Object.keys(e);return r.length?r.every(i=>n.strict?e[i]===t[i]:Jb(e[i])?e[i].test(t[i]):e[i]===t[i]):!0}function HO(t,e,n={}){return t.find(r=>r.type===e&&Ih(Object.fromEntries(Object.keys(n).map(i=>[i,r.attrs[i]])),n))}function FT(t,e,n={}){return!!HO(t,e,n)}function Qb(t,e,n){var r;if(!t||!e)return;let i=t.parent.childAfter(t.parentOffset);if((!i.node||!i.node.marks.some(p=>p.type===e))&&(i=t.parent.childBefore(t.parentOffset)),!i.node||!i.node.marks.some(p=>p.type===e)||(n=n||((r=i.node.marks[0])==null?void 0:r.attrs),!HO([...i.node.marks],e,n)))return;let a=i.index,c=t.start()+i.offset,u=a+1,f=c+i.node.nodeSize;for(;a>0&&FT([...t.parent.child(a-1).marks],e,n);)a-=1,c-=t.parent.child(a).nodeSize;for(;u<t.parent.childCount&&FT([...t.parent.child(u).marks],e,n);)f+=t.parent.child(u).nodeSize,u+=1;return{from:c,to:f}}function vo(t,e){if(typeof t=="string"){if(!e.marks[t])throw Error(`There is no mark type named '${t}'. Maybe you forgot to add the extension?`);return e.marks[t]}return t}var ZU=(t,e={})=>({tr:n,state:r,dispatch:i})=>{const o=vo(t,r.schema),{doc:a,selection:c}=n,{$from:u,from:f,to:p}=c;if(i){const g=Qb(u,o,e);if(g&&g.from<=f&&g.to>=p){const v=st.create(a,g.from,g.to);n.setSelection(v)}}return!0},e8=t=>e=>{const n=typeof t=="function"?t(e):t;for(let r=0;r<n.length;r+=1)if(n[r](e))return!0;return!1};function UO(t){return t instanceof st}function Js(t=0,e=0,n=0){return Math.min(Math.max(t,e),n)}function VO(t,e=null){if(!e)return null;const n=xt.atStart(t),r=xt.atEnd(t);if(e==="start"||e===!0)return n;if(e==="end")return r;const i=n.from,o=r.to;return e==="all"?st.create(t,Js(0,i,o),Js(t.content.size,i,o)):st.create(t,Js(e,i,o),Js(e,i,o))}function px(){return navigator.platform==="Android"||/android/i.test(navigator.userAgent)}function _u(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}function t8(){return typeof navigator<"u"?/^((?!chrome|android).)*safari/i.test(navigator.userAgent):!1}var n8=(t=null,e={})=>({editor:n,view:r,tr:i,dispatch:o})=>{e={scrollIntoView:!0,...e};const a=()=>{(_u()||px())&&r.dom.focus(),t8()&&!_u()&&!px()&&r.dom.focus({preventScroll:!0}),requestAnimationFrame(()=>{n.isDestroyed||(r.focus(),e?.scrollIntoView&&n.commands.scrollIntoView())})};try{if(r.hasFocus()&&t===null||t===!1)return!0}catch{return!1}if(o&&t===null&&!UO(n.state.selection))return a(),!0;const c=VO(i.doc,t)||n.state.selection,u=n.state.selection.eq(c);return o&&(u||i.setSelection(c),u&&i.storedMarks&&i.setStoredMarks(i.storedMarks),a()),!0},r8=(t,e)=>n=>t.every((r,i)=>e(r,{...n,index:i})),i8=(t,e)=>({tr:n,commands:r})=>r.insertContentAt({from:n.selection.from,to:n.selection.to},t,e),qO=t=>{const e=t.childNodes;for(let n=e.length-1;n>=0;n-=1){const r=e[n];r.nodeType===3&&r.nodeValue&&/^(\n\s\s|\n)$/.test(r.nodeValue)?t.removeChild(r):r.nodeType===1&&qO(r)}return t};function If(t){if(typeof window>"u")throw new Error("[tiptap error]: there is no window object available, so this function cannot be used");const e=`<body>${t}</body>`,n=new window.DOMParser().parseFromString(e,"text/html").body;return qO(n)}function Lu(t,e,n){if(t instanceof as||t instanceof Ee)return t;n={slice:!0,parseOptions:{},...n};const r=typeof t=="object"&&t!==null,i=typeof t=="string";if(r)try{if(Array.isArray(t)&&t.length>0)return Ee.fromArray(t.map(c=>e.nodeFromJSON(c)));const a=e.nodeFromJSON(t);return n.errorOnInvalidContent&&a.check(),a}catch(o){if(n.errorOnInvalidContent)throw new Error("[tiptap error]: Invalid JSON content",{cause:o});return console.warn("[tiptap warn]: Invalid content.","Passed value:",t,"Error:",o),Lu("",e,n)}if(i){if(n.errorOnInvalidContent){let a=!1,c="";const u=new kD({topNode:e.spec.topNode,marks:e.spec.marks,nodes:e.spec.nodes.append({__tiptap__private__unknown__catch__all__node:{content:"inline*",group:"block",parseDOM:[{tag:"*",getAttrs:f=>(a=!0,c=typeof f=="string"?f:f.outerHTML,null)}]}})});if(n.slice?ls.fromSchema(u).parseSlice(If(t),n.parseOptions):ls.fromSchema(u).parse(If(t),n.parseOptions),n.errorOnInvalidContent&&a)throw new Error("[tiptap error]: Invalid HTML content",{cause:new Error(`Invalid element found: ${c}`)})}const o=ls.fromSchema(e);return n.slice?o.parseSlice(If(t),n.parseOptions).content:o.parse(If(t),n.parseOptions)}return Lu("",e,n)}function o8(t,e,n){const r=t.steps.length-1;if(r<e)return;const i=t.steps[r];if(!(i instanceof Dn||i instanceof On))return;const o=t.mapping.maps[r];let a=0;o.forEach((c,u,f,p)=>{a===0&&(a=p)}),t.setSelection(xt.near(t.doc.resolve(a),n))}var s8=t=>!("type"in t),a8=(t,e,n)=>({tr:r,dispatch:i,editor:o})=>{var a;if(i){n={parseOptions:o.options.parseOptions,updateSelection:!0,applyInputRules:!1,applyPasteRules:!1,...n};let c;const u=C=>{o.emit("contentError",{editor:o,error:C,disableCollaboration:()=>{"collaboration"in o.storage&&typeof o.storage.collaboration=="object"&&o.storage.collaboration&&(o.storage.collaboration.isDisabled=!0)}})},f={preserveWhitespace:"full",...n.parseOptions};if(!n.errorOnInvalidContent&&!o.options.enableContentCheck&&o.options.emitContentError)try{Lu(e,o.schema,{parseOptions:f,errorOnInvalidContent:!0})}catch(C){u(C)}try{c=Lu(e,o.schema,{parseOptions:f,errorOnInvalidContent:(a=n.errorOnInvalidContent)!=null?a:o.options.enableContentCheck})}catch(C){return u(C),!1}let{from:p,to:g}=typeof t=="number"?{from:t,to:t}:{from:t.from,to:t.to},v=!0,y=!0;if((s8(c)?c:[c]).forEach(C=>{C.check(),v=v?C.isText&&C.marks.length===0:!1,y=y?C.isBlock:!1}),p===g&&y){const{parent:C}=r.doc.resolve(p);C.isTextblock&&!C.type.spec.code&&!C.childCount&&(p-=1,g+=1)}let S;if(v){if(Array.isArray(e))S=e.map(C=>C.text||"").join("");else if(e instanceof Ee){let C="";e.forEach(T=>{T.text&&(C+=T.text)}),S=C}else typeof e=="object"&&e&&e.text?S=e.text:S=e;r.insertText(S,p,g)}else{S=c;const C=r.doc.resolve(p),T=C.node(),N=C.parentOffset===0,k=T.isText||T.isTextblock,D=T.content.size>0;N&&k&&D&&(p=Math.max(0,p-1)),r.replaceWith(p,g,S)}n.updateSelection&&o8(r,r.steps.length-1,-1),n.applyInputRules&&r.setMeta("applyInputRules",{from:p,text:S}),n.applyPasteRules&&r.setMeta("applyPasteRules",{from:p,text:S})}return!0},l8=()=>({state:t,dispatch:e})=>R$(t,e),c8=()=>({state:t,dispatch:e})=>j$(t,e),u8=()=>({state:t,dispatch:e})=>YD(t,e),d8=()=>({state:t,dispatch:e})=>QD(t,e),f8=()=>({state:t,dispatch:e,tr:n})=>{try{const r=$p(t.doc,t.selection.$from.pos,-1);return r==null?!1:(n.join(r,2),e&&e(n),!0)}catch{return!1}},h8=()=>({state:t,dispatch:e,tr:n})=>{try{const r=$p(t.doc,t.selection.$from.pos,1);return r==null?!1:(n.join(r,2),e&&e(n),!0)}catch{return!1}},p8=()=>({state:t,dispatch:e})=>O$(t,e),m8=()=>({state:t,dispatch:e})=>M$(t,e);function GO(){return typeof navigator<"u"?/Mac/.test(navigator.platform):!1}function g8(t){const e=t.split(/-(?!$)/);let n=e[e.length-1];n==="Space"&&(n=" ");let r,i,o,a;for(let c=0;c<e.length-1;c+=1){const u=e[c];if(/^(cmd|meta|m)$/i.test(u))a=!0;else if(/^a(lt)?$/i.test(u))r=!0;else if(/^(c|ctrl|control)$/i.test(u))i=!0;else if(/^s(hift)?$/i.test(u))o=!0;else if(/^mod$/i.test(u))_u()||GO()?a=!0:i=!0;else throw new Error(`Unrecognized modifier name: ${u}`)}return r&&(n=`Alt-${n}`),i&&(n=`Ctrl-${n}`),a&&(n=`Meta-${n}`),o&&(n=`Shift-${n}`),n}var y8=t=>({editor:e,view:n,tr:r,dispatch:i})=>{const o=g8(t).split(/-(?!$)/),a=o.find(f=>!["Alt","Ctrl","Meta","Shift"].includes(f)),c=new KeyboardEvent("keydown",{key:a==="Space"?" ":a,altKey:o.includes("Alt"),ctrlKey:o.includes("Ctrl"),metaKey:o.includes("Meta"),shiftKey:o.includes("Shift"),bubbles:!0,cancelable:!0}),u=e.captureTransaction(()=>{n.someProp("handleKeyDown",f=>f(n,c))});return u?.steps.forEach(f=>{const p=f.map(r.mapping);p&&i&&r.maybeStep(p)}),!0};function vs(t,e,n={}){const{from:r,to:i,empty:o}=t.selection,a=e?wn(e,t.schema):null,c=[];t.doc.nodesBetween(r,i,(g,v)=>{if(g.isText)return;const y=Math.max(r,v),w=Math.min(i,v+g.nodeSize);c.push({node:g,from:y,to:w})});const u=i-r,f=c.filter(g=>a?a.name===g.node.type.name:!0).filter(g=>Ih(g.node.attrs,n,{strict:!1}));return o?!!f.length:f.reduce((g,v)=>g+v.to-v.from,0)>=u}var v8=(t,e={})=>({state:n,dispatch:r})=>{const i=wn(t,n.schema);return vs(n,i,e)?I$(n,r):!1},x8=()=>({state:t,dispatch:e})=>nO(t,e),b8=t=>({state:e,dispatch:n})=>{const r=wn(t,e.schema);return G$(r)(e,n)},w8=()=>({state:t,dispatch:e})=>eO(t,e);function Kp(t,e){return e.nodes[t]?"node":e.marks[t]?"mark":null}function $T(t,e){const n=typeof e=="string"?[e]:e;return Object.keys(t).reduce((r,i)=>(n.includes(i)||(r[i]=t[i]),r),{})}var S8=(t,e)=>({tr:n,state:r,dispatch:i})=>{let o=null,a=null;const c=Kp(typeof t=="string"?t:t.name,r.schema);if(!c)return!1;c==="node"&&(o=wn(t,r.schema)),c==="mark"&&(a=vo(t,r.schema));let u=!1;return n.selection.ranges.forEach(f=>{r.doc.nodesBetween(f.$from.pos,f.$to.pos,(p,g)=>{o&&o===p.type&&(u=!0,i&&n.setNodeMarkup(g,void 0,$T(p.attrs,e))),a&&p.marks.length&&p.marks.forEach(v=>{a===v.type&&(u=!0,i&&n.addMark(g,g+p.nodeSize,a.create($T(v.attrs,e))))})})}),u},E8=()=>({tr:t,dispatch:e})=>(e&&t.scrollIntoView(),!0),C8=()=>({tr:t,dispatch:e})=>{if(e){const n=new kr(t.doc);t.setSelection(n)}return!0},T8=()=>({state:t,dispatch:e})=>XD(t,e),N8=()=>({state:t,dispatch:e})=>ZD(t,e),A8=()=>({state:t,dispatch:e})=>z$(t,e),k8=()=>({state:t,dispatch:e})=>$$(t,e),D8=()=>({state:t,dispatch:e})=>F$(t,e);function mx(t,e,n={},r={}){return Lu(t,e,{slice:!1,parseOptions:n,errorOnInvalidContent:r.errorOnInvalidContent})}var O8=(t,{errorOnInvalidContent:e,emitUpdate:n=!0,parseOptions:r={}}={})=>({editor:i,tr:o,dispatch:a,commands:c})=>{const{doc:u}=o;if(r.preserveWhitespace!=="full"){const f=mx(t,i.schema,r,{errorOnInvalidContent:e??i.options.enableContentCheck});return a&&o.replaceWith(0,u.content.size,f).setMeta("preventUpdate",!n),!0}return a&&o.setMeta("preventUpdate",!n),c.insertContentAt({from:0,to:u.content.size},t,{parseOptions:r,errorOnInvalidContent:e??i.options.enableContentCheck})};function WO(t,e){const n=vo(e,t.schema),{from:r,to:i,empty:o}=t.selection,a=[];o?(t.storedMarks&&a.push(...t.storedMarks),a.push(...t.selection.$head.marks())):t.doc.nodesBetween(r,i,u=>{a.push(...u.marks)});const c=a.find(u=>u.type.name===n.name);return c?{...c.attrs}:{}}function YO(t,e){const n=new VD(t);return e.forEach(r=>{r.steps.forEach(i=>{n.step(i)})}),n}function M8(t){for(let e=0;e<t.edgeCount;e+=1){const{type:n}=t.edge(e);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}function R8(t,e,n){const r=[];return t.nodesBetween(e.from,e.to,(i,o)=>{n(i)&&r.push({node:i,pos:o})}),r}function j8(t,e){for(let n=t.depth;n>0;n-=1){const r=t.node(n);if(e(r))return{pos:n>0?t.before(n):0,start:t.start(n),depth:n,node:r}}}function Xp(t){return e=>j8(e.$from,t)}function Xe(t,e,n){return t.config[e]===void 0&&t.parent?Xe(t.parent,e,n):typeof t.config[e]=="function"?t.config[e].bind({...n,parent:t.parent?Xe(t.parent,e,n):null}):t.config[e]}function Zb(t){return t.map(e=>{const n={name:e.name,options:e.options,storage:e.storage},r=Xe(e,"addExtensions",n);return r?[e,...Zb(r())]:e}).flat(10)}function e0(t,e){const n=ya.fromSchema(e).serializeFragment(t),i=document.implementation.createHTMLDocument().createElement("div");return i.appendChild(n),i.innerHTML}function KO(t){return typeof t=="function"}function Ut(t,e=void 0,...n){return KO(t)?e?t.bind(e)(...n):t(...n):t}function I8(t={}){return Object.keys(t).length===0&&t.constructor===Object}function jl(t){const e=t.filter(i=>i.type==="extension"),n=t.filter(i=>i.type==="node"),r=t.filter(i=>i.type==="mark");return{baseExtensions:e,nodeExtensions:n,markExtensions:r}}function XO(t){const e=[],{nodeExtensions:n,markExtensions:r}=jl(t),i=[...n,...r],o={default:null,validate:void 0,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return t.forEach(a=>{const c={name:a.name,options:a.options,storage:a.storage,extensions:i},u=Xe(a,"addGlobalAttributes",c);if(!u)return;u().forEach(p=>{p.types.forEach(g=>{Object.entries(p.attributes).forEach(([v,y])=>{e.push({type:g,name:v,attribute:{...o,...y}})})})})}),i.forEach(a=>{const c={name:a.name,options:a.options,storage:a.storage},u=Xe(a,"addAttributes",c);if(!u)return;const f=u();Object.entries(f).forEach(([p,g])=>{const v={...o,...g};typeof v?.default=="function"&&(v.default=v.default()),v?.isRequired&&v?.default===void 0&&delete v.default,e.push({type:a.name,name:p,attribute:v})})}),e}function sn(...t){return t.filter(e=>!!e).reduce((e,n)=>{const r={...e};return Object.entries(n).forEach(([i,o])=>{if(!r[i]){r[i]=o;return}if(i==="class"){const c=o?String(o).split(" "):[],u=r[i]?r[i].split(" "):[],f=c.filter(p=>!u.includes(p));r[i]=[...u,...f].join(" ")}else if(i==="style"){const c=o?o.split(";").map(p=>p.trim()).filter(Boolean):[],u=r[i]?r[i].split(";").map(p=>p.trim()).filter(Boolean):[],f=new Map;u.forEach(p=>{const[g,v]=p.split(":").map(y=>y.trim());f.set(g,v)}),c.forEach(p=>{const[g,v]=p.split(":").map(y=>y.trim());f.set(g,v)}),r[i]=Array.from(f.entries()).map(([p,g])=>`${p}: ${g}`).join("; ")}else r[i]=o}),r},{})}function Il(t,e){return e.filter(n=>n.type===t.type.name).filter(n=>n.attribute.rendered).map(n=>n.attribute.renderHTML?n.attribute.renderHTML(t.attrs)||{}:{[n.name]:t.attrs[n.name]}).reduce((n,r)=>sn(n,r),{})}function _8(t){return typeof t!="string"?t:t.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(t):t==="true"?!0:t==="false"?!1:t}function HT(t,e){return"style"in t?t:{...t,getAttrs:n=>{const r=t.getAttrs?t.getAttrs(n):t.attrs;if(r===!1)return!1;const i=e.reduce((o,a)=>{const c=a.attribute.parseHTML?a.attribute.parseHTML(n):_8(n.getAttribute(a.name));return c==null?o:{...o,[a.name]:c}},{});return{...r,...i}}}}function UT(t){return Object.fromEntries(Object.entries(t).filter(([e,n])=>e==="attrs"&&I8(n)?!1:n!=null))}function VT(t){var e,n;const r={};return!((e=t?.attribute)!=null&&e.isRequired)&&"default"in(t?.attribute||{})&&(r.default=t.attribute.default),((n=t?.attribute)==null?void 0:n.validate)!==void 0&&(r.validate=t.attribute.validate),[t.name,r]}function L8(t,e){var n;const r=XO(t),{nodeExtensions:i,markExtensions:o}=jl(t),a=(n=i.find(f=>Xe(f,"topNode")))==null?void 0:n.name,c=Object.fromEntries(i.map(f=>{const p=r.filter(T=>T.type===f.name),g={name:f.name,options:f.options,storage:f.storage,editor:e},v=t.reduce((T,N)=>{const k=Xe(N,"extendNodeSchema",g);return{...T,...k?k(f):{}}},{}),y=UT({...v,content:Ut(Xe(f,"content",g)),marks:Ut(Xe(f,"marks",g)),group:Ut(Xe(f,"group",g)),inline:Ut(Xe(f,"inline",g)),atom:Ut(Xe(f,"atom",g)),selectable:Ut(Xe(f,"selectable",g)),draggable:Ut(Xe(f,"draggable",g)),code:Ut(Xe(f,"code",g)),whitespace:Ut(Xe(f,"whitespace",g)),linebreakReplacement:Ut(Xe(f,"linebreakReplacement",g)),defining:Ut(Xe(f,"defining",g)),isolating:Ut(Xe(f,"isolating",g)),attrs:Object.fromEntries(p.map(VT))}),w=Ut(Xe(f,"parseHTML",g));w&&(y.parseDOM=w.map(T=>HT(T,p)));const S=Xe(f,"renderHTML",g);S&&(y.toDOM=T=>S({node:T,HTMLAttributes:Il(T,p)}));const C=Xe(f,"renderText",g);return C&&(y.toText=C),[f.name,y]})),u=Object.fromEntries(o.map(f=>{const p=r.filter(C=>C.type===f.name),g={name:f.name,options:f.options,storage:f.storage,editor:e},v=t.reduce((C,T)=>{const N=Xe(T,"extendMarkSchema",g);return{...C,...N?N(f):{}}},{}),y=UT({...v,inclusive:Ut(Xe(f,"inclusive",g)),excludes:Ut(Xe(f,"excludes",g)),group:Ut(Xe(f,"group",g)),spanning:Ut(Xe(f,"spanning",g)),code:Ut(Xe(f,"code",g)),attrs:Object.fromEntries(p.map(VT))}),w=Ut(Xe(f,"parseHTML",g));w&&(y.parseDOM=w.map(C=>HT(C,p)));const S=Xe(f,"renderHTML",g);return S&&(y.toDOM=C=>S({mark:C,HTMLAttributes:Il(C,p)})),[f.name,y]}));return new kD({topNode:a,nodes:c,marks:u})}function P8(t){const e=t.filter((n,r)=>t.indexOf(n)!==r);return Array.from(new Set(e))}function _h(t){return t.sort((n,r)=>{const i=Xe(n,"priority")||100,o=Xe(r,"priority")||100;return i>o?-1:i<o?1:0})}function JO(t){const e=_h(Zb(t)),n=P8(e.map(r=>r.name));return n.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${n.map(r=>`'${r}'`).join(", ")}]. This can lead to issues.`),e}function QO(t,e,n){const{from:r,to:i}=e,{blockSeparator:o=`

`,textSerializers:a={}}=n||{};let c="";return t.nodesBetween(r,i,(u,f,p,g)=>{var v;u.isBlock&&f>r&&(c+=o);const y=a?.[u.type.name];if(y)return p&&(c+=y({node:u,pos:f,parent:p,index:g,range:e})),!1;u.isText&&(c+=(v=u?.text)==null?void 0:v.slice(Math.max(r,f)-f,i-f))}),c}function z8(t,e){const n={from:0,to:t.content.size};return QO(t,n,e)}function ZO(t){return Object.fromEntries(Object.entries(t.nodes).filter(([,e])=>e.spec.toText).map(([e,n])=>[e,n.spec.toText]))}function B8(t,e){const n=wn(e,t.schema),{from:r,to:i}=t.selection,o=[];t.doc.nodesBetween(r,i,c=>{o.push(c)});const a=o.reverse().find(c=>c.type.name===n.name);return a?{...a.attrs}:{}}function eM(t,e){const n=Kp(typeof e=="string"?e:e.name,t.schema);return n==="node"?B8(t,e):n==="mark"?WO(t,e):{}}function F8(t,e=JSON.stringify){const n={};return t.filter(r=>{const i=e(r);return Object.prototype.hasOwnProperty.call(n,i)?!1:n[i]=!0})}function $8(t){const e=F8(t);return e.length===1?e:e.filter((n,r)=>!e.filter((o,a)=>a!==r).some(o=>n.oldRange.from>=o.oldRange.from&&n.oldRange.to<=o.oldRange.to&&n.newRange.from>=o.newRange.from&&n.newRange.to<=o.newRange.to))}function tM(t){const{mapping:e,steps:n}=t,r=[];return e.maps.forEach((i,o)=>{const a=[];if(i.ranges.length)i.forEach((c,u)=>{a.push({from:c,to:u})});else{const{from:c,to:u}=n[o];if(c===void 0||u===void 0)return;a.push({from:c,to:u})}a.forEach(({from:c,to:u})=>{const f=e.slice(o).map(c,-1),p=e.slice(o).map(u),g=e.invert().map(f,-1),v=e.invert().map(p);r.push({oldRange:{from:g,to:v},newRange:{from:f,to:p}})})}),$8(r)}function t0(t,e,n){const r=[];return t===e?n.resolve(t).marks().forEach(i=>{const o=n.resolve(t),a=Qb(o,i.type);a&&r.push({mark:i,...a})}):n.nodesBetween(t,e,(i,o)=>{!i||i?.nodeSize===void 0||r.push(...i.marks.map(a=>({from:o,to:o+i.nodeSize,mark:a})))}),r}var H8=(t,e,n,r=20)=>{const i=t.doc.resolve(n);let o=r,a=null;for(;o>0&&a===null;){const c=i.node(o);c?.type.name===e?a=c:o-=1}return[a,o]};function _f(t,e){return e.nodes[t]||e.marks[t]||null}function sh(t,e,n){return Object.fromEntries(Object.entries(n).filter(([r])=>{const i=t.find(o=>o.type===e&&o.name===r);return i?i.attribute.keepOnSplit:!1}))}var U8=(t,e=500)=>{let n="";const r=t.parentOffset;return t.parent.nodesBetween(Math.max(0,r-e),r,(i,o,a,c)=>{var u,f;const p=((f=(u=i.type.spec).toText)==null?void 0:f.call(u,{node:i,pos:o,parent:a,index:c}))||i.textContent||"%leaf%";n+=i.isAtom&&!i.isText?p:p.slice(0,Math.max(0,r-o))}),n};function gx(t,e,n={}){const{empty:r,ranges:i}=t.selection,o=e?vo(e,t.schema):null;if(r)return!!(t.storedMarks||t.selection.$from.marks()).filter(g=>o?o.name===g.type.name:!0).find(g=>Ih(g.attrs,n,{strict:!1}));let a=0;const c=[];if(i.forEach(({$from:g,$to:v})=>{const y=g.pos,w=v.pos;t.doc.nodesBetween(y,w,(S,C)=>{if(!S.isText&&!S.marks.length)return;const T=Math.max(y,C),N=Math.min(w,C+S.nodeSize),k=N-T;a+=k,c.push(...S.marks.map(D=>({mark:D,from:T,to:N})))})}),a===0)return!1;const u=c.filter(g=>o?o.name===g.mark.type.name:!0).filter(g=>Ih(g.mark.attrs,n,{strict:!1})).reduce((g,v)=>g+v.to-v.from,0),f=c.filter(g=>o?g.mark.type!==o&&g.mark.type.excludes(o):!0).reduce((g,v)=>g+v.to-v.from,0);return(u>0?u+f:u)>=a}function V8(t,e,n={}){if(!e)return vs(t,null,n)||gx(t,null,n);const r=Kp(e,t.schema);return r==="node"?vs(t,e,n):r==="mark"?gx(t,e,n):!1}var q8=(t,e)=>{const{$from:n,$to:r,$anchor:i}=t.selection;if(e){const o=Xp(c=>c.type.name===e)(t.selection);if(!o)return!1;const a=t.doc.resolve(o.pos+1);return i.pos+1===a.end()}return!(r.parentOffset<r.parent.nodeSize-2||n.pos!==r.pos)},G8=t=>{const{$from:e,$to:n}=t.selection;return!(e.parentOffset>0||e.pos!==n.pos)};function qT(t,e){return Array.isArray(e)?e.some(n=>(typeof n=="string"?n:n.name)===t.name):e}function GT(t,e){const{nodeExtensions:n}=jl(e),r=n.find(a=>a.name===t);if(!r)return!1;const i={name:r.name,options:r.options,storage:r.storage},o=Ut(Xe(r,"group",i));return typeof o!="string"?!1:o.split(" ").includes("list")}function Jp(t,{checkChildren:e=!0,ignoreWhitespace:n=!1}={}){var r;if(n){if(t.type.name==="hardBreak")return!0;if(t.isText)return/^\s*$/m.test((r=t.text)!=null?r:"")}if(t.isText)return!t.text;if(t.isAtom||t.isLeaf)return!1;if(t.content.childCount===0)return!0;if(e){let i=!0;return t.content.forEach(o=>{i!==!1&&(Jp(o,{ignoreWhitespace:n,checkChildren:e})||(i=!1))}),i}return!1}function nM(t){return t instanceof Je}var rM=class iM{constructor(e){this.position=e}static fromJSON(e){return new iM(e.position)}toJSON(){return{position:this.position}}};function W8(t,e){const n=e.mapping.mapResult(t.position);return{position:new rM(n.pos),mapResult:n}}function Y8(t){return new rM(t)}function K8(t,e,n){var r;const{selection:i}=e;let o=null;if(UO(i)&&(o=i.$cursor),o){const c=(r=t.storedMarks)!=null?r:o.marks();return o.parent.type.allowsMarkType(n)&&(!!n.isInSet(c)||!c.some(f=>f.type.excludes(n)))}const{ranges:a}=i;return a.some(({$from:c,$to:u})=>{let f=c.depth===0?t.doc.inlineContent&&t.doc.type.allowsMarkType(n):!1;return t.doc.nodesBetween(c.pos,u.pos,(p,g,v)=>{if(f)return!1;if(p.isInline){const y=!v||v.type.allowsMarkType(n),w=!!n.isInSet(p.marks)||!p.marks.some(S=>S.type.excludes(n));f=y&&w}return!f}),f})}var X8=(t,e={})=>({tr:n,state:r,dispatch:i})=>{const{selection:o}=n,{empty:a,ranges:c}=o,u=vo(t,r.schema);if(i)if(a){const f=WO(r,u);n.addStoredMark(u.create({...f,...e}))}else c.forEach(f=>{const p=f.$from.pos,g=f.$to.pos;r.doc.nodesBetween(p,g,(v,y)=>{const w=Math.max(y,p),S=Math.min(y+v.nodeSize,g);v.marks.find(T=>T.type===u)?v.marks.forEach(T=>{u===T.type&&n.addMark(w,S,u.create({...T.attrs,...e}))}):n.addMark(w,S,u.create(e))})});return K8(r,n,u)},J8=(t,e)=>({tr:n})=>(n.setMeta(t,e),!0),Q8=(t,e={})=>({state:n,dispatch:r,chain:i})=>{const o=wn(t,n.schema);let a;return n.selection.$anchor.sameParent(n.selection.$head)&&(a=n.selection.$anchor.parent.attrs),o.isTextblock?i().command(({commands:c})=>sT(o,{...a,...e})(n)?!0:c.clearNodes()).command(({state:c})=>sT(o,{...a,...e})(c,r)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},Z8=t=>({tr:e,dispatch:n})=>{if(n){const{doc:r}=e,i=Js(t,0,r.content.size),o=Je.create(r,i);e.setSelection(o)}return!0},eV=(t,e)=>({tr:n,state:r,dispatch:i})=>{const{selection:o}=r;let a,c;return typeof e=="number"?(a=e,c=e):e&&"from"in e&&"to"in e?(a=e.from,c=e.to):(a=o.from,c=o.to),i&&n.doc.nodesBetween(a,c,(u,f)=>{u.isText||n.setNodeMarkup(f,void 0,{...u.attrs,dir:t})}),!0},tV=t=>({tr:e,dispatch:n})=>{if(n){const{doc:r}=e,{from:i,to:o}=typeof t=="number"?{from:t,to:t}:t,a=st.atStart(r).from,c=st.atEnd(r).to,u=Js(i,a,c),f=Js(o,a,c),p=st.create(r,u,f);e.setSelection(p)}return!0},nV=t=>({state:e,dispatch:n})=>{const r=wn(t,e.schema);return K$(r)(e,n)};function WT(t,e){const n=t.storedMarks||t.selection.$to.parentOffset&&t.selection.$from.marks();if(n){const r=n.filter(i=>e?.includes(i.type.name));t.tr.ensureMarks(r)}}var rV=({keepMarks:t=!0}={})=>({tr:e,state:n,dispatch:r,editor:i})=>{const{selection:o,doc:a}=e,{$from:c,$to:u}=o,f=i.extensionManager.attributes,p=sh(f,c.node().type.name,c.node().attrs);if(o instanceof Je&&o.node.isBlock)return!c.parentOffset||!ao(a,c.pos)?!1:(r&&(t&&WT(n,i.extensionManager.splittableMarks),e.split(c.pos).scrollIntoView()),!0);if(!c.parent.isBlock)return!1;const g=u.parentOffset===u.parent.content.size,v=c.depth===0?void 0:M8(c.node(-1).contentMatchAt(c.indexAfter(-1)));let y=g&&v?[{type:v,attrs:p}]:void 0,w=ao(e.doc,e.mapping.map(c.pos),1,y);if(!y&&!w&&ao(e.doc,e.mapping.map(c.pos),1,v?[{type:v}]:void 0)&&(w=!0,y=v?[{type:v,attrs:p}]:void 0),r){if(w&&(o instanceof st&&e.deleteSelection(),e.split(e.mapping.map(c.pos),1,y),v&&!g&&!c.parentOffset&&c.parent.type!==v)){const S=e.mapping.map(c.before()),C=e.doc.resolve(S);c.node(-1).canReplaceWith(C.index(),C.index()+1,v)&&e.setNodeMarkup(e.mapping.map(c.before()),v)}t&&WT(n,i.extensionManager.splittableMarks),e.scrollIntoView()}return w},iV=(t,e={})=>({tr:n,state:r,dispatch:i,editor:o})=>{var a;const c=wn(t,r.schema),{$from:u,$to:f}=r.selection,p=r.selection.node;if(p&&p.isBlock||u.depth<2||!u.sameParent(f))return!1;const g=u.node(-1);if(g.type!==c)return!1;const v=o.extensionManager.attributes;if(u.parent.content.size===0&&u.node(-1).childCount===u.indexAfter(-1)){if(u.depth===2||u.node(-3).type!==c||u.index(-2)!==u.node(-2).childCount-1)return!1;if(i){let T=Ee.empty;const N=u.index(-1)?1:u.index(-2)?2:3;for(let I=u.depth-N;I>=u.depth-3;I-=1)T=Ee.from(u.node(I).copy(T));const k=u.indexAfter(-1)<u.node(-2).childCount?1:u.indexAfter(-2)<u.node(-3).childCount?2:3,D={...sh(v,u.node().type.name,u.node().attrs),...e},M=((a=c.contentMatch.defaultType)==null?void 0:a.createAndFill(D))||void 0;T=T.append(Ee.from(c.createAndFill(null,M)||void 0));const R=u.before(u.depth-(N-1));n.replace(R,u.after(-k),new je(T,4-N,0));let O=-1;n.doc.nodesBetween(R,n.doc.content.size,(I,z)=>{if(O>-1)return!1;I.isTextblock&&I.content.size===0&&(O=z+1)}),O>-1&&n.setSelection(st.near(n.doc.resolve(O))),n.scrollIntoView()}return!0}const y=f.pos===u.end()?g.contentMatchAt(0).defaultType:null,w={...sh(v,g.type.name,g.attrs),...e},S={...sh(v,u.node().type.name,u.node().attrs),...e};n.delete(u.pos,f.pos);const C=y?[{type:c,attrs:w},{type:y,attrs:S}]:[{type:c,attrs:w}];if(!ao(n.doc,u.pos,2))return!1;if(i){const{selection:T,storedMarks:N}=r,{splittableMarks:k}=o.extensionManager,D=N||T.$to.parentOffset&&T.$from.marks();if(n.split(u.pos,2,C).scrollIntoView(),!D||!i)return!0;const M=D.filter(R=>k.includes(R.type.name));n.ensureMarks(M)}return!0},sv=(t,e)=>{const n=Xp(a=>a.type===e)(t.selection);if(!n)return!0;const r=t.doc.resolve(Math.max(0,n.pos-1)).before(n.depth);if(r===void 0)return!0;const i=t.doc.nodeAt(r);return n.node.type===i?.type&&Ss(t.doc,n.pos)&&t.join(n.pos),!0},av=(t,e)=>{const n=Xp(a=>a.type===e)(t.selection);if(!n)return!0;const r=t.doc.resolve(n.start).after(n.depth);if(r===void 0)return!0;const i=t.doc.nodeAt(r);return n.node.type===i?.type&&Ss(t.doc,r)&&t.join(r),!0},oV=(t,e,n,r={})=>({editor:i,tr:o,state:a,dispatch:c,chain:u,commands:f,can:p})=>{const{extensions:g,splittableMarks:v}=i.extensionManager,y=wn(t,a.schema),w=wn(e,a.schema),{selection:S,storedMarks:C}=a,{$from:T,$to:N}=S,k=T.blockRange(N),D=C||S.$to.parentOffset&&S.$from.marks();if(!k)return!1;const M=Xp(R=>GT(R.type.name,g))(S);if(k.depth>=1&&M&&k.depth-M.depth<=1){if(M.node.type===y)return f.liftListItem(w);if(GT(M.node.type.name,g)&&y.validContent(M.node.content)&&c)return u().command(()=>(o.setNodeMarkup(M.pos,y),!0)).command(()=>sv(o,y)).command(()=>av(o,y)).run()}return!n||!D||!c?u().command(()=>p().wrapInList(y,r)?!0:f.clearNodes()).wrapInList(y,r).command(()=>sv(o,y)).command(()=>av(o,y)).run():u().command(()=>{const R=p().wrapInList(y,r),O=D.filter(I=>v.includes(I.type.name));return o.ensureMarks(O),R?!0:f.clearNodes()}).wrapInList(y,r).command(()=>sv(o,y)).command(()=>av(o,y)).run()},sV=(t,e={},n={})=>({state:r,commands:i})=>{const{extendEmptyMarkRange:o=!1}=n,a=vo(t,r.schema);return gx(r,a,e)?i.unsetMark(a,{extendEmptyMarkRange:o}):i.setMark(a,e)},aV=(t,e,n={})=>({state:r,commands:i})=>{const o=wn(t,r.schema),a=wn(e,r.schema),c=vs(r,o,n);let u;return r.selection.$anchor.sameParent(r.selection.$head)&&(u=r.selection.$anchor.parent.attrs),c?i.setNode(a,u):i.setNode(o,{...u,...n})},lV=(t,e={})=>({state:n,commands:r})=>{const i=wn(t,n.schema);return vs(n,i,e)?r.lift(i):r.wrapIn(i,e)},cV=()=>({state:t,dispatch:e})=>{const n=t.plugins;for(let r=0;r<n.length;r+=1){const i=n[r];let o;if(i.spec.isInputRules&&(o=i.getState(t))){if(e){const a=t.tr,c=o.transform;for(let u=c.steps.length-1;u>=0;u-=1)a.step(c.steps[u].invert(c.docs[u]));if(o.text){const u=a.doc.resolve(o.from).marks();a.replaceWith(o.from,o.to,t.schema.text(o.text,u))}else a.delete(o.from,o.to)}return!0}}return!1},uV=()=>({tr:t,dispatch:e})=>{const{selection:n}=t,{empty:r,ranges:i}=n;return r||e&&i.forEach(o=>{t.removeMark(o.$from.pos,o.$to.pos)}),!0},dV=(t,e={})=>({tr:n,state:r,dispatch:i})=>{var o;const{extendEmptyMarkRange:a=!1}=e,{selection:c}=n,u=vo(t,r.schema),{$from:f,empty:p,ranges:g}=c;if(!i)return!0;if(p&&a){let{from:v,to:y}=c;const w=(o=f.marks().find(C=>C.type===u))==null?void 0:o.attrs,S=Qb(f,u,w);S&&(v=S.from,y=S.to),n.removeMark(v,y,u)}else g.forEach(v=>{n.removeMark(v.$from.pos,v.$to.pos,u)});return n.removeStoredMark(u),!0},fV=t=>({tr:e,state:n,dispatch:r})=>{const{selection:i}=n;let o,a;return typeof t=="number"?(o=t,a=t):t&&"from"in t&&"to"in t?(o=t.from,a=t.to):(o=i.from,a=i.to),r&&e.doc.nodesBetween(o,a,(c,u)=>{if(c.isText)return;const f={...c.attrs};delete f.dir,e.setNodeMarkup(u,void 0,f)}),!0},hV=(t,e={})=>({tr:n,state:r,dispatch:i})=>{let o=null,a=null;const c=Kp(typeof t=="string"?t:t.name,r.schema);if(!c)return!1;c==="node"&&(o=wn(t,r.schema)),c==="mark"&&(a=vo(t,r.schema));let u=!1;return n.selection.ranges.forEach(f=>{const p=f.$from.pos,g=f.$to.pos;let v,y,w,S;n.selection.empty?r.doc.nodesBetween(p,g,(C,T)=>{o&&o===C.type&&(u=!0,w=Math.max(T,p),S=Math.min(T+C.nodeSize,g),v=T,y=C)}):r.doc.nodesBetween(p,g,(C,T)=>{T<p&&o&&o===C.type&&(u=!0,w=Math.max(T,p),S=Math.min(T+C.nodeSize,g),v=T,y=C),T>=p&&T<=g&&(o&&o===C.type&&(u=!0,i&&n.setNodeMarkup(T,void 0,{...C.attrs,...e})),a&&C.marks.length&&C.marks.forEach(N=>{if(a===N.type&&(u=!0,i)){const k=Math.max(T,p),D=Math.min(T+C.nodeSize,g);n.addMark(k,D,a.create({...N.attrs,...e}))}}))}),y&&(v!==void 0&&i&&n.setNodeMarkup(v,void 0,{...y.attrs,...e}),a&&y.marks.length&&y.marks.forEach(C=>{a===C.type&&i&&n.addMark(w,S,a.create({...C.attrs,...e}))}))}),u},pV=(t,e={})=>({state:n,dispatch:r})=>{const i=wn(t,n.schema);return H$(i,e)(n,r)},mV=(t,e={})=>({state:n,dispatch:r})=>{const i=wn(t,n.schema);return U$(i,e)(n,r)},gV=class{constructor(){this.callbacks={}}on(t,e){return this.callbacks[t]||(this.callbacks[t]=[]),this.callbacks[t].push(e),this}emit(t,...e){const n=this.callbacks[t];return n&&n.forEach(r=>r.apply(this,e)),this}off(t,e){const n=this.callbacks[t];return n&&(e?this.callbacks[t]=n.filter(r=>r!==e):delete this.callbacks[t]),this}once(t,e){const n=(...r)=>{this.off(t,n),e.apply(this,r)};return this.on(t,n)}removeAllListeners(){this.callbacks={}}},Qp=class{constructor(t){var e;this.find=t.find,this.handler=t.handler,this.undoable=(e=t.undoable)!=null?e:!0}},yV=(t,e)=>{if(Jb(e))return e.exec(t);const n=e(t);if(!n)return null;const r=[n.text];return r.index=n.index,r.input=t,r.data=n.data,n.replaceWith&&(n.text.includes(n.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),r.push(n.replaceWith)),r};function Lf(t){var e;const{editor:n,from:r,to:i,text:o,rules:a,plugin:c}=t,{view:u}=n;if(u.composing)return!1;const f=u.state.doc.resolve(r);if(f.parent.type.spec.code||(e=f.nodeBefore||f.nodeAfter)!=null&&e.marks.find(v=>v.type.spec.code))return!1;let p=!1;const g=U8(f)+o;return a.forEach(v=>{if(p)return;const y=yV(g,v.find);if(!y)return;const w=u.state.tr,S=Wp({state:u.state,transaction:w}),C={from:r-(y[0].length-o.length),to:i},{commands:T,chain:N,can:k}=new Yp({editor:n,state:S});v.handler({state:S,range:C,match:y,commands:T,chain:N,can:k})===null||!w.steps.length||(v.undoable&&w.setMeta(c,{transform:w,from:r,to:i,text:o}),u.dispatch(w),p=!0)}),p}function vV(t){const{editor:e,rules:n}=t,r=new nn({state:{init(){return null},apply(i,o,a){const c=i.getMeta(r);if(c)return c;const u=i.getMeta("applyInputRules");return u&&setTimeout(()=>{let{text:p}=u;typeof p=="string"?p=p:p=e0(Ee.from(p),a.schema);const{from:g}=u,v=g+p.length;Lf({editor:e,from:g,to:v,text:p,rules:n,plugin:r})}),i.selectionSet||i.docChanged?null:o}},props:{handleTextInput(i,o,a,c){return Lf({editor:e,from:o,to:a,text:c,rules:n,plugin:r})},handleDOMEvents:{compositionend:i=>(setTimeout(()=>{const{$cursor:o}=i.state.selection;o&&Lf({editor:e,from:o.pos,to:o.pos,text:"",rules:n,plugin:r})}),!1)},handleKeyDown(i,o){if(o.key!=="Enter")return!1;const{$cursor:a}=i.state.selection;return a?Lf({editor:e,from:a.pos,to:a.pos,text:`
`,rules:n,plugin:r}):!1}},isInputRules:!0});return r}function xV(t){return Object.prototype.toString.call(t).slice(8,-1)}function Pf(t){return xV(t)!=="Object"?!1:t.constructor===Object&&Object.getPrototypeOf(t)===Object.prototype}function oM(t,e){const n={...t};return Pf(t)&&Pf(e)&&Object.keys(e).forEach(r=>{Pf(e[r])&&Pf(t[r])?n[r]=oM(t[r],e[r]):n[r]=e[r]}),n}var n0=class{constructor(t={}){this.type="extendable",this.parent=null,this.child=null,this.name="",this.config={name:this.name},this.config={...this.config,...t},this.name=this.config.name}get options(){return{...Ut(Xe(this,"addOptions",{name:this.name}))||{}}}get storage(){return{...Ut(Xe(this,"addStorage",{name:this.name,options:this.options}))||{}}}configure(t={}){const e=this.extend({...this.config,addOptions:()=>oM(this.options,t)});return e.name=this.name,e.parent=this.parent,e}extend(t={}){const e=new this.constructor({...this.config,...t});return e.parent=this,this.child=e,e.name="name"in t?t.name:e.parent.name,e}},va=class sM extends n0{constructor(){super(...arguments),this.type="mark"}static create(e={}){const n=typeof e=="function"?e():e;return new sM(n)}static handleExit({editor:e,mark:n}){const{tr:r}=e.state,i=e.state.selection.$from;if(i.pos===i.end()){const a=i.marks();if(!!!a.find(f=>f?.type.name===n.name))return!1;const u=a.find(f=>f?.type.name===n.name);return u&&r.removeStoredMark(u),r.insertText(" ",i.pos),e.view.dispatch(r),!0}return!1}configure(e){return super.configure(e)}extend(e){const n=typeof e=="function"?e():e;return super.extend(n)}};function bV(t){return typeof t=="number"}var wV=class{constructor(t){this.find=t.find,this.handler=t.handler}},SV=(t,e,n)=>{if(Jb(e))return[...t.matchAll(e)];const r=e(t,n);return r?r.map(i=>{const o=[i.text];return o.index=i.index,o.input=t,o.data=i.data,i.replaceWith&&(i.text.includes(i.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),o.push(i.replaceWith)),o}):[]};function EV(t){const{editor:e,state:n,from:r,to:i,rule:o,pasteEvent:a,dropEvent:c}=t,{commands:u,chain:f,can:p}=new Yp({editor:e,state:n}),g=[];return n.doc.nodesBetween(r,i,(y,w)=>{var S,C,T,N,k;if((C=(S=y.type)==null?void 0:S.spec)!=null&&C.code||!(y.isText||y.isTextblock||y.isInline))return;const D=(k=(N=(T=y.content)==null?void 0:T.size)!=null?N:y.nodeSize)!=null?k:0,M=Math.max(r,w),R=Math.min(i,w+D);if(M>=R)return;const O=y.isText?y.text||"":y.textBetween(M-w,R-w,void 0,"");SV(O,o.find,a).forEach(z=>{if(z.index===void 0)return;const U=M+z.index+1,Y=U+z[0].length,W={from:n.tr.mapping.map(U),to:n.tr.mapping.map(Y)},j=o.handler({state:n,range:W,match:z,commands:u,chain:f,can:p,pasteEvent:a,dropEvent:c});g.push(j)})}),g.every(y=>y!==null)}var zf=null,CV=t=>{var e;const n=new ClipboardEvent("paste",{clipboardData:new DataTransfer});return(e=n.clipboardData)==null||e.setData("text/html",t),n};function TV(t){const{editor:e,rules:n}=t;let r=null,i=!1,o=!1,a=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,c;try{c=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{c=null}const u=({state:p,from:g,to:v,rule:y,pasteEvt:w})=>{const S=p.tr,C=Wp({state:p,transaction:S});if(!(!EV({editor:e,state:C,from:Math.max(g-1,0),to:v.b-1,rule:y,pasteEvent:w,dropEvent:c})||!S.steps.length)){try{c=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{c=null}return a=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,S}};return n.map(p=>new nn({view(g){const v=w=>{var S;r=(S=g.dom.parentElement)!=null&&S.contains(w.target)?g.dom.parentElement:null,r&&(zf=e)},y=()=>{zf&&(zf=null)};return window.addEventListener("dragstart",v),window.addEventListener("dragend",y),{destroy(){window.removeEventListener("dragstart",v),window.removeEventListener("dragend",y)}}},props:{handleDOMEvents:{drop:(g,v)=>{if(o=r===g.dom.parentElement,c=v,!o){const y=zf;y?.isEditable&&setTimeout(()=>{const w=y.state.selection;w&&y.commands.deleteRange({from:w.from,to:w.to})},10)}return!1},paste:(g,v)=>{var y;const w=(y=v.clipboardData)==null?void 0:y.getData("text/html");return a=v,i=!!w?.includes("data-pm-slice"),!1}}},appendTransaction:(g,v,y)=>{const w=g[0],S=w.getMeta("uiEvent")==="paste"&&!i,C=w.getMeta("uiEvent")==="drop"&&!o,T=w.getMeta("applyPasteRules"),N=!!T;if(!S&&!C&&!N)return;if(N){let{text:M}=T;typeof M=="string"?M=M:M=e0(Ee.from(M),y.schema);const{from:R}=T,O=R+M.length,I=CV(M);return u({rule:p,state:y,from:R,to:{b:O},pasteEvt:I})}const k=v.doc.content.findDiffStart(y.doc.content),D=v.doc.content.findDiffEnd(y.doc.content);if(!(!bV(k)||!D||k===D.b))return u({rule:p,state:y,from:k,to:D,pasteEvt:a})}}))}var Zp=class{constructor(t,e){this.splittableMarks=[],this.editor=e,this.baseExtensions=t,this.extensions=JO(t),this.schema=L8(this.extensions,e),this.setupExtensions()}get commands(){return this.extensions.reduce((t,e)=>{const n={name:e.name,options:e.options,storage:this.editor.extensionStorage[e.name],editor:this.editor,type:_f(e.name,this.schema)},r=Xe(e,"addCommands",n);return r?{...t,...r()}:t},{})}get plugins(){const{editor:t}=this;return _h([...this.extensions].reverse()).flatMap(r=>{const i={name:r.name,options:r.options,storage:this.editor.extensionStorage[r.name],editor:t,type:_f(r.name,this.schema)},o=[],a=Xe(r,"addKeyboardShortcuts",i);let c={};if(r.type==="mark"&&Xe(r,"exitable",i)&&(c.ArrowRight=()=>va.handleExit({editor:t,mark:r})),a){const v=Object.fromEntries(Object.entries(a()).map(([y,w])=>[y,()=>w({editor:t})]));c={...c,...v}}const u=BU(c);o.push(u);const f=Xe(r,"addInputRules",i);if(qT(r,t.options.enableInputRules)&&f){const v=f();if(v&&v.length){const y=vV({editor:t,rules:v}),w=Array.isArray(y)?y:[y];o.push(...w)}}const p=Xe(r,"addPasteRules",i);if(qT(r,t.options.enablePasteRules)&&p){const v=p();if(v&&v.length){const y=TV({editor:t,rules:v});o.push(...y)}}const g=Xe(r,"addProseMirrorPlugins",i);if(g){const v=g();o.push(...v)}return o})}get attributes(){return XO(this.extensions)}get nodeViews(){const{editor:t}=this,{nodeExtensions:e}=jl(this.extensions);return Object.fromEntries(e.filter(n=>!!Xe(n,"addNodeView")).map(n=>{const r=this.attributes.filter(u=>u.type===n.name),i={name:n.name,options:n.options,storage:this.editor.extensionStorage[n.name],editor:t,type:wn(n.name,this.schema)},o=Xe(n,"addNodeView",i);if(!o)return[];const a=o();if(!a)return[];const c=(u,f,p,g,v)=>{const y=Il(u,r);return a({node:u,view:f,getPos:p,decorations:g,innerDecorations:v,editor:t,extension:n,HTMLAttributes:y})};return[n.name,c]}))}dispatchTransaction(t){const{editor:e}=this;return _h([...this.extensions].reverse()).reduceRight((r,i)=>{const o={name:i.name,options:i.options,storage:this.editor.extensionStorage[i.name],editor:e,type:_f(i.name,this.schema)},a=Xe(i,"dispatchTransaction",o);return a?c=>{a.call(o,{transaction:c,next:r})}:r},t)}get markViews(){const{editor:t}=this,{markExtensions:e}=jl(this.extensions);return Object.fromEntries(e.filter(n=>!!Xe(n,"addMarkView")).map(n=>{const r=this.attributes.filter(c=>c.type===n.name),i={name:n.name,options:n.options,storage:this.editor.extensionStorage[n.name],editor:t,type:vo(n.name,this.schema)},o=Xe(n,"addMarkView",i);if(!o)return[];const a=(c,u,f)=>{const p=Il(c,r);return o()({mark:c,view:u,inline:f,editor:t,extension:n,HTMLAttributes:p,updateAttributes:g=>{BV(c,t,g)}})};return[n.name,a]}))}setupExtensions(){const t=this.extensions;this.editor.extensionStorage=Object.fromEntries(t.map(e=>[e.name,e.storage])),t.forEach(e=>{var n;const r={name:e.name,options:e.options,storage:this.editor.extensionStorage[e.name],editor:this.editor,type:_f(e.name,this.schema)};e.type==="mark"&&((n=Ut(Xe(e,"keepOnSplit",r)))==null||n)&&this.splittableMarks.push(e.name);const i=Xe(e,"onBeforeCreate",r),o=Xe(e,"onCreate",r),a=Xe(e,"onUpdate",r),c=Xe(e,"onSelectionUpdate",r),u=Xe(e,"onTransaction",r),f=Xe(e,"onFocus",r),p=Xe(e,"onBlur",r),g=Xe(e,"onDestroy",r);i&&this.editor.on("beforeCreate",i),o&&this.editor.on("create",o),a&&this.editor.on("update",a),c&&this.editor.on("selectionUpdate",c),u&&this.editor.on("transaction",u),f&&this.editor.on("focus",f),p&&this.editor.on("blur",p),g&&this.editor.on("destroy",g)})}};Zp.resolve=JO;Zp.sort=_h;Zp.flatten=Zb;var NV={};Xb(NV,{ClipboardTextSerializer:()=>lM,Commands:()=>cM,Delete:()=>uM,Drop:()=>dM,Editable:()=>fM,FocusEvents:()=>pM,Keymap:()=>mM,Paste:()=>gM,Tabindex:()=>yM,TextDirection:()=>vM,focusEventsPluginKey:()=>hM});var an=class aM extends n0{constructor(){super(...arguments),this.type="extension"}static create(e={}){const n=typeof e=="function"?e():e;return new aM(n)}configure(e){return super.configure(e)}extend(e){const n=typeof e=="function"?e():e;return super.extend(n)}},lM=an.create({name:"clipboardTextSerializer",addOptions(){return{blockSeparator:void 0}},addProseMirrorPlugins(){return[new nn({key:new Sn("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:t}=this,{state:e,schema:n}=t,{doc:r,selection:i}=e,{ranges:o}=i,a=Math.min(...o.map(p=>p.$from.pos)),c=Math.max(...o.map(p=>p.$to.pos)),u=ZO(n);return QO(r,{from:a,to:c},{...this.options.blockSeparator!==void 0?{blockSeparator:this.options.blockSeparator}:{},textSerializers:u})}}})]}}),cM=an.create({name:"commands",addCommands(){return{...$O}}}),uM=an.create({name:"delete",onUpdate({transaction:t,appendedTransactions:e}){var n,r,i;const o=()=>{var a,c,u,f;if((f=(u=(c=(a=this.editor.options.coreExtensionOptions)==null?void 0:a.delete)==null?void 0:c.filterTransaction)==null?void 0:u.call(c,t))!=null?f:t.getMeta("y-sync$"))return;const p=YO(t.before,[t,...e]);tM(p).forEach(y=>{p.mapping.mapResult(y.oldRange.from).deletedAfter&&p.mapping.mapResult(y.oldRange.to).deletedBefore&&p.before.nodesBetween(y.oldRange.from,y.oldRange.to,(w,S)=>{const C=S+w.nodeSize-2,T=y.oldRange.from<=S&&C<=y.oldRange.to;this.editor.emit("delete",{type:"node",node:w,from:S,to:C,newFrom:p.mapping.map(S),newTo:p.mapping.map(C),deletedRange:y.oldRange,newRange:y.newRange,partial:!T,editor:this.editor,transaction:t,combinedTransform:p})})});const v=p.mapping;p.steps.forEach((y,w)=>{var S,C;if(y instanceof oi){const T=v.slice(w).map(y.from,-1),N=v.slice(w).map(y.to),k=v.invert().map(T,-1),D=v.invert().map(N),M=(S=p.doc.nodeAt(T-1))==null?void 0:S.marks.some(O=>O.eq(y.mark)),R=(C=p.doc.nodeAt(N))==null?void 0:C.marks.some(O=>O.eq(y.mark));this.editor.emit("delete",{type:"mark",mark:y.mark,from:y.from,to:y.to,deletedRange:{from:k,to:D},newRange:{from:T,to:N},partial:!!(R||M),editor:this.editor,transaction:t,combinedTransform:p})}})};(i=(r=(n=this.editor.options.coreExtensionOptions)==null?void 0:n.delete)==null?void 0:r.async)==null||i?setTimeout(o,0):o()}}),dM=an.create({name:"drop",addProseMirrorPlugins(){return[new nn({key:new Sn("tiptapDrop"),props:{handleDrop:(t,e,n,r)=>{this.editor.emit("drop",{editor:this.editor,event:e,slice:n,moved:r})}}})]}}),fM=an.create({name:"editable",addProseMirrorPlugins(){return[new nn({key:new Sn("editable"),props:{editable:()=>this.editor.options.editable}})]}}),hM=new Sn("focusEvents"),pM=an.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:t}=this;return[new nn({key:hM,props:{handleDOMEvents:{focus:(e,n)=>{t.isFocused=!0;const r=t.state.tr.setMeta("focus",{event:n}).setMeta("addToHistory",!1);return e.dispatch(r),!1},blur:(e,n)=>{t.isFocused=!1;const r=t.state.tr.setMeta("blur",{event:n}).setMeta("addToHistory",!1);return e.dispatch(r),!1}}}})]}}),mM=an.create({name:"keymap",addKeyboardShortcuts(){const t=()=>this.editor.commands.first(({commands:a})=>[()=>a.undoInputRule(),()=>a.command(({tr:c})=>{const{selection:u,doc:f}=c,{empty:p,$anchor:g}=u,{pos:v,parent:y}=g,w=g.parent.isTextblock&&v>0?c.doc.resolve(v-1):g,S=w.parent.type.spec.isolating,C=g.pos-g.parentOffset,T=S&&w.parent.childCount===1?C===g.pos:xt.atStart(f).from===v;return!p||!y.type.isTextblock||y.textContent.length||!T||T&&g.parent.type.name==="paragraph"?!1:a.clearNodes()}),()=>a.deleteSelection(),()=>a.joinBackward(),()=>a.selectNodeBackward()]),e=()=>this.editor.commands.first(({commands:a})=>[()=>a.deleteSelection(),()=>a.deleteCurrentNode(),()=>a.joinForward(),()=>a.selectNodeForward()]),r={Enter:()=>this.editor.commands.first(({commands:a})=>[()=>a.newlineInCode(),()=>a.createParagraphNear(),()=>a.liftEmptyBlock(),()=>a.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:t,"Mod-Backspace":t,"Shift-Backspace":t,Delete:e,"Mod-Delete":e,"Mod-a":()=>this.editor.commands.selectAll()},i={...r},o={...r,"Ctrl-h":t,"Alt-Backspace":t,"Ctrl-d":e,"Ctrl-Alt-Backspace":e,"Alt-Delete":e,"Alt-d":e,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return _u()||GO()?o:i},addProseMirrorPlugins(){return[new nn({key:new Sn("clearDocument"),appendTransaction:(t,e,n)=>{if(t.some(S=>S.getMeta("composition")))return;const r=t.some(S=>S.docChanged)&&!e.doc.eq(n.doc),i=t.some(S=>S.getMeta("preventClearDocument"));if(!r||i)return;const{empty:o,from:a,to:c}=e.selection,u=xt.atStart(e.doc).from,f=xt.atEnd(e.doc).to;if(o||!(a===u&&c===f)||!Jp(n.doc))return;const v=n.tr,y=Wp({state:n,transaction:v}),{commands:w}=new Yp({editor:this.editor,state:y});if(w.clearNodes(),!!v.steps.length)return v}})]}}),gM=an.create({name:"paste",addProseMirrorPlugins(){return[new nn({key:new Sn("tiptapPaste"),props:{handlePaste:(t,e,n)=>{this.editor.emit("paste",{editor:this.editor,event:e,slice:n})}}})]}}),yM=an.create({name:"tabindex",addProseMirrorPlugins(){return[new nn({key:new Sn("tabindex"),props:{attributes:()=>this.editor.isEditable?{tabindex:"0"}:{}}})]}}),vM=an.create({name:"textDirection",addOptions(){return{direction:void 0}},addGlobalAttributes(){if(!this.options.direction)return[];const{nodeExtensions:t}=jl(this.extensions);return[{types:t.filter(e=>e.name!=="text").map(e=>e.name),attributes:{dir:{default:this.options.direction,parseHTML:e=>{const n=e.getAttribute("dir");return n&&(n==="ltr"||n==="rtl"||n==="auto")?n:this.options.direction},renderHTML:e=>e.dir?{dir:e.dir}:{}}}}]},addProseMirrorPlugins(){return[new nn({key:new Sn("textDirection"),props:{attributes:()=>{const t=this.options.direction;return t?{dir:t}:{}}}})]}}),AV=class au{constructor(e,n,r=!1,i=null){this.currentNode=null,this.actualDepth=null,this.isBlock=r,this.resolvedPos=e,this.editor=n,this.currentNode=i}get name(){return this.node.type.name}get node(){return this.currentNode||this.resolvedPos.node()}get element(){return this.editor.view.domAtPos(this.pos).node}get depth(){var e;return(e=this.actualDepth)!=null?e:this.resolvedPos.depth}get pos(){return this.resolvedPos.pos}get content(){return this.node.content}set content(e){let n=this.from,r=this.to;if(this.isBlock){if(this.content.size===0){console.error(`You cant set content on a block node. Tried to set content on ${this.name} at ${this.pos}`);return}n=this.from+1,r=this.to-1}this.editor.commands.insertContentAt({from:n,to:r},e)}get attributes(){return this.node.attrs}get textContent(){return this.node.textContent}get size(){return this.node.nodeSize}get from(){return this.isBlock?this.pos:this.resolvedPos.start(this.resolvedPos.depth)}get range(){return{from:this.from,to:this.to}}get to(){return this.isBlock?this.pos+this.size:this.resolvedPos.end(this.resolvedPos.depth)+(this.node.isText?0:1)}get parent(){if(this.depth===0)return null;const e=this.resolvedPos.start(this.resolvedPos.depth-1),n=this.resolvedPos.doc.resolve(e);return new au(n,this.editor)}get before(){let e=this.resolvedPos.doc.resolve(this.from-(this.isBlock?1:2));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.from-3)),new au(e,this.editor)}get after(){let e=this.resolvedPos.doc.resolve(this.to+(this.isBlock?2:1));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.to+3)),new au(e,this.editor)}get children(){const e=[];return this.node.content.forEach((n,r)=>{const i=n.isBlock&&!n.isTextblock,o=n.isAtom&&!n.isText,a=n.isInline,c=this.pos+r+(o?0:1);if(c<0||c>this.resolvedPos.doc.nodeSize-2)return;const u=this.resolvedPos.doc.resolve(c);if(!i&&!a&&u.depth<=this.depth)return;const f=new au(u,this.editor,i,i||a?n:null);i&&(f.actualDepth=this.depth+1),e.push(f)}),e}get firstChild(){return this.children[0]||null}get lastChild(){const e=this.children;return e[e.length-1]||null}closest(e,n={}){let r=null,i=this.parent;for(;i&&!r;){if(i.node.type.name===e)if(Object.keys(n).length>0){const o=i.node.attrs,a=Object.keys(n);for(let c=0;c<a.length;c+=1){const u=a[c];if(o[u]!==n[u])break}}else r=i;i=i.parent}return r}querySelector(e,n={}){return this.querySelectorAll(e,n,!0)[0]||null}querySelectorAll(e,n={},r=!1){let i=[];if(!this.children||this.children.length===0)return i;const o=Object.keys(n);return this.children.forEach(a=>{r&&i.length>0||(a.node.type.name===e&&o.every(u=>n[u]===a.node.attrs[u])&&i.push(a),!(r&&i.length>0)&&(i=i.concat(a.querySelectorAll(e,n,r))))}),i}setAttribute(e){const{tr:n}=this.editor.state;n.setNodeMarkup(this.from,void 0,{...this.node.attrs,...e}),this.editor.view.dispatch(n)}},kV=`.ProseMirror {
  position: relative;
}

.ProseMirror {
  word-wrap: break-word;
  white-space: pre-wrap;
  white-space: break-spaces;
  -webkit-font-variant-ligatures: none;
  font-variant-ligatures: none;
  font-feature-settings: "liga" 0; /* the above doesn't seem to work in Edge */
}

.ProseMirror [contenteditable="false"] {
  white-space: normal;
}

.ProseMirror [contenteditable="false"] [contenteditable="true"] {
  white-space: pre-wrap;
}

.ProseMirror pre {
  white-space: pre-wrap;
}

img.ProseMirror-separator {
  display: inline !important;
  border: none !important;
  margin: 0 !important;
  width: 0 !important;
  height: 0 !important;
}

.ProseMirror-gapcursor {
  display: none;
  pointer-events: none;
  position: absolute;
  margin: 0;
}

.ProseMirror-gapcursor:after {
  content: "";
  display: block;
  position: absolute;
  top: -2px;
  width: 20px;
  border-top: 1px solid black;
  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;
}

@keyframes ProseMirror-cursor-blink {
  to {
    visibility: hidden;
  }
}

.ProseMirror-hideselection *::selection {
  background: transparent;
}

.ProseMirror-hideselection *::-moz-selection {
  background: transparent;
}

.ProseMirror-hideselection * {
  caret-color: transparent;
}

.ProseMirror-focused .ProseMirror-gapcursor {
  display: block;
}`;function DV(t,e,n){const r=document.querySelector("style[data-tiptap-style]");if(r!==null)return r;const i=document.createElement("style");return e&&i.setAttribute("nonce",e),i.setAttribute("data-tiptap-style",""),i.innerHTML=t,document.getElementsByTagName("head")[0].appendChild(i),i}var OV=class extends gV{constructor(t={}){super(),this.css=null,this.className="tiptap",this.editorView=null,this.isFocused=!1,this.isInitialized=!1,this.extensionStorage={},this.instanceId=Math.random().toString(36).slice(2,9),this.options={element:typeof document<"u"?document.createElement("div"):null,content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,textDirection:void 0,editorProps:{},parseOptions:{},coreExtensionOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,enableContentCheck:!1,emitContentError:!1,onBeforeCreate:()=>null,onCreate:()=>null,onMount:()=>null,onUnmount:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null,onContentError:({error:r})=>{throw r},onPaste:()=>null,onDrop:()=>null,onDelete:()=>null,enableExtensionDispatchTransaction:!0},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.utils={getUpdatedPosition:W8,createMappablePosition:Y8},this.setOptions(t),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.on("mount",this.options.onMount),this.on("unmount",this.options.onUnmount),this.on("contentError",this.options.onContentError),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),this.on("drop",({event:r,slice:i,moved:o})=>this.options.onDrop(r,i,o)),this.on("paste",({event:r,slice:i})=>this.options.onPaste(r,i)),this.on("delete",this.options.onDelete);const e=this.createDoc(),n=VO(e,this.options.autofocus);this.editorState=vl.create({doc:e,schema:this.schema,selection:n||void 0}),this.options.element&&this.mount(this.options.element)}mount(t){if(typeof document>"u")throw new Error("[tiptap error]: The editor cannot be mounted because there is no 'document' defined in this environment.");this.createView(t),this.emit("mount",{editor:this}),this.css&&!document.head.contains(this.css)&&document.head.appendChild(this.css),window.setTimeout(()=>{this.isDestroyed||(this.options.autofocus!==!1&&this.options.autofocus!==null&&this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}),this.isInitialized=!0)},0)}unmount(){if(this.editorView){const t=this.editorView.dom;t?.editor&&delete t.editor,this.editorView.destroy()}if(this.editorView=null,this.isInitialized=!1,this.css&&!document.querySelectorAll(`.${this.className}`).length)try{typeof this.css.remove=="function"?this.css.remove():this.css.parentNode&&this.css.parentNode.removeChild(this.css)}catch(t){console.warn("Failed to remove CSS element:",t)}this.css=null,this.emit("unmount",{editor:this})}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&typeof document<"u"&&(this.css=DV(kV,this.options.injectNonce))}setOptions(t={}){this.options={...this.options,...t},!(!this.editorView||!this.state||this.isDestroyed)&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(t,e=!0){this.setOptions({editable:t}),e&&this.emit("update",{editor:this,transaction:this.state.tr,appendedTransactions:[]})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get view(){return this.editorView?this.editorView:new Proxy({state:this.editorState,updateState:t=>{this.editorState=t},dispatch:t=>{this.dispatchTransaction(t)},composing:!1,dragging:null,editable:!0,isDestroyed:!1},{get:(t,e)=>{if(this.editorView)return this.editorView[e];if(e==="state")return this.editorState;if(e in t)return Reflect.get(t,e);throw new Error(`[tiptap error]: The editor view is not available. Cannot access view['${e}']. The editor may not be mounted yet.`)}})}get state(){return this.editorView&&(this.editorState=this.view.state),this.editorState}registerPlugin(t,e){const n=KO(e)?e(t,[...this.state.plugins]):[...this.state.plugins,t],r=this.state.reconfigure({plugins:n});return this.view.updateState(r),r}unregisterPlugin(t){if(this.isDestroyed)return;const e=this.state.plugins;let n=e;if([].concat(t).forEach(i=>{const o=typeof i=="string"?`${i}$`:i.key;n=n.filter(a=>!a.key.startsWith(o))}),e.length===n.length)return;const r=this.state.reconfigure({plugins:n});return this.view.updateState(r),r}createExtensionManager(){var t,e;const r=[...this.options.enableCoreExtensions?[fM,lM.configure({blockSeparator:(e=(t=this.options.coreExtensionOptions)==null?void 0:t.clipboardTextSerializer)==null?void 0:e.blockSeparator}),cM,pM,mM,yM,dM,gM,uM,vM.configure({direction:this.options.textDirection})].filter(i=>typeof this.options.enableCoreExtensions=="object"?this.options.enableCoreExtensions[i.name]!==!1:!0):[],...this.options.extensions].filter(i=>["extension","node","mark"].includes(i?.type));this.extensionManager=new Zp(r,this)}createCommandManager(){this.commandManager=new Yp({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createDoc(){let t;try{t=mx(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:this.options.enableContentCheck})}catch(e){if(!(e instanceof Error)||!["[tiptap error]: Invalid JSON content","[tiptap error]: Invalid HTML content"].includes(e.message))throw e;this.emit("contentError",{editor:this,error:e,disableCollaboration:()=>{"collaboration"in this.storage&&typeof this.storage.collaboration=="object"&&this.storage.collaboration&&(this.storage.collaboration.isDisabled=!0),this.options.extensions=this.options.extensions.filter(n=>n.name!=="collaboration"),this.createExtensionManager()}}),t=mx(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:!1})}return t}createView(t){const{editorProps:e,enableExtensionDispatchTransaction:n}=this.options,r=e.dispatchTransaction||this.dispatchTransaction.bind(this),i=n?this.extensionManager.dispatchTransaction(r):r;this.editorView=new BO(t,{...e,attributes:{role:"textbox",...e?.attributes},dispatchTransaction:i,state:this.editorState,markViews:this.extensionManager.markViews,nodeViews:this.extensionManager.nodeViews});const o=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(o),this.prependClass(),this.injectCSS();const a=this.view.dom;a.editor=this}createNodeViews(){this.view.isDestroyed||this.view.setProps({markViews:this.extensionManager.markViews,nodeViews:this.extensionManager.nodeViews})}prependClass(){this.view.dom.className=`${this.className} ${this.view.dom.className}`}captureTransaction(t){this.isCapturingTransaction=!0,t(),this.isCapturingTransaction=!1;const e=this.capturedTransaction;return this.capturedTransaction=null,e}dispatchTransaction(t){if(this.view.isDestroyed)return;if(this.isCapturingTransaction){if(!this.capturedTransaction){this.capturedTransaction=t;return}t.steps.forEach(f=>{var p;return(p=this.capturedTransaction)==null?void 0:p.step(f)});return}const{state:e,transactions:n}=this.state.applyTransaction(t),r=!this.state.selection.eq(e.selection),i=n.includes(t),o=this.state;if(this.emit("beforeTransaction",{editor:this,transaction:t,nextState:e}),!i)return;this.view.updateState(e),this.emit("transaction",{editor:this,transaction:t,appendedTransactions:n.slice(1)}),r&&this.emit("selectionUpdate",{editor:this,transaction:t});const a=n.findLast(f=>f.getMeta("focus")||f.getMeta("blur")),c=a?.getMeta("focus"),u=a?.getMeta("blur");c&&this.emit("focus",{editor:this,event:c.event,transaction:a}),u&&this.emit("blur",{editor:this,event:u.event,transaction:a}),!(t.getMeta("preventUpdate")||!n.some(f=>f.docChanged)||o.doc.eq(e.doc))&&this.emit("update",{editor:this,transaction:t,appendedTransactions:n.slice(1)})}getAttributes(t){return eM(this.state,t)}isActive(t,e){const n=typeof t=="string"?t:null,r=typeof t=="string"?e:t;return V8(this.state,n,r)}getJSON(){return this.state.doc.toJSON()}getHTML(){return e0(this.state.doc.content,this.schema)}getText(t){const{blockSeparator:e=`

`,textSerializers:n={}}=t||{};return z8(this.state.doc,{blockSeparator:e,textSerializers:{...ZO(this.schema),...n}})}get isEmpty(){return Jp(this.state.doc)}destroy(){this.emit("destroy"),this.unmount(),this.removeAllListeners()}get isDestroyed(){var t,e;return(e=(t=this.editorView)==null?void 0:t.isDestroyed)!=null?e:!0}$node(t,e){var n;return((n=this.$doc)==null?void 0:n.querySelector(t,e))||null}$nodes(t,e){var n;return((n=this.$doc)==null?void 0:n.querySelectorAll(t,e))||null}$pos(t){const e=this.state.doc.resolve(t);return new AV(e,this)}get $doc(){return this.$pos(0)}};function _l(t){return new Qp({find:t.find,handler:({state:e,range:n,match:r})=>{const i=Ut(t.getAttributes,void 0,r);if(i===!1||i===null)return null;const{tr:o}=e,a=r[r.length-1],c=r[0];if(a){const u=c.search(/\S/),f=n.from+c.indexOf(a),p=f+a.length;if(t0(n.from,n.to,e.doc).filter(y=>y.mark.type.excluded.find(S=>S===t.type&&S!==y.mark.type)).filter(y=>y.to>f).length)return null;p<n.to&&o.delete(p,n.to),f>n.from&&o.delete(n.from+u,f);const v=n.from+u+a.length;o.addMark(n.from+u,v,t.type.create(i||{})),o.removeStoredMark(t.type)}},undoable:t.undoable})}function MV(t){return new Qp({find:t.find,handler:({state:e,range:n,match:r})=>{const i=Ut(t.getAttributes,void 0,r)||{},{tr:o}=e,a=n.from;let c=n.to;const u=t.type.create(i);if(r[1]){const f=r[0].lastIndexOf(r[1]);let p=a+f;p>c?p=c:c=p+r[1].length;const g=r[0][r[0].length-1];o.insertText(g,a+r[0].length-1),o.replaceWith(p,c,u)}else if(r[0]){const f=t.type.isInline?a:a-1;o.insert(f,t.type.create(i)).delete(o.mapping.map(a),o.mapping.map(c))}o.scrollIntoView()},undoable:t.undoable})}function yx(t){return new Qp({find:t.find,handler:({state:e,range:n,match:r})=>{const i=e.doc.resolve(n.from),o=Ut(t.getAttributes,void 0,r)||{};if(!i.node(-1).canReplaceWith(i.index(-1),i.indexAfter(-1),t.type))return null;e.tr.delete(n.from,n.to).setBlockType(n.from,n.from,t.type,o)},undoable:t.undoable})}function Ll(t){return new Qp({find:t.find,handler:({state:e,range:n,match:r,chain:i})=>{const o=Ut(t.getAttributes,void 0,r)||{},a=e.tr.delete(n.from,n.to),u=a.doc.resolve(n.from).blockRange(),f=u&&Ib(u,t.type,o);if(!f)return null;if(a.wrap(u,f),t.keepMarks&&t.editor){const{selection:g,storedMarks:v}=e,{splittableMarks:y}=t.editor.extensionManager,w=v||g.$to.parentOffset&&g.$from.marks();if(w){const S=w.filter(C=>y.includes(C.type.name));a.ensureMarks(S)}}if(t.keepAttributes){const g=t.type.name==="bulletList"||t.type.name==="orderedList"?"listItem":"taskList";i().updateAttributes(g,o).run()}const p=a.doc.resolve(n.from-1).nodeBefore;p&&p.type===t.type&&Ss(a.doc,n.from-1)&&(!t.joinPredicate||t.joinPredicate(r,p))&&a.join(n.from-1)},undoable:t.undoable})}function RV(t,e){const{selection:n}=t,{$from:r}=n;if(n instanceof Je){const o=r.index();return r.parent.canReplaceWith(o,o+1,e)}let i=r.depth;for(;i>=0;){const o=r.index(i);if(r.node(i).contentMatchAt(o).matchType(e))return!0;i-=1}return!1}var jV={};Xb(jV,{createAtomBlockMarkdownSpec:()=>IV,createBlockMarkdownSpec:()=>_V,createInlineMarkdownSpec:()=>zV,parseAttributes:()=>r0,parseIndentedBlocks:()=>vx,renderNestedMarkdownContent:()=>o0,serializeAttributes:()=>i0});function r0(t){if(!t?.trim())return{};const e={},n=[],r=t.replace(/["']([^"']*)["']/g,f=>(n.push(f),`__QUOTED_${n.length-1}__`)),i=r.match(/(?:^|\s)\.([a-zA-Z][\w-]*)/g);if(i){const f=i.map(p=>p.trim().slice(1));e.class=f.join(" ")}const o=r.match(/(?:^|\s)#([a-zA-Z][\w-]*)/);o&&(e.id=o[1]);const a=/([a-zA-Z][\w-]*)\s*=\s*(__QUOTED_\d+__)/g;Array.from(r.matchAll(a)).forEach(([,f,p])=>{var g;const v=parseInt(((g=p.match(/__QUOTED_(\d+)__/))==null?void 0:g[1])||"0",10),y=n[v];y&&(e[f]=y.slice(1,-1))});const u=r.replace(/(?:^|\s)\.([a-zA-Z][\w-]*)/g,"").replace(/(?:^|\s)#([a-zA-Z][\w-]*)/g,"").replace(/([a-zA-Z][\w-]*)\s*=\s*__QUOTED_\d+__/g,"").trim();return u&&u.split(/\s+/).filter(Boolean).forEach(p=>{p.match(/^[a-zA-Z][\w-]*$/)&&(e[p]=!0)}),e}function i0(t){if(!t||Object.keys(t).length===0)return"";const e=[];return t.class&&String(t.class).split(/\s+/).filter(Boolean).forEach(r=>e.push(`.${r}`)),t.id&&e.push(`#${t.id}`),Object.entries(t).forEach(([n,r])=>{n==="class"||n==="id"||(r===!0?e.push(n):r!==!1&&r!=null&&e.push(`${n}="${String(r)}"`))}),e.join(" ")}function IV(t){const{nodeName:e,name:n,parseAttributes:r=r0,serializeAttributes:i=i0,defaultAttributes:o={},requiredAttributes:a=[],allowedAttributes:c}=t,u=n||e,f=p=>{if(!c)return p;const g={};return c.forEach(v=>{v in p&&(g[v]=p[v])}),g};return{parseMarkdown:(p,g)=>{const v={...o,...p.attributes};return g.createNode(e,v,[])},markdownTokenizer:{name:e,level:"block",start(p){var g;const v=new RegExp(`^:::${u}(?:\\s|$)`,"m"),y=(g=p.match(v))==null?void 0:g.index;return y!==void 0?y:-1},tokenize(p,g,v){const y=new RegExp(`^:::${u}(?:\\s+\\{([^}]*)\\})?\\s*:::(?:\\n|$)`),w=p.match(y);if(!w)return;const S=w[1]||"",C=r(S);if(!a.find(N=>!(N in C)))return{type:e,raw:w[0],attributes:C}}},renderMarkdown:p=>{const g=f(p.attrs||{}),v=i(g),y=v?` {${v}}`:"";return`:::${u}${y} :::`}}}function _V(t){const{nodeName:e,name:n,getContent:r,parseAttributes:i=r0,serializeAttributes:o=i0,defaultAttributes:a={},content:c="block",allowedAttributes:u}=t,f=n||e,p=g=>{if(!u)return g;const v={};return u.forEach(y=>{y in g&&(v[y]=g[y])}),v};return{parseMarkdown:(g,v)=>{let y;if(r){const S=r(g);y=typeof S=="string"?[{type:"text",text:S}]:S}else c==="block"?y=v.parseChildren(g.tokens||[]):y=v.parseInline(g.tokens||[]);const w={...a,...g.attributes};return v.createNode(e,w,y)},markdownTokenizer:{name:e,level:"block",start(g){var v;const y=new RegExp(`^:::${f}`,"m"),w=(v=g.match(y))==null?void 0:v.index;return w!==void 0?w:-1},tokenize(g,v,y){var w;const S=new RegExp(`^:::${f}(?:\\s+\\{([^}]*)\\})?\\s*\\n`),C=g.match(S);if(!C)return;const[T,N=""]=C,k=i(N);let D=1;const M=T.length;let R="";const O=/^:::([\w-]*)(\s.*)?/gm,I=g.slice(M);for(O.lastIndex=0;;){const z=O.exec(I);if(z===null)break;const U=z.index,Y=z[1];if(!((w=z[2])!=null&&w.endsWith(":::"))){if(Y)D+=1;else if(D-=1,D===0){const W=I.slice(0,U);R=W.trim();const j=g.slice(0,M+U+z[0].length);let G=[];if(R)if(c==="block")for(G=y.blockTokens(W),G.forEach(oe=>{oe.text&&(!oe.tokens||oe.tokens.length===0)&&(oe.tokens=y.inlineTokens(oe.text))});G.length>0;){const oe=G[G.length-1];if(oe.type==="paragraph"&&(!oe.text||oe.text.trim()===""))G.pop();else break}else G=y.inlineTokens(R);return{type:e,raw:j,attributes:k,content:R,tokens:G}}}}}},renderMarkdown:(g,v)=>{const y=p(g.attrs||{}),w=o(y),S=w?` {${w}}`:"",C=v.renderChildren(g.content||[],`

`);return`:::${f}${S}

${C}

:::`}}}function LV(t){if(!t.trim())return{};const e={},n=/(\w+)=(?:"([^"]*)"|'([^']*)')/g;let r=n.exec(t);for(;r!==null;){const[,i,o,a]=r;e[i]=o||a,r=n.exec(t)}return e}function PV(t){return Object.entries(t).filter(([,e])=>e!=null).map(([e,n])=>`${e}="${n}"`).join(" ")}function zV(t){const{nodeName:e,name:n,getContent:r,parseAttributes:i=LV,serializeAttributes:o=PV,defaultAttributes:a={},selfClosing:c=!1,allowedAttributes:u}=t,f=n||e,p=v=>{if(!u)return v;const y={};return u.forEach(w=>{const S=typeof w=="string"?w:w.name,C=typeof w=="string"?void 0:w.skipIfDefault;if(S in v){const T=v[S];if(C!==void 0&&T===C)return;y[S]=T}}),y},g=f.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");return{parseMarkdown:(v,y)=>{const w={...a,...v.attributes};if(c)return y.createNode(e,w);const S=r?r(v):v.content||"";return S?y.createNode(e,w,[y.createTextNode(S)]):y.createNode(e,w,[])},markdownTokenizer:{name:e,level:"inline",start(v){const y=c?new RegExp(`\\[${g}\\s*[^\\]]*\\]`):new RegExp(`\\[${g}\\s*[^\\]]*\\][\\s\\S]*?\\[\\/${g}\\]`),w=v.match(y),S=w?.index;return S!==void 0?S:-1},tokenize(v,y,w){const S=c?new RegExp(`^\\[${g}\\s*([^\\]]*)\\]`):new RegExp(`^\\[${g}\\s*([^\\]]*)\\]([\\s\\S]*?)\\[\\/${g}\\]`),C=v.match(S);if(!C)return;let T="",N="";if(c){const[,D]=C;N=D}else{const[,D,M]=C;N=D,T=M||""}const k=i(N.trim());return{type:e,raw:C[0],content:T.trim(),attributes:k}}},renderMarkdown:v=>{let y="";r?y=r(v):v.content&&v.content.length>0&&(y=v.content.filter(T=>T.type==="text").map(T=>T.text).join(""));const w=p(v.attrs||{}),S=o(w),C=S?` ${S}`:"";return c?`[${f}${C}]`:`[${f}${C}]${y}[/${f}]`}}}function vx(t,e,n){var r,i,o,a;const c=t.split(`
`),u=[];let f="",p=0;const g=e.baseIndentSize||2;for(;p<c.length;){const v=c[p],y=v.match(e.itemPattern);if(!y){if(u.length>0)break;if(v.trim()===""){p+=1,f=`${f}${v}
`;continue}else return}const w=e.extractItemData(y),{indentLevel:S,mainContent:C}=w;f=`${f}${v}
`;const T=[C];for(p+=1;p<c.length;){const M=c[p];if(M.trim()===""){const O=c.slice(p+1).findIndex(U=>U.trim()!=="");if(O===-1)break;if((((i=(r=c[p+1+O].match(/^(\s*)/))==null?void 0:r[1])==null?void 0:i.length)||0)>S){T.push(M),f=`${f}${M}
`,p+=1;continue}else break}if((((a=(o=M.match(/^(\s*)/))==null?void 0:o[1])==null?void 0:a.length)||0)>S)T.push(M),f=`${f}${M}
`,p+=1;else break}let N;const k=T.slice(1);if(k.length>0){const M=k.map(R=>R.slice(S+g)).join(`
`);M.trim()&&(e.customNestedParser?N=e.customNestedParser(M):N=n.blockTokens(M))}const D=e.createToken(w,N);u.push(D)}if(u.length!==0)return{items:u,raw:f}}function o0(t,e,n,r){if(!t||!Array.isArray(t.content))return"";const i=typeof n=="function"?n(r):n,[o,...a]=t.content,c=e.renderChildren([o]),u=[`${i}${c}`];return a&&a.length>0&&a.forEach(f=>{const p=e.renderChildren([f]);if(p){const g=p.split(`
`).map(v=>v?e.indent(v):"").join(`
`);u.push(g)}}),u.join(`
`)}function BV(t,e,n={}){const{state:r}=e,{doc:i,tr:o}=r,a=t;i.descendants((c,u)=>{const f=o.mapping.map(u),p=o.mapping.map(u)+c.nodeSize;let g=null;if(c.marks.forEach(y=>{if(y!==a)return!1;g=y}),!g)return;let v=!1;if(Object.keys(n).forEach(y=>{n[y]!==g.attrs[y]&&(v=!0)}),v){const y=t.type.create({...t.attrs,...n});o.removeMark(f,p,t.type),o.addMark(f,p,y)}}),o.docChanged&&e.view.dispatch(o)}var Xn=class xM extends n0{constructor(){super(...arguments),this.type="node"}static create(e={}){const n=typeof e=="function"?e():e;return new xM(n)}configure(e){return super.configure(e)}extend(e){const n=typeof e=="function"?e():e;return super.extend(n)}},FV=class{constructor(t,e,n){this.isDragging=!1,this.component=t,this.editor=e.editor,this.options={stopEvent:null,ignoreMutation:null,...n},this.extension=e.extension,this.node=e.node,this.decorations=e.decorations,this.innerDecorations=e.innerDecorations,this.view=e.view,this.HTMLAttributes=e.HTMLAttributes,this.getPos=e.getPos,this.mount()}mount(){}get dom(){return this.editor.view.dom}get contentDOM(){return null}onDragStart(t){var e,n,r,i,o,a,c;const{view:u}=this.editor,f=t.target,p=f.nodeType===3?(e=f.parentElement)==null?void 0:e.closest("[data-drag-handle]"):f.closest("[data-drag-handle]");if(!this.dom||(n=this.contentDOM)!=null&&n.contains(f)||!p)return;let g=0,v=0;if(this.dom!==p){const N=this.dom.getBoundingClientRect(),k=p.getBoundingClientRect(),D=(i=t.offsetX)!=null?i:(r=t.nativeEvent)==null?void 0:r.offsetX,M=(a=t.offsetY)!=null?a:(o=t.nativeEvent)==null?void 0:o.offsetY;g=k.x-N.x+D,v=k.y-N.y+M}const y=this.dom.cloneNode(!0);try{const N=this.dom.getBoundingClientRect();y.style.width=`${Math.round(N.width)}px`,y.style.height=`${Math.round(N.height)}px`,y.style.boxSizing="border-box",y.style.pointerEvents="none"}catch{}let w=null;try{w=document.createElement("div"),w.style.position="absolute",w.style.top="-9999px",w.style.left="-9999px",w.style.pointerEvents="none",w.appendChild(y),document.body.appendChild(w),(c=t.dataTransfer)==null||c.setDragImage(y,g,v)}finally{w&&setTimeout(()=>{try{w?.remove()}catch{}},0)}const S=this.getPos();if(typeof S!="number")return;const C=Je.create(u.state.doc,S),T=u.state.tr.setSelection(C);u.dispatch(T)}stopEvent(t){var e;if(!this.dom)return!1;if(typeof this.options.stopEvent=="function")return this.options.stopEvent({event:t});const n=t.target;if(!(this.dom.contains(n)&&!((e=this.contentDOM)!=null&&e.contains(n))))return!1;const i=t.type.startsWith("drag"),o=t.type==="drop";if((["INPUT","BUTTON","SELECT","TEXTAREA"].includes(n.tagName)||n.isContentEditable)&&!o&&!i)return!0;const{isEditable:c}=this.editor,{isDragging:u}=this,f=!!this.node.type.spec.draggable,p=Je.isSelectable(this.node),g=t.type==="copy",v=t.type==="paste",y=t.type==="cut",w=t.type==="mousedown";if(!f&&p&&i&&t.target===this.dom&&t.preventDefault(),f&&i&&!u&&t.target===this.dom)return t.preventDefault(),!1;if(f&&c&&!u&&w){const S=n.closest("[data-drag-handle]");S&&(this.dom===S||this.dom.contains(S))&&(this.isDragging=!0,document.addEventListener("dragend",()=>{this.isDragging=!1},{once:!0}),document.addEventListener("drop",()=>{this.isDragging=!1},{once:!0}),document.addEventListener("mouseup",()=>{this.isDragging=!1},{once:!0}))}return!(u||o||g||v||y||w&&p)}ignoreMutation(t){return!this.dom||!this.contentDOM?!0:typeof this.options.ignoreMutation=="function"?this.options.ignoreMutation({mutation:t}):this.node.isLeaf||this.node.isAtom?!0:t.type==="selection"||this.dom.contains(t.target)&&t.type==="childList"&&(_u()||px())&&this.editor.isFocused&&[...Array.from(t.addedNodes),...Array.from(t.removedNodes)].every(n=>n.isContentEditable)?!1:this.contentDOM===t.target&&t.type==="attributes"?!0:!this.contentDOM.contains(t.target)}updateAttributes(t){this.editor.commands.command(({tr:e})=>{const n=this.getPos();return typeof n!="number"?!1:(e.setNodeMarkup(n,void 0,{...this.node.attrs,...t}),!0)})}deleteNode(){const t=this.getPos();if(typeof t!="number")return;const e=t+this.node.nodeSize;this.editor.commands.deleteRange({from:t,to:e})}};function pa(t){return new wV({find:t.find,handler:({state:e,range:n,match:r,pasteEvent:i})=>{const o=Ut(t.getAttributes,void 0,r,i);if(o===!1||o===null)return null;const{tr:a}=e,c=r[r.length-1],u=r[0];let f=n.to;if(c){const p=u.search(/\S/),g=n.from+u.indexOf(c),v=g+c.length;if(t0(n.from,n.to,e.doc).filter(w=>w.mark.type.excluded.find(C=>C===t.type&&C!==w.mark.type)).filter(w=>w.to>g).length)return null;v<n.to&&a.delete(v,n.to),g>n.from&&a.delete(n.from+p,g),f=n.from+p+c.length,a.addMark(n.from+p,f,t.type.create(o||{})),a.removeStoredMark(t.type)}}})}const{getOwnPropertyNames:$V,getOwnPropertySymbols:HV}=Object,{hasOwnProperty:UV}=Object.prototype;function lv(t,e){return function(r,i,o){return t(r,i,o)&&e(r,i,o)}}function Bf(t){return function(n,r,i){if(!n||!r||typeof n!="object"||typeof r!="object")return t(n,r,i);const{cache:o}=i,a=o.get(n),c=o.get(r);if(a&&c)return a===r&&c===n;o.set(n,r),o.set(r,n);const u=t(n,r,i);return o.delete(n),o.delete(r),u}}function VV(t){return t?.[Symbol.toStringTag]}function YT(t){return $V(t).concat(HV(t))}const qV=Object.hasOwn||((t,e)=>UV.call(t,e));function xa(t,e){return t===e||!t&&!e&&t!==t&&e!==e}const GV="__v",WV="__o",YV="_owner",{getOwnPropertyDescriptor:KT,keys:XT}=Object;function KV(t,e){return t.byteLength===e.byteLength&&Lh(new Uint8Array(t),new Uint8Array(e))}function XV(t,e,n){let r=t.length;if(e.length!==r)return!1;for(;r-- >0;)if(!n.equals(t[r],e[r],r,r,t,e,n))return!1;return!0}function JV(t,e){return t.byteLength===e.byteLength&&Lh(new Uint8Array(t.buffer,t.byteOffset,t.byteLength),new Uint8Array(e.buffer,e.byteOffset,e.byteLength))}function QV(t,e){return xa(t.getTime(),e.getTime())}function ZV(t,e){return t.name===e.name&&t.message===e.message&&t.cause===e.cause&&t.stack===e.stack}function e9(t,e){return t===e}function JT(t,e,n){const r=t.size;if(r!==e.size)return!1;if(!r)return!0;const i=new Array(r),o=t.entries();let a,c,u=0;for(;(a=o.next())&&!a.done;){const f=e.entries();let p=!1,g=0;for(;(c=f.next())&&!c.done;){if(i[g]){g++;continue}const v=a.value,y=c.value;if(n.equals(v[0],y[0],u,g,t,e,n)&&n.equals(v[1],y[1],v[0],y[0],t,e,n)){p=i[g]=!0;break}g++}if(!p)return!1;u++}return!0}const t9=xa;function n9(t,e,n){const r=XT(t);let i=r.length;if(XT(e).length!==i)return!1;for(;i-- >0;)if(!bM(t,e,n,r[i]))return!1;return!0}function Kc(t,e,n){const r=YT(t);let i=r.length;if(YT(e).length!==i)return!1;let o,a,c;for(;i-- >0;)if(o=r[i],!bM(t,e,n,o)||(a=KT(t,o),c=KT(e,o),(a||c)&&(!a||!c||a.configurable!==c.configurable||a.enumerable!==c.enumerable||a.writable!==c.writable)))return!1;return!0}function r9(t,e){return xa(t.valueOf(),e.valueOf())}function i9(t,e){return t.source===e.source&&t.flags===e.flags}function QT(t,e,n){const r=t.size;if(r!==e.size)return!1;if(!r)return!0;const i=new Array(r),o=t.values();let a,c;for(;(a=o.next())&&!a.done;){const u=e.values();let f=!1,p=0;for(;(c=u.next())&&!c.done;){if(!i[p]&&n.equals(a.value,c.value,a.value,c.value,t,e,n)){f=i[p]=!0;break}p++}if(!f)return!1}return!0}function Lh(t,e){let n=t.byteLength;if(e.byteLength!==n||t.byteOffset!==e.byteOffset)return!1;for(;n-- >0;)if(t[n]!==e[n])return!1;return!0}function o9(t,e){return t.hostname===e.hostname&&t.pathname===e.pathname&&t.protocol===e.protocol&&t.port===e.port&&t.hash===e.hash&&t.username===e.username&&t.password===e.password}function bM(t,e,n,r){return(r===YV||r===WV||r===GV)&&(t.$$typeof||e.$$typeof)?!0:qV(e,r)&&n.equals(t[r],e[r],r,r,t,e,n)}const s9="[object ArrayBuffer]",a9="[object Arguments]",l9="[object Boolean]",c9="[object DataView]",u9="[object Date]",d9="[object Error]",f9="[object Map]",h9="[object Number]",p9="[object Object]",m9="[object RegExp]",g9="[object Set]",y9="[object String]",v9={"[object Int8Array]":!0,"[object Uint8Array]":!0,"[object Uint8ClampedArray]":!0,"[object Int16Array]":!0,"[object Uint16Array]":!0,"[object Int32Array]":!0,"[object Uint32Array]":!0,"[object Float16Array]":!0,"[object Float32Array]":!0,"[object Float64Array]":!0,"[object BigInt64Array]":!0,"[object BigUint64Array]":!0},x9="[object URL]",b9=Object.prototype.toString;function w9({areArrayBuffersEqual:t,areArraysEqual:e,areDataViewsEqual:n,areDatesEqual:r,areErrorsEqual:i,areFunctionsEqual:o,areMapsEqual:a,areNumbersEqual:c,areObjectsEqual:u,arePrimitiveWrappersEqual:f,areRegExpsEqual:p,areSetsEqual:g,areTypedArraysEqual:v,areUrlsEqual:y,unknownTagComparators:w}){return function(C,T,N){if(C===T)return!0;if(C==null||T==null)return!1;const k=typeof C;if(k!==typeof T)return!1;if(k!=="object")return k==="number"?c(C,T,N):k==="function"?o(C,T,N):!1;const D=C.constructor;if(D!==T.constructor)return!1;if(D===Object)return u(C,T,N);if(Array.isArray(C))return e(C,T,N);if(D===Date)return r(C,T,N);if(D===RegExp)return p(C,T,N);if(D===Map)return a(C,T,N);if(D===Set)return g(C,T,N);const M=b9.call(C);if(M===u9)return r(C,T,N);if(M===m9)return p(C,T,N);if(M===f9)return a(C,T,N);if(M===g9)return g(C,T,N);if(M===p9)return typeof C.then!="function"&&typeof T.then!="function"&&u(C,T,N);if(M===x9)return y(C,T,N);if(M===d9)return i(C,T,N);if(M===a9)return u(C,T,N);if(v9[M])return v(C,T,N);if(M===s9)return t(C,T,N);if(M===c9)return n(C,T,N);if(M===l9||M===h9||M===y9)return f(C,T,N);if(w){let R=w[M];if(!R){const O=VV(C);O&&(R=w[O])}if(R)return R(C,T,N)}return!1}}function S9({circular:t,createCustomConfig:e,strict:n}){let r={areArrayBuffersEqual:KV,areArraysEqual:n?Kc:XV,areDataViewsEqual:JV,areDatesEqual:QV,areErrorsEqual:ZV,areFunctionsEqual:e9,areMapsEqual:n?lv(JT,Kc):JT,areNumbersEqual:t9,areObjectsEqual:n?Kc:n9,arePrimitiveWrappersEqual:r9,areRegExpsEqual:i9,areSetsEqual:n?lv(QT,Kc):QT,areTypedArraysEqual:n?lv(Lh,Kc):Lh,areUrlsEqual:o9,unknownTagComparators:void 0};if(e&&(r=Object.assign({},r,e(r))),t){const i=Bf(r.areArraysEqual),o=Bf(r.areMapsEqual),a=Bf(r.areObjectsEqual),c=Bf(r.areSetsEqual);r=Object.assign({},r,{areArraysEqual:i,areMapsEqual:o,areObjectsEqual:a,areSetsEqual:c})}return r}function E9(t){return function(e,n,r,i,o,a,c){return t(e,n,c)}}function C9({circular:t,comparator:e,createState:n,equals:r,strict:i}){if(n)return function(c,u){const{cache:f=t?new WeakMap:void 0,meta:p}=n();return e(c,u,{cache:f,equals:r,meta:p,strict:i})};if(t)return function(c,u){return e(c,u,{cache:new WeakMap,equals:r,meta:void 0,strict:i})};const o={cache:void 0,equals:r,meta:void 0,strict:i};return function(c,u){return e(c,u,o)}}const T9=Cs();Cs({strict:!0});Cs({circular:!0});Cs({circular:!0,strict:!0});Cs({createInternalComparator:()=>xa});Cs({strict:!0,createInternalComparator:()=>xa});Cs({circular:!0,createInternalComparator:()=>xa});Cs({circular:!0,createInternalComparator:()=>xa,strict:!0});function Cs(t={}){const{circular:e=!1,createInternalComparator:n,createState:r,strict:i=!1}=t,o=S9(t),a=w9(o),c=n?n(a):E9(a);return C9({circular:e,comparator:a,createState:r,equals:c,strict:i})}var cv={exports:{}},uv={};var ZT;function N9(){if(ZT)return uv;ZT=1;var t=Wu(),e=dD();function n(f,p){return f===p&&(f!==0||1/f===1/p)||f!==f&&p!==p}var r=typeof Object.is=="function"?Object.is:n,i=e.useSyncExternalStore,o=t.useRef,a=t.useEffect,c=t.useMemo,u=t.useDebugValue;return uv.useSyncExternalStoreWithSelector=function(f,p,g,v,y){var w=o(null);if(w.current===null){var S={hasValue:!1,value:null};w.current=S}else S=w.current;w=c(function(){function T(R){if(!N){if(N=!0,k=R,R=v(R),y!==void 0&&S.hasValue){var O=S.value;if(y(O,R))return D=O}return D=R}if(O=D,r(k,R))return O;var I=v(R);return y!==void 0&&y(O,I)?(k=R,O):(k=R,D=I)}var N=!1,k,D,M=g===void 0?null:g;return[function(){return T(p())},M===null?void 0:function(){return T(M())}]},[p,g,v,y]);var C=i(f,w[0],w[1]);return a(function(){S.hasValue=!0,S.value=C},[C]),u(C),C},uv}var eN;function A9(){return eN||(eN=1,cv.exports=N9()),cv.exports}var k9=A9(),D9=(...t)=>e=>{t.forEach(n=>{typeof n=="function"?n(e):n&&(n.current=e)})},O9=({contentComponent:t})=>{const e=fD.useSyncExternalStore(t.subscribe,t.getSnapshot,t.getServerSnapshot);return h.jsx(h.Fragment,{children:Object.values(e)})};function M9(){const t=new Set;let e={};return{subscribe(n){return t.add(n),()=>{t.delete(n)}},getSnapshot(){return e},getServerSnapshot(){return e},setRenderer(n,r){e={...e,[n]:ob.createPortal(r.reactElement,r.element,n)},t.forEach(i=>i())},removeRenderer(n){const r={...e};delete r[n],e=r,t.forEach(i=>i())}}}var R9=class extends Se.Component{constructor(t){var e;super(t),this.editorContentRef=Se.createRef(),this.initialized=!1,this.state={hasContentComponentInitialized:!!((e=t.editor)!=null&&e.contentComponent)}}componentDidMount(){this.init()}componentDidUpdate(){this.init()}init(){var t;const e=this.props.editor;if(e&&!e.isDestroyed&&((t=e.view.dom)!=null&&t.parentNode)){if(e.contentComponent)return;const n=this.editorContentRef.current;n.append(...e.view.dom.parentNode.childNodes),e.setOptions({element:n}),e.contentComponent=M9(),this.state.hasContentComponentInitialized||(this.unsubscribeToContentComponent=e.contentComponent.subscribe(()=>{this.setState(r=>r.hasContentComponentInitialized?r:{hasContentComponentInitialized:!0}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent()})),e.createNodeViews(),this.initialized=!0}}componentWillUnmount(){var t;const e=this.props.editor;if(e){this.initialized=!1,e.isDestroyed||e.view.setProps({nodeViews:{}}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent(),e.contentComponent=null;try{if(!((t=e.view.dom)!=null&&t.parentNode))return;const n=document.createElement("div");n.append(...e.view.dom.parentNode.childNodes),e.setOptions({element:n})}catch{}}}render(){const{editor:t,innerRef:e,...n}=this.props;return h.jsxs(h.Fragment,{children:[h.jsx("div",{ref:D9(e,this.editorContentRef),...n}),t?.contentComponent&&h.jsx(O9,{contentComponent:t.contentComponent})]})}},j9=x.forwardRef((t,e)=>{const n=Se.useMemo(()=>Math.floor(Math.random()*4294967295).toString(),[t.editor]);return Se.createElement(R9,{key:n,innerRef:e,...t})}),wM=Se.memo(j9),I9=typeof window<"u"?x.useLayoutEffect:x.useEffect,_9=class{constructor(t){this.transactionNumber=0,this.lastTransactionNumber=0,this.subscribers=new Set,this.editor=t,this.lastSnapshot={editor:t,transactionNumber:0},this.getSnapshot=this.getSnapshot.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.watch=this.watch.bind(this),this.subscribe=this.subscribe.bind(this)}getSnapshot(){return this.transactionNumber===this.lastTransactionNumber?this.lastSnapshot:(this.lastTransactionNumber=this.transactionNumber,this.lastSnapshot={editor:this.editor,transactionNumber:this.transactionNumber},this.lastSnapshot)}getServerSnapshot(){return{editor:null,transactionNumber:0}}subscribe(t){return this.subscribers.add(t),()=>{this.subscribers.delete(t)}}watch(t){if(this.editor=t,this.editor){const e=()=>{this.transactionNumber+=1,this.subscribers.forEach(r=>r())},n=this.editor;return n.on("transaction",e),()=>{n.off("transaction",e)}}}};function L9(t){var e;const[n]=x.useState(()=>new _9(t.editor)),r=k9.useSyncExternalStoreWithSelector(n.subscribe,n.getSnapshot,n.getServerSnapshot,t.selector,(e=t.equalityFn)!=null?e:T9);return I9(()=>n.watch(t.editor),[t.editor,n]),x.useDebugValue(r),r}var P9=!1,xx=typeof window>"u",z9=xx||!!(typeof window<"u"&&window.next),B9=class SM{constructor(e){this.editor=null,this.subscriptions=new Set,this.isComponentMounted=!1,this.previousDeps=null,this.instanceId="",this.options=e,this.subscriptions=new Set,this.setEditor(this.getInitialEditor()),this.scheduleDestroy(),this.getEditor=this.getEditor.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.subscribe=this.subscribe.bind(this),this.refreshEditorInstance=this.refreshEditorInstance.bind(this),this.scheduleDestroy=this.scheduleDestroy.bind(this),this.onRender=this.onRender.bind(this),this.createEditor=this.createEditor.bind(this)}setEditor(e){this.editor=e,this.instanceId=Math.random().toString(36).slice(2,9),this.subscriptions.forEach(n=>n())}getInitialEditor(){return this.options.current.immediatelyRender===void 0?xx||z9?null:this.createEditor():(this.options.current.immediatelyRender,this.options.current.immediatelyRender?this.createEditor():null)}createEditor(){const e={...this.options.current,onBeforeCreate:(...r)=>{var i,o;return(o=(i=this.options.current).onBeforeCreate)==null?void 0:o.call(i,...r)},onBlur:(...r)=>{var i,o;return(o=(i=this.options.current).onBlur)==null?void 0:o.call(i,...r)},onCreate:(...r)=>{var i,o;return(o=(i=this.options.current).onCreate)==null?void 0:o.call(i,...r)},onDestroy:(...r)=>{var i,o;return(o=(i=this.options.current).onDestroy)==null?void 0:o.call(i,...r)},onFocus:(...r)=>{var i,o;return(o=(i=this.options.current).onFocus)==null?void 0:o.call(i,...r)},onSelectionUpdate:(...r)=>{var i,o;return(o=(i=this.options.current).onSelectionUpdate)==null?void 0:o.call(i,...r)},onTransaction:(...r)=>{var i,o;return(o=(i=this.options.current).onTransaction)==null?void 0:o.call(i,...r)},onUpdate:(...r)=>{var i,o;return(o=(i=this.options.current).onUpdate)==null?void 0:o.call(i,...r)},onContentError:(...r)=>{var i,o;return(o=(i=this.options.current).onContentError)==null?void 0:o.call(i,...r)},onDrop:(...r)=>{var i,o;return(o=(i=this.options.current).onDrop)==null?void 0:o.call(i,...r)},onPaste:(...r)=>{var i,o;return(o=(i=this.options.current).onPaste)==null?void 0:o.call(i,...r)},onDelete:(...r)=>{var i,o;return(o=(i=this.options.current).onDelete)==null?void 0:o.call(i,...r)}};return new OV(e)}getEditor(){return this.editor}getServerSnapshot(){return null}subscribe(e){return this.subscriptions.add(e),()=>{this.subscriptions.delete(e)}}static compareOptions(e,n){return Object.keys(e).every(r=>["onCreate","onBeforeCreate","onDestroy","onUpdate","onTransaction","onFocus","onBlur","onSelectionUpdate","onContentError","onDrop","onPaste"].includes(r)?!0:r==="extensions"&&e.extensions&&n.extensions?e.extensions.length!==n.extensions.length?!1:e.extensions.every((i,o)=>{var a;return i===((a=n.extensions)==null?void 0:a[o])}):e[r]===n[r])}onRender(e){return()=>(this.isComponentMounted=!0,clearTimeout(this.scheduledDestructionTimeout),this.editor&&!this.editor.isDestroyed&&e.length===0?SM.compareOptions(this.options.current,this.editor.options)||this.editor.setOptions({...this.options.current,editable:this.editor.isEditable}):this.refreshEditorInstance(e),()=>{this.isComponentMounted=!1,this.scheduleDestroy()})}refreshEditorInstance(e){if(this.editor&&!this.editor.isDestroyed){if(this.previousDeps===null){this.previousDeps=e;return}if(this.previousDeps.length===e.length&&this.previousDeps.every((r,i)=>r===e[i]))return}this.editor&&!this.editor.isDestroyed&&this.editor.destroy(),this.setEditor(this.createEditor()),this.previousDeps=e}scheduleDestroy(){const e=this.instanceId,n=this.editor;this.scheduledDestructionTimeout=setTimeout(()=>{if(this.isComponentMounted&&this.instanceId===e){n&&n.setOptions(this.options.current);return}n&&!n.isDestroyed&&(n.destroy(),this.instanceId===e&&this.setEditor(null))},1)}};function F9(t={},e=[]){const n=x.useRef(t);n.current=t;const[r]=x.useState(()=>new B9(n)),i=fD.useSyncExternalStore(r.subscribe,r.getEditor,r.getServerSnapshot);return x.useDebugValue(i),x.useEffect(r.onRender(e)),L9({editor:i,selector:({transactionNumber:o})=>t.shouldRerenderOnTransaction===!1||t.shouldRerenderOnTransaction===void 0?null:t.immediatelyRender&&o===0?0:o+1}),i}var EM=x.createContext({editor:null});EM.Consumer;var CM=x.createContext({onDragStart:()=>{},nodeViewContentChildren:void 0,nodeViewContentRef:()=>{}}),$9=()=>x.useContext(CM),Ph=Se.forwardRef((t,e)=>{const{onDragStart:n}=$9(),r=t.as||"div";return h.jsx(r,{...t,ref:e,"data-node-view-wrapper":"",onDragStart:n,style:{whiteSpace:"normal",...t.style}})});function tN(t){return!!(typeof t=="function"&&t.prototype&&t.prototype.isReactComponent)}function nN(t){return!!(typeof t=="object"&&t.$$typeof&&(t.$$typeof.toString()==="Symbol(react.forward_ref)"||t.$$typeof.description==="react.forward_ref"))}function H9(t){return!!(typeof t=="object"&&t.$$typeof&&(t.$$typeof.toString()==="Symbol(react.memo)"||t.$$typeof.description==="react.memo"))}function U9(t){if(tN(t)||nN(t))return!0;if(H9(t)){const e=t.type;if(e)return tN(e)||nN(e)}return!1}function V9(){try{if(x.version)return parseInt(x.version.split(".")[0],10)>=19}catch{}return!1}var q9=class{constructor(t,{editor:e,props:n={},as:r="div",className:i=""}){this.ref=null,this.destroyed=!1,this.id=Math.floor(Math.random()*4294967295).toString(),this.component=t,this.editor=e,this.props=n,this.element=document.createElement(r),this.element.classList.add("react-renderer"),i&&this.element.classList.add(...i.split(" ")),this.editor.isInitialized?yo.flushSync(()=>{this.render()}):queueMicrotask(()=>{this.destroyed||this.render()})}render(){var t;if(this.destroyed)return;const e=this.component,n=this.props,r=this.editor,i=V9(),o=U9(e),a={...n};a.ref&&!(i||o)&&delete a.ref,!a.ref&&(i||o)&&(a.ref=c=>{this.ref=c}),this.reactElement=h.jsx(e,{...a}),(t=r?.contentComponent)==null||t.setRenderer(this.id,this)}updateProps(t={}){this.destroyed||(this.props={...this.props,...t},this.render())}destroy(){var t;this.destroyed=!0;const e=this.editor;(t=e?.contentComponent)==null||t.removeRenderer(this.id);try{this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element)}catch{}}updateAttributes(t){Object.keys(t).forEach(e=>{this.element.setAttribute(e,t[e])})}};Se.createContext({markViewContentRef:()=>{}});var G9=class extends FV{constructor(t,e,n){if(super(t,e,n),this.selectionRafId=null,this.cachedExtensionWithSyncedStorage=null,!this.node.isLeaf){this.options.contentDOMElementTag?this.contentDOMElement=document.createElement(this.options.contentDOMElementTag):this.contentDOMElement=document.createElement(this.node.isInline?"span":"div"),this.contentDOMElement.dataset.nodeViewContentReact="",this.contentDOMElement.dataset.nodeViewWrapper="",this.contentDOMElement.style.whiteSpace="inherit";const r=this.dom.querySelector("[data-node-view-content]");if(!r)return;r.appendChild(this.contentDOMElement)}}get extensionWithSyncedStorage(){if(!this.cachedExtensionWithSyncedStorage){const t=this.editor,e=this.extension;this.cachedExtensionWithSyncedStorage=new Proxy(e,{get(n,r,i){var o;return r==="storage"?(o=t.storage[e.name])!=null?o:{}:Reflect.get(n,r,i)}})}return this.cachedExtensionWithSyncedStorage}mount(){const t={editor:this.editor,node:this.node,decorations:this.decorations,innerDecorations:this.innerDecorations,view:this.view,selected:!1,extension:this.extensionWithSyncedStorage,HTMLAttributes:this.HTMLAttributes,getPos:()=>this.getPos(),updateAttributes:(u={})=>this.updateAttributes(u),deleteNode:()=>this.deleteNode(),ref:x.createRef()};if(!this.component.displayName){const u=f=>f.charAt(0).toUpperCase()+f.substring(1);this.component.displayName=u(this.extension.name)}const r={onDragStart:this.onDragStart.bind(this),nodeViewContentRef:u=>{u&&this.contentDOMElement&&u.firstChild!==this.contentDOMElement&&(u.hasAttribute("data-node-view-wrapper")&&u.removeAttribute("data-node-view-wrapper"),u.appendChild(this.contentDOMElement))}},i=this.component,o=x.memo(u=>h.jsx(CM.Provider,{value:r,children:x.createElement(i,u)}));o.displayName="ReactNodeView";let a=this.node.isInline?"span":"div";this.options.as&&(a=this.options.as);const{className:c=""}=this.options;this.handleSelectionUpdate=this.handleSelectionUpdate.bind(this),this.renderer=new q9(o,{editor:this.editor,props:t,as:a,className:`node-${this.node.type.name} ${c}`.trim()}),this.editor.on("selectionUpdate",this.handleSelectionUpdate),this.updateElementAttributes()}get dom(){var t;if(this.renderer.element.firstElementChild&&!((t=this.renderer.element.firstElementChild)!=null&&t.hasAttribute("data-node-view-wrapper")))throw Error("Please use the NodeViewWrapper component for your node view.");return this.renderer.element}get contentDOM(){return this.node.isLeaf?null:this.contentDOMElement}handleSelectionUpdate(){this.selectionRafId&&(cancelAnimationFrame(this.selectionRafId),this.selectionRafId=null),this.selectionRafId=requestAnimationFrame(()=>{this.selectionRafId=null;const{from:t,to:e}=this.editor.state.selection,n=this.getPos();if(typeof n=="number")if(t<=n&&e>=n+this.node.nodeSize){if(this.renderer.props.selected)return;this.selectNode()}else{if(!this.renderer.props.selected)return;this.deselectNode()}})}update(t,e,n){const r=i=>{this.renderer.updateProps(i),typeof this.options.attrs=="function"&&this.updateElementAttributes()};if(t.type!==this.node.type)return!1;if(typeof this.options.update=="function"){const i=this.node,o=this.decorations,a=this.innerDecorations;return this.node=t,this.decorations=e,this.innerDecorations=n,this.options.update({oldNode:i,oldDecorations:o,newNode:t,newDecorations:e,oldInnerDecorations:a,innerDecorations:n,updateProps:()=>r({node:t,decorations:e,innerDecorations:n,extension:this.extensionWithSyncedStorage})})}return t===this.node&&this.decorations===e&&this.innerDecorations===n||(this.node=t,this.decorations=e,this.innerDecorations=n,r({node:t,decorations:e,innerDecorations:n,extension:this.extensionWithSyncedStorage})),!0}selectNode(){this.renderer.updateProps({selected:!0}),this.renderer.element.classList.add("ProseMirror-selectednode")}deselectNode(){this.renderer.updateProps({selected:!1}),this.renderer.element.classList.remove("ProseMirror-selectednode")}destroy(){this.renderer.destroy(),this.editor.off("selectionUpdate",this.handleSelectionUpdate),this.contentDOMElement=null,this.selectionRafId&&(cancelAnimationFrame(this.selectionRafId),this.selectionRafId=null)}updateElementAttributes(){if(this.options.attrs){let t={};if(typeof this.options.attrs=="function"){const e=this.editor.extensionManager.attributes,n=Il(this.node,e);t=this.options.attrs({node:this.node,HTMLAttributes:n})}else t=this.options.attrs;this.renderer.updateAttributes(t)}}};function s0(t,e){return n=>n.editor.contentComponent?new G9(t,n,e):{}}var a0=x.createContext({get editor(){throw new Error("useTiptap must be used within a <Tiptap> provider")}});a0.displayName="TiptapContext";var W9=()=>x.useContext(a0);function TM({editor:t,instance:e,children:n}){const r=t??e;if(!r)throw new Error("Tiptap: An editor instance is required. Pass a non-null `editor` prop.");const i=x.useMemo(()=>({editor:r}),[r]),o=x.useMemo(()=>({editor:r}),[r]);return h.jsx(EM.Provider,{value:o,children:h.jsx(a0.Provider,{value:i,children:n})})}TM.displayName="Tiptap";function NM({...t}){const{editor:e}=W9();return h.jsx(wM,{editor:e,...t})}NM.displayName="Tiptap.Content";Object.assign(TM,{Content:NM});var zh=(t,e)=>{if(t==="slot")return 0;if(t instanceof Function)return t(e);const{children:n,...r}=e??{};if(t==="svg")throw new Error("SVG elements are not supported in the JSX syntax, use the array syntax instead");return[t,r,n]},Y9=/^\s*>\s$/,K9=Xn.create({name:"blockquote",addOptions(){return{HTMLAttributes:{}}},content:"block+",group:"block",defining:!0,parseHTML(){return[{tag:"blockquote"}]},renderHTML({HTMLAttributes:t}){return zh("blockquote",{...sn(this.options.HTMLAttributes,t),children:zh("slot",{})})},parseMarkdown:(t,e)=>e.createNode("blockquote",void 0,e.parseChildren(t.tokens||[])),renderMarkdown:(t,e)=>{if(!t.content)return"";const n=">",r=[];return t.content.forEach(i=>{const c=e.renderChildren([i]).split(`
`).map(u=>u.trim()===""?n:`${n} ${u}`);r.push(c.join(`
`))}),r.join(`
${n}
`)},addCommands(){return{setBlockquote:()=>({commands:t})=>t.wrapIn(this.name),toggleBlockquote:()=>({commands:t})=>t.toggleWrap(this.name),unsetBlockquote:()=>({commands:t})=>t.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[Ll({find:Y9,type:this.type})]}}),X9=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))$/,J9=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))/g,Q9=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))$/,Z9=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))/g,e7=va.create({name:"bold",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:t=>t.style.fontWeight!=="normal"&&null},{style:"font-weight=400",clearMark:t=>t.type.name===this.name},{style:"font-weight",getAttrs:t=>/^(bold(er)?|[5-9]\d{2,})$/.test(t)&&null}]},renderHTML({HTMLAttributes:t}){return zh("strong",{...sn(this.options.HTMLAttributes,t),children:zh("slot",{})})},markdownTokenName:"strong",parseMarkdown:(t,e)=>e.applyMark("bold",e.parseInline(t.tokens||[])),renderMarkdown:(t,e)=>`**${e.renderChildren(t)}**`,addCommands(){return{setBold:()=>({commands:t})=>t.setMark(this.name),toggleBold:()=>({commands:t})=>t.toggleMark(this.name),unsetBold:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[_l({find:X9,type:this.type}),_l({find:Q9,type:this.type})]},addPasteRules(){return[pa({find:J9,type:this.type}),pa({find:Z9,type:this.type})]}}),t7=/(^|[^`])`([^`]+)`(?!`)$/,n7=/(^|[^`])`([^`]+)`(?!`)/g,r7=va.create({name:"code",addOptions(){return{HTMLAttributes:{}}},excludes:"_",code:!0,exitable:!0,parseHTML(){return[{tag:"code"}]},renderHTML({HTMLAttributes:t}){return["code",sn(this.options.HTMLAttributes,t),0]},markdownTokenName:"codespan",parseMarkdown:(t,e)=>e.applyMark("code",[{type:"text",text:t.text||""}]),renderMarkdown:(t,e)=>t.content?`\`${e.renderChildren(t.content)}\``:"",addCommands(){return{setCode:()=>({commands:t})=>t.setMark(this.name),toggleCode:()=>({commands:t})=>t.toggleMark(this.name),unsetCode:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[_l({find:t7,type:this.type})]},addPasteRules(){return[pa({find:n7,type:this.type})]}}),dv=4,i7=/^```([a-z]+)?[\s\n]$/,o7=/^~~~([a-z]+)?[\s\n]$/,s7=Xn.create({name:"codeBlock",addOptions(){return{languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,defaultLanguage:null,enableTabIndentation:!1,tabSize:dv,HTMLAttributes:{}}},content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:this.options.defaultLanguage,parseHTML:t=>{var e;const{languageClassPrefix:n}=this.options;if(!n)return null;const o=[...((e=t.firstElementChild)==null?void 0:e.classList)||[]].filter(a=>a.startsWith(n)).map(a=>a.replace(n,""))[0];return o||null},rendered:!1}}},parseHTML(){return[{tag:"pre",preserveWhitespace:"full"}]},renderHTML({node:t,HTMLAttributes:e}){return["pre",sn(this.options.HTMLAttributes,e),["code",{class:t.attrs.language?this.options.languageClassPrefix+t.attrs.language:null},0]]},markdownTokenName:"code",parseMarkdown:(t,e)=>{var n;return((n=t.raw)==null?void 0:n.startsWith("```"))===!1&&t.codeBlockStyle!=="indented"?[]:e.createNode("codeBlock",{language:t.lang||null},t.text?[e.createTextNode(t.text)]:[])},renderMarkdown:(t,e)=>{var n;let r="";const i=((n=t.attrs)==null?void 0:n.language)||"";return t.content?r=[`\`\`\`${i}`,e.renderChildren(t.content),"```"].join(`
`):r=`\`\`\`${i}

\`\`\``,r},addCommands(){return{setCodeBlock:t=>({commands:e})=>e.setNode(this.name,t),toggleCodeBlock:t=>({commands:e})=>e.toggleNode(this.name,"paragraph",t)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:t,$anchor:e}=this.editor.state.selection,n=e.pos===1;return!t||e.parent.type.name!==this.name?!1:n||!e.parent.textContent.length?this.editor.commands.clearNodes():!1},Tab:({editor:t})=>{var e;if(!this.options.enableTabIndentation)return!1;const n=(e=this.options.tabSize)!=null?e:dv,{state:r}=t,{selection:i}=r,{$from:o,empty:a}=i;if(o.parent.type!==this.type)return!1;const c=" ".repeat(n);return a?t.commands.insertContent(c):t.commands.command(({tr:u})=>{const{from:f,to:p}=i,y=r.doc.textBetween(f,p,`
`,`
`).split(`
`).map(w=>c+w).join(`
`);return u.replaceWith(f,p,r.schema.text(y)),!0})},"Shift-Tab":({editor:t})=>{var e;if(!this.options.enableTabIndentation)return!1;const n=(e=this.options.tabSize)!=null?e:dv,{state:r}=t,{selection:i}=r,{$from:o,empty:a}=i;return o.parent.type!==this.type?!1:a?t.commands.command(({tr:c})=>{var u;const{pos:f}=o,p=o.start(),g=o.end(),y=r.doc.textBetween(p,g,`
`,`
`).split(`
`);let w=0,S=0;const C=f-p;for(let R=0;R<y.length;R+=1){if(S+y[R].length>=C){w=R;break}S+=y[R].length+1}const N=((u=y[w].match(/^ */))==null?void 0:u[0])||"",k=Math.min(N.length,n);if(k===0)return!0;let D=p;for(let R=0;R<w;R+=1)D+=y[R].length+1;return c.delete(D,D+k),f-D<=k&&c.setSelection(st.create(c.doc,D)),!0}):t.commands.command(({tr:c})=>{const{from:u,to:f}=i,v=r.doc.textBetween(u,f,`
`,`
`).split(`
`).map(y=>{var w;const S=((w=y.match(/^ */))==null?void 0:w[0])||"",C=Math.min(S.length,n);return y.slice(C)}).join(`
`);return c.replaceWith(u,f,r.schema.text(v)),!0})},Enter:({editor:t})=>{if(!this.options.exitOnTripleEnter)return!1;const{state:e}=t,{selection:n}=e,{$from:r,empty:i}=n;if(!i||r.parent.type!==this.type)return!1;const o=r.parentOffset===r.parent.nodeSize-2,a=r.parent.textContent.endsWith(`

`);return!o||!a?!1:t.chain().command(({tr:c})=>(c.delete(r.pos-2,r.pos),!0)).exitCode().run()},ArrowDown:({editor:t})=>{if(!this.options.exitOnArrowDown)return!1;const{state:e}=t,{selection:n,doc:r}=e,{$from:i,empty:o}=n;if(!o||i.parent.type!==this.type||!(i.parentOffset===i.parent.nodeSize-2))return!1;const c=i.after();return c===void 0?!1:r.nodeAt(c)?t.commands.command(({tr:f})=>(f.setSelection(xt.near(r.resolve(c))),!0)):t.commands.exitCode()}}},addInputRules(){return[yx({find:i7,type:this.type,getAttributes:t=>({language:t[1]})}),yx({find:o7,type:this.type,getAttributes:t=>({language:t[1]})})]},addProseMirrorPlugins(){return[new nn({key:new Sn("codeBlockVSCodeHandler"),props:{handlePaste:(t,e)=>{if(!e.clipboardData||this.editor.isActive(this.type.name))return!1;const n=e.clipboardData.getData("text/plain"),r=e.clipboardData.getData("vscode-editor-data"),i=r?JSON.parse(r):void 0,o=i?.mode;if(!n||!o)return!1;const{tr:a,schema:c}=t.state,u=c.text(n.replace(/\r\n?/g,`
`));return a.replaceSelectionWith(this.type.create({language:o},u)),a.selection.$from.parent.type!==this.type&&a.setSelection(st.near(a.doc.resolve(Math.max(0,a.selection.from-2)))),a.setMeta("paste",!0),t.dispatch(a),!0}}})]}}),a7=Xn.create({name:"doc",topNode:!0,content:"block+",renderMarkdown:(t,e)=>t.content?e.renderChildren(t.content,`

`):""}),l7=Xn.create({name:"hardBreak",markdownTokenName:"br",addOptions(){return{keepMarks:!0,HTMLAttributes:{}}},inline:!0,group:"inline",selectable:!1,linebreakReplacement:!0,parseHTML(){return[{tag:"br"}]},renderHTML({HTMLAttributes:t}){return["br",sn(this.options.HTMLAttributes,t)]},renderText(){return`
`},renderMarkdown:()=>`  
`,parseMarkdown:()=>({type:"hardBreak"}),addCommands(){return{setHardBreak:()=>({commands:t,chain:e,state:n,editor:r})=>t.first([()=>t.exitCode(),()=>t.command(()=>{const{selection:i,storedMarks:o}=n;if(i.$from.parent.type.spec.isolating)return!1;const{keepMarks:a}=this.options,{splittableMarks:c}=r.extensionManager,u=o||i.$to.parentOffset&&i.$from.marks();return e().insertContent({type:this.name}).command(({tr:f,dispatch:p})=>{if(p&&u&&a){const g=u.filter(v=>c.includes(v.type.name));f.ensureMarks(g)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),c7=Xn.create({name:"heading",addOptions(){return{levels:[1,2,3,4,5,6],HTMLAttributes:{}}},content:"inline*",group:"block",defining:!0,addAttributes(){return{level:{default:1,rendered:!1}}},parseHTML(){return this.options.levels.map(t=>({tag:`h${t}`,attrs:{level:t}}))},renderHTML({node:t,HTMLAttributes:e}){return[`h${this.options.levels.includes(t.attrs.level)?t.attrs.level:this.options.levels[0]}`,sn(this.options.HTMLAttributes,e),0]},parseMarkdown:(t,e)=>e.createNode("heading",{level:t.depth||1},e.parseInline(t.tokens||[])),renderMarkdown:(t,e)=>{var n;const r=(n=t.attrs)!=null&&n.level?parseInt(t.attrs.level,10):1,i="#".repeat(r);return t.content?`${i} ${e.renderChildren(t.content)}`:""},addCommands(){return{setHeading:t=>({commands:e})=>this.options.levels.includes(t.level)?e.setNode(this.name,t):!1,toggleHeading:t=>({commands:e})=>this.options.levels.includes(t.level)?e.toggleNode(this.name,"paragraph",t):!1}},addKeyboardShortcuts(){return this.options.levels.reduce((t,e)=>({...t,[`Mod-Alt-${e}`]:()=>this.editor.commands.toggleHeading({level:e})}),{})},addInputRules(){return this.options.levels.map(t=>yx({find:new RegExp(`^(#{${Math.min(...this.options.levels)},${t}})\\s$`),type:this.type,getAttributes:{level:t}}))}}),u7=Xn.create({name:"horizontalRule",addOptions(){return{HTMLAttributes:{},nextNodeType:"paragraph"}},group:"block",parseHTML(){return[{tag:"hr"}]},renderHTML({HTMLAttributes:t}){return["hr",sn(this.options.HTMLAttributes,t)]},markdownTokenName:"hr",parseMarkdown:(t,e)=>e.createNode("horizontalRule"),renderMarkdown:()=>"---",addCommands(){return{setHorizontalRule:()=>({chain:t,state:e})=>{if(!RV(e,e.schema.nodes[this.name]))return!1;const{selection:n}=e,{$to:r}=n,i=t();return nM(n)?i.insertContentAt(r.pos,{type:this.name}):i.insertContent({type:this.name}),i.command(({state:o,tr:a,dispatch:c})=>{if(c){const{$to:u}=a.selection,f=u.end();if(u.nodeAfter)u.nodeAfter.isTextblock?a.setSelection(st.create(a.doc,u.pos+1)):u.nodeAfter.isBlock?a.setSelection(Je.create(a.doc,u.pos)):a.setSelection(st.create(a.doc,u.pos));else{const p=o.schema.nodes[this.options.nextNodeType]||u.parent.type.contentMatch.defaultType,g=p?.create();g&&(a.insert(f,g),a.setSelection(st.create(a.doc,f+1)))}a.scrollIntoView()}return!0}).run()}}},addInputRules(){return[MV({find:/^(?:---|-|___\s|\*\*\*\s)$/,type:this.type})]}}),d7=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))$/,f7=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))/g,h7=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))$/,p7=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))/g,m7=va.create({name:"italic",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:t=>t.style.fontStyle!=="normal"&&null},{style:"font-style=normal",clearMark:t=>t.type.name===this.name},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:t}){return["em",sn(this.options.HTMLAttributes,t),0]},addCommands(){return{setItalic:()=>({commands:t})=>t.setMark(this.name),toggleItalic:()=>({commands:t})=>t.toggleMark(this.name),unsetItalic:()=>({commands:t})=>t.unsetMark(this.name)}},markdownTokenName:"em",parseMarkdown:(t,e)=>e.applyMark("italic",e.parseInline(t.tokens||[])),renderMarkdown:(t,e)=>`*${e.renderChildren(t)}*`,addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[_l({find:d7,type:this.type}),_l({find:h7,type:this.type})]},addPasteRules(){return[pa({find:f7,type:this.type}),pa({find:p7,type:this.type})]}});const g7="aaa1rp3bb0ott3vie4c1le2ogado5udhabi7c0ademy5centure6ountant0s9o1tor4d0s1ult4e0g1ro2tna4f0l1rica5g0akhan5ency5i0g1rbus3force5tel5kdn3l0ibaba4pay4lfinanz6state5y2sace3tom5m0azon4ericanexpress7family11x2fam3ica3sterdam8nalytics7droid5quan4z2o0l2partments8p0le4q0uarelle8r0ab1mco4chi3my2pa2t0e3s0da2ia2sociates9t0hleta5torney7u0ction5di0ble3o3spost5thor3o0s4w0s2x0a2z0ure5ba0by2idu3namex4d1k2r0celona5laycard4s5efoot5gains6seball5ketball8uhaus5yern5b0c1t1va3cg1n2d1e0ats2uty4er2rlin4st0buy5t2f1g1h0arti5i0ble3d1ke2ng0o3o1z2j1lack0friday9ockbuster8g1omberg7ue3m0s1w2n0pparibas9o0ats3ehringer8fa2m1nd2o0k0ing5sch2tik2on4t1utique6x2r0adesco6idgestone9oadway5ker3ther5ussels7s1t1uild0ers6siness6y1zz3v1w1y1z0h3ca0b1fe2l0l1vinklein9m0era3p2non3petown5ital0one8r0avan4ds2e0er0s4s2sa1e1h1ino4t0ering5holic7ba1n1re3c1d1enter4o1rn3f0a1d2g1h0anel2nel4rity4se2t2eap3intai5ristmas6ome4urch5i0priani6rcle4sco3tadel4i0c2y3k1l0aims4eaning6ick2nic1que6othing5ud3ub0med6m1n1o0ach3des3ffee4llege4ogne5m0mbank4unity6pany2re3uter5sec4ndos3struction8ulting7tact3ractors9oking4l1p2rsica5untry4pon0s4rses6pa2r0edit0card4union9icket5own3s1uise0s6u0isinella9v1w1x1y0mru3ou3z2dad1nce3ta1e1ing3sun4y2clk3ds2e0al0er2s3gree4livery5l1oitte5ta3mocrat6ntal2ist5si0gn4v2hl2iamonds6et2gital5rect0ory7scount3ver5h2y2j1k1m1np2o0cs1tor4g1mains5t1wnload7rive4tv2ubai3nlop4pont4rban5vag2r2z2earth3t2c0o2deka3u0cation8e1g1mail3erck5nergy4gineer0ing9terprises10pson4quipment8r0icsson6ni3s0q1tate5t1u0rovision8s2vents5xchange6pert3osed4ress5traspace10fage2il1rwinds6th3mily4n0s2rm0ers5shion4t3edex3edback6rrari3ero6i0delity5o2lm2nal1nce1ial7re0stone6mdale6sh0ing5t0ness6j1k1lickr3ghts4r2orist4wers5y2m1o0o0d1tball6rd1ex2sale4um3undation8x2r0ee1senius7l1ogans4ntier7tr2ujitsu5n0d2rniture7tbol5yi3ga0l0lery3o1up4me0s3p1rden4y2b0iz3d0n2e0a1nt0ing5orge5f1g0ee3h1i0ft0s3ves2ing5l0ass3e1obal2o4m0ail3bh2o1x2n1odaddy5ld0point6f2o0dyear5g0le4p1t1v2p1q1r0ainger5phics5tis4een3ipe3ocery4up4s1t1u0cci3ge2ide2tars5ru3w1y2hair2mburg5ngout5us3bo2dfc0bank7ealth0care8lp1sinki6re1mes5iphop4samitsu7tachi5v2k0t2m1n1ockey4ldings5iday5medepot5goods5s0ense7nda3rse3spital5t0ing5t0els3mail5use3w2r1sbc3t1u0ghes5yatt3undai7ibm2cbc2e1u2d1e0ee3fm2kano4l1m0amat4db2mo0bilien9n0c1dustries8finiti5o2g1k1stitute6urance4e4t0ernational10uit4vestments10o1piranga7q1r0ish4s0maili5t0anbul7t0au2v3jaguar4va3cb2e0ep2tzt3welry6io2ll2m0p2nj2o0bs1urg4t1y2p0morgan6rs3uegos4niper7kaufen5ddi3e0rryhotels6properties14fh2g1h1i0a1ds2m1ndle4tchen5wi3m1n1oeln3matsu5sher5p0mg2n2r0d1ed3uokgroup8w1y0oto4z2la0caixa5mborghini8er3nd0rover6xess5salle5t0ino3robe5w0yer5b1c1ds2ease3clerc5frak4gal2o2xus4gbt3i0dl2fe0insurance9style7ghting6ke2lly3mited4o2ncoln4k2ve1ing5k1lc1p2oan0s3cker3us3l1ndon4tte1o3ve3pl0financial11r1s1t0d0a3u0ndbeck6xe1ury5v1y2ma0drid4if1son4keup4n0agement7go3p1rket0ing3s4riott5shalls7ttel5ba2c0kinsey7d1e0d0ia3et2lbourne7me1orial6n0u2rckmsd7g1h1iami3crosoft7l1ni1t2t0subishi9k1l0b1s2m0a2n1o0bi0le4da2e1i1m1nash3ey2ster5rmon3tgage6scow4to0rcycles9v0ie4p1q1r1s0d2t0n1r2u0seum3ic4v1w1x1y1z2na0b1goya4me2vy3ba2c1e0c1t0bank4flix4work5ustar5w0s2xt0direct7us4f0l2g0o2hk2i0co2ke1on3nja3ssan1y5l1o0kia3rton4w0ruz3tv4p1r0a1w2tt2u1yc2z2obi1server7ffice5kinawa6layan0group9lo3m0ega4ne1g1l0ine5oo2pen3racle3nge4g0anic5igins6saka4tsuka4t2vh3pa0ge2nasonic7ris2s1tners4s1y3y2ccw3e0t2f0izer5g1h0armacy6d1ilips5one2to0graphy6s4ysio5ics1tet2ures6d1n0g1k2oneer5zza4k1l0ace2y0station9umbing5s3m1n0c2ohl2ker3litie5rn2st3r0axi3ess3ime3o0d0uctions8f1gressive8mo2perties3y5tection8u0dential9s1t1ub2w0c2y2qa1pon3uebec3st5racing4dio4e0ad1lestate6tor2y4cipes5d0stone5umbrella9hab3ise0n3t2liance6n0t0als5pair3ort3ublican8st0aurant8view0s5xroth6ich0ardli6oh3l1o1p2o0cks3deo3gers4om3s0vp3u0gby3hr2n2w0e2yukyu6sa0arland6fe0ty4kura4le1on3msclub4ung5ndvik0coromant12ofi4p1rl2s1ve2xo3b0i1s2c0b1haeffler7midt4olarships8ol3ule3warz5ience5ot3d1e0arch3t2cure1ity6ek2lect4ner3rvices6ven3w1x0y3fr2g1h0angrila6rp3ell3ia1ksha5oes2p0ping5uji3w3i0lk2na1gles5te3j1k0i0n2y0pe4l0ing4m0art3ile4n0cf3o0ccer3ial4ftbank4ware6hu2lar2utions7ng1y2y2pa0ce3ort2t3r0l2s1t0ada2ples4r1tebank4farm7c0group6ockholm6rage3e3ream4udio2y3yle4u0cks3pplies3y2ort5rf1gery5zuki5v1watch4iss4x1y0dney4stems6z2tab1ipei4lk2obao4rget4tamotors6r2too4x0i3c0i2d0k2eam2ch0nology8l1masek5nnis4va3f1g1h0d1eater2re6iaa2ckets5enda4ps2res2ol4j0maxx4x2k0maxx5l1m0all4n1o0day3kyo3ols3p1ray3shiba5tal3urs3wn2yota3s3r0ade1ing4ining5vel0ers0insurance16ust3v2t1ube2i1nes3shu4v0s2w1z2ua1bank3s2g1k1nicom3versity8o2ol2ps2s1y1z2va0cations7na1guard7c1e0gas3ntures6risign5mgensberater2ung14sicherung10t2g1i0ajes4deo3g1king4llas4n1p1rgin4sa1ion4va1o3laanderen9n1odka3lvo3te1ing3o2yage5u2wales2mart4ter4ng0gou5tch0es6eather0channel12bcam3er2site5d0ding5ibo2r3f1hoswho6ien2ki2lliamhill9n0dows4e1ners6me2olterskluwer11odside6rk0s2ld3w2s1tc1f3xbox3erox4ihuan4n2xx2yz3yachts4hoo3maxun5ndex5e1odobashi7ga2kohama6u0tube6t1un3za0ppos4ra3ero3ip2m1one3uerich6w2",y7="121342632165322333335355455655552435435422463632574574330355524444661154543332344423364211133222221212112052232222232212222223222241112222224322321222",bx="numeric",wx="ascii",Sx="alpha",gu="asciinumeric",lu="alphanumeric",Ex="domain",AM="emoji",v7="scheme",x7="slashscheme",fv="whitespace";function b7(t,e){return t in e||(e[t]=[]),e[t]}function Qs(t,e,n){e[bx]&&(e[gu]=!0,e[lu]=!0),e[wx]&&(e[gu]=!0,e[Sx]=!0),e[gu]&&(e[lu]=!0),e[Sx]&&(e[lu]=!0),e[lu]&&(e[Ex]=!0),e[AM]&&(e[Ex]=!0);for(const r in e){const i=b7(r,n);i.indexOf(t)<0&&i.push(t)}}function w7(t,e){const n={};for(const r in e)e[r].indexOf(t)>=0&&(n[r]=!0);return n}function fr(t=null){this.j={},this.jr=[],this.jd=null,this.t=t}fr.groups={};fr.prototype={accepts(){return!!this.t},go(t){const e=this,n=e.j[t];if(n)return n;for(let r=0;r<e.jr.length;r++){const i=e.jr[r][0],o=e.jr[r][1];if(o&&i.test(t))return o}return e.jd},has(t,e=!1){return e?t in this.j:!!this.go(t)},ta(t,e,n,r){for(let i=0;i<t.length;i++)this.tt(t[i],e,n,r)},tr(t,e,n,r){r=r||fr.groups;let i;return e&&e.j?i=e:(i=new fr(e),n&&r&&Qs(e,n,r)),this.jr.push([t,i]),i},ts(t,e,n,r){let i=this;const o=t.length;if(!o)return i;for(let a=0;a<o-1;a++)i=i.tt(t[a]);return i.tt(t[o-1],e,n,r)},tt(t,e,n,r){r=r||fr.groups;const i=this;if(e&&e.j)return i.j[t]=e,e;const o=e;let a,c=i.go(t);if(c?(a=new fr,Object.assign(a.j,c.j),a.jr.push.apply(a.jr,c.jr),a.jd=c.jd,a.t=c.t):a=new fr,o){if(r)if(a.t&&typeof a.t=="string"){const u=Object.assign(w7(a.t,r),n);Qs(o,u,r)}else n&&Qs(o,n,r);a.t=o}return i.j[t]=a,a}};const vt=(t,e,n,r,i)=>t.ta(e,n,r,i),un=(t,e,n,r,i)=>t.tr(e,n,r,i),rN=(t,e,n,r,i)=>t.ts(e,n,r,i),Ne=(t,e,n,r,i)=>t.tt(e,n,r,i),no="WORD",Cx="UWORD",kM="ASCIINUMERICAL",DM="ALPHANUMERICAL",Pu="LOCALHOST",Tx="TLD",Nx="UTLD",ah="SCHEME",gl="SLASH_SCHEME",l0="NUM",Ax="WS",c0="NL",yu="OPENBRACE",vu="CLOSEBRACE",Bh="OPENBRACKET",Fh="CLOSEBRACKET",$h="OPENPAREN",Hh="CLOSEPAREN",Uh="OPENANGLEBRACKET",Vh="CLOSEANGLEBRACKET",qh="FULLWIDTHLEFTPAREN",Gh="FULLWIDTHRIGHTPAREN",Wh="LEFTCORNERBRACKET",Yh="RIGHTCORNERBRACKET",Kh="LEFTWHITECORNERBRACKET",Xh="RIGHTWHITECORNERBRACKET",Jh="FULLWIDTHLESSTHAN",Qh="FULLWIDTHGREATERTHAN",Zh="AMPERSAND",ep="APOSTROPHE",tp="ASTERISK",Jo="AT",np="BACKSLASH",rp="BACKTICK",ip="CARET",es="COLON",u0="COMMA",op="DOLLAR",xi="DOT",sp="EQUALS",d0="EXCLAMATION",$r="HYPHEN",xu="PERCENT",ap="PIPE",lp="PLUS",cp="POUND",bu="QUERY",f0="QUOTE",OM="FULLWIDTHMIDDLEDOT",h0="SEMI",bi="SLASH",wu="TILDE",up="UNDERSCORE",MM="EMOJI",dp="SYM";var RM=Object.freeze({__proto__:null,ALPHANUMERICAL:DM,AMPERSAND:Zh,APOSTROPHE:ep,ASCIINUMERICAL:kM,ASTERISK:tp,AT:Jo,BACKSLASH:np,BACKTICK:rp,CARET:ip,CLOSEANGLEBRACKET:Vh,CLOSEBRACE:vu,CLOSEBRACKET:Fh,CLOSEPAREN:Hh,COLON:es,COMMA:u0,DOLLAR:op,DOT:xi,EMOJI:MM,EQUALS:sp,EXCLAMATION:d0,FULLWIDTHGREATERTHAN:Qh,FULLWIDTHLEFTPAREN:qh,FULLWIDTHLESSTHAN:Jh,FULLWIDTHMIDDLEDOT:OM,FULLWIDTHRIGHTPAREN:Gh,HYPHEN:$r,LEFTCORNERBRACKET:Wh,LEFTWHITECORNERBRACKET:Kh,LOCALHOST:Pu,NL:c0,NUM:l0,OPENANGLEBRACKET:Uh,OPENBRACE:yu,OPENBRACKET:Bh,OPENPAREN:$h,PERCENT:xu,PIPE:ap,PLUS:lp,POUND:cp,QUERY:bu,QUOTE:f0,RIGHTCORNERBRACKET:Yh,RIGHTWHITECORNERBRACKET:Xh,SCHEME:ah,SEMI:h0,SLASH:bi,SLASH_SCHEME:gl,SYM:dp,TILDE:wu,TLD:Tx,UNDERSCORE:up,UTLD:Nx,UWORD:Cx,WORD:no,WS:Ax});const eo=/[a-z]/,Xc=new RegExp("\\p{L}","u"),hv=new RegExp("\\p{Emoji}","u"),to=/\d/,pv=/\s/,iN="\r",mv=`
`,S7="",E7="",gv="";let Ff=null,$f=null;function C7(t=[]){const e={};fr.groups=e;const n=new fr;Ff==null&&(Ff=oN(g7)),$f==null&&($f=oN(y7)),Ne(n,"'",ep),Ne(n,"{",yu),Ne(n,"}",vu),Ne(n,"[",Bh),Ne(n,"]",Fh),Ne(n,"(",$h),Ne(n,")",Hh),Ne(n,"<",Uh),Ne(n,">",Vh),Ne(n,"",qh),Ne(n,"",Gh),Ne(n,"",Wh),Ne(n,"",Yh),Ne(n,"",Kh),Ne(n,"",Xh),Ne(n,"",Jh),Ne(n,"",Qh),Ne(n,"&",Zh),Ne(n,"*",tp),Ne(n,"@",Jo),Ne(n,"`",rp),Ne(n,"^",ip),Ne(n,":",es),Ne(n,",",u0),Ne(n,"$",op),Ne(n,".",xi),Ne(n,"=",sp),Ne(n,"!",d0),Ne(n,"-",$r),Ne(n,"%",xu),Ne(n,"|",ap),Ne(n,"+",lp),Ne(n,"#",cp),Ne(n,"?",bu),Ne(n,'"',f0),Ne(n,"/",bi),Ne(n,";",h0),Ne(n,"~",wu),Ne(n,"_",up),Ne(n,"\\",np),Ne(n,"",OM);const r=un(n,to,l0,{[bx]:!0});un(r,to,r);const i=un(r,eo,kM,{[gu]:!0}),o=un(r,Xc,DM,{[lu]:!0}),a=un(n,eo,no,{[wx]:!0});un(a,to,i),un(a,eo,a),un(i,to,i),un(i,eo,i);const c=un(n,Xc,Cx,{[Sx]:!0});un(c,eo),un(c,to,o),un(c,Xc,c),un(o,to,o),un(o,eo),un(o,Xc,o);const u=Ne(n,mv,c0,{[fv]:!0}),f=Ne(n,iN,Ax,{[fv]:!0}),p=un(n,pv,Ax,{[fv]:!0});Ne(n,gv,p),Ne(f,mv,u),Ne(f,gv,p),un(f,pv,p),Ne(p,iN),Ne(p,mv),un(p,pv,p),Ne(p,gv,p);const g=un(n,hv,MM,{[AM]:!0});Ne(g,"#"),un(g,hv,g),Ne(g,S7,g);const v=Ne(g,E7);Ne(v,"#"),un(v,hv,g);const y=[[eo,a],[to,i]],w=[[eo,null],[Xc,c],[to,o]];for(let S=0;S<Ff.length;S++)qo(n,Ff[S],Tx,no,y);for(let S=0;S<$f.length;S++)qo(n,$f[S],Nx,Cx,w);Qs(Tx,{tld:!0,ascii:!0},e),Qs(Nx,{utld:!0,alpha:!0},e),qo(n,"file",ah,no,y),qo(n,"mailto",ah,no,y),qo(n,"http",gl,no,y),qo(n,"https",gl,no,y),qo(n,"ftp",gl,no,y),qo(n,"ftps",gl,no,y),Qs(ah,{scheme:!0,ascii:!0},e),Qs(gl,{slashscheme:!0,ascii:!0},e),t=t.sort((S,C)=>S[0]>C[0]?1:-1);for(let S=0;S<t.length;S++){const C=t[S][0],N=t[S][1]?{[v7]:!0}:{[x7]:!0};C.indexOf("-")>=0?N[Ex]=!0:eo.test(C)?to.test(C)?N[gu]=!0:N[wx]=!0:N[bx]=!0,rN(n,C,C,N)}return rN(n,"localhost",Pu,{ascii:!0}),n.jd=new fr(dp),{start:n,tokens:Object.assign({groups:e},RM)}}function jM(t,e){const n=T7(e.replace(/[A-Z]/g,c=>c.toLowerCase())),r=n.length,i=[];let o=0,a=0;for(;a<r;){let c=t,u=null,f=0,p=null,g=-1,v=-1;for(;a<r&&(u=c.go(n[a]));)c=u,c.accepts()?(g=0,v=0,p=c):g>=0&&(g+=n[a].length,v++),f+=n[a].length,o+=n[a].length,a++;o-=g,a-=v,f-=g,i.push({t:p.t,v:e.slice(o-f,o),s:o-f,e:o})}return i}function T7(t){const e=[],n=t.length;let r=0;for(;r<n;){let i=t.charCodeAt(r),o,a=i<55296||i>56319||r+1===n||(o=t.charCodeAt(r+1))<56320||o>57343?t[r]:t.slice(r,r+2);e.push(a),r+=a.length}return e}function qo(t,e,n,r,i){let o;const a=e.length;for(let c=0;c<a-1;c++){const u=e[c];t.j[u]?o=t.j[u]:(o=new fr(r),o.jr=i.slice(),t.j[u]=o),t=o}return o=new fr(n),o.jr=i.slice(),t.j[e[a-1]]=o,o}function oN(t){const e=[],n=[];let r=0,i="0123456789";for(;r<t.length;){let o=0;for(;i.indexOf(t[r+o])>=0;)o++;if(o>0){e.push(n.join(""));for(let a=parseInt(t.substring(r,r+o),10);a>0;a--)n.pop();r+=o}else n.push(t[r]),r++}return e}const zu={defaultProtocol:"http",events:null,format:sN,formatHref:sN,nl2br:!1,tagName:"a",target:null,rel:null,validate:!0,truncate:1/0,className:null,attributes:null,ignoreTags:[],render:null};function p0(t,e=null){let n=Object.assign({},zu);t&&(n=Object.assign(n,t instanceof p0?t.o:t));const r=n.ignoreTags,i=[];for(let o=0;o<r.length;o++)i.push(r[o].toUpperCase());this.o=n,e&&(this.defaultRender=e),this.ignoreTags=i}p0.prototype={o:zu,ignoreTags:[],defaultRender(t){return t},check(t){return this.get("validate",t.toString(),t)},get(t,e,n){const r=e!=null;let i=this.o[t];return i&&(typeof i=="object"?(i=n.t in i?i[n.t]:zu[t],typeof i=="function"&&r&&(i=i(e,n))):typeof i=="function"&&r&&(i=i(e,n.t,n)),i)},getObj(t,e,n){let r=this.o[t];return typeof r=="function"&&e!=null&&(r=r(e,n.t,n)),r},render(t){const e=t.render(this);return(this.get("render",null,t)||this.defaultRender)(e,t.t,t)}};function sN(t){return t}function IM(t,e){this.t="token",this.v=t,this.tk=e}IM.prototype={isLink:!1,toString(){return this.v},toHref(t){return this.toString()},toFormattedString(t){const e=this.toString(),n=t.get("truncate",e,this),r=t.get("format",e,this);return n&&r.length>n?r.substring(0,n)+"":r},toFormattedHref(t){return t.get("formatHref",this.toHref(t.get("defaultProtocol")),this)},startIndex(){return this.tk[0].s},endIndex(){return this.tk[this.tk.length-1].e},toObject(t=zu.defaultProtocol){return{type:this.t,value:this.toString(),isLink:this.isLink,href:this.toHref(t),start:this.startIndex(),end:this.endIndex()}},toFormattedObject(t){return{type:this.t,value:this.toFormattedString(t),isLink:this.isLink,href:this.toFormattedHref(t),start:this.startIndex(),end:this.endIndex()}},validate(t){return t.get("validate",this.toString(),this)},render(t){const e=this,n=this.toHref(t.get("defaultProtocol")),r=t.get("formatHref",n,this),i=t.get("tagName",n,e),o=this.toFormattedString(t),a={},c=t.get("className",n,e),u=t.get("target",n,e),f=t.get("rel",n,e),p=t.getObj("attributes",n,e),g=t.getObj("events",n,e);return a.href=r,c&&(a.class=c),u&&(a.target=u),f&&(a.rel=f),p&&Object.assign(a,p),{tagName:i,attributes:a,content:o,eventListeners:g}}};function em(t,e){class n extends IM{constructor(i,o){super(i,o),this.t=t}}for(const r in e)n.prototype[r]=e[r];return n.t=t,n}const aN=em("email",{isLink:!0,toHref(){return"mailto:"+this.toString()}}),lN=em("text"),N7=em("nl"),Hf=em("url",{isLink:!0,toHref(t=zu.defaultProtocol){return this.hasProtocol()?this.v:`${t}://${this.v}`},hasProtocol(){const t=this.tk;return t.length>=2&&t[0].t!==Pu&&t[1].t===es}}),Br=t=>new fr(t);function A7({groups:t}){const e=t.domain.concat([Zh,tp,Jo,np,rp,ip,op,sp,$r,l0,xu,ap,lp,cp,bi,dp,wu,up]),n=[ep,es,u0,xi,d0,xu,bu,f0,h0,Uh,Vh,yu,vu,Fh,Bh,$h,Hh,qh,Gh,Wh,Yh,Kh,Xh,Jh,Qh],r=[Zh,ep,tp,np,rp,ip,op,sp,$r,yu,vu,xu,ap,lp,cp,bu,bi,dp,wu,up],i=Br(),o=Ne(i,wu);vt(o,r,o),vt(o,t.domain,o);const a=Br(),c=Br(),u=Br();vt(i,t.domain,a),vt(i,t.scheme,c),vt(i,t.slashscheme,u),vt(a,r,o),vt(a,t.domain,a);const f=Ne(a,Jo);Ne(o,Jo,f),Ne(c,Jo,f),Ne(u,Jo,f);const p=Ne(o,xi);vt(p,r,o),vt(p,t.domain,o);const g=Br();vt(f,t.domain,g),vt(g,t.domain,g);const v=Ne(g,xi);vt(v,t.domain,g);const y=Br(aN);vt(v,t.tld,y),vt(v,t.utld,y),Ne(f,Pu,y);const w=Ne(g,$r);Ne(w,$r,w),vt(w,t.domain,g),vt(y,t.domain,g),Ne(y,xi,v),Ne(y,$r,w);const S=Ne(y,es);vt(S,t.numeric,aN);const C=Ne(a,$r),T=Ne(a,xi);Ne(C,$r,C),vt(C,t.domain,a),vt(T,r,o),vt(T,t.domain,a);const N=Br(Hf);vt(T,t.tld,N),vt(T,t.utld,N),vt(N,t.domain,a),vt(N,r,o),Ne(N,xi,T),Ne(N,$r,C),Ne(N,Jo,f);const k=Ne(N,es),D=Br(Hf);vt(k,t.numeric,D);const M=Br(Hf),R=Br();vt(M,e,M),vt(M,n,R),vt(R,e,M),vt(R,n,R),Ne(N,bi,M),Ne(D,bi,M);const O=Ne(c,es),I=Ne(u,es),z=Ne(I,bi),U=Ne(z,bi);vt(c,t.domain,a),Ne(c,xi,T),Ne(c,$r,C),vt(u,t.domain,a),Ne(u,xi,T),Ne(u,$r,C),vt(O,t.domain,M),Ne(O,bi,M),Ne(O,bu,M),vt(U,t.domain,M),vt(U,e,M),Ne(U,bi,M);const Y=[[yu,vu],[Bh,Fh],[$h,Hh],[Uh,Vh],[qh,Gh],[Wh,Yh],[Kh,Xh],[Jh,Qh]];for(let W=0;W<Y.length;W++){const[j,G]=Y[W],oe=Ne(M,j);Ne(R,j,oe),Ne(oe,G,M);const L=Br(Hf);vt(oe,e,L);const $=Br();vt(oe,n),vt(L,e,L),vt(L,n,$),vt($,e,L),vt($,n,$),Ne(L,G,M),Ne($,G,M)}return Ne(i,Pu,N),Ne(i,c0,N7),{start:i,tokens:RM}}function k7(t,e,n){let r=n.length,i=0,o=[],a=[];for(;i<r;){let c=t,u=null,f=null,p=0,g=null,v=-1;for(;i<r&&!(u=c.go(n[i].t));)a.push(n[i++]);for(;i<r&&(f=u||c.go(n[i].t));)u=null,c=f,c.accepts()?(v=0,g=c):v>=0&&v++,i++,p++;if(v<0)i-=p,i<r&&(a.push(n[i]),i++);else{a.length>0&&(o.push(yv(lN,e,a)),a=[]),i-=v,p-=v;const y=g.t,w=n.slice(i-p,i);o.push(yv(y,e,w))}}return a.length>0&&o.push(yv(lN,e,a)),o}function yv(t,e,n){const r=n[0].s,i=n[n.length-1].e,o=e.slice(r,i);return new t(o,n)}const D7=typeof console<"u"&&console&&console.warn||(()=>{}),O7="until manual call of linkify.init(). Register all schemes and plugins before invoking linkify the first time.",Zt={scanner:null,parser:null,tokenQueue:[],pluginQueue:[],customSchemes:[],initialized:!1};function M7(){return fr.groups={},Zt.scanner=null,Zt.parser=null,Zt.tokenQueue=[],Zt.pluginQueue=[],Zt.customSchemes=[],Zt.initialized=!1,Zt}function cN(t,e=!1){if(Zt.initialized&&D7(`linkifyjs: already initialized - will not register custom scheme "${t}" ${O7}`),!/^[0-9a-z]+(-[0-9a-z]+)*$/.test(t))throw new Error(`linkifyjs: incorrect scheme format.
1. Must only contain digits, lowercase ASCII letters or "-"
2. Cannot start or end with "-"
3. "-" cannot repeat`);Zt.customSchemes.push([t,e])}function R7(){Zt.scanner=C7(Zt.customSchemes);for(let t=0;t<Zt.tokenQueue.length;t++)Zt.tokenQueue[t][1]({scanner:Zt.scanner});Zt.parser=A7(Zt.scanner.tokens);for(let t=0;t<Zt.pluginQueue.length;t++)Zt.pluginQueue[t][1]({scanner:Zt.scanner,parser:Zt.parser});return Zt.initialized=!0,Zt}function m0(t){return Zt.initialized||R7(),k7(Zt.parser.start,t,jM(Zt.scanner.start,t))}m0.scan=jM;function _M(t,e=null,n=null){if(e&&typeof e=="object"){if(n)throw Error(`linkifyjs: Invalid link type ${e}; must be a string`);n=e,e=null}const r=new p0(n),i=m0(t),o=[];for(let a=0;a<i.length;a++){const c=i[a];c.isLink&&(!e||c.t===e)&&r.check(c)&&o.push(c.toFormattedObject(r))}return o}var g0="[\0- -\u2029]",j7=new RegExp(g0),I7=new RegExp(`${g0}$`),_7=new RegExp(g0,"g");function L7(t){return t.length===1?t[0].isLink:t.length===3&&t[1].isLink?["()","[]"].includes(t[0].value+t[2].value):!1}function P7(t){return new nn({key:new Sn("autolink"),appendTransaction:(e,n,r)=>{const i=e.some(f=>f.docChanged)&&!n.doc.eq(r.doc),o=e.some(f=>f.getMeta("preventAutolink"));if(!i||o)return;const{tr:a}=r,c=YO(n.doc,[...e]);if(tM(c).forEach(({newRange:f})=>{const p=R8(r.doc,f,y=>y.isTextblock);let g,v;if(p.length>1)g=p[0],v=r.doc.textBetween(g.pos,g.pos+g.node.nodeSize,void 0," ");else if(p.length){const y=r.doc.textBetween(f.from,f.to," "," ");if(!I7.test(y))return;g=p[0],v=r.doc.textBetween(g.pos,f.to,void 0," ")}if(g&&v){const y=v.split(j7).filter(Boolean);if(y.length<=0)return!1;const w=y[y.length-1],S=g.pos+v.lastIndexOf(w);if(!w)return!1;const C=m0(w).map(T=>T.toObject(t.defaultProtocol));if(!L7(C))return!1;C.filter(T=>T.isLink).map(T=>({...T,from:S+T.start+1,to:S+T.end+1})).filter(T=>r.schema.marks.code?!r.doc.rangeHasMark(T.from,T.to,r.schema.marks.code):!0).filter(T=>t.validate(T.value)).filter(T=>t.shouldAutoLink(T.value)).forEach(T=>{t0(T.from,T.to,r.doc).some(N=>N.mark.type===t.type)||a.addMark(T.from,T.to,t.type.create({href:T.href}))})}}),!!a.steps.length)return a}})}function z7(t){return new nn({key:new Sn("handleClickLink"),props:{handleClick:(e,n,r)=>{var i,o;if(r.button!==0||!e.editable)return!1;let a=null;if(r.target instanceof HTMLAnchorElement)a=r.target;else{const u=r.target;if(!u)return!1;const f=t.editor.view.dom;a=u.closest("a"),a&&!f.contains(a)&&(a=null)}if(!a)return!1;let c=!1;if(t.enableClickSelection&&(c=t.editor.commands.extendMarkRange(t.type.name)),t.openOnClick){const u=eM(e.state,t.type.name),f=(i=a.href)!=null?i:u.href,p=(o=a.target)!=null?o:u.target;f&&(window.open(f,p),c=!0)}return c}}})}function B7(t){return new nn({key:new Sn("handlePasteLink"),props:{handlePaste:(e,n,r)=>{const{shouldAutoLink:i}=t,{state:o}=e,{selection:a}=o,{empty:c}=a;if(c)return!1;let u="";r.content.forEach(p=>{u+=p.textContent});const f=_M(u,{defaultProtocol:t.defaultProtocol}).find(p=>p.isLink&&p.value===u);return!u||!f||i!==void 0&&!i(f.value)?!1:t.editor.commands.setMark(t.type,{href:f.href})}}})}function qs(t,e){const n=["http","https","ftp","ftps","mailto","tel","callto","sms","cid","xmpp"];return e&&e.forEach(r=>{const i=typeof r=="string"?r:r.scheme;i&&n.push(i)}),!t||t.replace(_7,"").match(new RegExp(`^(?:(?:${n.join("|")}):|[^a-z]|[a-z0-9+.-]+(?:[^a-z+.-:]|$))`,"i"))}var F7=va.create({name:"link",priority:1e3,keepOnSplit:!1,exitable:!0,onCreate(){this.options.validate&&!this.options.shouldAutoLink&&(this.options.shouldAutoLink=this.options.validate,console.warn("The `validate` option is deprecated. Rename to the `shouldAutoLink` option instead.")),this.options.protocols.forEach(t=>{if(typeof t=="string"){cN(t);return}cN(t.scheme,t.optionalSlashes)})},onDestroy(){M7()},inclusive(){return this.options.autolink},addOptions(){return{openOnClick:!0,enableClickSelection:!1,linkOnPaste:!0,autolink:!0,protocols:[],defaultProtocol:"http",HTMLAttributes:{target:"_blank",rel:"noopener noreferrer nofollow",class:null},isAllowedUri:(t,e)=>!!qs(t,e.protocols),validate:t=>!!t,shouldAutoLink:t=>{const e=/^[a-z][a-z0-9+.-]*:\/\//i.test(t),n=/^[a-z][a-z0-9+.-]*:/i.test(t);if(e||n&&!t.includes("@"))return!0;const i=(t.includes("@")?t.split("@").pop():t).split(/[/?#:]/)[0];return!(/^\d{1,3}(\.\d{1,3}){3}$/.test(i)||!/\./.test(i))}}},addAttributes(){return{href:{default:null,parseHTML(t){return t.getAttribute("href")}},target:{default:this.options.HTMLAttributes.target},rel:{default:this.options.HTMLAttributes.rel},class:{default:this.options.HTMLAttributes.class},title:{default:null}}},parseHTML(){return[{tag:"a[href]",getAttrs:t=>{const e=t.getAttribute("href");return!e||!this.options.isAllowedUri(e,{defaultValidate:n=>!!qs(n,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?!1:null}}]},renderHTML({HTMLAttributes:t}){return this.options.isAllowedUri(t.href,{defaultValidate:e=>!!qs(e,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?["a",sn(this.options.HTMLAttributes,t),0]:["a",sn(this.options.HTMLAttributes,{...t,href:""}),0]},markdownTokenName:"link",parseMarkdown:(t,e)=>e.applyMark("link",e.parseInline(t.tokens||[]),{href:t.href,title:t.title||null}),renderMarkdown:(t,e)=>{var n,r,i,o;const a=(r=(n=t.attrs)==null?void 0:n.href)!=null?r:"",c=(o=(i=t.attrs)==null?void 0:i.title)!=null?o:"",u=e.renderChildren(t);return c?`[${u}](${a} "${c}")`:`[${u}](${a})`},addCommands(){return{setLink:t=>({chain:e})=>{const{href:n}=t;return this.options.isAllowedUri(n,{defaultValidate:r=>!!qs(r,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?e().setMark(this.name,t).setMeta("preventAutolink",!0).run():!1},toggleLink:t=>({chain:e})=>{const{href:n}=t||{};return n&&!this.options.isAllowedUri(n,{defaultValidate:r=>!!qs(r,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?!1:e().toggleMark(this.name,t,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()},unsetLink:()=>({chain:t})=>t().unsetMark(this.name,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()}},addPasteRules(){return[pa({find:t=>{const e=[];if(t){const{protocols:n,defaultProtocol:r}=this.options,i=_M(t).filter(o=>o.isLink&&this.options.isAllowedUri(o.value,{defaultValidate:a=>!!qs(a,n),protocols:n,defaultProtocol:r}));i.length&&i.forEach(o=>{this.options.shouldAutoLink(o.value)&&e.push({text:o.value,data:{href:o.href},index:o.start})})}return e},type:this.type,getAttributes:t=>{var e;return{href:(e=t.data)==null?void 0:e.href}}})]},addProseMirrorPlugins(){const t=[],{protocols:e,defaultProtocol:n}=this.options;return this.options.autolink&&t.push(P7({type:this.type,defaultProtocol:this.options.defaultProtocol,validate:r=>this.options.isAllowedUri(r,{defaultValidate:i=>!!qs(i,e),protocols:e,defaultProtocol:n}),shouldAutoLink:this.options.shouldAutoLink})),t.push(z7({type:this.type,editor:this.editor,openOnClick:this.options.openOnClick==="whenNotEditable"?!0:this.options.openOnClick,enableClickSelection:this.options.enableClickSelection})),this.options.linkOnPaste&&t.push(B7({editor:this.editor,defaultProtocol:this.options.defaultProtocol,type:this.type,shouldAutoLink:this.options.shouldAutoLink})),t}}),$7=Object.defineProperty,H7=(t,e)=>{for(var n in e)$7(t,n,{get:e[n],enumerable:!0})},U7="listItem",uN="textStyle",dN=/^\s*([-+*])\s$/,LM=Xn.create({name:"bulletList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:"ul"}]},renderHTML({HTMLAttributes:t}){return["ul",sn(this.options.HTMLAttributes,t),0]},markdownTokenName:"list",parseMarkdown:(t,e)=>t.type!=="list"||t.ordered?[]:{type:"bulletList",content:t.items?e.parseChildren(t.items):[]},renderMarkdown:(t,e)=>t.content?e.renderChildren(t.content,`
`):"",markdownOptions:{indentsContent:!0},addCommands(){return{toggleBulletList:()=>({commands:t,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(U7,this.editor.getAttributes(uN)).run():t.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let t=Ll({find:dN,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(t=Ll({find:dN,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(uN),editor:this.editor})),[t]}}),PM=Xn.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:t}){return["li",sn(this.options.HTMLAttributes,t),0]},markdownTokenName:"list_item",parseMarkdown:(t,e)=>{if(t.type!=="list_item")return[];let n=[];if(t.tokens&&t.tokens.length>0)if(t.tokens.some(i=>i.type==="paragraph"))n=e.parseChildren(t.tokens);else{const i=t.tokens[0];if(i&&i.type==="text"&&i.tokens&&i.tokens.length>0){if(n=[{type:"paragraph",content:e.parseInline(i.tokens)}],t.tokens.length>1){const a=t.tokens.slice(1),c=e.parseChildren(a);n.push(...c)}}else n=e.parseChildren(t.tokens)}return n.length===0&&(n=[{type:"paragraph",content:[]}]),{type:"listItem",content:n}},renderMarkdown:(t,e,n)=>o0(t,e,r=>{var i,o;return r.parentType==="bulletList"?"- ":r.parentType==="orderedList"?`${(((o=(i=r.meta)==null?void 0:i.parentAttrs)==null?void 0:o.start)||1)+r.index}. `:"- "},n),addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),V7={};H7(V7,{findListItemPos:()=>rd,getNextListDepth:()=>y0,handleBackspace:()=>kx,handleDelete:()=>Dx,hasListBefore:()=>zM,hasListItemAfter:()=>q7,hasListItemBefore:()=>BM,listItemHasSubList:()=>FM,nextListIsDeeper:()=>$M,nextListIsHigher:()=>HM});var rd=(t,e)=>{const{$from:n}=e.selection,r=wn(t,e.schema);let i=null,o=n.depth,a=n.pos,c=null;for(;o>0&&c===null;)i=n.node(o),i.type===r?c=o:(o-=1,a-=1);return c===null?null:{$pos:e.doc.resolve(a),depth:c}},y0=(t,e)=>{const n=rd(t,e);if(!n)return!1;const[,r]=H8(e,t,n.$pos.pos+4);return r},zM=(t,e,n)=>{const{$anchor:r}=t.selection,i=Math.max(0,r.pos-2),o=t.doc.resolve(i).node();return!(!o||!n.includes(o.type.name))},BM=(t,e)=>{var n;const{$anchor:r}=e.selection,i=e.doc.resolve(r.pos-2);return!(i.index()===0||((n=i.nodeBefore)==null?void 0:n.type.name)!==t)},FM=(t,e,n)=>{if(!n)return!1;const r=wn(t,e.schema);let i=!1;return n.descendants(o=>{o.type===r&&(i=!0)}),i},kx=(t,e,n)=>{if(t.commands.undoInputRule())return!0;if(t.state.selection.from!==t.state.selection.to)return!1;if(!vs(t.state,e)&&zM(t.state,e,n)){const{$anchor:c}=t.state.selection,u=t.state.doc.resolve(c.before()-1),f=[];u.node().descendants((v,y)=>{v.type.name===e&&f.push({node:v,pos:y})});const p=f.at(-1);if(!p)return!1;const g=t.state.doc.resolve(u.start()+p.pos+1);return t.chain().cut({from:c.start()-1,to:c.end()+1},g.end()).joinForward().run()}if(!vs(t.state,e)||!G8(t.state))return!1;const r=rd(e,t.state);if(!r)return!1;const o=t.state.doc.resolve(r.$pos.pos-2).node(r.depth),a=FM(e,t.state,o);return BM(e,t.state)&&!a?t.commands.joinItemBackward():t.chain().liftListItem(e).run()},$M=(t,e)=>{const n=y0(t,e),r=rd(t,e);return!r||!n?!1:n>r.depth},HM=(t,e)=>{const n=y0(t,e),r=rd(t,e);return!r||!n?!1:n<r.depth},Dx=(t,e)=>{if(!vs(t.state,e)||!q8(t.state,e))return!1;const{selection:n}=t.state,{$from:r,$to:i}=n;return!n.empty&&r.sameParent(i)?!1:$M(e,t.state)?t.chain().focus(t.state.selection.from+4).lift(e).joinBackward().run():HM(e,t.state)?t.chain().joinForward().joinBackward().run():t.commands.joinItemForward()},q7=(t,e)=>{var n;const{$anchor:r}=e.selection,i=e.doc.resolve(r.pos-r.parentOffset-2);return!(i.index()===i.parent.childCount-1||((n=i.nodeAfter)==null?void 0:n.type.name)!==t)},UM=an.create({name:"listKeymap",addOptions(){return{listTypes:[{itemName:"listItem",wrapperNames:["bulletList","orderedList"]},{itemName:"taskItem",wrapperNames:["taskList"]}]}},addKeyboardShortcuts(){return{Delete:({editor:t})=>{let e=!1;return this.options.listTypes.forEach(({itemName:n})=>{t.state.schema.nodes[n]!==void 0&&Dx(t,n)&&(e=!0)}),e},"Mod-Delete":({editor:t})=>{let e=!1;return this.options.listTypes.forEach(({itemName:n})=>{t.state.schema.nodes[n]!==void 0&&Dx(t,n)&&(e=!0)}),e},Backspace:({editor:t})=>{let e=!1;return this.options.listTypes.forEach(({itemName:n,wrapperNames:r})=>{t.state.schema.nodes[n]!==void 0&&kx(t,n,r)&&(e=!0)}),e},"Mod-Backspace":({editor:t})=>{let e=!1;return this.options.listTypes.forEach(({itemName:n,wrapperNames:r})=>{t.state.schema.nodes[n]!==void 0&&kx(t,n,r)&&(e=!0)}),e}}}}),fN=/^(\s*)(\d+)\.\s+(.*)$/,G7=/^\s/;function W7(t){const e=[];let n=0,r=0;for(;n<t.length;){const i=t[n],o=i.match(fN);if(!o)break;const[,a,c,u]=o,f=a.length;let p=u,g=n+1;const v=[i];for(;g<t.length;){const y=t[g];if(y.match(fN))break;if(y.trim()==="")v.push(y),p+=`
`,g+=1;else if(y.match(G7))v.push(y),p+=`
${y.slice(f+2)}`,g+=1;else break}e.push({indent:f,number:parseInt(c,10),content:p.trim(),raw:v.join(`
`)}),r=g,n=g}return[e,r]}function VM(t,e,n){var r;const i=[];let o=0;for(;o<t.length;){const a=t[o];if(a.indent===e){const c=a.content.split(`
`),u=((r=c[0])==null?void 0:r.trim())||"",f=[];u&&f.push({type:"paragraph",raw:u,tokens:n.inlineTokens(u)});const p=c.slice(1).join(`
`).trim();if(p){const y=n.blockTokens(p);f.push(...y)}let g=o+1;const v=[];for(;g<t.length&&t[g].indent>e;)v.push(t[g]),g+=1;if(v.length>0){const y=Math.min(...v.map(S=>S.indent)),w=VM(v,y,n);f.push({type:"list",ordered:!0,start:v[0].number,items:w,raw:v.map(S=>S.raw).join(`
`)})}i.push({type:"list_item",raw:a.raw,tokens:f}),o=g}else o+=1}return i}function Y7(t,e){return t.map(n=>{if(n.type!=="list_item")return e.parseChildren([n])[0];const r=[];return n.tokens&&n.tokens.length>0&&n.tokens.forEach(i=>{if(i.type==="paragraph"||i.type==="list"||i.type==="blockquote"||i.type==="code")r.push(...e.parseChildren([i]));else if(i.type==="text"&&i.tokens){const o=e.parseChildren([i]);r.push({type:"paragraph",content:o})}else{const o=e.parseChildren([i]);o.length>0&&r.push(...o)}}),{type:"listItem",content:r}})}var K7="listItem",hN="textStyle",pN=/^(\d+)\.\s$/,qM=Xn.create({name:"orderedList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes(){return{start:{default:1,parseHTML:t=>t.hasAttribute("start")?parseInt(t.getAttribute("start")||"",10):1},type:{default:null,parseHTML:t=>t.getAttribute("type")}}},parseHTML(){return[{tag:"ol"}]},renderHTML({HTMLAttributes:t}){const{start:e,...n}=t;return e===1?["ol",sn(this.options.HTMLAttributes,n),0]:["ol",sn(this.options.HTMLAttributes,t),0]},markdownTokenName:"list",parseMarkdown:(t,e)=>{if(t.type!=="list"||!t.ordered)return[];const n=t.start||1,r=t.items?Y7(t.items,e):[];return n!==1?{type:"orderedList",attrs:{start:n},content:r}:{type:"orderedList",content:r}},renderMarkdown:(t,e)=>t.content?e.renderChildren(t.content,`
`):"",markdownTokenizer:{name:"orderedList",level:"block",start:t=>{const e=t.match(/^(\s*)(\d+)\.\s+/),n=e?.index;return n!==void 0?n:-1},tokenize:(t,e,n)=>{var r;const i=t.split(`
`),[o,a]=W7(i);if(o.length===0)return;const c=VM(o,0,n);return c.length===0?void 0:{type:"list",ordered:!0,start:((r=o[0])==null?void 0:r.number)||1,items:c,raw:i.slice(0,a).join(`
`)}}},markdownOptions:{indentsContent:!0},addCommands(){return{toggleOrderedList:()=>({commands:t,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(K7,this.editor.getAttributes(hN)).run():t.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let t=Ll({find:pN,type:this.type,getAttributes:e=>({start:+e[1]}),joinPredicate:(e,n)=>n.childCount+n.attrs.start===+e[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(t=Ll({find:pN,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:e=>({start:+e[1],...this.editor.getAttributes(hN)}),joinPredicate:(e,n)=>n.childCount+n.attrs.start===+e[1],editor:this.editor})),[t]}}),X7=/^\s*(\[([( |x])?\])\s$/,J7=Xn.create({name:"taskItem",addOptions(){return{nested:!1,HTMLAttributes:{},taskListTypeName:"taskList",a11y:void 0}},content(){return this.options.nested?"paragraph block*":"paragraph+"},defining:!0,addAttributes(){return{checked:{default:!1,keepOnSplit:!1,parseHTML:t=>{const e=t.getAttribute("data-checked");return e===""||e==="true"},renderHTML:t=>({"data-checked":t.checked})}}},parseHTML(){return[{tag:`li[data-type="${this.name}"]`,priority:51}]},renderHTML({node:t,HTMLAttributes:e}){return["li",sn(this.options.HTMLAttributes,e,{"data-type":this.name}),["label",["input",{type:"checkbox",checked:t.attrs.checked?"checked":null}],["span"]],["div",0]]},parseMarkdown:(t,e)=>{const n=[];if(t.tokens&&t.tokens.length>0?n.push(e.createNode("paragraph",{},e.parseInline(t.tokens))):t.text?n.push(e.createNode("paragraph",{},[e.createNode("text",{text:t.text})])):n.push(e.createNode("paragraph",{},[])),t.nestedTokens&&t.nestedTokens.length>0){const r=e.parseChildren(t.nestedTokens);n.push(...r)}return e.createNode("taskItem",{checked:t.checked||!1},n)},renderMarkdown:(t,e)=>{var n;const i=`- [${(n=t.attrs)!=null&&n.checked?"x":" "}] `;return o0(t,e,i)},addKeyboardShortcuts(){const t={Enter:()=>this.editor.commands.splitListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)};return this.options.nested?{...t,Tab:()=>this.editor.commands.sinkListItem(this.name)}:t},addNodeView(){return({node:t,HTMLAttributes:e,getPos:n,editor:r})=>{const i=document.createElement("li"),o=document.createElement("label"),a=document.createElement("span"),c=document.createElement("input"),u=document.createElement("div"),f=g=>{var v,y;c.ariaLabel=((y=(v=this.options.a11y)==null?void 0:v.checkboxLabel)==null?void 0:y.call(v,g,c.checked))||`Task item checkbox for ${g.textContent||"empty task item"}`};f(t),o.contentEditable="false",c.type="checkbox",c.addEventListener("mousedown",g=>g.preventDefault()),c.addEventListener("change",g=>{if(!r.isEditable&&!this.options.onReadOnlyChecked){c.checked=!c.checked;return}const{checked:v}=g.target;r.isEditable&&typeof n=="function"&&r.chain().focus(void 0,{scrollIntoView:!1}).command(({tr:y})=>{const w=n();if(typeof w!="number")return!1;const S=y.doc.nodeAt(w);return y.setNodeMarkup(w,void 0,{...S?.attrs,checked:v}),!0}).run(),!r.isEditable&&this.options.onReadOnlyChecked&&(this.options.onReadOnlyChecked(t,v)||(c.checked=!c.checked))}),Object.entries(this.options.HTMLAttributes).forEach(([g,v])=>{i.setAttribute(g,v)}),i.dataset.checked=t.attrs.checked,c.checked=t.attrs.checked,o.append(c,a),i.append(o,u),Object.entries(e).forEach(([g,v])=>{i.setAttribute(g,v)});let p=new Set(Object.keys(e));return{dom:i,contentDOM:u,update:g=>{if(g.type!==this.type)return!1;i.dataset.checked=g.attrs.checked,c.checked=g.attrs.checked,f(g);const v=r.extensionManager.attributes,y=Il(g,v),w=new Set(Object.keys(y)),S=this.options.HTMLAttributes;return p.forEach(C=>{w.has(C)||(C in S?i.setAttribute(C,S[C]):i.removeAttribute(C))}),Object.entries(y).forEach(([C,T])=>{T==null?C in S?i.setAttribute(C,S[C]):i.removeAttribute(C):i.setAttribute(C,T)}),p=w,!0}}}},addInputRules(){return[Ll({find:X7,type:this.type,getAttributes:t=>({checked:t[t.length-1]==="x"})})]}}),Q7=Xn.create({name:"taskList",addOptions(){return{itemTypeName:"taskItem",HTMLAttributes:{}}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:`ul[data-type="${this.name}"]`,priority:51}]},renderHTML({HTMLAttributes:t}){return["ul",sn(this.options.HTMLAttributes,t,{"data-type":this.name}),0]},parseMarkdown:(t,e)=>e.createNode("taskList",{},e.parseChildren(t.items||[])),renderMarkdown:(t,e)=>t.content?e.renderChildren(t.content,`
`):"",markdownTokenizer:{name:"taskList",level:"block",start(t){var e;const n=(e=t.match(/^\s*[-+*]\s+\[([ xX])\]\s+/))==null?void 0:e.index;return n!==void 0?n:-1},tokenize(t,e,n){const r=o=>{const a=vx(o,{itemPattern:/^(\s*)([-+*])\s+\[([ xX])\]\s+(.*)$/,extractItemData:c=>({indentLevel:c[1].length,mainContent:c[4],checked:c[3].toLowerCase()==="x"}),createToken:(c,u)=>({type:"taskItem",raw:"",mainContent:c.mainContent,indentLevel:c.indentLevel,checked:c.checked,text:c.mainContent,tokens:n.inlineTokens(c.mainContent),nestedTokens:u}),customNestedParser:r},n);return a?[{type:"taskList",raw:a.raw,items:a.items}]:n.blockTokens(o)},i=vx(t,{itemPattern:/^(\s*)([-+*])\s+\[([ xX])\]\s+(.*)$/,extractItemData:o=>({indentLevel:o[1].length,mainContent:o[4],checked:o[3].toLowerCase()==="x"}),createToken:(o,a)=>({type:"taskItem",raw:"",mainContent:o.mainContent,indentLevel:o.indentLevel,checked:o.checked,text:o.mainContent,tokens:n.inlineTokens(o.mainContent),nestedTokens:a}),customNestedParser:r},n);if(i)return{type:"taskList",raw:i.raw,items:i.items}}},markdownOptions:{indentsContent:!0},addCommands(){return{toggleTaskList:()=>({commands:t})=>t.toggleList(this.name,this.options.itemTypeName)}},addKeyboardShortcuts(){return{"Mod-Shift-9":()=>this.editor.commands.toggleTaskList()}}});an.create({name:"listKit",addExtensions(){const t=[];return this.options.bulletList!==!1&&t.push(LM.configure(this.options.bulletList)),this.options.listItem!==!1&&t.push(PM.configure(this.options.listItem)),this.options.listKeymap!==!1&&t.push(UM.configure(this.options.listKeymap)),this.options.orderedList!==!1&&t.push(qM.configure(this.options.orderedList)),this.options.taskItem!==!1&&t.push(J7.configure(this.options.taskItem)),this.options.taskList!==!1&&t.push(Q7.configure(this.options.taskList)),t}});var mN="&nbsp;",Z7="",eq=Xn.create({name:"paragraph",priority:1e3,addOptions(){return{HTMLAttributes:{}}},group:"block",content:"inline*",parseHTML(){return[{tag:"p"}]},renderHTML({HTMLAttributes:t}){return["p",sn(this.options.HTMLAttributes,t),0]},parseMarkdown:(t,e)=>{const n=t.tokens||[];if(n.length===1&&n[0].type==="image")return e.parseChildren([n[0]]);const r=e.parseInline(n);return r.length===1&&r[0].type==="text"&&(r[0].text===mN||r[0].text===Z7)?e.createNode("paragraph",void 0,[]):e.createNode("paragraph",void 0,r)},renderMarkdown:(t,e)=>{if(!t)return"";const n=Array.isArray(t.content)?t.content:[];return n.length===0?mN:e.renderChildren(n)},addCommands(){return{setParagraph:()=>({commands:t})=>t.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),tq=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))$/,nq=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))/g,rq=va.create({name:"strike",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:t=>t.includes("line-through")?{}:!1}]},renderHTML({HTMLAttributes:t}){return["s",sn(this.options.HTMLAttributes,t),0]},markdownTokenName:"del",parseMarkdown:(t,e)=>e.applyMark("strike",e.parseInline(t.tokens||[])),renderMarkdown:(t,e)=>`~~${e.renderChildren(t)}~~`,addCommands(){return{setStrike:()=>({commands:t})=>t.setMark(this.name),toggleStrike:()=>({commands:t})=>t.toggleMark(this.name),unsetStrike:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-s":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[_l({find:tq,type:this.type})]},addPasteRules(){return[pa({find:nq,type:this.type})]}}),iq=Xn.create({name:"text",group:"inline",parseMarkdown:t=>({type:"text",text:t.text||""}),renderMarkdown:t=>t.text||""}),oq=va.create({name:"underline",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"u"},{style:"text-decoration",consuming:!1,getAttrs:t=>t.includes("underline")?{}:!1}]},renderHTML({HTMLAttributes:t}){return["u",sn(this.options.HTMLAttributes,t),0]},parseMarkdown(t,e){return e.applyMark(this.name||"underline",e.parseInline(t.tokens||[]))},renderMarkdown(t,e){return`++${e.renderChildren(t)}++`},markdownTokenizer:{name:"underline",level:"inline",start(t){return t.indexOf("++")},tokenize(t,e,n){const i=/^(\+\+)([\s\S]+?)(\+\+)/.exec(t);if(!i)return;const o=i[2].trim();return{type:"underline",raw:i[0],text:o,tokens:n.inlineTokens(o)}}},addCommands(){return{setUnderline:()=>({commands:t})=>t.setMark(this.name),toggleUnderline:()=>({commands:t})=>t.toggleMark(this.name),unsetUnderline:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-u":()=>this.editor.commands.toggleUnderline(),"Mod-U":()=>this.editor.commands.toggleUnderline()}}});function sq(t={}){return new nn({view(e){return new aq(e,t)}})}class aq{constructor(e,n){var r;this.editorView=e,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=(r=n.width)!==null&&r!==void 0?r:1,this.color=n.color===!1?void 0:n.color||"black",this.class=n.class,this.handlers=["dragover","dragend","drop","dragleave"].map(i=>{let o=a=>{this[i](a)};return e.dom.addEventListener(i,o),{name:i,handler:o}})}destroy(){this.handlers.forEach(({name:e,handler:n})=>this.editorView.dom.removeEventListener(e,n))}update(e,n){this.cursorPos!=null&&n.doc!=e.state.doc&&(this.cursorPos>e.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(e){e!=this.cursorPos&&(this.cursorPos=e,e==null?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let e=this.editorView.state.doc.resolve(this.cursorPos),n=!e.parent.inlineContent,r,i=this.editorView.dom,o=i.getBoundingClientRect(),a=o.width/i.offsetWidth,c=o.height/i.offsetHeight;if(n){let g=e.nodeBefore,v=e.nodeAfter;if(g||v){let y=this.editorView.nodeDOM(this.cursorPos-(g?g.nodeSize:0));if(y){let w=y.getBoundingClientRect(),S=g?w.bottom:w.top;g&&v&&(S=(S+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2);let C=this.width/2*c;r={left:w.left,right:w.right,top:S-C,bottom:S+C}}}}if(!r){let g=this.editorView.coordsAtPos(this.cursorPos),v=this.width/2*a;r={left:g.left-v,right:g.left+v,top:g.top,bottom:g.bottom}}let u=this.editorView.dom.offsetParent;this.element||(this.element=u.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",n),this.element.classList.toggle("prosemirror-dropcursor-inline",!n);let f,p;if(!u||u==document.body&&getComputedStyle(u).position=="static")f=-pageXOffset,p=-pageYOffset;else{let g=u.getBoundingClientRect(),v=g.width/u.offsetWidth,y=g.height/u.offsetHeight;f=g.left-u.scrollLeft*v,p=g.top-u.scrollTop*y}this.element.style.left=(r.left-f)/a+"px",this.element.style.top=(r.top-p)/c+"px",this.element.style.width=(r.right-r.left)/a+"px",this.element.style.height=(r.bottom-r.top)/c+"px"}scheduleRemoval(e){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),e)}dragover(e){if(!this.editorView.editable)return;let n=this.editorView.posAtCoords({left:e.clientX,top:e.clientY}),r=n&&n.inside>=0&&this.editorView.state.doc.nodeAt(n.inside),i=r&&r.type.spec.disableDropCursor,o=typeof i=="function"?i(this.editorView,n,e):i;if(n&&!o){let a=n.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){let c=BD(this.editorView.state.doc,a,this.editorView.dragging.slice);c!=null&&(a=c)}this.setCursor(a),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(e){this.editorView.dom.contains(e.relatedTarget)||this.setCursor(null)}}class dn extends xt{constructor(e){super(e,e)}map(e,n){let r=e.resolve(n.map(this.head));return dn.valid(r)?new dn(r):xt.near(r)}content(){return je.empty}eq(e){return e instanceof dn&&e.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(e,n){if(typeof n.pos!="number")throw new RangeError("Invalid input for GapCursor.fromJSON");return new dn(e.resolve(n.pos))}getBookmark(){return new v0(this.anchor)}static valid(e){let n=e.parent;if(n.isTextblock||!lq(e)||!cq(e))return!1;let r=n.type.spec.allowGapCursor;if(r!=null)return r;let i=n.contentMatchAt(e.index()).defaultType;return i&&i.isTextblock}static findGapCursorFrom(e,n,r=!1){e:for(;;){if(!r&&dn.valid(e))return e;let i=e.pos,o=null;for(let a=e.depth;;a--){let c=e.node(a);if(n>0?e.indexAfter(a)<c.childCount:e.index(a)>0){o=c.child(n>0?e.indexAfter(a):e.index(a)-1);break}else if(a==0)return null;i+=n;let u=e.doc.resolve(i);if(dn.valid(u))return u}for(;;){let a=n>0?o.firstChild:o.lastChild;if(!a){if(o.isAtom&&!o.isText&&!Je.isSelectable(o)){e=e.doc.resolve(i+o.nodeSize*n),r=!1;continue e}break}o=a,i+=n;let c=e.doc.resolve(i);if(dn.valid(c))return c}return null}}}dn.prototype.visible=!1;dn.findFrom=dn.findGapCursorFrom;xt.jsonID("gapcursor",dn);class v0{constructor(e){this.pos=e}map(e){return new v0(e.map(this.pos))}resolve(e){let n=e.resolve(this.pos);return dn.valid(n)?new dn(n):xt.near(n)}}function GM(t){return t.isAtom||t.spec.isolating||t.spec.createGapCursor}function lq(t){for(let e=t.depth;e>=0;e--){let n=t.index(e),r=t.node(e);if(n==0){if(r.type.spec.isolating)return!0;continue}for(let i=r.child(n-1);;i=i.lastChild){if(i.childCount==0&&!i.inlineContent||GM(i.type))return!0;if(i.inlineContent)return!1}}return!0}function cq(t){for(let e=t.depth;e>=0;e--){let n=t.indexAfter(e),r=t.node(e);if(n==r.childCount){if(r.type.spec.isolating)return!0;continue}for(let i=r.child(n);;i=i.firstChild){if(i.childCount==0&&!i.inlineContent||GM(i.type))return!0;if(i.inlineContent)return!1}}return!0}function uq(){return new nn({props:{decorations:pq,createSelectionBetween(t,e,n){return e.pos==n.pos&&dn.valid(n)?new dn(n):null},handleClick:fq,handleKeyDown:dq,handleDOMEvents:{beforeinput:hq}}})}const dq=FO({ArrowLeft:Uf("horiz",-1),ArrowRight:Uf("horiz",1),ArrowUp:Uf("vert",-1),ArrowDown:Uf("vert",1)});function Uf(t,e){const n=t=="vert"?e>0?"down":"up":e>0?"right":"left";return function(r,i,o){let a=r.selection,c=e>0?a.$to:a.$from,u=a.empty;if(a instanceof st){if(!o.endOfTextblock(n)||c.depth==0)return!1;u=!1,c=r.doc.resolve(e>0?c.after():c.before())}let f=dn.findGapCursorFrom(c,e,u);return f?(i&&i(r.tr.setSelection(new dn(f))),!0):!1}}function fq(t,e,n){if(!t||!t.editable)return!1;let r=t.state.doc.resolve(e);if(!dn.valid(r))return!1;let i=t.posAtCoords({left:n.clientX,top:n.clientY});return i&&i.inside>-1&&Je.isSelectable(t.state.doc.nodeAt(i.inside))?!1:(t.dispatch(t.state.tr.setSelection(new dn(r))),!0)}function hq(t,e){if(e.inputType!="insertCompositionText"||!(t.state.selection instanceof dn))return!1;let{$from:n}=t.state.selection,r=n.parent.contentMatchAt(n.index()).findWrapping(t.state.schema.nodes.text);if(!r)return!1;let i=Ee.empty;for(let a=r.length-1;a>=0;a--)i=Ee.from(r[a].createAndFill(null,i));let o=t.state.tr.replace(n.pos,n.pos,new je(i,0,0));return o.setSelection(st.near(o.doc.resolve(n.pos+1))),t.dispatch(o),!1}function pq(t){if(!(t.selection instanceof dn))return null;let e=document.createElement("div");return e.className="ProseMirror-gapcursor",tn.create(t.doc,[Gn.widget(t.selection.head,e,{key:"gapcursor"})])}var fp=200,Mn=function(){};Mn.prototype.append=function(e){return e.length?(e=Mn.from(e),!this.length&&e||e.length<fp&&this.leafAppend(e)||this.length<fp&&e.leafPrepend(this)||this.appendInner(e)):this};Mn.prototype.prepend=function(e){return e.length?Mn.from(e).append(this):this};Mn.prototype.appendInner=function(e){return new mq(this,e)};Mn.prototype.slice=function(e,n){return e===void 0&&(e=0),n===void 0&&(n=this.length),e>=n?Mn.empty:this.sliceInner(Math.max(0,e),Math.min(this.length,n))};Mn.prototype.get=function(e){if(!(e<0||e>=this.length))return this.getInner(e)};Mn.prototype.forEach=function(e,n,r){n===void 0&&(n=0),r===void 0&&(r=this.length),n<=r?this.forEachInner(e,n,r,0):this.forEachInvertedInner(e,n,r,0)};Mn.prototype.map=function(e,n,r){n===void 0&&(n=0),r===void 0&&(r=this.length);var i=[];return this.forEach(function(o,a){return i.push(e(o,a))},n,r),i};Mn.from=function(e){return e instanceof Mn?e:e&&e.length?new WM(e):Mn.empty};var WM=(function(t){function e(r){t.call(this),this.values=r}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={length:{configurable:!0},depth:{configurable:!0}};return e.prototype.flatten=function(){return this.values},e.prototype.sliceInner=function(i,o){return i==0&&o==this.length?this:new e(this.values.slice(i,o))},e.prototype.getInner=function(i){return this.values[i]},e.prototype.forEachInner=function(i,o,a,c){for(var u=o;u<a;u++)if(i(this.values[u],c+u)===!1)return!1},e.prototype.forEachInvertedInner=function(i,o,a,c){for(var u=o-1;u>=a;u--)if(i(this.values[u],c+u)===!1)return!1},e.prototype.leafAppend=function(i){if(this.length+i.length<=fp)return new e(this.values.concat(i.flatten()))},e.prototype.leafPrepend=function(i){if(this.length+i.length<=fp)return new e(i.flatten().concat(this.values))},n.length.get=function(){return this.values.length},n.depth.get=function(){return 0},Object.defineProperties(e.prototype,n),e})(Mn);Mn.empty=new WM([]);var mq=(function(t){function e(n,r){t.call(this),this.left=n,this.right=r,this.length=n.length+r.length,this.depth=Math.max(n.depth,r.depth)+1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},e.prototype.getInner=function(r){return r<this.left.length?this.left.get(r):this.right.get(r-this.left.length)},e.prototype.forEachInner=function(r,i,o,a){var c=this.left.length;if(i<c&&this.left.forEachInner(r,i,Math.min(o,c),a)===!1||o>c&&this.right.forEachInner(r,Math.max(i-c,0),Math.min(this.length,o)-c,a+c)===!1)return!1},e.prototype.forEachInvertedInner=function(r,i,o,a){var c=this.left.length;if(i>c&&this.right.forEachInvertedInner(r,i-c,Math.max(o,c)-c,a+c)===!1||o<c&&this.left.forEachInvertedInner(r,Math.min(i,c),o,a)===!1)return!1},e.prototype.sliceInner=function(r,i){if(r==0&&i==this.length)return this;var o=this.left.length;return i<=o?this.left.slice(r,i):r>=o?this.right.slice(r-o,i-o):this.left.slice(r,o).append(this.right.slice(0,i-o))},e.prototype.leafAppend=function(r){var i=this.right.leafAppend(r);if(i)return new e(this.left,i)},e.prototype.leafPrepend=function(r){var i=this.left.leafPrepend(r);if(i)return new e(i,this.right)},e.prototype.appendInner=function(r){return this.left.depth>=Math.max(this.right.depth,r.depth)+1?new e(this.left,new e(this.right,r)):new e(this,r)},e})(Mn);const gq=500;class ri{constructor(e,n){this.items=e,this.eventCount=n}popEvent(e,n){if(this.eventCount==0)return null;let r=this.items.length;for(;;r--)if(this.items.get(r-1).selection){--r;break}let i,o;n&&(i=this.remapping(r,this.items.length),o=i.maps.length);let a=e.tr,c,u,f=[],p=[];return this.items.forEach((g,v)=>{if(!g.step){i||(i=this.remapping(r,v+1),o=i.maps.length),o--,p.push(g);return}if(i){p.push(new Go(g.map));let y=g.step.map(i.slice(o)),w;y&&a.maybeStep(y).doc&&(w=a.mapping.maps[a.mapping.maps.length-1],f.push(new Go(w,void 0,void 0,f.length+p.length))),o--,w&&i.appendMap(w,o)}else a.maybeStep(g.step);if(g.selection)return c=i?g.selection.map(i.slice(o)):g.selection,u=new ri(this.items.slice(0,r).append(p.reverse().concat(f)),this.eventCount-1),!1},this.items.length,0),{remaining:u,transform:a,selection:c}}addTransform(e,n,r,i){let o=[],a=this.eventCount,c=this.items,u=!i&&c.length?c.get(c.length-1):null;for(let p=0;p<e.steps.length;p++){let g=e.steps[p].invert(e.docs[p]),v=new Go(e.mapping.maps[p],g,n),y;(y=u&&u.merge(v))&&(v=y,p?o.pop():c=c.slice(0,c.length-1)),o.push(v),n&&(a++,n=void 0),i||(u=v)}let f=a-r.depth;return f>vq&&(c=yq(c,f),a-=f),new ri(c.append(o),a)}remapping(e,n){let r=new Ou;return this.items.forEach((i,o)=>{let a=i.mirrorOffset!=null&&o-i.mirrorOffset>=e?r.maps.length-i.mirrorOffset:void 0;r.appendMap(i.map,a)},e,n),r}addMaps(e){return this.eventCount==0?this:new ri(this.items.append(e.map(n=>new Go(n))),this.eventCount)}rebased(e,n){if(!this.eventCount)return this;let r=[],i=Math.max(0,this.items.length-n),o=e.mapping,a=e.steps.length,c=this.eventCount;this.items.forEach(v=>{v.selection&&c--},i);let u=n;this.items.forEach(v=>{let y=o.getMirror(--u);if(y==null)return;a=Math.min(a,y);let w=o.maps[y];if(v.step){let S=e.steps[y].invert(e.docs[y]),C=v.selection&&v.selection.map(o.slice(u+1,y));C&&c++,r.push(new Go(w,S,C))}else r.push(new Go(w))},i);let f=[];for(let v=n;v<a;v++)f.push(new Go(o.maps[v]));let p=this.items.slice(0,i).append(f).append(r),g=new ri(p,c);return g.emptyItemCount()>gq&&(g=g.compress(this.items.length-r.length)),g}emptyItemCount(){let e=0;return this.items.forEach(n=>{n.step||e++}),e}compress(e=this.items.length){let n=this.remapping(0,e),r=n.maps.length,i=[],o=0;return this.items.forEach((a,c)=>{if(c>=e)i.push(a),a.selection&&o++;else if(a.step){let u=a.step.map(n.slice(r)),f=u&&u.getMap();if(r--,f&&n.appendMap(f,r),u){let p=a.selection&&a.selection.map(n.slice(r));p&&o++;let g=new Go(f.invert(),u,p),v,y=i.length-1;(v=i.length&&i[y].merge(g))?i[y]=v:i.push(g)}}else a.map&&r--},this.items.length,0),new ri(Mn.from(i.reverse()),o)}}ri.empty=new ri(Mn.empty,0);function yq(t,e){let n;return t.forEach((r,i)=>{if(r.selection&&e--==0)return n=i,!1}),t.slice(n)}let Go=class YM{constructor(e,n,r,i){this.map=e,this.step=n,this.selection=r,this.mirrorOffset=i}merge(e){if(this.step&&e.step&&!e.selection){let n=e.step.merge(this.step);if(n)return new YM(n.getMap().invert(),n,this.selection)}}};class Qo{constructor(e,n,r,i,o){this.done=e,this.undone=n,this.prevRanges=r,this.prevTime=i,this.prevComposition=o}}const vq=20;function xq(t,e,n,r){let i=n.getMeta(ra),o;if(i)return i.historyState;n.getMeta(Sq)&&(t=new Qo(t.done,t.undone,null,0,-1));let a=n.getMeta("appendedTransaction");if(n.steps.length==0)return t;if(a&&a.getMeta(ra))return a.getMeta(ra).redo?new Qo(t.done.addTransform(n,void 0,r,lh(e)),t.undone,gN(n.mapping.maps),t.prevTime,t.prevComposition):new Qo(t.done,t.undone.addTransform(n,void 0,r,lh(e)),null,t.prevTime,t.prevComposition);if(n.getMeta("addToHistory")!==!1&&!(a&&a.getMeta("addToHistory")===!1)){let c=n.getMeta("composition"),u=t.prevTime==0||!a&&t.prevComposition!=c&&(t.prevTime<(n.time||0)-r.newGroupDelay||!bq(n,t.prevRanges)),f=a?vv(t.prevRanges,n.mapping):gN(n.mapping.maps);return new Qo(t.done.addTransform(n,u?e.selection.getBookmark():void 0,r,lh(e)),ri.empty,f,n.time,c??t.prevComposition)}else return(o=n.getMeta("rebased"))?new Qo(t.done.rebased(n,o),t.undone.rebased(n,o),vv(t.prevRanges,n.mapping),t.prevTime,t.prevComposition):new Qo(t.done.addMaps(n.mapping.maps),t.undone.addMaps(n.mapping.maps),vv(t.prevRanges,n.mapping),t.prevTime,t.prevComposition)}function bq(t,e){if(!e)return!1;if(!t.docChanged)return!0;let n=!1;return t.mapping.maps[0].forEach((r,i)=>{for(let o=0;o<e.length;o+=2)r<=e[o+1]&&i>=e[o]&&(n=!0)}),n}function gN(t){let e=[];for(let n=t.length-1;n>=0&&e.length==0;n--)t[n].forEach((r,i,o,a)=>e.push(o,a));return e}function vv(t,e){if(!t)return null;let n=[];for(let r=0;r<t.length;r+=2){let i=e.map(t[r],1),o=e.map(t[r+1],-1);i<=o&&n.push(i,o)}return n}function wq(t,e,n){let r=lh(e),i=ra.get(e).spec.config,o=(n?t.undone:t.done).popEvent(e,r);if(!o)return null;let a=o.selection.resolve(o.transform.doc),c=(n?t.done:t.undone).addTransform(o.transform,e.selection.getBookmark(),i,r),u=new Qo(n?c:o.remaining,n?o.remaining:c,null,0,-1);return o.transform.setSelection(a).setMeta(ra,{redo:n,historyState:u})}let xv=!1,yN=null;function lh(t){let e=t.plugins;if(yN!=e){xv=!1,yN=e;for(let n=0;n<e.length;n++)if(e[n].spec.historyPreserveItems){xv=!0;break}}return xv}const ra=new Sn("history"),Sq=new Sn("closeHistory");function Eq(t={}){return t={depth:t.depth||100,newGroupDelay:t.newGroupDelay||500},new nn({key:ra,state:{init(){return new Qo(ri.empty,ri.empty,null,0,-1)},apply(e,n,r){return xq(n,r,e,t)}},config:t,props:{handleDOMEvents:{beforeinput(e,n){let r=n.inputType,i=r=="historyUndo"?XM:r=="historyRedo"?JM:null;return!i||!e.editable?!1:(n.preventDefault(),i(e.state,e.dispatch))}}}})}function KM(t,e){return(n,r)=>{let i=ra.getState(n);if(!i||(t?i.undone:i.done).eventCount==0)return!1;if(r){let o=wq(i,n,t);o&&r(e?o.scrollIntoView():o)}return!0}}const XM=KM(!1,!0),JM=KM(!0,!0);an.create({name:"characterCount",addOptions(){return{limit:null,mode:"textSize",textCounter:t=>t.length,wordCounter:t=>t.split(" ").filter(e=>e!=="").length}},addStorage(){return{characters:()=>0,words:()=>0}},onBeforeCreate(){this.storage.characters=t=>{const e=t?.node||this.editor.state.doc;if((t?.mode||this.options.mode)==="textSize"){const r=e.textBetween(0,e.content.size,void 0," ");return this.options.textCounter(r)}return e.nodeSize},this.storage.words=t=>{const e=t?.node||this.editor.state.doc,n=e.textBetween(0,e.content.size," "," ");return this.options.wordCounter(n)}},addProseMirrorPlugins(){let t=!1;return[new nn({key:new Sn("characterCount"),appendTransaction:(e,n,r)=>{if(t)return;const i=this.options.limit;if(i==null||i===0){t=!0;return}const o=this.storage.characters({node:r.doc});if(o>i){const a=o-i,c=0,u=a;console.warn(`[CharacterCount] Initial content exceeded limit of ${i} characters. Content was automatically trimmed.`);const f=r.tr.deleteRange(c,u);return t=!0,f}t=!0},filterTransaction:(e,n)=>{const r=this.options.limit;if(!e.docChanged||r===0||r===null||r===void 0)return!0;const i=this.storage.characters({node:n.doc}),o=this.storage.characters({node:e.doc});if(o<=r||i>r&&o>r&&o<=i)return!0;if(i>r&&o>r&&o>i||!e.getMeta("paste"))return!1;const c=e.selection.$head.pos,u=o-r,f=c-u,p=c;return e.deleteRange(f,p),!(this.storage.characters({node:e.doc})>r)}})]}});var Cq=an.create({name:"dropCursor",addOptions(){return{color:"currentColor",width:1,class:void 0}},addProseMirrorPlugins(){return[sq(this.options)]}});an.create({name:"focus",addOptions(){return{className:"has-focus",mode:"all"}},addProseMirrorPlugins(){return[new nn({key:new Sn("focus"),props:{decorations:({doc:t,selection:e})=>{const{isEditable:n,isFocused:r}=this.editor,{anchor:i}=e,o=[];if(!n||!r)return tn.create(t,[]);let a=0;this.options.mode==="deepest"&&t.descendants((u,f)=>{if(u.isText)return;if(!(i>=f&&i<=f+u.nodeSize-1))return!1;a+=1});let c=0;return t.descendants((u,f)=>{if(u.isText||!(i>=f&&i<=f+u.nodeSize-1))return!1;if(c+=1,this.options.mode==="deepest"&&a-c>0||this.options.mode==="shallowest"&&c>1)return this.options.mode==="deepest";o.push(Gn.node(f,f+u.nodeSize,{class:this.options.className}))}),tn.create(t,o)}}})]}});var Tq=an.create({name:"gapCursor",addProseMirrorPlugins(){return[uq()]},extendNodeSchema(t){var e;const n={name:t.name,options:t.options,storage:t.storage};return{allowGapCursor:(e=Ut(Xe(t,"allowGapCursor",n)))!=null?e:null}}}),vN="placeholder";function Nq(t){return t.replace(/\s+/g,"-").replace(/[^a-zA-Z0-9-]/g,"").replace(/^[0-9-]+/,"").replace(/^-+/,"").toLowerCase()}var Aq=an.create({name:"placeholder",addOptions(){return{emptyEditorClass:"is-editor-empty",emptyNodeClass:"is-empty",dataAttribute:vN,placeholder:"Write something ",showOnlyWhenEditable:!0,showOnlyCurrent:!0,includeChildren:!1}},addProseMirrorPlugins(){const t=this.options.dataAttribute?`data-${Nq(this.options.dataAttribute)}`:`data-${vN}`;return[new nn({key:new Sn("placeholder"),props:{decorations:({doc:e,selection:n})=>{const r=this.editor.isEditable||!this.options.showOnlyWhenEditable,{anchor:i}=n,o=[];if(!r)return null;const a=this.editor.isEmpty;return e.descendants((c,u)=>{const f=i>=u&&i<=u+c.nodeSize,p=!c.isLeaf&&Jp(c);if((f||!this.options.showOnlyCurrent)&&p){const g=[this.options.emptyNodeClass];a&&g.push(this.options.emptyEditorClass);const v=Gn.node(u,u+c.nodeSize,{class:g.join(" "),[t]:typeof this.options.placeholder=="function"?this.options.placeholder({editor:this.editor,node:c,pos:u,hasAnchor:f}):this.options.placeholder});o.push(v)}return this.options.includeChildren}),tn.create(e,o)}}})]}});an.create({name:"selection",addOptions(){return{className:"selection"}},addProseMirrorPlugins(){const{editor:t,options:e}=this;return[new nn({key:new Sn("selection"),props:{decorations(n){return n.selection.empty||t.isFocused||!t.isEditable||nM(n.selection)||t.view.dragging?null:tn.create(n.doc,[Gn.inline(n.selection.from,n.selection.to,{class:e.className})])}}})]}});function xN({types:t,node:e}){return e&&Array.isArray(t)&&t.includes(e.type)||e?.type===t}var kq=an.create({name:"trailingNode",addOptions(){return{node:void 0,notAfter:[]}},addProseMirrorPlugins(){var t;const e=new Sn(this.name),n=this.options.node||((t=this.editor.schema.topNodeType.contentMatch.defaultType)==null?void 0:t.name)||"paragraph",r=Object.entries(this.editor.schema.nodes).map(([,i])=>i).filter(i=>(this.options.notAfter||[]).concat(n).includes(i.name));return[new nn({key:e,appendTransaction:(i,o,a)=>{const{doc:c,tr:u,schema:f}=a,p=e.getState(a),g=c.content.size,v=f.nodes[n];if(p)return u.insert(g,v.create())},state:{init:(i,o)=>{const a=o.tr.doc.lastChild;return!xN({node:a,types:r})},apply:(i,o)=>{if(!i.docChanged||i.getMeta("__uniqueIDTransaction"))return o;const a=i.doc.lastChild;return!xN({node:a,types:r})}}})]}}),Dq=an.create({name:"undoRedo",addOptions(){return{depth:100,newGroupDelay:500}},addCommands(){return{undo:()=>({state:t,dispatch:e})=>XM(t,e),redo:()=>({state:t,dispatch:e})=>JM(t,e)}},addProseMirrorPlugins(){return[Eq(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-":()=>this.editor.commands.undo(),"Shift-Mod-":()=>this.editor.commands.redo()}}}),Oq=an.create({name:"starterKit",addExtensions(){var t,e,n,r;const i=[];return this.options.bold!==!1&&i.push(e7.configure(this.options.bold)),this.options.blockquote!==!1&&i.push(K9.configure(this.options.blockquote)),this.options.bulletList!==!1&&i.push(LM.configure(this.options.bulletList)),this.options.code!==!1&&i.push(r7.configure(this.options.code)),this.options.codeBlock!==!1&&i.push(s7.configure(this.options.codeBlock)),this.options.document!==!1&&i.push(a7.configure(this.options.document)),this.options.dropcursor!==!1&&i.push(Cq.configure(this.options.dropcursor)),this.options.gapcursor!==!1&&i.push(Tq.configure(this.options.gapcursor)),this.options.hardBreak!==!1&&i.push(l7.configure(this.options.hardBreak)),this.options.heading!==!1&&i.push(c7.configure(this.options.heading)),this.options.undoRedo!==!1&&i.push(Dq.configure(this.options.undoRedo)),this.options.horizontalRule!==!1&&i.push(u7.configure(this.options.horizontalRule)),this.options.italic!==!1&&i.push(m7.configure(this.options.italic)),this.options.listItem!==!1&&i.push(PM.configure(this.options.listItem)),this.options.listKeymap!==!1&&i.push(UM.configure((t=this.options)==null?void 0:t.listKeymap)),this.options.link!==!1&&i.push(F7.configure((e=this.options)==null?void 0:e.link)),this.options.orderedList!==!1&&i.push(qM.configure(this.options.orderedList)),this.options.paragraph!==!1&&i.push(eq.configure(this.options.paragraph)),this.options.strike!==!1&&i.push(rq.configure(this.options.strike)),this.options.text!==!1&&i.push(iq.configure(this.options.text)),this.options.underline!==!1&&i.push(oq.configure((n=this.options)==null?void 0:n.underline)),this.options.trailingNode!==!1&&i.push(kq.configure((r=this.options)==null?void 0:r.trailingNode)),i}}),Mq=Oq,Rq=Aq;function jq(t){if(Array.isArray(t))return t}function Iq(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var r,i,o,a,c=[],u=!0,f=!1;try{if(o=(n=n.call(t)).next,e!==0)for(;!(u=(r=o.call(n)).done)&&(c.push(r.value),c.length!==e);u=!0);}catch(p){f=!0,i=p}finally{try{if(!u&&n.return!=null&&(a=n.return(),Object(a)!==a))return}finally{if(f)throw i}}return c}}function Ox(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function QM(t,e){if(t){if(typeof t=="string")return Ox(t,e);var n={}.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ox(t,e):void 0}}function _q(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ZM(t,e){return jq(t)||Iq(t,e)||QM(t,e)||_q()}var bv={},Jc={},bN;function e2(){if(bN)return Jc;bN=1,Object.defineProperty(Jc,"__esModule",{value:!0}),Jc.bind=void 0;function t(e,n){var r=n.type,i=n.listener,o=n.options;return e.addEventListener(r,i,o),function(){e.removeEventListener(r,i,o)}}return Jc.bind=t,Jc}var Gs={},wN;function Lq(){if(wN)return Gs;wN=1;var t=Gs&&Gs.__assign||function(){return t=Object.assign||function(o){for(var a,c=1,u=arguments.length;c<u;c++){a=arguments[c];for(var f in a)Object.prototype.hasOwnProperty.call(a,f)&&(o[f]=a[f])}return o},t.apply(this,arguments)};Object.defineProperty(Gs,"__esModule",{value:!0}),Gs.bindAll=void 0;var e=e2();function n(o){if(!(typeof o>"u"))return typeof o=="boolean"?{capture:o}:o}function r(o,a){if(a==null)return o;var c=t(t({},o),{options:t(t({},n(a)),n(o.options))});return c}function i(o,a,c){var u=a.map(function(f){var p=r(f,c);return(0,e.bind)(o,p)});return function(){u.forEach(function(p){return p()})}}return Gs.bindAll=i,Gs}var SN;function Pq(){return SN||(SN=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.bindAll=t.bind=void 0;var e=e2();Object.defineProperty(t,"bind",{enumerable:!0,get:function(){return e.bind}});var n=Lq();Object.defineProperty(t,"bindAll",{enumerable:!0,get:function(){return n.bindAll}})})(bv)),bv}var mo=Pq(),t2="data-pdnd-honey-pot";function n2(t){return t instanceof Element&&t.hasAttribute(t2)}function x0(t){var e=document.elementsFromPoint(t.x,t.y),n=ZM(e,2),r=n[0],i=n[1];return r?n2(r)?i??null:r:null}function Bu(t){"@babel/helpers - typeof";return Bu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Bu(t)}function zq(t,e){if(Bu(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(Bu(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Bq(t){var e=zq(t,"string");return Bu(e)=="symbol"?e:e+""}function si(t,e,n){return(e=Bq(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var r2=2147483647;function EN(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function CN(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?EN(Object(n),!0).forEach(function(r){si(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):EN(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}var Fu=2,TN=Fu/2;function Fq(t){return{x:Math.floor(t.x),y:Math.floor(t.y)}}function $q(t){return{x:t.x-TN,y:t.y-TN}}function Hq(t){return{x:Math.max(t.x,0),y:Math.max(t.y,0)}}function Uq(t){return{x:Math.min(t.x,window.innerWidth-Fu),y:Math.min(t.y,window.innerHeight-Fu)}}function NN(t){var e=t.client,n=Uq(Hq($q(Fq(e))));return DOMRect.fromRect({x:n.x,y:n.y,width:Fu,height:Fu})}function AN(t){var e=t.clientRect;return{left:"".concat(e.left,"px"),top:"".concat(e.top,"px"),width:"".concat(e.width,"px"),height:"".concat(e.height,"px")}}function Vq(t){var e=t.client,n=t.clientRect;return e.x>=n.x&&e.x<=n.x+n.width&&e.y>=n.y&&e.y<=n.y+n.height}function qq(t){var e=t.initial,n=document.createElement("div");n.setAttribute(t2,"true");var r=NN({client:e});Object.assign(n.style,CN(CN({backgroundColor:"transparent",position:"fixed",padding:0,margin:0,boxSizing:"border-box"},AN({clientRect:r})),{},{pointerEvents:"auto",zIndex:r2})),document.body.appendChild(n);var i=mo.bind(window,{type:"pointermove",listener:function(a){var c={x:a.clientX,y:a.clientY};r=NN({client:c}),Object.assign(n.style,AN({clientRect:r}))},options:{capture:!0}});return function(a){var c=a.current;if(i(),Vq({client:c,clientRect:r})){n.remove();return}function u(){f(),n.remove()}var f=mo.bindAll(window,[{type:"pointerdown",listener:u},{type:"pointermove",listener:u},{type:"focusin",listener:u},{type:"focusout",listener:u},{type:"dragstart",listener:u},{type:"dragenter",listener:u},{type:"dragover",listener:u}],{capture:!0})}}function Gq(){var t=null;function e(){return t=null,mo.bind(window,{type:"pointermove",listener:function(i){t={x:i.clientX,y:i.clientY}},options:{capture:!0}})}function n(){var r=null;return function(o){var a=o.eventName,c=o.payload;if(a==="onDragStart"){var u=c.location.initial.input,f=t??{x:u.clientX,y:u.clientY};r=qq({initial:f})}if(a==="onDrop"){var p,g=c.location.current.input;(p=r)===null||p===void 0||p({current:{x:g.clientX,y:g.clientY}}),r=null,t=null}}}return{bindEvents:e,getOnPostDispatch:n}}function Wq(t){if(Array.isArray(t))return Ox(t)}function Yq(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Kq(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function b0(t){return Wq(t)||Yq(t)||QM(t)||Kq()}function Xl(t){var e=null;return function(){if(!e){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];var a=t.apply(this,i);e={result:a}}return e.result}}var i2=Xl(function(){return navigator.userAgent.includes("Firefox")}),Jl=Xl(function(){var e=navigator,n=e.userAgent;return n.includes("AppleWebKit")&&!n.includes("Chrome")}),hp={isLeavingWindow:Symbol("leaving"),isEnteringWindow:Symbol("entering")};function Xq(t){var e=t.dragEnter;return Jl()?e.hasOwnProperty(hp.isEnteringWindow):!1}function Jq(t){var e=t.dragLeave;return Jl()?e.hasOwnProperty(hp.isLeavingWindow):!1}(function(){if(typeof window>"u"||!Jl())return;function e(){return{enterCount:0,isOverWindow:!1}}var n=e();function r(){n=e()}mo.bindAll(window,[{type:"dragstart",listener:function(){n.enterCount=0,n.isOverWindow=!0}},{type:"drop",listener:r},{type:"dragend",listener:r},{type:"dragenter",listener:function(o){!n.isOverWindow&&n.enterCount===0&&(o[hp.isEnteringWindow]=!0),n.isOverWindow=!0,n.enterCount++}},{type:"dragleave",listener:function(o){n.enterCount--,n.isOverWindow&&n.enterCount===0&&(o[hp.isLeavingWindow]=!0,n.isOverWindow=!1)}}],{capture:!0})})();function Qq(t){return"nodeName"in t}function o2(t){return Qq(t)&&t.ownerDocument!==document}function Zq(t){var e=t.dragLeave,n=e.type,r=e.relatedTarget;return n!=="dragleave"?!1:Jl()?Jq({dragLeave:e}):r==null?!0:i2()?o2(r):r instanceof HTMLIFrameElement}function s2(t){var e=t.onDragEnd;return[{type:"pointermove",listener:(function(){var n=0;return function(){if(n<20){n++;return}e()}})()},{type:"pointerdown",listener:e}]}function Su(t){return{altKey:t.altKey,button:t.button,buttons:t.buttons,ctrlKey:t.ctrlKey,metaKey:t.metaKey,shiftKey:t.shiftKey,clientX:t.clientX,clientY:t.clientY,pageX:t.pageX,pageY:t.pageY}}var eG=function(e){var n=[],r=null,i=function(){for(var a=arguments.length,c=new Array(a),u=0;u<a;u++)c[u]=arguments[u];n=c,!r&&(r=requestAnimationFrame(function(){r=null,e.apply(void 0,n)}))};return i.cancel=function(){r&&(cancelAnimationFrame(r),r=null)},i},wv=eG(function(t){return t()}),Vf=(function(){var t=null;function e(r){var i=requestAnimationFrame(function(){t=null,r()});t={frameId:i,fn:r}}function n(){t&&(cancelAnimationFrame(t.frameId),t.fn(),t=null)}return{schedule:e,flush:n}})();function tG(t){var e=t.source,n=t.initial,r=t.dispatchEvent,i={dropTargets:[]};function o(c){r(c),i={dropTargets:c.payload.location.current.dropTargets}}var a={start:function(u){var f=u.nativeSetDragImage,p={current:n,previous:i,initial:n};o({eventName:"onGenerateDragPreview",payload:{source:e,location:p,nativeSetDragImage:f}}),Vf.schedule(function(){o({eventName:"onDragStart",payload:{source:e,location:p}})})},dragUpdate:function(u){var f=u.current;Vf.flush(),wv.cancel(),o({eventName:"onDropTargetChange",payload:{source:e,location:{initial:n,previous:i,current:f}}})},drag:function(u){var f=u.current;wv(function(){Vf.flush();var p={initial:n,previous:i,current:f};o({eventName:"onDrag",payload:{source:e,location:p}})})},drop:function(u){var f=u.current,p=u.updatedSourcePayload;Vf.flush(),wv.cancel(),o({eventName:"onDrop",payload:{source:p??e,location:{current:f,previous:i,initial:n}}})}};return a}var Mx={isActive:!1};function a2(){return!Mx.isActive}function nG(t){return t.dataTransfer?t.dataTransfer.setDragImage.bind(t.dataTransfer):null}function rG(t){var e=t.current,n=t.next;if(e.length!==n.length)return!0;for(var r=0;r<e.length;r++)if(e[r].element!==n[r].element)return!0;return!1}function iG(t){var e=t.event,n=t.dragType,r=t.getDropTargetsOver,i=t.dispatchEvent;if(!a2())return;var o=oG({event:e,dragType:n,getDropTargetsOver:r});Mx.isActive=!0;var a={current:o};Sv({event:e,current:o.dropTargets});var c=tG({source:n.payload,dispatchEvent:i,initial:o});function u(y){var w=rG({current:a.current.dropTargets,next:y.dropTargets});a.current=y,w&&c.dragUpdate({current:a.current})}function f(y){var w=Su(y),S=n2(y.target)?x0({x:w.clientX,y:w.clientY}):y.target,C=r({target:S,input:w,source:n.payload,current:a.current.dropTargets});C.length&&(y.preventDefault(),Sv({event:y,current:C})),u({dropTargets:C,input:w})}function p(){a.current.dropTargets.length&&u({dropTargets:[],input:a.current.input}),c.drop({current:a.current,updatedSourcePayload:null}),g()}function g(){Mx.isActive=!1,v()}var v=mo.bindAll(window,[{type:"dragover",listener:function(w){f(w),c.drag({current:a.current})}},{type:"dragenter",listener:f},{type:"dragleave",listener:function(w){Zq({dragLeave:w})&&(u({input:a.current.input,dropTargets:[]}),n.startedFrom==="external"&&p())}},{type:"drop",listener:function(w){if(a.current={dropTargets:a.current.dropTargets,input:Su(w)},!a.current.dropTargets.length){p();return}w.preventDefault(),Sv({event:w,current:a.current.dropTargets}),c.drop({current:a.current,updatedSourcePayload:n.type==="external"?n.getDropPayload(w):null}),g()}},{type:"dragend",listener:function(w){a.current={dropTargets:a.current.dropTargets,input:Su(w)},p()}}].concat(b0(s2({onDragEnd:p}))),{capture:!0});c.start({nativeSetDragImage:nG(e)})}function Sv(t){var e,n=t.event,r=t.current,i=(e=r[0])===null||e===void 0?void 0:e.dropEffect;i!=null&&n.dataTransfer&&(n.dataTransfer.dropEffect=i)}function oG(t){var e=t.event,n=t.dragType,r=t.getDropTargetsOver,i=Su(e);if(n.startedFrom==="external")return{input:i,dropTargets:[]};var o=r({input:i,source:n.payload,target:e.target,current:[]});return{input:i,dropTargets:o}}var kN={canStart:a2,start:iG},Rx=new Map;function sG(t){var e=t.typeKey,n=t.mount,r=Rx.get(e);if(r)return r.usageCount++,r;var i={typeKey:e,unmount:n(),usageCount:1};return Rx.set(e,i),i}function aG(t){var e=sG(t);return function(){e.usageCount--,!(e.usageCount>0)&&(e.unmount(),Rx.delete(t.typeKey))}}function Ql(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return function(){e.forEach(function(i){return i()})}}function l2(t,e){var n=e.attribute,r=e.value;return t.setAttribute(n,r),function(){return t.removeAttribute(n)}}function DN(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function Wo(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?DN(Object(n),!0).forEach(function(r){si(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):DN(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function Ev(t,e){var n=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=lG(t))||e){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(f){throw f},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o,a=!0,c=!1;return{s:function(){n=n.call(t)},n:function(){var f=n.next();return a=f.done,f},e:function(f){c=!0,o=f},f:function(){try{a||n.return==null||n.return()}finally{if(c)throw o}}}}function lG(t,e){if(t){if(typeof t=="string")return ON(t,e);var n={}.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ON(t,e):void 0}}function ON(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function Cv(t){return t.slice(0).reverse()}function cG(t){var e=t.typeKey,n=t.defaultDropEffect,r=new WeakMap,i="data-drop-target-for-".concat(e),o="[".concat(i,"]");function a(y){return r.set(y.element,y),function(){return r.delete(y.element)}}function c(y){var w=Ql(l2(y.element,{attribute:i,value:"true"}),a(y));return Xl(w)}function u(y){var w,S,C,T,N=y.source,k=y.target,D=y.input,M=y.result,R=M===void 0?[]:M;if(k==null)return R;if(!(k instanceof Element))return k instanceof Node?u({source:N,target:k.parentElement,input:D,result:R}):R;var O=k.closest(o);if(O==null)return R;var I=r.get(O);if(I==null)return R;var z={input:D,source:N,element:I.element};if(I.canDrop&&!I.canDrop(z))return u({source:N,target:I.element.parentElement,input:D,result:R});var U=(w=(S=I.getData)===null||S===void 0?void 0:S.call(I,z))!==null&&w!==void 0?w:{},Y=(C=(T=I.getDropEffect)===null||T===void 0?void 0:T.call(I,z))!==null&&C!==void 0?C:n,W={data:U,element:I.element,dropEffect:Y,isActiveDueToStickiness:!1};return u({source:N,target:I.element.parentElement,input:D,result:[].concat(b0(R),[W])})}function f(y){var w=y.eventName,S=y.payload,C=Ev(S.location.current.dropTargets),T;try{for(C.s();!(T=C.n()).done;){var N,k=T.value,D=r.get(k.element),M=Wo(Wo({},S),{},{self:k});D==null||(N=D[w])===null||N===void 0||N.call(D,M)}}catch(R){C.e(R)}finally{C.f()}}var p={onGenerateDragPreview:f,onDrag:f,onDragStart:f,onDrop:f,onDropTargetChange:function(w){var S=w.payload,C=new Set(S.location.current.dropTargets.map(function($){return $.element})),T=new Set,N=Ev(S.location.previous.dropTargets),k;try{for(N.s();!(k=N.n()).done;){var D,M=k.value;T.add(M.element);var R=r.get(M.element),O=C.has(M.element),I=Wo(Wo({},S),{},{self:M});if(R==null||(D=R.onDropTargetChange)===null||D===void 0||D.call(R,I),!O){var z;R==null||(z=R.onDragLeave)===null||z===void 0||z.call(R,I)}}}catch($){N.e($)}finally{N.f()}var U=Ev(S.location.current.dropTargets),Y;try{for(U.s();!(Y=U.n()).done;){var W,j,G=Y.value;if(!T.has(G.element)){var oe=Wo(Wo({},S),{},{self:G}),L=r.get(G.element);L==null||(W=L.onDropTargetChange)===null||W===void 0||W.call(L,oe),L==null||(j=L.onDragEnter)===null||j===void 0||j.call(L,oe)}}}catch($){U.e($)}finally{U.f()}}};function g(y){p[y.eventName](y)}function v(y){var w=y.source,S=y.target,C=y.input,T=y.current,N=u({source:w,target:S,input:C});if(N.length>=T.length)return N;for(var k=Cv(T),D=Cv(N),M=[],R=0;R<k.length;R++){var O,I=k[R],z=D[R];if(z!=null){M.push(z);continue}var U=M[R-1],Y=k[R-1];if(U?.element!==Y?.element)break;var W=r.get(I.element);if(!W)break;var j={input:C,source:w,element:W.element};if(W.canDrop&&!W.canDrop(j)||!((O=W.getIsSticky)!==null&&O!==void 0&&O.call(W,j)))break;M.push(Wo(Wo({},I),{},{isActiveDueToStickiness:!0}))}return Cv(M)}return{dropTargetForConsumers:c,getIsOver:v,dispatchEvent:g}}function uG(t,e){var n=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=dG(t))||e){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(f){throw f},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o,a=!0,c=!1;return{s:function(){n=n.call(t)},n:function(){var f=n.next();return a=f.done,f},e:function(f){c=!0,o=f},f:function(){try{a||n.return==null||n.return()}finally{if(c)throw o}}}}function dG(t,e){if(t){if(typeof t=="string")return MN(t,e);var n={}.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?MN(t,e):void 0}}function MN(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function RN(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function fG(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?RN(Object(n),!0).forEach(function(r){si(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):RN(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function hG(){var t=new Set,e=null;function n(o){e&&(!o.canMonitor||o.canMonitor(e.canMonitorArgs))&&e.active.add(o)}function r(o){var a=fG({},o);t.add(a),n(a);function c(){t.delete(a),e&&e.active.delete(a)}return Xl(c)}function i(o){var a=o.eventName,c=o.payload;if(a==="onGenerateDragPreview"){e={canMonitorArgs:{initial:c.location.initial,source:c.source},active:new Set};var u=uG(t),f;try{for(u.s();!(f=u.n()).done;){var p=f.value;n(p)}}catch(C){u.e(C)}finally{u.f()}}if(e){for(var g=Array.from(e.active),v=0,y=g;v<y.length;v++){var w=y[v];if(e.active.has(w)){var S;(S=w[a])===null||S===void 0||S.call(w,c)}}a==="onDrop"&&(e.active.clear(),e=null)}}return{dispatchEvent:i,monitorForConsumers:r}}function c2(t){var e=t.typeKey,n=t.mount,r=t.dispatchEventToSource,i=t.onPostDispatch,o=t.defaultDropEffect,a=hG(),c=cG({typeKey:e,defaultDropEffect:o});function u(g){r?.(g),c.dispatchEvent(g),a.dispatchEvent(g),i?.(g)}function f(g){var v=g.event,y=g.dragType;kN.start({event:v,dragType:y,getDropTargetsOver:c.getIsOver,dispatchEvent:u})}function p(){function g(){var v={canStart:kN.canStart,start:f};return n(v)}return aG({typeKey:e,mount:g})}return{registerUsage:p,dropTarget:c.dropTargetForConsumers,monitor:a.monitorForConsumers}}var pG=Xl(function(){return navigator.userAgent.toLocaleLowerCase().includes("android")}),u2="pdnd:android-fallback",jx="text/plain",mG="text/uri-list",d2="application/vnd.pdnd",pp=new WeakMap;function gG(t){return pp.set(t.element,t),function(){pp.delete(t.element)}}var jN=Gq(),w0=c2({typeKey:"element",defaultDropEffect:"move",mount:function(e){return Ql(jN.bindEvents(),mo.bind(document,{type:"dragstart",listener:function(r){var i,o,a,c,u,f;if(e.canStart(r)&&!r.defaultPrevented&&r.dataTransfer){var p=r.target;if(p instanceof HTMLElement){var g=pp.get(p);if(g){var v=Su(r),y={element:g.element,dragHandle:(i=g.dragHandle)!==null&&i!==void 0?i:null,input:v};if(g.canDrag&&!g.canDrag(y)){r.preventDefault();return}if(g.dragHandle){var w=x0({x:v.clientX,y:v.clientY});if(!g.dragHandle.contains(w)){r.preventDefault();return}}var S=(o=(a=g.getInitialDataForExternal)===null||a===void 0?void 0:a.call(g,y))!==null&&o!==void 0?o:null;if(S)for(var C=0,T=Object.entries(S);C<T.length;C++){var N=ZM(T[C],2),k=N[0],D=N[1];r.dataTransfer.setData(k,D??"")}pG()&&!r.dataTransfer.types.includes(jx)&&!r.dataTransfer.types.includes(mG)&&r.dataTransfer.setData(jx,u2),r.dataTransfer.setData(d2,"");var M={element:g.element,dragHandle:(c=g.dragHandle)!==null&&c!==void 0?c:null,data:(u=(f=g.getInitialData)===null||f===void 0?void 0:f.call(g,y))!==null&&u!==void 0?u:{}},R={type:"element",payload:M,startedFrom:"internal"};e.start({event:r,dragType:R})}}}}}))},dispatchEventToSource:function(e){var n,r,i=e.eventName,o=e.payload;(n=pp.get(o.source.element))===null||n===void 0||(r=n[i])===null||r===void 0||r.call(n,o)},onPostDispatch:jN.getOnPostDispatch()}),Zl=w0.dropTarget,f2=w0.monitor;function id(t){var e=Ql(w0.registerUsage(),gG(t),l2(t.element,{attribute:"draggable",value:"true"}));return Xl(e)}function yG(t=[]){const e={};for(const n of t)n?.id&&(e[n.id]=n);return e}function vG(t){const e=new Date(t),n=new Date(e.getFullYear(),0,0),r=e-n,i=1e3*60*60*24;return Math.floor(r/i)}function xG(t){let e=t|0;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function bG(t){const e=new Date(t);return e.getFullYear()*1e4+(e.getMonth()+1)*100+e.getDate()}const ba={sum:{label:"Sum",symbol:"",description:"Add all values together",types:["number"],fn:t=>t.reduce((e,n)=>e+n,0)},count:{label:"Count",symbol:"#",description:"Count number of occurrences",types:["number","text","boolean","date"],fn:t=>t.length},countTrue:{label:"Count True",symbol:"#",description:"Count occurrences where value is true/truthy",types:["boolean","number"],fn:t=>t.filter(Boolean).length},avg:{label:"Average",symbol:"",description:"Calculate mean average",types:["number"],fn:t=>t.length>0?t.reduce((e,n)=>e+n,0)/t.length:0},min:{label:"Minimum",symbol:"",description:"Find smallest value",types:["number","date"],fn:t=>t.length>0?Math.min(...t):0},max:{label:"Maximum",symbol:"",description:"Find largest value",types:["number","date"],fn:t=>t.length>0?Math.max(...t):0},last:{label:"Latest",symbol:"",description:"Get most recent value",types:["number","text","boolean","date"],fn:t=>t.length>0?t[t.length-1]:null},first:{label:"First",symbol:"",description:"Get earliest value",types:["number","text","boolean","date"],fn:t=>t.length>0?t[0]:null},range:{label:"Range",symbol:"",description:"Difference between max and min",types:["number"],fn:t=>t.length>0?Math.max(...t)-Math.min(...t):0},median:{label:"Median",symbol:"M",description:"Middle value when sorted",types:["number"],fn:t=>{if(t.length===0)return 0;const e=[...t].sort((r,i)=>r-i),n=Math.floor(e.length/2);return e.length%2!==0?e[n]:(e[n-1]+e[n])/2}},mode:{label:"Mode",symbol:"Mo",description:"Most frequent value",types:["number","text"],fn:t=>{if(t.length===0)return null;const e={};return t.forEach(n=>{e[n]=(e[n]||0)+1}),Object.entries(e).reduce((n,r)=>r[1]>n[1]?r:n,[null,0])[0]}},stdDev:{label:"Std Dev",symbol:"",description:"Standard deviation",types:["number"],fn:t=>{if(t.length===0)return 0;const e=t.reduce((r,i)=>r+i,0)/t.length,n=t.map(r=>Math.pow(r-e,2));return Math.sqrt(n.reduce((r,i)=>r+i,0)/t.length)}},product:{label:"Product",symbol:"",description:"Multiply all values",types:["number"],fn:t=>t.length>0?t.reduce((e,n)=>e*n,1):0},concat:{label:"Concatenate",symbol:"++",description:"Join text values",types:["text"],fn:(t,e={})=>t.join(e.separator||", ")},unique:{label:"Unique Count",symbol:"#!",description:"Count distinct values",types:["number","text"],fn:t=>new Set(t).size},random:{label:"Random",symbol:"?",description:"Pick a random value from the list",types:["number","text","boolean","date"],fn:t=>t.length>0?t[Math.floor(Math.random()*t.length)]:null}},tm={">=":{label:" (at least)",fn:(t,e)=>t>=e},"<=":{label:" (at most)",fn:(t,e)=>t<=e},"==":{label:"= (exactly)",fn:(t,e)=>t===e},"!=":{label:" (not equal)",fn:(t,e)=>t!==e},">":{label:"> (more than)",fn:(t,e)=>t>e},"<":{label:"< (less than)",fn:(t,e)=>t<e}},wG={in:{label:"In (+)",description:"Value counts as positive"},out:{label:"Out ()",description:"Value counts as negative"},replace:{label:"Replace",description:"Value replaces (not summed)"}},SG={any:{label:"Any",description:"Count both in and out values"},in:{label:"In only",description:"Only count positive (in) values"},out:{label:"Out only",description:"Only count negative (out) values"}},ch={persistent:{label:"Always Show",description:"Shows on all iterations (templates, recurring habits)",icon:""},specific:{label:"This Day Only",description:"Only shows on the specific iteration/date it was created",icon:""},untilDone:{label:"Until Completed",description:"Shows on all iterations until marked complete, then stays on completion date",icon:""}},EG={grid:{label:"Grid (all)",description:"All occurrences in the grid"},panel:{label:"Panel",description:"Occurrences in the same panel"},container:{label:"Container",description:"Occurrences in the same container"},instance:{label:"Instance",description:"All occurrences of this instance"}},nm={all:{label:"All time",fn:()=>!0},today:{label:"Today",fn:t=>{const e=new Date().setHours(0,0,0,0);return new Date(t.createdAt||t.meta?.createdAt).setHours(0,0,0,0)===e}},thisWeek:{label:"This week",fn:t=>{const e=new Date,n=new Date(e.setDate(e.getDate()-e.getDay())).setHours(0,0,0,0);return new Date(t.createdAt||t.meta?.createdAt).getTime()>=n}},thisMonth:{label:"This month",fn:t=>{const e=new Date,n=new Date(e.getFullYear(),e.getMonth(),1).getTime();return new Date(t.createdAt||t.meta?.createdAt).getTime()>=n}},last7Days:{label:"Last 7 days",fn:t=>{const e=Date.now()-6048e5;return new Date(t.createdAt||t.meta?.createdAt).getTime()>=e}},last30Days:{label:"Last 30 days",fn:t=>{const e=Date.now()-2592e6;return new Date(t.createdAt||t.meta?.createdAt).getTime()>=e}}},IN={daily:1,weekly:7,monthly:30,yearly:365};function S0(t,e,n){if(t==null)return null;if(!e||!n||e===n||e==="inherit"||e==="all"||n==="inherit"||n==="all")return t;const r=IN[e]||1,i=IN[n]||1;return t*(i/r)}function _N(t,e,n){if(!t||!e)return!1;const r=new Date(t);r.setHours(0,0,0,0);const i=new Date(e);switch(i.setHours(0,0,0,0),n){case"daily":return r.getTime()===i.getTime();case"weekly":{const o=new Date(i);o.setDate(i.getDate()-i.getDay());const a=new Date(o);return a.setDate(o.getDate()+7),r>=o&&r<a}case"monthly":return r.getFullYear()===i.getFullYear()&&r.getMonth()===i.getMonth();case"yearly":return r.getFullYear()===i.getFullYear();default:return!0}}function CG(t,e,n,r={}){const{categoryKey:i=null,categoryValue:o=null}=r;let a=t;if(i&&o&&(a=a.filter(u=>{const f=u.iteration?.categoryValue;return!f||f===o})),a=a.filter(u=>u.iteration?.mode!=="persistent"),!e||e==="all"||!n)return a;const c=new Date(n);return c.setHours(0,0,0,0),a.filter(u=>{if((u.iteration?.mode||"specific")==="untilDone"){const g=u.iteration?.completedOn;return g?_N(g,c,e):!1}const p=u.iteration?.timeValue||u.iteration?.value||u.createdAt||u.meta?.createdAt;return _N(p,c,e)})}function LN(t,e,n,r={}){return CG(t,e,n,r)}function h2(t,e,n={}){const{gridId:r,panelId:i,containerId:o,instanceId:a}=n;switch(e){case"grid":return t.filter(c=>c.gridId===r);case"panel":return t.filter(c=>c.gridId===r&&c.meta?.panelId===i);case"container":return t.filter(c=>c.gridId===r&&c.meta?.containerId===o);case"instance":return t.filter(c=>c.gridId===r&&c.targetId===a);default:return t}}function p2(t,e="all"){const n=nm[e];return!n||e==="all"?t:t.filter(n.fn)}function $u(t,e,n={}){const{flowFilter:r="any"}=n,i=r==="any"?null:Array.isArray(r)?r:[r];return t.map(o=>{const a=o.fields?.[e];if(a==null)return null;if(typeof a!="object")return i&&!i.includes("in")?null:a;const{value:c,flow:u="in"}=a;return c==null||i&&!i.includes(u)?null:typeof c=="number"&&u==="out"?-c:c}).filter(o=>o!==null)}function E0(t,e,n={}){const r=ba[e];return r?r.fn(t,n):(console.warn(`Unknown aggregation: ${e}`),null)}function m2(t,e,n=null){if(!e||e.value===void 0)return null;const r=tm[e.op||">="];if(!r)return!1;let i=e.value;return n&&e.timeFilter&&e.timeFilter!=="inherit"&&(i=S0(e.value,e.timeFilter,n)),r.fn(t,i)}function g2(t,e){return!t||t.value===void 0?null:e&&t.timeFilter&&t.timeFilter!=="inherit"?S0(t.value,t.timeFilter,e):t.value}function TG(t,e,n=null){if(!e||e.value===void 0||e.value===0)return null;let r=e.value;if(n&&e.timeFilter&&e.timeFilter!=="inherit"&&(r=S0(e.value,e.timeFilter,n)),r===0)return null;const i=t/r*100;return Math.min(Math.max(i,0),100)}function NG(t,e,n={}){if(!e||e.mode!=="derived"||!e.metric)return null;const{metric:r}=e,{fieldId:i,scope:o="container",timeFilter:a="all"}=r,c=t.occurrences||[],u=h2(c,o,n),p=p2(u,a).map(S=>`${S.id}:${S.fields?.[i]??"null"}`).join("|"),{currentIteration:g,iterationDate:v}=n,y=g||"default",w=v?new Date(v).toISOString().split("T")[0]:"all";return`${e.id}:${o}:${a}:${y}:${w}:${p}`}function AG(t,e,n={}){if(!e||e.mode!=="derived"||!e.metric)return[];const{metric:r}=e,{scope:i="container",timeFilter:o="all"}=r,a=t.occurrences||[],c=h2(a,i,n);return p2(c,o)}function y2(t,e,n={}){if(!e||e.mode!=="derived"||!e.metric)return null;const{metric:r}=e,{source:i="occurrences",allowedFields:o=[],aggregation:a="sum",options:c={},fieldId:u}=r;if(i!=="occurrences")return console.warn(`Unknown metric source: ${i}`),null;const f=t.grid?.iterations||[],p=t.selectedIterationId||"default",g=t.currentIterationValue,y=(f.find(R=>R.id===p)||f[0])?.timeFilter,w=t.grid?.categoryDimensions||[],S=t.selectedCategoryId||t.grid?.selectedCategoryId,C=t.currentCategoryValue||t.grid?.currentCategoryValue,T=w.find(R=>R.id===S);let N=t.occurrences||[];const k=t.containersById||yG(t.containers),D={categoryKey:T?.id,categoryValue:C};y&&g?N=LN(N,y,g,D):T&&C&&(N=LN(N,"all",null,D));let M=[];if(o.length>0)for(const R of o){const{fieldId:O,destinations:I=[],flowFilter:z="any"}=R;let U=N;I.length>0&&(U=N.filter(W=>{const j=W.meta?.containerId,G=k[j]?.panelId;for(const oe of I){if(oe.id.startsWith("container:")){const $=oe.id.replace("container:","");if(j!==$)continue}else if(oe.id.startsWith("panel:")){const $=oe.id.replace("panel:","");if(G!==$)continue}const L=oe.timeFilter||"all";if(L!=="all"){const $=nm[L];if($&&!$.fn(W))continue}return!0}return!1}));const Y=$u(U,O,{flowFilter:z});M=M.concat(Y)}else if(u){const R=AG(t,e,n);M=$u(R,u)}if((a==="first"||a==="random")&&e.siblingLinks&&e.siblingLinks.length>0){const R={};(t.fields||[]).forEach(O=>{O?.id&&(R[O.id]=O)});for(const O of e.siblingLinks){const I=R[O],z=I?.meta?.options;if(I?.type==="select"&&Array.isArray(z)&&z.length>0){const U=g?new Date(g):new Date;if(a==="first"){const W=vG(U)%z.length;return z[W].label??z[W].value}if(a==="random"){const Y=bG(U),W=xG(Y),j=Math.floor(W*z.length);return z[j].label??z[j].value}}}}return E0(M,a,c)}function kG(t){return Object.entries(ba).filter(([,e])=>e.types.includes(t)).map(([e,n])=>({value:e,label:n.label,symbol:n.symbol,description:n.description}))}function DG(t){return ba[t]?.symbol||"="}function PN(t,e){if(t==null)return"";switch(e?.type||"text"){case"number":return typeof t=="number"?t.toLocaleString():String(t);case"boolean":return t?"":"";case"rating":return typeof t=="number"?"".repeat(Math.round(t))+"".repeat(5-Math.round(t)):String(t);case"duration":if(typeof t=="number"){const r=Math.floor(t/60),i=t%60;return r>0?`${r}h ${i}m`:`${i}m`}return String(t);case"select":return Array.isArray(t)?t.join(", "):String(t);case"date":return t instanceof Date?t.toLocaleDateString():typeof t=="string"?new Date(t).toLocaleDateString():String(t);default:return String(t)}}function OG(t){const e=x.useContext(Rn)||{},{fieldsById:n={},occurrencesById:r={},state:i={}}=e;return x.useMemo(()=>{const o=n[t];if(!o)return{value:null,displayValue:"",error:"Field not found"};try{if(o.mode==="derived"){const a=y2(i,o);return{value:a,displayValue:PN(a,o),error:null}}else{const a=Object.values(r),c=$u(a,t),u=o.type==="number"||o.type==="duration"?"sum":"first",f=E0(c,u);return{value:f,displayValue:PN(f,o),error:null}}}catch(a){return{value:null,displayValue:"Error",error:a.message}}},[t,n,r,i])}function fn(t){return t!==!1}function ti({dispatch:t,socket:e,gridId:n,grid:r,emit:i=!0}){!n||!r||(t?.(cP({gridId:n,grid:r})),fn(i)&&e?.emit("update_grid",{gridId:n,grid:r}))}function MG({dispatch:t,socket:e,gridId:n,emit:r=!0}){n&&(t?.(uP(n)),fn(r)&&e?.emit("delete_grid",{gridId:n}))}function RG({dispatch:t,socket:e,panel:n,emit:r=!0}){n&&(t?.(dP(n)),fn(r)&&e?.emit("create_panel",{panel:n}))}function qn({dispatch:t,socket:e,panel:n,emit:r=!0}){n?.id&&(t?.(fP(n)),fn(r)&&e?.emit("update_panel",{panel:n}))}function v2({dispatch:t,socket:e,container:n,emit:r=!0}){n&&(t?.(hP(n)),fn(r)&&e?.emit("create_container",{container:n}))}function oo({dispatch:t,socket:e,container:n,emit:r=!0}){n?.id&&(t?.(pP(n)),fn(r)&&e?.emit("update_container",{container:n}))}function jG({dispatch:t,socket:e,containerId:n,emit:r=!0}){n&&(t?.(mP(n)),fn(r)&&e?.emit("delete_container",{containerId:n}))}function IG({dispatch:t,socket:e,instance:n,emit:r=!0}){n&&(t?.(gP(n)),fn(r)&&e?.emit("update_instance",{instance:n}))}function _G({dispatch:t,socket:e,containerId:n,instance:r,emit:i=!0}){!n||!r?.id||(t?.(xP({containerId:n,instance:r})),fn(i)&&e?.emit("create_instance_in_container",{containerId:n,instance:r}))}function Nr({dispatch:t,socket:e,instance:n,emit:r=!0}){n?.id&&(t?.(yP(n)),fn(r)&&e?.emit("update_instance",{instance:n}))}function LG({dispatch:t,socket:e,instanceId:n,emit:r=!0}){n&&(t?.(vP(n)),fn(r)&&e?.emit("delete_instance",{instanceId:n}))}function Qc({dispatch:t,socket:e,occurrence:n,emit:r=!0}){n?.id&&(t?.(bP(n)),fn(r)&&e?.emit("create_occurrence",{occurrence:n}))}function ai({dispatch:t,socket:e,occurrence:n,emit:r=!0}){n?.id&&(t?.(wP(n)),fn(r)&&e?.emit("update_occurrence",{occurrence:n}))}function PG({dispatch:t,socket:e,field:n,emit:r=!0}){n?.id&&(t?.(SP(n)),fn(r)&&e?.emit("create_field",{field:n}))}function x2({dispatch:t,socket:e,field:n,emit:r=!0}){n?.id&&(t?.(EP(n)),fn(r)&&e?.emit("update_field",{field:n}))}function zG({dispatch:t,socket:e,view:n,emit:r=!0}){n?.id&&(t?.(CP(n)),fn(r)&&e?.emit("create_view",{view:n}))}function cu({dispatch:t,socket:e,view:n,emit:r=!0}){n?.id&&(t?.(TP(n)),fn(r)&&e?.emit("update_view",{view:n}))}function yl({dispatch:t,socket:e,doc:n,emit:r=!0}){n?.id&&(t?.(NP(n)),fn(r)&&e?.emit("create_doc",{doc:n}))}function BG({dispatch:t,socket:e,doc:n,emit:r=!0}){n?.id&&(t?.(AP(n)),fn(r)&&e?.emit("update_doc",{doc:n}))}function FG({dispatch:t,socket:e,folder:n,emit:r=!0}){n?.id&&(t?.(kP(n)),fn(r)&&e?.emit("create_folder",{folder:n}))}function $G({dispatch:t,socket:e,folder:n,emit:r=!0}){n?.id&&(t?.(DP(n)),fn(r)&&e?.emit("update_folder",{folder:n}))}function HG({dispatch:t,socket:e,artifact:n,emit:r=!0}){n?.id&&(t?.(MP(n)),fn(r)&&e?.emit("update_artifact",{artifact:n}))}function UG({socket:t,gridId:e,template:n}){!e||!n?.id||t?.emit("save_template",{gridId:e,template:n})}function VG({socket:t,gridId:e,templateId:n,containerId:r,iterationValue:i}){!e||!n||!r||t?.emit("fill_from_template",{gridId:e,templateId:n,containerId:r,iterationValue:i})}async function b2({file:t,userId:e,gridId:n,folderId:r,manifestId:i,dispatch:o}){const a=new FormData;a.append("file",t),a.append("userId",e),n&&a.append("gridId",n),r&&a.append("folderId",r),i&&a.append("manifestId",i);try{const u=await(await fetch("/api/upload",{method:"POST",body:a})).json();return u.artifact&&o&&o(OP(u.artifact)),u.artifact}catch(c){return console.error("Upload failed:",c),null}}const zN={input:{bg:"bg-blue-500",border:"border-blue-600",text:"text-white"},derived:{bg:"bg-purple-500",border:"border-purple-600",text:"text-white"}};function qG({node:t,selected:e,deleteNode:n}){const{fieldsById:r,dispatch:i,socket:o}=x.useContext(Rn)||{},[a,c]=x.useState(!1),[u,f]=x.useState(!1),p=a||u,[g,v]=x.useState(!1),[y,w]=x.useState(""),S=x.useRef(null),C=x.useRef(null),{fieldId:T,fieldName:N,fieldType:k="text",fieldMode:D="input",showValue:M=!0,showLabel:R=!0}=t.attrs,O=x.useMemo(()=>r?.[T]||null,[r,T]),{displayValue:I,error:z}=OG(T),U=x.useMemo(()=>M?z?"!":I:null,[M,I,z]),Y=zN[D]||zN.input,W=O?.name||N||"Unknown Field",j=x.useCallback(()=>{navigator.clipboard?.writeText(`#${W}${U!=null?`: ${U}`:""}`)},[W,U]),G=x.useCallback(()=>{navigator.clipboard?.writeText(`[[field:${T}]]`)},[T]),oe=x.useCallback(()=>{n?.()},[n]),L=x.useCallback(pe=>{pe.stopPropagation(),pe.preventDefault(),w(W),v(!0)},[W]),$=x.useCallback(()=>{const pe=y.trim();pe&&pe!==W&&O&&i&&o&&x2({dispatch:i,socket:o,field:{...O,name:pe},emit:!0}),v(!1)},[y,W,O,i,o]),V=x.useCallback(()=>{v(!1)},[]);x.useEffect(()=>{g&&C.current&&(C.current.focus(),C.current.select())},[g]);const we=x.useMemo(()=>[{icon:Tl,label:"Copy",onClick:j,color:"bg-blue-600 hover:bg-blue-500"},{icon:jA,label:"Copy Link",onClick:G,color:"bg-purple-600 hover:bg-purple-500"},{icon:ps,label:"Remove",onClick:oe,color:"bg-red-600 hover:bg-red-500"}],[j,G,oe]);return x.useEffect(()=>{const pe=S.current;if(pe)return id({element:pe,getInitialData:()=>({type:"field",fieldId:T,fieldName:W,fromDoc:!0})})},[T,W]),h.jsx(Ph,{as:"span",contentEditable:!1,children:h.jsxs("span",{ref:S,className:`
          field-pill inline-flex items-center gap-1 relative
          ${Y.bg} ${Y.border} ${Y.text}
          px-2 py-0.5 rounded-full text-xs font-medium
          border cursor-pointer select-none
          transition-all duration-150
          ${e?"ring-2 ring-white ring-offset-1 ring-offset-transparent":""}
          hover:brightness-110
        `,"data-field-id":T,"data-field-mode":D,onMouseEnter:()=>c(!0),onMouseLeave:()=>c(!1),onDoubleClick:L,children:[h.jsx("span",{className:"opacity-50",children:"#"}),R&&!g&&h.jsx("span",{className:"font-medium",children:W}),R&&g&&h.jsx("input",{ref:C,type:"text",value:y,onChange:pe=>w(pe.target.value),onBlur:$,onKeyDown:pe=>{pe.key==="Enter"&&(pe.preventDefault(),$()),pe.key==="Escape"&&(pe.preventDefault(),V()),pe.stopPropagation()},onClick:pe=>pe.stopPropagation(),className:"bg-transparent border-none outline-none text-inherit font-medium text-xs w-auto min-w-[30px]",style:{width:`${Math.max(y.length,3)}ch`}}),R&&M&&U!==null&&!g&&h.jsx("span",{className:"opacity-60",children:":"}),M&&U!==null&&!g&&h.jsx("span",{className:"font-normal",children:U}),h.jsx("span",{className:`inline-flex items-center ml-0.5 -mr-1 transition-opacity duration-150 ${p?"opacity-100":"opacity-0 pointer-events-none"}`,contentEditable:!1,children:h.jsx(sa,{items:we,handleIcon:oa,handleTitle:`${W}  Click for actions`,size:"sm",handleClassName:`${Y.bg} border-none rounded-full !w-4 !h-4 !px-0 !rounded-r-full !rounded-l-full`,forceDirection:"down",onOpenChange:f})})]})})}const GG=Xn.create({name:"fieldPill",group:"inline",inline:!0,selectable:!0,atom:!0,addAttributes(){return{fieldId:{default:null,parseHTML:t=>t.getAttribute("data-field-id"),renderHTML:t=>({"data-field-id":t.fieldId})},fieldName:{default:"",parseHTML:t=>t.getAttribute("data-field-name"),renderHTML:t=>({"data-field-name":t.fieldName})},fieldType:{default:"text",parseHTML:t=>t.getAttribute("data-field-type"),renderHTML:t=>({"data-field-type":t.fieldType})},fieldMode:{default:"input",parseHTML:t=>t.getAttribute("data-field-mode"),renderHTML:t=>({"data-field-mode":t.fieldMode})},showValue:{default:!0,parseHTML:t=>t.getAttribute("data-show-value")==="true",renderHTML:t=>({"data-show-value":String(t.showValue)})},showLabel:{default:!0,parseHTML:t=>t.getAttribute("data-show-label")==="true",renderHTML:t=>({"data-show-label":String(t.showLabel)})}}},parseHTML(){return[{tag:'span[data-type="field-pill"]'}]},renderHTML({HTMLAttributes:t}){return["span",sn({"data-type":"field-pill",class:"field-pill"},t)]},addNodeView(){return s0(qG,{stopEvent:({event:t})=>t.type==="dblclick"||t.target?.tagName==="INPUT"})},addCommands(){return{insertFieldPill:t=>({commands:e})=>e.insertContent({type:this.name,attrs:t})}},addKeyboardShortcuts(){return{}}});function BN(t){return t&&typeof t=="object"&&"value"in t?t.value:t}function WG(t,e){if(e==null||e==="")return null;const n=t?.meta?.prefix||"",r=t?.meta?.postfix||"";if(t.type==="boolean")return e?"":null;if(t.type==="duration"){if(typeof e=="object"){const i=e.hours||0,o=e.minutes||0;return!i&&!o?null:i>0?`${i}h ${o}m`:`${o}m`}return e?`${e}`:null}if(t.type==="rating")return e?`${"".repeat(e)}`:null;if(t.type==="select")return Array.isArray(e)?e.join(", "):String(e);if(t.type==="number")return`${n}${e}${r}`;if(t.type==="text"){const i=String(e);return i.length>20?i.slice(0,18)+"":i}return String(e)}function YG({node:t,updateAttributes:e,selected:n,deleteNode:r}){const{instancesById:i,occurrencesById:o,fieldsById:a,dispatch:c,socket:u}=x.useContext(Rn)||{},[f,p]=x.useState(!1),[g,v]=x.useState(!1),y=x.useRef(null),w=x.useRef(null),[S,C]=x.useState(!1),[T,N]=x.useState(""),k=x.useRef(null),[D,M]=x.useState(!1),[R,O]=x.useState(""),[I,z]=x.useState(""),U=x.useRef(null),Y=x.useRef(null),W=x.useRef("header"),{instanceId:j,instanceLabel:G,occurrenceId:oe,containerId:L,showIcon:$=!0,bodyContent:V=null,pillDisplay:we="inline",headerLevel:pe=1}=t.attrs,P=f||g,K=x.useMemo(()=>i?.[j]||null,[i,j]),B=!K?.fieldBindings?.length&&!K?.artifactId,Z=K?.label||G||"Unknown Item",le=we==="block"&&V!=null,be=x.useMemo(()=>{if(!K?.fieldBindings?.length||!o||!a)return[];const X=Object.values(o).filter(Ce=>Ce.targetType==="instance"&&Ce.targetId===j&&Ce.fields);if(X.length===0)return[];const ve={};for(const Ce of X)if(Ce.fields)for(const[Oe,Ye]of Object.entries(Ce.fields)){const et=BN(Ye);et!=null&&et!==""&&(ve[Oe]=Ye)}return(K.fieldBindings||[]).map(Ce=>{const Oe=a[Ce.fieldId];if(!Oe||Oe.mode==="derived")return null;const Ye=ve[Ce.fieldId];if(!Ye)return null;const et=BN(Ye),at=WG(Oe,et);return at?{field:Oe,formatted:at,isBoolean:Oe.type==="boolean"}:null}).filter(Boolean)},[K?.fieldBindings,j,o,a]),H=x.useCallback(X=>ve=>{ve.stopPropagation(),ve.preventDefault(),W.current=X;const Ce="#".repeat(pe||1);O(`${Ce} ${Z}`),z(V||""),M(!0)},[Z,V,pe]),ce=x.useCallback(()=>{const X=R.trim(),ve=X.match(/^(#{1,6})\s*/),Ce=ve?ve[1].length:1,Oe=X.replace(/^#{1,6}\s*/,"").trim();Oe&&Oe!==Z&&K&&c&&u&&Nr({dispatch:c,socket:u,instance:{id:K.id,label:Oe},emit:!0});const Ye={};Ce!==pe&&(Ye.headerLevel=Ce),I!==V&&(Ye.bodyContent=I),Object.keys(Ye).length>0&&e(Ye),M(!1)},[R,Z,K,c,u,I,V,pe,e]),te=x.useCallback(()=>M(!1),[]),me=x.useCallback(()=>{const X=w.current;X&&requestAnimationFrame(()=>{X.contains(document.activeElement)||ce()})},[ce]);x.useEffect(()=>{if(!D)return;const X=W.current==="body"?Y.current:U.current;if(X){X.focus();const ve=X.value.length;X.setSelectionRange(ve,ve)}},[D]);const Te=x.useCallback(X=>{X.stopPropagation(),X.preventDefault(),N(Z),C(!0)},[Z]),re=x.useCallback(()=>{const X=T.trim();X&&X!==Z&&K&&c&&u&&Nr({dispatch:c,socket:u,instance:{id:K.id,label:X},emit:!0}),C(!1)},[T,Z,K,c,u]);x.useEffect(()=>{if(S&&k.current){k.current.focus();const X=k.current.value.length;k.current.setSelectionRange(X,X)}},[S]);const he=x.useCallback(()=>navigator.clipboard?.writeText(`#${Z}`),[Z]),Ae=x.useCallback(()=>navigator.clipboard?.writeText(`[[instance:${j}]]`),[j]),Re=x.useCallback(()=>navigator.clipboard?.writeText(j),[j]),Le=x.useCallback(()=>r?.(),[r]),ae=x.useMemo(()=>[{icon:Tl,label:"Copy",onClick:he,color:"bg-blue-600 hover:bg-blue-500"},{icon:jA,label:"Copy Link",onClick:Ae,color:"bg-emerald-700 hover:bg-emerald-600"},{icon:mh,label:"Move",onClick:Re,color:"bg-slate-600 hover:bg-slate-500"},{icon:ps,label:"Remove",onClick:Le,color:"bg-red-600 hover:bg-red-500"}],[he,Ae,Re,Le]);x.useEffect(()=>{const X=y.current;if(!(!X||D||S))return id({element:X,getInitialData:()=>({type:"instance",instanceId:j,instanceLabel:Z,occurrenceId:oe,fromDoc:!0})})},[j,Z,oe,D,S]);const Me=x.useCallback(X=>X?X.split(`
`).map((ve,Ce)=>ve.startsWith("### ")?h.jsx("div",{className:"text-sm font-semibold mt-2 mb-0.5 opacity-80",children:ve.slice(4)},Ce):ve.startsWith("## ")?h.jsx("div",{className:"text-base font-semibold mt-2 mb-0.5 opacity-85",children:ve.slice(3)},Ce):ve.startsWith("# ")?h.jsx("div",{className:"text-lg font-bold mt-2 mb-0.5",children:ve.slice(2)},Ce):ve.startsWith("- ")?h.jsx("div",{className:"pl-4 before:content-[''] before:absolute before:left-1 relative text-xs leading-relaxed opacity-75",children:ve.slice(2)},Ce):ve.trim()?h.jsx("div",{className:"text-xs leading-relaxed opacity-75",children:ve},Ce):h.jsx("div",{className:"h-2"},Ce)):null,[]),J=x.useMemo(()=>be.length===0?null:h.jsx("span",{className:"inline-flex items-center gap-0.5 ml-1",children:be.map(({field:X,formatted:ve,isBoolean:Ce},Oe)=>Ce?h.jsx("span",{className:"inline-flex items-center justify-center w-3.5 h-3.5 rounded-full bg-green-500/30 text-green-300",title:X.name,children:h.jsx(Cp,{className:"w-2.5 h-2.5"})},Oe):h.jsx("span",{className:"inline-flex items-center px-1 py-0 rounded text-[10px] bg-white/10 text-gray-200 whitespace-nowrap",title:X.name,children:ve},Oe))}),[be]);return le?h.jsx(Ph,{as:"span",contentEditable:!1,style:{display:"block"},children:h.jsxs("div",{ref:X=>{y.current=X,w.current=X},className:`
            instance-pill block-pill my-2 rounded-lg
            border-l-4 border-emerald-500/60 bg-emerald-900/15
            ${n?"ring-2 ring-white ring-offset-1 ring-offset-transparent":""}
            ${D?"":"hover:bg-emerald-900/25 select-none"} transition-colors duration-150
          `,"data-instance-id":j,"data-occurrence-id":oe,"data-container-id":L,onMouseEnter:()=>p(!0),onMouseLeave:()=>p(!1),children:[!D&&h.jsxs(h.Fragment,{children:[h.jsxs("div",{className:"flex items-center gap-1.5 px-3 py-1.5 border-b border-emerald-500/20 cursor-pointer",onDoubleClick:H("header"),children:[h.jsx("span",{className:`font-semibold text-emerald-300 ${pe>=3?"text-sm":pe===2?"text-base":"text-lg"}`,children:Z}),h.jsx("span",{className:`inline-flex items-center ml-auto transition-opacity duration-150 ${P?"opacity-100":"opacity-0 pointer-events-none"}`,contentEditable:!1,children:h.jsx(sa,{items:ae,handleIcon:oa,handleTitle:`${Z}  Click for actions`,size:"sm",handleClassName:"bg-emerald-600 border-none rounded-full !w-4 !h-4 !px-0 !rounded-r-full !rounded-l-full",forceDirection:"down",onOpenChange:v})})]}),h.jsx("div",{className:"px-3 py-2 text-gray-300 cursor-text",onDoubleClick:H("body"),children:Me(V)})]}),D&&h.jsxs(h.Fragment,{children:[h.jsx("div",{className:"px-3 py-1.5 border-b border-emerald-500/20",children:h.jsx("input",{ref:U,type:"text",value:R,onChange:X=>O(X.target.value),onBlur:me,onKeyDown:X=>{X.key==="Enter"&&(X.preventDefault(),ce()),X.key==="Escape"&&(X.preventDefault(),te()),X.stopPropagation()},onMouseDown:X=>X.stopPropagation(),onClick:X=>X.stopPropagation(),className:"w-full bg-black/30 border border-emerald-500/40 rounded px-1.5 py-0.5 outline-none text-emerald-200 font-semibold text-sm min-w-[60px]",style:{caretColor:"#6ee7b7"}})}),h.jsx("div",{className:"px-3 py-2",children:h.jsx("textarea",{ref:Y,value:I,onChange:X=>z(X.target.value),onBlur:me,onKeyDown:X=>{X.key==="Escape"&&(X.preventDefault(),te()),X.stopPropagation()},onMouseDown:X=>X.stopPropagation(),onClick:X=>X.stopPropagation(),className:"w-full bg-black/20 border border-emerald-500/20 rounded text-xs text-gray-200 p-2 outline-none resize-y font-mono leading-relaxed",style:{minHeight:"100px",caretColor:"#a7f3d0"}})})]})]})}):h.jsx(Ph,{as:"span",contentEditable:!1,children:h.jsxs("span",{ref:y,className:`
          instance-pill inline-flex items-center gap-1 relative
          ${B&&be.length===0?"bg-gray-500/40 border-gray-600/40 text-gray-200":"bg-emerald-600 border-emerald-700 text-white"}
          px-2 py-0.5 rounded-full text-xs font-medium
          border cursor-pointer transition-all duration-150
          ${S?"":"select-none"}
          ${n?"ring-2 ring-white ring-offset-1 ring-offset-transparent":""}
          hover:brightness-110
        `,"data-instance-id":j,"data-occurrence-id":oe,"data-container-id":L,onMouseEnter:()=>p(!0),onMouseLeave:()=>p(!1),onDoubleClick:Te,children:[h.jsx("span",{className:"opacity-50",children:"#"}),!S&&h.jsx("span",{className:"font-medium truncate max-w-[120px]",children:Z}),S&&h.jsx("input",{ref:k,type:"text",value:T,onChange:X=>N(X.target.value),onBlur:re,onKeyDown:X=>{X.key==="Enter"&&(X.preventDefault(),re()),X.key==="Escape"&&(X.preventDefault(),C(!1)),X.stopPropagation()},onMouseDown:X=>X.stopPropagation(),onClick:X=>X.stopPropagation(),className:"bg-black/30 border border-white/20 rounded px-1 outline-none text-inherit font-medium text-xs min-w-[40px]",style:{width:`${Math.max(T.length+1,4)}ch`,caretColor:"white"}}),J,!S&&h.jsx("span",{className:`inline-flex items-center ml-0.5 -mr-1 transition-opacity duration-150 ${P?"opacity-100":"opacity-0 pointer-events-none"}`,contentEditable:!1,children:h.jsx(sa,{items:ae,handleIcon:oa,handleTitle:`${Z}  Click for actions`,size:"sm",handleClassName:`${B&&be.length===0?"bg-gray-500/40":"bg-emerald-600"} border-none rounded-full !w-4 !h-4 !px-0 !rounded-r-full !rounded-l-full`,forceDirection:"down",onOpenChange:v})})]})})}const KG=Xn.create({name:"instancePill",group:"inline",inline:!0,selectable:!0,atom:!0,addAttributes(){return{instanceId:{default:null,parseHTML:t=>t.getAttribute("data-instance-id"),renderHTML:t=>({"data-instance-id":t.instanceId})},instanceLabel:{default:"",parseHTML:t=>t.getAttribute("data-instance-label"),renderHTML:t=>({"data-instance-label":t.instanceLabel})},occurrenceId:{default:null,parseHTML:t=>t.getAttribute("data-occurrence-id"),renderHTML:t=>({"data-occurrence-id":t.occurrenceId})},containerId:{default:null,parseHTML:t=>t.getAttribute("data-container-id"),renderHTML:t=>({"data-container-id":t.containerId})},showIcon:{default:!0,parseHTML:t=>t.getAttribute("data-show-icon")==="true",renderHTML:t=>({"data-show-icon":String(t.showIcon)})},bodyContent:{default:null,parseHTML:t=>t.getAttribute("data-body-content"),renderHTML:t=>({"data-body-content":t.bodyContent})},pillDisplay:{default:"inline",parseHTML:t=>t.getAttribute("data-pill-display")||"inline",renderHTML:t=>({"data-pill-display":t.pillDisplay})},headerLevel:{default:1,parseHTML:t=>parseInt(t.getAttribute("data-header-level")||"1",10),renderHTML:t=>({"data-header-level":String(t.headerLevel||1)})}}},parseHTML(){return[{tag:'span[data-type="instance-pill"]'}]},renderHTML({HTMLAttributes:t}){return["span",sn({"data-type":"instance-pill",class:"instance-pill"},t)]},addNodeView(){return s0(YG,{stopEvent:({event:t})=>{if(t.type==="dblclick")return!0;const e=t.target;return!!(e?.tagName==="INPUT"||e?.tagName==="TEXTAREA"||e?.closest?.("input, textarea")||e?.closest?.(".block-pill")?.querySelector("textarea, input"))}})},addCommands(){return{insertInstancePill:t=>({commands:e})=>e.insertContent({type:this.name,attrs:t})}}});function XG({node:t,selected:e}){const{containersById:n,setSelectedDocId:r}=x.useContext(Rn)||{},{targetId:i,label:o,linkType:a="doc"}=t.attrs,c=x.useMemo(()=>n?.[i]||null,[n,i]),u=o||c?.label||i||"Unknown",f=!!c||a==="dayPage",p=a==="dayPage"?ab:Ai,g=x.useCallback(()=>{i&&r&&r(i)},[i,r]);return h.jsxs(Ph,{as:"span",className:`
        doc-link inline-flex items-center gap-0.5
        text-blue-400 hover:text-blue-300
        cursor-pointer select-none
        transition-colors duration-150
        ${e?"bg-blue-500/20 rounded":""}
        ${f?"":"text-red-400 line-through"}
      `,contentEditable:!1,"data-target-id":i,"data-link-type":a,onClick:g,children:[h.jsx("span",{className:"opacity-50",children:"[["}),h.jsx(p,{className:"w-3 h-3 opacity-70"}),h.jsx("span",{className:"hover:underline",children:u}),h.jsx("span",{className:"opacity-50",children:"]]"})]})}const JG=Xn.create({name:"docLink",group:"inline",inline:!0,selectable:!0,atom:!0,addAttributes(){return{targetId:{default:null,parseHTML:t=>t.getAttribute("data-target-id"),renderHTML:t=>({"data-target-id":t.targetId})},label:{default:"",parseHTML:t=>t.getAttribute("data-label"),renderHTML:t=>({"data-label":t.label})},linkType:{default:"doc",parseHTML:t=>t.getAttribute("data-link-type"),renderHTML:t=>({"data-link-type":t.linkType})}}},parseHTML(){return[{tag:'span[data-type="doc-link"]'}]},renderHTML({HTMLAttributes:t}){return["span",sn({"data-type":"doc-link",class:"doc-link"},t)]},addNodeView(){return s0(XG)},addCommands(){return{insertDocLink:t=>({commands:e})=>e.insertContent({type:this.name,attrs:t})}},addInputRules(){return[]}});function QG(t,e){if(!e||!t)return!0;const n=e[t];if(!n)return!0;const r=n.fieldBindings||n.fields;return r&&typeof r=="object"?Object.keys(r).length===0:!0}const ZG=an.create({name:"pillBackspace",addKeyboardShortcuts(){return{Backspace:({editor:t})=>{const{state:e}=t,{selection:n}=e,{$anchor:r}=n;if(!n.empty)return!1;const i=r.pos;if(i<1)return!1;const o=e.doc.resolve(i).nodeBefore;if(!o)return!1;const a=o.type.name;if(a==="fieldPill"){const c=i-o.nodeSize;return t.chain().deleteRange({from:c,to:i}).run(),!0}if(a==="instancePill"){const c=o.attrs,u=c.instanceId,f=t.options?.editorProps?.instancesById||null;if(QG(u,f)){const p=c.instanceLabel||"",g=i-o.nodeSize;t.chain().deleteRange({from:g,to:i}).insertContentAt(g,p).run()}else{const p=i-o.nodeSize;t.chain().deleteRange({from:p,to:i}).run()}return!0}return!1}}}}),eW=new Sn("headingFocus"),tW=an.create({name:"headingFocus",addProseMirrorPlugins(){return[new nn({key:eW,props:{decorations(t){const{doc:e,selection:n}=t,r=[],i=n.$head;for(let o=i.depth;o>=0;o--){const a=i.node(o);if(a.type.name==="heading"){const c=i.before(o);r.push(Gn.node(c,c+a.nodeSize,{class:"heading-focused"}));break}}return tn.create(e,r)}}})]}}),qf={field_input:"bg-blue-500",field_derived:"bg-purple-500",instance:"bg-emerald-500",container:"bg-amber-500"};function nW({fields:t=[],query:e="",onSelect:n,onSelectInstance:r,onSelectContainer:i,onClose:o,position:a={top:0,left:0}}){const[c,u]=x.useState(0),[f,p]=x.useState(e),[g,v]=x.useState("all"),y=x.useRef(null),w=x.useRef(null),S=x.useContext(Rn)||{},{instancesById:C,containersById:T}=S,N=x.useMemo(()=>{const O=[];return(t||[]).forEach(I=>{O.push({_category:"field",_id:`field:${I.id}`,id:I.id,name:I.name||I.id,subtitle:`${I.type||"text"}  ${I.mode||"input"}`,color:I.mode==="derived"?qf.field_derived:qf.field_input,icon:I.mode==="derived"?"":"",data:I})}),C&&Object.values(C).forEach(I=>{O.push({_category:"instance",_id:`instance:${I.id}`,id:I.id,name:I.label||I.id,subtitle:`Instance  ${(I.fieldBindings||[]).length} fields`,color:qf.instance,icon:"",data:I})}),T&&Object.values(T).forEach(I=>{O.push({_category:"container",_id:`container:${I.id}`,id:I.id,name:I.label||I.id,subtitle:`Container  ${I.kind||"default"}`,color:qf.container,icon:"",data:I})}),O},[t,C,T]),k=x.useMemo(()=>{let O=N;if(g!=="all"&&(O=O.filter(I=>I._category===g)),f){const I=f.toLowerCase();O=O.filter(z=>z.name?.toLowerCase().includes(I)||z.id?.toLowerCase().includes(I)||z.subtitle?.toLowerCase().includes(I))}return O},[N,f,g]);x.useEffect(()=>{y.current?.focus()},[]),x.useEffect(()=>{p(e)},[e]),x.useEffect(()=>{u(0)},[k.length]),x.useEffect(()=>{w.current&&k.length>0&&w.current.querySelectorAll("[data-suggestion-item]")[c]?.scrollIntoView({block:"nearest"})},[c,k.length]);const D=x.useCallback((O,I="copy")=>{O._category==="field"?n?.(O.data):O._category==="instance"?r?.(O.data,I):O._category==="container"&&i?.(O.data,I),o?.()},[n,r,i,o]),M=x.useCallback(O=>{switch(O.key){case"ArrowDown":O.preventDefault(),u(I=>Math.min(I+1,k.length-1));break;case"ArrowUp":O.preventDefault(),u(I=>Math.max(I-1,0));break;case"Enter":O.preventDefault(),k[c]&&D(k[c]);break;case"Escape":O.preventDefault(),o?.();break;case"Tab":O.preventDefault(),k[c]&&D(k[c]);break}},[k,c,D,o]),R=[{key:"all",label:"All"},{key:"field",label:"Fields"},{key:"instance",label:"Instances"},{key:"container",label:"Containers"}];return h.jsxs("div",{className:"field-suggestion absolute z-50 bg-background border border-border rounded-lg shadow-xl overflow-hidden",style:{top:a.top,left:a.left,minWidth:280,maxWidth:360},onKeyDown:M,children:[h.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 border-b border-border bg-muted/50",children:[h.jsx(fb,{className:"w-4 h-4 text-muted-foreground shrink-0"}),h.jsx("input",{ref:y,type:"text",value:f,onChange:O=>{p(O.target.value),u(0)},placeholder:"Search fields, instances, containers...",className:"flex-1 bg-transparent text-sm outline-none placeholder:text-muted-foreground",autoComplete:"off",autoFocus:!0}),h.jsx("span",{className:"text-xs text-muted-foreground",children:k.length})]}),h.jsx("div",{className:"flex gap-0.5 px-2 py-1 border-b border-border bg-muted/20",children:R.map(O=>h.jsx("button",{onClick:()=>{v(O.key),u(0)},className:`px-2 py-0.5 text-[10px] rounded transition-colors ${g===O.key?"bg-primary text-primary-foreground":"text-muted-foreground hover:text-foreground hover:bg-muted"}`,children:O.label},O.key))}),h.jsx("div",{ref:w,className:"max-h-60 overflow-y-auto",children:k.length===0?h.jsx("div",{className:"px-3 py-4 text-center text-sm text-muted-foreground",children:"No results found"}):k.map((O,I)=>h.jsxs("div",{"data-suggestion-item":!0,className:`flex items-center gap-2 px-3 py-2 cursor-pointer transition-colors duration-75 ${I===c?"bg-accent":"hover:bg-accent/50"}`,children:[h.jsx("span",{className:`inline-flex items-center justify-center w-6 h-6 rounded-full text-xs ${O.color} text-white shrink-0`,children:O.icon}),h.jsxs("div",{className:"flex-1 min-w-0",onClick:()=>D(O,"copy"),children:[h.jsx("div",{className:"text-sm font-medium truncate",children:O.name}),h.jsx("div",{className:"text-xs text-muted-foreground truncate",children:O.subtitle})]}),(O._category==="instance"||O._category==="container")&&h.jsxs("div",{className:"flex gap-0.5 shrink-0",children:[h.jsx("button",{onClick:z=>{z.stopPropagation(),D(O,"copy")},className:"p-1 rounded hover:bg-muted transition-colors",title:"Copy",children:h.jsx(Tl,{className:"h-3 w-3 text-muted-foreground"})}),h.jsx("button",{onClick:z=>{z.stopPropagation(),D(O,"copylink")},className:"p-1 rounded hover:bg-muted transition-colors",title:"Copy Link (synced)",children:h.jsx(Nl,{className:"h-3 w-3 text-muted-foreground"})})]}),O._category==="field"&&I===c&&h.jsx("span",{className:"text-xs text-muted-foreground px-1.5 py-0.5 bg-muted rounded shrink-0",children:""})]},O._id))}),h.jsxs("div",{className:"px-3 py-1.5 border-t border-border bg-muted/30 text-xs text-muted-foreground flex items-center gap-3",children:[h.jsx("span",{children:" Navigate"}),h.jsx("span",{children:" Select"}),h.jsx("span",{children:"Esc Close"})]})]})}const FN=[{id:"h1",label:"Heading 1",shortcut:"# ",category:"Formatting",icon:"H1",action:"heading",level:1},{id:"h2",label:"Heading 2",shortcut:"## ",category:"Formatting",icon:"H2",action:"heading",level:2},{id:"h3",label:"Heading 3",shortcut:"### ",category:"Formatting",icon:"H3",action:"heading",level:3},{id:"bold",label:"Bold",shortcut:"**text**",category:"Formatting",icon:"B",action:"bold"},{id:"italic",label:"Italic",shortcut:"*text*",category:"Formatting",icon:"I",action:"italic"},{id:"strike",label:"Strikethrough",shortcut:"~~text~~",category:"Formatting",icon:"S",action:"strike"},{id:"code",label:"Inline Code",shortcut:"`code`",category:"Formatting",icon:"</>",action:"code"},{id:"bullet",label:"Bullet List",shortcut:"- ",category:"Lists",icon:"",action:"bulletList"},{id:"numbered",label:"Numbered List",shortcut:"1. ",category:"Lists",icon:"1.",action:"orderedList"},{id:"todo",label:"Task List",shortcut:"[ ] ",category:"Lists",icon:"",action:"taskList"},{id:"quote",label:"Blockquote",shortcut:"> ",category:"Blocks",icon:"",action:"blockquote"},{id:"codeblock",label:"Code Block",shortcut:"```",category:"Blocks",icon:"{ }",action:"codeBlock"},{id:"divider",label:"Divider",shortcut:"---",category:"Blocks",icon:"",action:"horizontalRule"},{id:"field",label:"Insert Field",shortcut:"@",category:"Insert",icon:"",action:"field"},{id:"link",label:"Insert Link",shortcut:"[text](url)",category:"Insert",icon:"",action:"link"},{id:"doclink",label:"Link to Document",shortcut:"[[doc]]",category:"Insert",icon:"",action:"docLink"},{id:"today",label:"Today's Date",shortcut:"",category:"Insert",icon:"",action:"insertDate"},{id:"time",label:"Current Time",shortcut:"",category:"Insert",icon:"",action:"insertTime"}],rW=t=>{if(!t)return null;if(typeof t=="function"||typeof t=="object"){const e=t;return h.jsx(e,{className:"w-4 h-4"})}return String(t)};function iW({query:t="",position:e={top:0,left:0},onSelect:n,onClose:r,editor:i}){const[o,a]=x.useState(0),c=x.useRef(null);x.useRef(null);const u=x.useMemo(()=>{if(!t)return FN;const y=t.toLowerCase();return FN.filter(w=>w.label.toLowerCase().includes(y)||w.category.toLowerCase().includes(y)||(w.shortcut||"").toLowerCase().includes(y))},[t]),f=x.useMemo(()=>{const y={};for(const w of u)y[w.category]||(y[w.category]=[]),y[w.category].push(w);return y},[u]),p=x.useMemo(()=>Object.values(f).flat(),[f]);x.useEffect(()=>{a(0)},[t]),x.useEffect(()=>{const y=c.current;if(!y)return;const w=y.querySelector(`[data-index="${o}"]`);w&&w.scrollIntoView({block:"nearest"})},[o]);const g=x.useCallback(y=>{if(!i)return;const{from:w}=i.state.selection,S=i.state.doc.textBetween(Math.max(0,w-50),w),C=S.lastIndexOf("/");if(C>=0){const T=w-(S.length-C);i.chain().focus().deleteRange({from:T,to:w}).run()}switch(y.action){case"heading":i.chain().focus().toggleHeading({level:y.level}).run();break;case"bold":i.chain().focus().toggleBold().run();break;case"italic":i.chain().focus().toggleItalic().run();break;case"strike":i.chain().focus().toggleStrike().run();break;case"code":i.chain().focus().toggleCode().run();break;case"bulletList":i.chain().focus().toggleBulletList().run();break;case"orderedList":i.chain().focus().toggleOrderedList().run();break;case"taskList":i.chain().focus().toggleTaskList().run();break;case"blockquote":i.chain().focus().toggleBlockquote().run();break;case"codeBlock":i.chain().focus().toggleCodeBlock().run();break;case"horizontalRule":i.chain().focus().setHorizontalRule().run();break;case"field":i.chain().focus().insertContent("@").run();break;case"link":const T=prompt("Enter URL:");T&&i.chain().focus().setLink({href:T}).run();break;case"docLink":i.chain().focus().insertContent("[[").run();break;case"insertDate":i.chain().focus().insertContent(new Date().toLocaleDateString()).run();break;case"insertTime":i.chain().focus().insertContent(new Date().toLocaleTimeString()).run();break}n?.(y),r?.()},[i,n,r]);if(x.useEffect(()=>{const y=w=>{switch(w.key){case"ArrowDown":w.preventDefault(),a(S=>Math.min(S+1,p.length-1));break;case"ArrowUp":w.preventDefault(),a(S=>Math.max(S-1,0));break;case"Enter":w.preventDefault(),p[o]&&g(p[o]);break;case"Escape":w.preventDefault(),r?.();break}};return window.addEventListener("keydown",y),()=>window.removeEventListener("keydown",y)},[p,o,g,r]),p.length===0)return h.jsx("div",{className:"command-palette absolute bg-popover border border-border rounded-lg shadow-lg p-2 z-50",style:{top:e.top,left:e.left,minWidth:200},children:h.jsx("p",{className:"text-sm text-muted-foreground p-2",children:"No commands found"})});let v=0;return h.jsxs("div",{className:"command-palette absolute bg-popover border border-border rounded-lg shadow-lg z-50 overflow-hidden",style:{top:e.top,left:e.left,minWidth:280,maxHeight:320},children:[h.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 border-b border-border",children:[h.jsx(fb,{className:"w-4 h-4 text-muted-foreground"}),h.jsx("span",{className:"text-sm text-muted-foreground",children:t?`/${t}`:"Type to search..."})]}),h.jsx("div",{ref:c,className:"overflow-y-auto max-h-[260px]",children:Object.entries(f).map(([y,w])=>h.jsxs("div",{children:[h.jsx("div",{className:"px-3 py-1.5 text-xs font-medium text-muted-foreground bg-muted/50",children:y}),w.map(S=>{const C=v++,T=C===o;return h.jsxs("div",{"data-index":C,onClick:()=>g(S),className:`
                    flex items-center gap-3 px-3 py-2 cursor-pointer
                    transition-colors
                    ${T?"bg-accent text-accent-foreground":"hover:bg-accent/50"}
                  `,children:[h.jsx("span",{className:"w-6 h-6 flex items-center justify-center text-sm font-mono bg-muted rounded",children:rW(S.icon)}),h.jsxs("div",{className:"flex-1 min-w-0",children:[h.jsx("div",{className:"text-sm font-medium",children:S.label}),S.shortcut&&h.jsx("div",{className:"text-xs text-muted-foreground font-mono truncate",children:S.shortcut})]})]},S.id)})]},y))}),h.jsxs("div",{className:"px-3 py-1.5 border-t border-border text-xs text-muted-foreground flex items-center gap-2",children:[h.jsx("kbd",{className:"px-1.5 py-0.5 bg-muted rounded text-[10px]",children:""}),h.jsx("span",{children:"navigate"}),h.jsx("kbd",{className:"px-1.5 py-0.5 bg-muted rounded text-[10px]",children:""}),h.jsx("span",{children:"select"}),h.jsx("kbd",{className:"px-1.5 py-0.5 bg-muted rounded text-[10px]",children:"esc"}),h.jsx("span",{children:"close"})]})]})}function oW({query:t="",position:e={top:0,left:0},onSelect:n,onClose:r}){const{containersById:i={}}=x.useContext(Rn)||{},[o,a]=x.useState(0),c=x.useRef(null),u=x.useMemo(()=>Object.values(i).filter(v=>v&&v.kind==="doc"),[i]),f=x.useMemo(()=>{const v=[],y=new Date;for(let w=0;w<7;w++){const S=new Date(y);S.setDate(S.getDate()-w);const C=S.toISOString().split("T")[0];v.push({id:`day-${C}`,label:w===0?"Today":w===1?"Yesterday":C,dateStr:C,type:"dayPage"})}return v},[]),p=x.useMemo(()=>{const v=u.map(S=>({id:S.id,label:S.label||"Untitled",type:"doc"})),y=[...f,...v];if(!t)return y;const w=t.toLowerCase();return y.filter(S=>S.label.toLowerCase().includes(w)||S.id.toLowerCase().includes(w)||S.dateStr&&S.dateStr.includes(w))},[u,f,t]);x.useEffect(()=>{a(0)},[t]),x.useEffect(()=>{const v=c.current;if(!v)return;const y=v.querySelector(`[data-index="${o}"]`);y&&y.scrollIntoView({block:"nearest"})},[o]);const g=x.useCallback(v=>{n?.({targetId:v.id,label:v.label,linkType:v.type})},[n]);return x.useEffect(()=>{const v=y=>{switch(y.key){case"ArrowDown":y.preventDefault(),a(w=>Math.min(w+1,p.length-1));break;case"ArrowUp":y.preventDefault(),a(w=>Math.max(w-1,0));break;case"Enter":y.preventDefault(),p[o]&&g(p[o]);break;case"Escape":y.preventDefault(),r?.();break;case"]":t&&(y.preventDefault(),n?.({targetId:null,label:t,linkType:"doc"}));break}};return window.addEventListener("keydown",v),()=>window.removeEventListener("keydown",v)},[p,o,g,r,n,t]),p.length===0&&!t?h.jsx("div",{className:"doc-link-suggestion absolute bg-popover border border-border rounded-lg shadow-lg p-2 z-50",style:{top:e.top,left:e.left,minWidth:200},children:h.jsx("p",{className:"text-sm text-muted-foreground p-2",children:"No documents found"})}):h.jsxs("div",{className:"doc-link-suggestion absolute bg-popover border border-border rounded-lg shadow-lg z-50 overflow-hidden",style:{top:e.top,left:e.left,minWidth:240,maxHeight:280},children:[h.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 border-b border-border",children:[h.jsx(fb,{className:"w-4 h-4 text-muted-foreground"}),h.jsx("span",{className:"text-sm text-muted-foreground",children:t?`[[${t}`:"Link to document..."})]}),h.jsx("div",{ref:c,className:"overflow-y-auto max-h-[200px]",children:p.length===0?h.jsx("div",{className:"p-3 text-sm text-muted-foreground",children:h.jsxs("p",{children:["No matches. Press ",h.jsx("kbd",{className:"px-1 bg-muted rounded",children:"]]"}),' to create link to "',t,'"']})}):p.map((v,y)=>{const w=y===o,S=v.type==="dayPage"?ab:Ai;return h.jsxs("div",{"data-index":y,onClick:()=>g(v),className:`
                  flex items-center gap-2 px-3 py-2 cursor-pointer
                  transition-colors
                  ${w?"bg-accent text-accent-foreground":"hover:bg-accent/50"}
                `,children:[h.jsx(S,{className:`w-4 h-4 ${v.type==="dayPage"?"text-amber-500":"text-blue-400"}`}),h.jsx("span",{className:"text-sm truncate",children:v.label})]},v.id)})}),h.jsxs("div",{className:"px-3 py-1.5 border-t border-border text-xs text-muted-foreground flex items-center gap-2",children:[h.jsx("kbd",{className:"px-1.5 py-0.5 bg-muted rounded text-[10px]",children:""}),h.jsx("span",{children:"select"}),h.jsx("kbd",{className:"px-1.5 py-0.5 bg-muted rounded text-[10px]",children:"]]"}),h.jsx("span",{children:"create"})]})]})}function sW({editor:t}){if(!t)return null;const e=({onClick:r,isActive:i,children:o,title:a})=>h.jsx(_e,{variant:"ghost",size:"sm",onClick:r,title:a,className:`
        h-7 w-7 p-0
        ${i?"bg-accent text-accent-foreground":""}
      `,children:o}),n=()=>h.jsx("div",{className:"w-px h-5 bg-border mx-1"});return h.jsxs("div",{className:"doc-toolbar flex items-center gap-0.5 px-2 py-1 border-b border-border bg-muted/30 flex-wrap sticky top-0 z-10",children:[h.jsx(e,{onClick:()=>t.chain().focus().toggleBold().run(),isActive:t.isActive("bold"),title:"Bold (Ctrl+B)",children:h.jsx(QP,{className:"w-4 h-4"})}),h.jsx(e,{onClick:()=>t.chain().focus().toggleItalic().run(),isActive:t.isActive("italic"),title:"Italic (Ctrl+I)",children:h.jsx($3,{className:"w-4 h-4"})}),h.jsx(e,{onClick:()=>t.chain().focus().toggleStrike().run(),isActive:t.isActive("strike"),title:"Strikethrough",children:h.jsx(x5,{className:"w-4 h-4"})}),h.jsx(e,{onClick:()=>t.chain().focus().toggleCode().run(),isActive:t.isActive("code"),title:"Inline Code",children:h.jsx(d3,{className:"w-4 h-4"})}),h.jsx(n,{}),h.jsx(e,{onClick:()=>t.chain().focus().toggleHeading({level:1}).run(),isActive:t.isActive("heading",{level:1}),title:"Heading 1",children:h.jsx(R3,{className:"w-4 h-4"})}),h.jsx(e,{onClick:()=>t.chain().focus().toggleHeading({level:2}).run(),isActive:t.isActive("heading",{level:2}),title:"Heading 2",children:h.jsx(I3,{className:"w-4 h-4"})}),h.jsx(e,{onClick:()=>t.chain().focus().toggleHeading({level:3}).run(),isActive:t.isActive("heading",{level:3}),title:"Heading 3",children:h.jsx(L3,{className:"w-4 h-4"})}),h.jsx(n,{}),h.jsx(e,{onClick:()=>t.chain().focus().toggleBulletList().run(),isActive:t.isActive("bulletList"),title:"Bullet List",children:h.jsx(IA,{className:"w-4 h-4"})}),h.jsx(e,{onClick:()=>t.chain().focus().toggleOrderedList().run(),isActive:t.isActive("orderedList"),title:"Numbered List",children:h.jsx(W3,{className:"w-4 h-4"})}),h.jsx(e,{onClick:()=>t.chain().focus().toggleBlockquote().run(),isActive:t.isActive("blockquote"),title:"Quote",children:h.jsx(o5,{className:"w-4 h-4"})}),h.jsx(e,{onClick:()=>t.chain().focus().setHorizontalRule().run(),title:"Horizontal Rule",children:h.jsx(X3,{className:"w-4 h-4"})}),h.jsx(n,{}),h.jsx(e,{onClick:()=>t.chain().focus().undo().run(),title:"Undo (Ctrl+Z)",children:h.jsx(E5,{className:"w-4 h-4"})}),h.jsx(e,{onClick:()=>t.chain().focus().redo().run(),title:"Redo (Ctrl+Y)",children:h.jsx(l5,{className:"w-4 h-4"})}),h.jsx(n,{}),h.jsx(_e,{variant:"ghost",size:"sm",onClick:()=>{t.chain().focus().insertContent("@").run()},title:"Insert Field (@)",className:"h-7 px-2 text-xs",children:"@ Field"}),h.jsxs(_e,{variant:"ghost",size:"sm",onClick:()=>{const{from:r,to:i,empty:o}=t.state.selection;if(o)return;const a=t.state.doc.textBetween(r,i);if(!a.trim())return;const c=crypto.randomUUID();t.chain().focus().deleteRange({from:r,to:i}).insertContent({type:"instancePill",attrs:{instanceId:c,instanceLabel:a,showIcon:!1}}).run()},title:"Convert selection to pill",className:"h-7 px-2 text-xs",children:[h.jsx(n5,{className:"w-3 h-3 mr-1"})," Pill"]})]})}const aW=x.forwardRef(function({content:e=null,onChange:n,onBlur:r,placeholder:i="Start typing... Use @ to insert a field",editable:o=!0,className:a="",showToolbar:c=!0},u){const{fieldsById:f,instancesById:p,containersById:g,occurrencesById:v}=x.useContext(Rn)||{},[y,w]=x.useState(!1),[S,C]=x.useState(""),[T,N]=x.useState({top:0,left:0}),[k,D]=x.useState(!1),[M,R]=x.useState(""),[O,I]=x.useState({top:0,left:0}),[z,U]=x.useState(!1),[Y,W]=x.useState(""),[j,G]=x.useState({top:0,left:0}),oe=x.useRef(""),L=x.useRef(null),$=x.useMemo(()=>f?Object.values(f).filter(te=>te&&te.id):[],[f]),V=x.useMemo(()=>{if(!S)return $;const te=S.toLowerCase();return $.filter(me=>me.name?.toLowerCase().includes(te)||me.id?.toLowerCase().includes(te))},[$,S]),we=x.useCallback(()=>{const te=window.getSelection();if(te&&te.rangeCount>0){const Te=te.getRangeAt(0).getBoundingClientRect(),re=L.current?.getBoundingClientRect();if(re)return{top:Te.bottom-re.top+4,left:Te.left-re.left}}return{top:0,left:0}},[]),pe=x.useCallback(()=>{y||(N(we()),w(!0),C(""))},[y,we]),P=x.useCallback(()=>{k||(I(we()),D(!0),R(""))},[k,we]),K=x.useCallback(()=>{z||(G(we()),U(!0),W(""))},[z,we]),B=F9({extensions:[Mq.configure({heading:{levels:[1,2,3]}}),Rq.configure({placeholder:i}),GG,KG,JG,ZG,tW],content:e||{type:"doc",content:[{type:"paragraph",content:[]}]},editable:o,onUpdate:({editor:te})=>{n?.(te.getJSON())},onBlur:({editor:te})=>{r?.(te.getJSON()),setTimeout(()=>w(!1),200)},editorProps:{instancesById:p,attributes:{class:"doc-editor-content prose prose-invert max-w-none focus:outline-none"},handleKeyDown:(te,me)=>{if(me.key==="@"&&pe(),me.key==="/"&&P(),me.key==="["&&oe.current==="["&&K(),oe.current=me.key,me.key==="Escape"){if(y)return w(!1),!0;if(k)return D(!1),!0;if(z)return U(!1),!0}return!1},handleTextInput:(te,me,Te,re)=>(y&&C(he=>he+re),k&&R(he=>he+re),z&&W(he=>he+re),!1)}});x.useEffect(()=>{if(B&&e&&!B.isFocused){const te=B.getJSON();JSON.stringify(te)!==JSON.stringify(e)&&B.commands.setContent(e)}},[B,e]);const Z=x.useCallback(te=>{if(!B)return;const{from:me}=B.state.selection,Te=B.state.doc.textBetween(Math.max(0,me-20),me),re=Te.lastIndexOf("@");if(re>=0){const he=me-(Te.length-re);B.chain().focus().deleteRange({from:he,to:me}).insertFieldPill({fieldId:te.id,fieldName:te.name,fieldType:te.type||"text",fieldMode:te.mode||"input",showValue:!0,showLabel:!0}).run()}else B.chain().focus().insertFieldPill({fieldId:te.id,fieldName:te.name,fieldType:te.type||"text",fieldMode:te.mode||"input",showValue:!0,showLabel:!0}).run();w(!1),C("")},[B]),le=x.useCallback(te=>{if(!B)return;const{from:me}=B.state.selection,Te=B.state.doc.textBetween(Math.max(0,me-20),me),re=Te.lastIndexOf("@"),he=B.chain().focus();if(re>=0){const Ae=me-(Te.length-re);he.deleteRange({from:Ae,to:me})}he.insertFieldPill({fieldId:te.id,fieldName:te.name,fieldType:te.type||"text",fieldMode:te.mode||"input",showValue:!0,showLabel:!1}).run(),w(!1),C("")},[B]),be=x.useCallback(()=>{if(!B)return;const{from:te}=B.state.selection,me=B.state.doc.textBetween(Math.max(0,te-20),te),Te=me.lastIndexOf("@");if(Te>=0){const re=te-(me.length-Te);B.chain().focus().deleteRange({from:re,to:te}).run()}},[B]),H=x.useCallback((te,me)=>{B&&(be(),B.chain().focus().insertContent({type:"instancePill",attrs:{instanceId:te.id,instanceLabel:te.label||te.id,containerId:te.containerId||null,showIcon:!0}}).insertContent(" ").run(),w(!1),C(""))},[B,be]),ce=x.useCallback((te,me)=>{if(!B)return;be();const Te=[];Te.push({type:"paragraph",content:[{type:"text",text:te.label||te.id,marks:[{type:"bold"}]}]});const re=te.occurrences||[];if(re.length>0&&p){const he=[];for(const Ae of re){const Re=v?.[Ae],Le=Re?.targetId||Ae,ae=p[Le];ae&&he.push({type:"listItem",content:[{type:"paragraph",content:[{type:"instancePill",attrs:{instanceId:ae.id,instanceLabel:ae.label||ae.id,occurrenceId:Re?.id||null,containerId:te.id,showIcon:!0}}]}]})}he.length>0&&Te.push({type:"bulletList",content:he})}B.chain().focus().insertContent(Te).run(),w(!1),C("")},[B,be,p,v]);return x.useEffect(()=>{if(!y&&!k&&!z)return;const te=me=>{me.key==="Backspace"&&(y&&(S.length>0?C(Te=>Te.slice(0,-1)):w(!1)),k&&(M.length>0?R(Te=>Te.slice(0,-1)):D(!1)),z&&(Y.length>0?W(Te=>Te.slice(0,-1)):U(!1)))};return window.addEventListener("keydown",te),()=>window.removeEventListener("keydown",te)},[y,S,k,M,z,Y]),x.useImperativeHandle(u,()=>({editor:B,insertFieldPill:Z,insertInstancePill:te=>{B&&B.chain().focus().insertContent({type:"instancePill",attrs:{instanceId:te.id,instanceLabel:te.label||"Item",containerId:te.containerId||null,showIcon:!0}}).run()}}),[B,Z]),h.jsxs("div",{ref:L,className:`doc-editor relative ${a}`,children:[c&&B&&h.jsx(sW,{editor:B}),h.jsx("div",{className:"doc-editor-wrapper min-h-[100px] p-3",children:h.jsx(wM,{editor:B})}),y&&h.jsx(nW,{fields:V,query:S,onSelect:le,onSelectInstance:H,onSelectContainer:ce,onClose:()=>w(!1),position:T}),k&&h.jsx(iW,{query:M,position:O,onSelect:()=>{},onClose:()=>{D(!1),R("")},editor:B}),z&&h.jsx(oW,{query:Y,position:j,onSelect:te=>{if(!B)return;const{from:me}=B.state.selection,Te=B.state.doc.textBetween(Math.max(0,me-30),me),re=Te.lastIndexOf("[[");if(re>=0){const he=me-(Te.length-re);B.chain().focus().deleteRange({from:he,to:me}).insertDocLink(te).run()}U(!1),W("")},onClose:()=>{U(!1),W("")}})]})});function Eu({container:t,occurrence:e,dispatch:n,socket:r,isHot:i=!1,docModel:o=null}){const{state:a}=x.useContext(Rn)||{},c=a?.grid?._id,u=a?.userId,f=x.useRef(null),[p,g]=x.useState(!1),[v,y]=x.useState(!1),w=x.useRef(null),S=x.useRef(null),C=x.useCallback((R,O)=>{if(!R?.view||!O)return null;const{clientX:I,clientY:z}=O;if(I==null||z==null)return null;const U=R.view.posAtCoords({left:I,top:z});return U?U.pos:null},[]),T=x.useCallback((R,O,I)=>{O!=null?R.chain().focus().insertContentAt(O,I).insertContentAt(O+1," ").run():R.chain().focus().insertContent(I).insertContent(" ").run()},[]),N=x.useCallback(async R=>{const O=R.dataTransfer?.files;if(!O||O.length===0)return;R.preventDefault(),R.stopPropagation();const I=S.current?.editor;for(const z of O){const U=await b2({dispatch:n,file:z,gridId:c,userId:u,folderId:null});U&&I&&I.chain().focus().insertContent({type:"instancePill",attrs:{instanceId:U.id||U._id,instanceLabel:U.name||z.name}}).insertContent(" ").run()}},[n,c,u]);x.useEffect(()=>{const R=w.current;if(!R)return;let O=null;const I=U=>{O=U};R.addEventListener("dragover",I);const z=Zl({element:R,canDrop:({source:U})=>{const Y=U.data?.type;return Y==="instance"||Y==="field"||Y==="container"},onDragEnter:()=>y(!0),onDragLeave:()=>y(!1),onDrop:({source:U})=>{if(y(!1),U.data?.fromDoc)return;const{type:Y,id:W,data:j,context:G}=U.data||{},oe=S.current?.editor;if(!oe)return;const L=C(oe,O);if(Y==="instance"){const $=j||{},V=G?.occurrenceId||$.occurrence?.id||null;T(oe,L,{type:"instancePill",attrs:{instanceId:W||$.id,instanceLabel:$.label||"Item",occurrenceId:V,containerId:G?.containerId||null,showIcon:!0}})}if(Y==="container"&&T(oe,L,{type:"paragraph",content:[{type:"text",text:(j||{}).label||W||"Container",marks:[{type:"bold"}]}]}),Y==="field"){const $=j||{};T(oe,L,{type:"fieldPill",attrs:{fieldId:W||$.id,fieldName:$.name||"Field",fieldType:$.type||"text",fieldMode:$.mode||"input",showValue:!0,showLabel:!0}})}}});return()=>{R.removeEventListener("dragover",I),z()}},[C,T]);const k=x.useCallback(R=>{if(!e&&!o){console.warn("DocContainer: No occurrence or docModel provided, cannot save");return}f.current&&clearTimeout(f.current),g(!0),f.current=setTimeout(()=>{o?r?.emit("update_doc_content",{docId:o.id,content:R}):ai({dispatch:n,socket:r,occurrence:{...e,docContent:R},emit:!0}),g(!1)},500)},[e,n,r,o]),D=x.useCallback(R=>{k(R)},[k]),M=x.useCallback(R=>{!e&&!o||(f.current&&clearTimeout(f.current),o?r?.emit("update_doc_content",{docId:o.id,content:R}):ai({dispatch:n,socket:r,occurrence:{...e,docContent:R},emit:!0}),g(!1))},[e,n,r,o]);return h.jsxs("div",{ref:w,className:"doc-container flex flex-col flex-1 min-h-0 relative",onDrop:N,onDragOver:R=>{R.dataTransfer?.types?.includes("Files")&&R.preventDefault()},style:{outline:i||v?"2px solid rgba(50,150,255,0.9)":"none"},children:[v&&h.jsx("div",{className:"absolute inset-0 bg-blue-500/10 pointer-events-none z-10 flex items-center justify-center",children:h.jsx("span",{className:"text-sm text-blue-400 font-medium",children:"Drop to insert as pill"})}),p&&h.jsx("div",{className:"absolute top-1 right-1 text-xs text-muted-foreground opacity-60 z-20",children:"Saving..."}),h.jsx(aW,{ref:S,content:e?.docContent,onChange:D,onBlur:M,placeholder:"Start writing... Use @ to insert fields",editable:!0,showToolbar:!0,className:"flex-1 overflow-auto"})]})}const lW={image:cb,video:Tp,audio:Tu,pdf:Ai,file:ss,archive:ss,other:ss};function $N(t){return t?t<1024?`${t} B`:t<1024*1024?`${(t/1024).toFixed(1)} KB`:`${(t/(1024*1024)).toFixed(1)} MB`:""}function cW({artifact:t,dispatch:e,socket:n}){const[r,i]=x.useState(1),[o,a]=x.useState(0);if(!t)return h.jsx("div",{className:"flex-1 flex items-center justify-center text-muted-foreground text-sm",children:"No file selected"});const{artifactType:c,name:u,mimeType:f,size:p,storagePath:g}=t,v=g||"",y=({icon:S,children:C})=>h.jsxs("div",{className:"flex items-center gap-1 px-2 py-1 border-b border-border bg-muted/30 shrink-0",children:[S&&h.jsx(S,{className:"h-3 w-3 text-muted-foreground shrink-0"}),h.jsx("span",{className:"text-xs text-muted-foreground truncate flex-1",children:u}),p>0&&h.jsx("span",{className:"text-[10px] text-muted-foreground shrink-0",children:$N(p)}),C,v&&h.jsx("a",{href:v,download:u,className:"inline-flex shrink-0",children:h.jsx(_e,{variant:"ghost",size:"icon",className:"h-6 w-6",title:"Download",children:h.jsx(nC,{className:"h-3 w-3"})})})]});if(c==="image"&&v)return h.jsxs("div",{className:"flex-1 flex flex-col min-h-0 overflow-hidden bg-background",children:[h.jsxs(y,{icon:cb,children:[h.jsx(_e,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:()=>i(S=>Math.max(.1,S-.25)),children:h.jsx(j5,{className:"h-3 w-3"})}),h.jsxs("span",{className:"text-[10px] text-muted-foreground w-10 text-center shrink-0",children:[Math.round(r*100),"%"]}),h.jsx(_e,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:()=>i(S=>Math.min(5,S+.25)),children:h.jsx(M5,{className:"h-3 w-3"})}),h.jsx(_e,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:()=>a(S=>(S+90)%360),children:h.jsx(d5,{className:"h-3 w-3"})})]}),h.jsx("div",{className:"flex-1 overflow-auto flex items-center justify-center p-4",children:h.jsx("img",{src:v,alt:u,style:{transform:`scale(${r}) rotate(${o}deg)`,transition:"transform 0.2s",maxWidth:"100%",maxHeight:"100%",objectFit:"contain"},draggable:!1})})]});if(c==="video"&&v)return h.jsxs("div",{className:"flex-1 flex flex-col min-h-0 overflow-hidden bg-background",children:[h.jsx(y,{icon:Tp}),h.jsx("div",{className:"flex-1 flex items-center justify-center p-4",children:h.jsx("video",{controls:!0,className:"max-w-full max-h-full rounded",src:v,children:"Your browser does not support video playback."})})]});if(c==="audio"&&v)return h.jsxs("div",{className:"flex-1 flex flex-col min-h-0 overflow-hidden bg-background",children:[h.jsx(y,{icon:Tu}),h.jsx("div",{className:"flex-1 flex items-center justify-center p-8",children:h.jsxs("div",{className:"w-full max-w-md space-y-4 text-center",children:[h.jsx(Tu,{className:"h-16 w-16 text-muted-foreground mx-auto"}),h.jsx("p",{className:"text-sm font-medium",children:u}),h.jsx("audio",{controls:!0,className:"w-full",src:v,children:"Your browser does not support audio."})]})})]});if(c==="pdf"&&v)return h.jsxs("div",{className:"flex-1 flex flex-col min-h-0 overflow-hidden bg-background",children:[h.jsx(y,{icon:Ai}),h.jsx("div",{className:"flex-1",children:h.jsx("iframe",{src:v,className:"w-full h-full border-0",title:u})})]});const w=lW[c]||ss;return h.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center gap-4 p-8 bg-background",children:[h.jsx(w,{className:"h-16 w-16 text-muted-foreground"}),h.jsxs("div",{className:"text-center space-y-1",children:[h.jsx("p",{className:"text-sm font-medium",children:u||"Unnamed file"}),f&&h.jsx("p",{className:"text-xs text-muted-foreground",children:f}),p>0&&h.jsx("p",{className:"text-xs text-muted-foreground",children:$N(p)})]}),v&&h.jsx("a",{href:v,download:u,children:h.jsxs(_e,{variant:"outline",size:"sm",children:[h.jsx(nC,{className:"h-4 w-4 mr-1"})," Download"]})})]})}function HN(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function UN(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?HN(Object(n),!0).forEach(function(r){si(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):HN(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}var uW={top:function(e,n){return Math.abs(n.y-e.top)},right:function(e,n){return Math.abs(e.right-n.x)},bottom:function(e,n){return Math.abs(e.bottom-n.y)},left:function(e,n){return Math.abs(n.x-e.left)}},w2=Symbol("closestEdge");function Ix(t,e){var n,r,i=e.element,o=e.input,a=e.allowedEdges,c={x:o.clientX,y:o.clientY},u=i.getBoundingClientRect(),f=a.map(function(g){return{edge:g,value:uW[g](u,c)}}),p=(n=(r=f.sort(function(g,v){return g.value-v.value})[0])===null||r===void 0?void 0:r.edge)!==null&&n!==void 0?n:null;return UN(UN({},t),{},si({},w2,p))}function io(t){var e;return(e=t[w2])!==null&&e!==void 0?e:null}const dW={image:cb,video:Tp,audio:Tu,pdf:Ai,file:ss,other:ss};function S2({item:t,level:e=0,selectedId:n,onSelect:r,onAddChild:i,isExpanded:o,onToggleExpand:a,onDropOnItem:c}){const u=x.useRef(null),[f,p]=x.useState(null),[g,v]=x.useState(!1),y=t.children&&t.children.length>0,w=n===t.id,S=o?.(t.id);let C;return t.type==="folder"?C=S?E3:MA:t.type==="doc"?C=t.docType==="day-page"?ab:Ai:C=dW[t.artifactType]||ss,x.useEffect(()=>{const T=u.current;if(T)return Zl({element:T,getData:({input:N,element:k})=>{const D={itemId:t.id,itemType:t.type};return Ix(D,{element:k,input:N,allowedEdges:["top","bottom"]})},onDragEnter:({self:N})=>{v(!0),p(io(N.data))},onDrag:({self:N})=>{p(io(N.data))},onDragLeave:()=>{v(!1),p(null)},onDrop:({source:N,self:k})=>{v(!1),p(null);const D=io(k.data);c?.(N.data,t,D)}})},[t,c]),h.jsxs("div",{className:"relative",children:[g&&f==="top"&&h.jsx("div",{style:{position:"absolute",top:0,left:e*12+8,right:4,height:2,backgroundColor:"rgb(50, 150, 255)",borderRadius:1,zIndex:10}}),h.jsxs("div",{ref:u,className:`
          flex items-center gap-1 px-2 py-1 cursor-pointer rounded-md
          hover:bg-accent/50 transition-colors group
          ${w?"bg-accent":""}
          ${g?"bg-blue-500/10":""}
        `,style:{paddingLeft:`${e*12+8}px`},onClick:()=>r?.(t),onDoubleClick:()=>r?.(t,!0),children:[y?h.jsx("button",{onClick:T=>{T.stopPropagation(),a?.(t.id)},className:"p-0.5 hover:bg-muted rounded",children:S?h.jsx(Yu,{className:"w-3 h-3 text-muted-foreground"}):h.jsx(hs,{className:"w-3 h-3 text-muted-foreground"})}):h.jsx("span",{className:"w-4"}),h.jsx(C,{className:`w-4 h-4 ${t.type==="folder"?"text-amber-500":"text-blue-400"}`}),h.jsx("span",{className:"text-sm truncate flex-1",children:t.label}),t.type==="folder"&&h.jsx("button",{onClick:T=>{T.stopPropagation(),i?.(t.id)},className:"p-0.5 opacity-0 group-hover:opacity-100 hover:bg-muted rounded",children:h.jsx(li,{className:"w-3 h-3 text-muted-foreground"})})]}),g&&f==="bottom"&&h.jsx("div",{style:{position:"absolute",bottom:0,left:e*12+8,right:4,height:2,backgroundColor:"rgb(50, 150, 255)",borderRadius:1,zIndex:10}}),y&&S&&h.jsx("div",{children:t.children.map(T=>h.jsx(S2,{item:T,level:e+1,selectedId:n,onSelect:r,onAddChild:i,isExpanded:o,onToggleExpand:a,onDropOnItem:c},T.id))})]})}function fW({items:t,selectedId:e,onSelect:n,onAddDoc:r,collapsed:i,onToggleCollapse:o,onDropOnItem:a}){const[c,u]=x.useState(new Set);x.useEffect(()=>{const g=t.map(v=>v.id);u(v=>{const y=new Set(v);return g.forEach(w=>y.add(w)),y})},[t]);const f=x.useCallback(g=>c.has(g),[c]),p=x.useCallback(g=>{u(v=>{const y=new Set(v);return y.has(g)?y.delete(g):y.add(g),y})},[]);return i?h.jsx("div",{className:"w-8 border-r border-border bg-muted/30 flex flex-col items-center py-2 cursor-pointer hover:bg-muted/50",onClick:o,title:"Expand sidebar",children:h.jsx(hs,{className:"w-4 h-4 text-muted-foreground"})}):h.jsxs("div",{className:"w-48 border-r border-border bg-muted/30 flex flex-col overflow-hidden",children:[h.jsxs("div",{className:"flex items-center justify-between px-2 py-1.5 border-b border-border",children:[h.jsx("span",{className:"text-xs font-medium text-muted-foreground",children:"Files"}),h.jsxs("div",{className:"flex items-center gap-1",children:[h.jsx(_e,{variant:"ghost",size:"sm",onClick:()=>r?.(null),className:"h-5 w-5 p-0",title:"New Document",children:h.jsx(li,{className:"w-3 h-3"})}),h.jsx(_e,{variant:"ghost",size:"sm",onClick:o,className:"h-5 w-5 p-0",title:"Collapse sidebar",children:h.jsx(Yu,{className:"w-3 h-3 rotate-90"})})]})]}),h.jsx("div",{className:"flex-1 overflow-auto py-1",children:t.map(g=>h.jsx(S2,{item:g,selectedId:e,onSelect:n,onAddChild:r,isExpanded:f,onToggleExpand:p,onDropOnItem:a},g.id))})]})}function hW({folder:t,items:e,onSelect:n,onUpload:r,onCreateFolder:i,onCreateDoc:o}){const a=f=>{Array.from(f.target.files||[]).forEach(g=>r?.(g)),f.target.value=""},c=f=>{f.preventDefault(),f.stopPropagation(),f.currentTarget.classList.remove("bg-primary/5"),Array.from(f.dataTransfer?.files||[]).forEach(g=>r?.(g))},u=f=>f._type==="folder"?h.jsx(MA,{className:"h-10 w-10 text-amber-500"}):f._type==="doc"?h.jsx(Ai,{className:"h-10 w-10 text-blue-400"}):f.artifactType==="image"&&f.storagePath?h.jsx("img",{src:f.storagePath,className:"h-10 w-10 object-cover rounded",alt:""}):f.artifactType==="video"?h.jsx(Tp,{className:"h-10 w-10 text-purple-400"}):f.artifactType==="audio"?h.jsx(Tu,{className:"h-10 w-10 text-green-400"}):h.jsx(ss,{className:"h-10 w-10 text-muted-foreground"});return h.jsxs("div",{className:"flex-1 flex flex-col min-h-0 overflow-hidden",onDragOver:f=>{f.preventDefault(),f.currentTarget.classList.add("bg-primary/5")},onDragLeave:f=>{f.currentTarget.classList.remove("bg-primary/5")},onDrop:c,children:[h.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 border-b border-border bg-muted/20 shrink-0",children:[h.jsx("span",{className:"text-sm font-medium truncate flex-1",children:t?.name||"Files"}),h.jsxs(_e,{variant:"ghost",size:"sm",className:"h-7 text-xs",onClick:i,children:[h.jsx(T3,{className:"h-3 w-3 mr-1"})," Folder"]}),h.jsxs(_e,{variant:"ghost",size:"sm",className:"h-7 text-xs",onClick:o,children:[h.jsx(Ai,{className:"h-3 w-3 mr-1"})," Doc"]}),h.jsxs("label",{className:"cursor-pointer",children:[h.jsx("input",{type:"file",className:"hidden",multiple:!0,onChange:a}),h.jsx(_e,{variant:"outline",size:"sm",className:"h-7 text-xs",asChild:!0,children:h.jsxs("span",{children:[h.jsx(N5,{className:"h-3 w-3 mr-1"})," Upload"]})})]})]}),h.jsx("div",{className:"flex-1 overflow-auto p-3",children:h.jsxs("div",{className:"grid grid-cols-[repeat(auto-fill,minmax(100px,1fr))] gap-3",children:[e.map(f=>h.jsxs("button",{onClick:()=>n(f),onDoubleClick:()=>n(f,!0),className:"flex flex-col items-center gap-2 p-3 rounded-lg border border-border hover:bg-muted/40 transition-colors text-center",children:[u(f),h.jsx("span",{className:"text-[11px] truncate w-full",children:f.name||f.title||"Untitled"})]},f.id)),e.length===0&&h.jsx("div",{className:"col-span-full text-center text-sm text-muted-foreground py-8",children:"Drop files here or click Upload"})]})})]})}function pW({panel:t,view:e,manifest:n,containers:r=[],dispatch:i,socket:o,addContainerToPanel:a}){const{occurrencesById:c,docsById:u,foldersById:f,artifactsById:p,state:g}=x.useContext(Rn),[v,y]=x.useState(e?.sidebarCollapsed||!1),[w,S]=x.useState(e?.activeDocId||e?.activeArtifactId||null),[C,T]=x.useState(e?.activeDocId?"doc":e?.activeArtifactId?"artifact":null),[N,k]=x.useState(n?.rootFolderId||null),D=g?.gridId,M=g?.userId,R=e?.showTree!==!1,O=e?.viewType==="file-manager",I=x.useMemo(()=>{const H=n?.rootFolderId,ce=Object.values(f),te=Object.values(u),me=Object.values(p);function Te(he){const Ae=f[he];if(!Ae)return null;const Re=ce.filter(J=>J.parentId===he).sort((J,X)=>(J.sortOrder||0)-(X.sortOrder||0)),Le=te.filter(J=>J.folderId===he&&!J.isDeleted).sort((J,X)=>(J.sortOrder||0)-(X.sortOrder||0)),ae=me.filter(J=>J.folderId===he&&!J.isDeleted).sort((J,X)=>(J.sortOrder||0)-(X.sortOrder||0)),Me=[...Re.map(J=>Te(J.id)).filter(Boolean),...Le.map(J=>({id:J.id,type:"doc",label:J.title||"Untitled",docType:J.docType,doc:J})),...ae.map(J=>({id:J.id,type:"artifact",label:J.name||"Unnamed",artifactType:J.artifactType,artifact:J}))];return{id:Ae.id,type:"folder",label:Ae.name||"Folder",folderType:Ae.folderType,folder:Ae,children:Me}}if(H&&f[H])return Te(H)?.children||[];if(ce.length===0&&te.length===0){const he=new Date().toISOString().split("T")[0],Ae=r.filter(Re=>Re.kind==="doc").map(Re=>({id:Re.id,type:"doc",label:Re.label||"Untitled",docType:"normal",container:Re}));return[{id:"day-pages",type:"folder",label:"Day Pages",folderType:"day-pages",children:[{id:`day-${he}`,type:"doc",label:he,docType:"day-page"}]},{id:"docs",type:"folder",label:"Documents",folderType:"normal",children:Ae}]}const re=ce.filter(he=>!he.parentId).sort((he,Ae)=>(he.sortOrder||0)-(Ae.sortOrder||0));return re.length>0?re.map(he=>Te(he.id)).filter(Boolean):te.map(he=>({id:he.id,type:"doc",label:he.title||"Untitled",docType:he.docType,doc:he}))},[n,f,u,p,r]),z=x.useMemo(()=>C==="doc"&&w&&u[w]||null,[w,C,u]),U=x.useMemo(()=>C==="artifact"&&w&&p[w]||null,[w,C,p]),Y=x.useMemo(()=>z&&Object.values(c).find(H=>H.targetType==="doc"&&H.targetId===z.id)||null,[z,c]),W=x.useMemo(()=>!z||Y?null:r.find(H=>H.id===w)||null,[z,w,r,Y]),j=x.useMemo(()=>W&&Object.values(c).find(H=>H.targetType==="container"&&H.targetId===W.id)||null,[W,c]),G=N||n?.rootFolderId,oe=x.useMemo(()=>{if(!O)return[];const H=[];return Object.values(f).forEach(ce=>{ce.parentId===G&&H.push({...ce,_type:"folder"})}),Object.values(u).forEach(ce=>{ce.folderId===G&&!ce.isDeleted&&H.push({...ce,_type:"doc"})}),Object.values(p).forEach(ce=>{ce.folderId===G&&!ce.isDeleted&&H.push({...ce,_type:"artifact"})}),H.sort((ce,te)=>(ce.sortOrder||0)-(te.sortOrder||0))},[O,f,u,p,G]),L=x.useMemo(()=>G?f[G]:null,[G,f]);x.useEffect(()=>{if(w)return;function H(te){for(const me of te){if(me.type==="doc")return me;if(me.children){const Te=H(me.children);if(Te)return Te}}return null}const ce=H(I);ce&&(S(ce.id),T(ce.type))},[w,I]);const $=g?.grid?.currentIterationValue,V=x.useRef(null);x.useEffect(()=>{if(!$||e?.viewType!=="notebook"&&t?.kind!=="notebook")return;const H=new Date($).toISOString().slice(0,10),ce=Object.values(u).find(Me=>Me.docType==="day-page"&&Me.title===H);if(ce){ce.id!==w&&(S(ce.id),T("doc"),e?.id&&cu({dispatch:i,socket:o,view:{id:e.id,activeDocId:ce.id,activeArtifactId:null},emit:!0}));return}if(V.current===H)return;V.current=H;const me=Object.values(f).find(Me=>Me.folderType==="day-pages")?.id||n?.rootFolderId;if(!me||!D||!M){V.current=null;return}const Te=g?.grid,re=Te?.defaultDayPageTemplateId,Ae=(re?Te?.templates?.find(Me=>Me.id===re):null)?.docContent||"",Re=kn(),Le={id:Re,userId:M,gridId:D,folderId:me,title:H,docType:"day-page",dayPageDate:new Date($),sortOrder:Date.now(),content:Ae};yl({dispatch:i,socket:o,doc:Le,emit:!0});const ae=kn();Qc({dispatch:i,socket:o,occurrence:{id:ae,userId:M,gridId:D,targetType:"doc",targetId:Re,iteration:{key:"time",mode:"persistent",timeFilter:"daily"},fields:{},meta:{folderId:me},docContent:Ae||{type:"doc",content:[{type:"paragraph"}]}},emit:!0}),S(Re),T("doc"),e?.id&&cu({dispatch:i,socket:o,view:{id:e.id,activeDocId:Re,activeArtifactId:null},emit:!0}),setTimeout(()=>{V.current=null},500)},[$,e?.viewType,e?.id,t?.kind,u,f,n,D,M,i,o]);const we=x.useCallback((H,ce)=>{if(H.type==="folder"){O&&(k(H.id),S(null),T("folder"));return}if(S(H.id),T(H.type),ce&&y(!0),e?.id){const te={};H.type==="doc"?(te.activeDocId=H.id,te.activeArtifactId=null):H.type==="artifact"&&(te.activeArtifactId=H.id,te.activeDocId=null),cu({dispatch:i,socket:o,view:{id:e.id,...te},emit:!0})}},[e,i,o,O]),pe=x.useCallback((H,ce)=>{if(H._type==="folder"){k(H.id),S(null),T("folder");return}if(S(H.id),T(H._type==="doc"?"doc":"artifact"),ce&&y(!0),e?.id){const te={};H._type==="doc"?(te.activeDocId=H.id,te.activeArtifactId=null):(te.activeArtifactId=H.id,te.activeDocId=null),cu({dispatch:i,socket:o,view:{id:e.id,...te},emit:!0})}},[e,i,o]),P=x.useCallback(H=>{if(!D||!M)return;let ce=H;if(!ce){const re=n?.rootFolderId;re&&(ce=Object.values(f).find(Ae=>Ae.parentId===re&&Ae.folderType==="normal")?.id||re)}const te=crypto.randomUUID(),me={id:te,userId:M,gridId:D,folderId:ce||null,title:"Untitled Document",docType:"normal",sortOrder:Object.values(u).length,content:{type:"doc",content:[{type:"paragraph",content:[]}]}};yl({dispatch:i,socket:o,doc:me,emit:!0});const Te=kn();Qc({dispatch:i,socket:o,occurrence:{id:Te,userId:M,gridId:D,targetType:"doc",targetId:te,iteration:{key:"time",mode:"persistent",timeFilter:"daily"},fields:{},meta:{folderId:ce||null},docContent:me.content},emit:!0}),S(te),T("doc")},[D,M,n,f,u,i,o]),K=x.useCallback((H,ce,te)=>{if(!(!D||!M)){if(H.type==="instance"){const me=H.data||{},Te=H.id||me.id,re=me.label||"Item",he=H.context?.occurrenceId||null,Ae=H.context?.containerId||null;let Re=null;ce.type==="folder"?Re=ce.id:ce.doc?.folderId&&(Re=ce.doc.folderId);const Le=crypto.randomUUID(),ae={id:Le,userId:M,gridId:D,folderId:Re,title:re,docType:"normal",sortOrder:Object.values(u).length,content:{type:"doc",content:[{type:"paragraph",content:[{type:"instancePill",attrs:{instanceId:Te,instanceLabel:re,occurrenceId:he,containerId:Ae,showIcon:!0}}]}]}};yl({dispatch:i,socket:o,doc:ae,emit:!0}),Qc({dispatch:i,socket:o,occurrence:{id:kn(),userId:M,gridId:D,targetType:"doc",targetId:Le,iteration:{key:"time",mode:"persistent",timeFilter:"daily"},fields:{},meta:{folderId:Re},docContent:ae.content},emit:!0}),S(Le),T("doc")}if(H.type==="field"){const me=H.data||{},Te=H.id||me.id,re=me.name||"Field";let he=null;ce.type==="folder"?he=ce.id:ce.doc?.folderId&&(he=ce.doc.folderId);const Ae=crypto.randomUUID(),Re={id:Ae,userId:M,gridId:D,folderId:he,title:re,docType:"normal",sortOrder:Object.values(u).length,content:{type:"doc",content:[{type:"paragraph",content:[{type:"fieldPill",attrs:{fieldId:Te,fieldName:re,fieldType:me.type||"text",fieldMode:me.mode||"input",showValue:!0,showLabel:!0}}]}]}};yl({dispatch:i,socket:o,doc:Re,emit:!0}),Qc({dispatch:i,socket:o,occurrence:{id:kn(),userId:M,gridId:D,targetType:"doc",targetId:Ae,iteration:{key:"time",mode:"persistent",timeFilter:"daily"},fields:{},meta:{folderId:he},docContent:Re.content},emit:!0}),S(Ae),T("doc")}if(H._treeItemType==="doc"&&H._treeItemId){const me=ce.type==="folder"?ce.id:ce.doc?.folderId||null;BG({dispatch:i,socket:o,doc:{id:H._treeItemId,folderId:me,sortOrder:Date.now()},emit:!0})}if(H._treeItemType==="folder"&&H._treeItemId){const me=ce.type==="folder"?ce.id:null;me!==H._treeItemId&&$G({dispatch:i,socket:o,folder:{id:H._treeItemId,parentId:me,sortOrder:Date.now()},emit:!0})}if(H._treeItemType==="artifact"&&H._treeItemId){const me=ce.type==="folder"?ce.id:null;HG({dispatch:i,socket:o,artifact:{id:H._treeItemId,folderId:me,sortOrder:Date.now()},emit:!0})}}},[D,M,u,i,o]),B=x.useCallback(async H=>{await b2({file:H,userId:M,gridId:D,folderId:G,manifestId:n?.id,dispatch:i})},[M,D,G,n,i]),Z=x.useCallback(()=>{const H={id:kn(),userId:M,gridId:D,manifestId:n?.id,parentId:G,name:"New Folder",folderType:"normal",sortOrder:Date.now()};FG({dispatch:i,socket:o,folder:H})},[M,D,n,G,i,o]),le=x.useCallback(()=>{const H={id:kn(),userId:M,gridId:D,manifestId:n?.id,folderId:G,title:"Untitled Document",content:{type:"doc",content:[{type:"paragraph"}]},sortOrder:Date.now()};yl({dispatch:i,socket:o,doc:H}),Qc({dispatch:i,socket:o,occurrence:{id:kn(),userId:M,gridId:D,targetType:"doc",targetId:H.id,iteration:{key:"time",mode:"persistent",timeFilter:"daily"},fields:{},meta:{folderId:G},docContent:H.content}}),S(H.id),T("doc")},[M,D,n,G,i,o]),be=()=>O&&(!w||C==="folder")?h.jsx(hW,{folder:L,items:oe,onSelect:pe,onUpload:B,onCreateFolder:Z,onCreateDoc:le}):z?Y?h.jsx(Eu,{container:{id:z.id,label:z.title,kind:"doc"},occurrence:Y,dispatch:i,socket:o}):W&&j?h.jsx(Eu,{container:W,occurrence:j,dispatch:i,socket:o}):h.jsx(Eu,{container:{id:z.id,label:z.title,kind:"doc"},occurrence:{id:z.id,docContent:z.content,targetType:"doc",targetId:z.id},dispatch:i,socket:o,docModel:z}):U?h.jsx(cW,{artifact:U}):h.jsx("div",{className:"flex-1 flex items-center justify-center text-muted-foreground text-sm",children:"Select a document or create a new one"});return h.jsxs("div",{className:"artifact-display flex flex-1 min-h-0 overflow-hidden",children:[R&&h.jsx(fW,{items:I,selectedId:w,onSelect:we,onAddDoc:P,collapsed:v,onToggleCollapse:()=>y(H=>!H),onDropOnItem:K}),h.jsx("div",{className:"flex-1 flex flex-col min-h-0 overflow-hidden bg-background",children:be()})]})}function VN({panel:t,view:e,containers:n=[],containerContent:r,dispatch:i,socket:o,addContainerToPanel:a}){const{manifestsById:c,docsById:u,foldersById:f,artifactsById:p,occurrencesById:g}=x.useContext(Rn),v=e?.viewType||"list",y=e?.manifestId?c[e.manifestId]:null;switch(v){case"notebook":case"artifact-viewer":case"file-manager":return h.jsx(pW,{panel:t,view:e,manifest:y,containers:n,dispatch:i,socket:o,addContainerToPanel:a});case"doc-viewer":{const w=e?.activeDocId?u[e.activeDocId]:null,S=n.find(T=>T.kind==="doc"),C=S?Object.values(g).find(T=>T.targetType==="container"&&T.targetId===S.id):null;return w?h.jsx("div",{className:"flex-1 flex flex-col min-h-0 overflow-hidden bg-background",children:h.jsx(Eu,{container:S||{id:w.id,label:w.title,kind:"doc"},occurrence:C||{id:w.id,docContent:w.content},dispatch:i,socket:o})}):h.jsx("div",{className:"flex-1 flex items-center justify-center text-muted-foreground text-sm",children:"No document selected"})}case"canvas":return h.jsx("div",{className:"flex-1 flex items-center justify-center text-muted-foreground text-sm",children:"Canvas view coming soon"});default:return r||null}}function mW({children:t,label:e="Layout",buttonVariant:n="ghost",align:r="start",side:i="bottom",className:o="",open:a,onOpenChange:c,triggerStyle:u}){return h.jsxs(fo,{open:a,onOpenChange:c,children:[e!==null&&h.jsx(ho,{asChild:!0,children:h.jsx(_e,{variant:n,size:"sm","aria-label":"Layout",style:u,children:e})}),h.jsx(po,{align:r,side:i,className:` ${o}`,children:t})]})}var gW=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],yW=gW.reduce((t,e)=>{const n=pb(`Primitive.${e}`),r=x.forwardRef((i,o)=>{const{asChild:a,...c}=i,u=a?n:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),h.jsx(u,{...c,ref:o})});return r.displayName=`Primitive.${e}`,{...t,[e]:r}},{}),vW="Separator",qN="horizontal",xW=["horizontal","vertical"],E2=x.forwardRef((t,e)=>{const{decorative:n,orientation:r=qN,...i}=t,o=bW(r)?r:qN,c=n?{role:"none"}:{"aria-orientation":o==="vertical"?o:void 0,role:"separator"};return h.jsx(yW.div,{"data-orientation":o,...c,...i,ref:e})});E2.displayName=vW;function bW(t){return xW.includes(t)}var wW=E2;function Rt({className:t,...e}){return h.jsx(wW,{className:Wt(" h-px mt-3 mb-5 w-full bg-borderScale-0",t),...e})}var SW=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],EW=SW.reduce((t,e)=>{const n=pb(`Primitive.${e}`),r=x.forwardRef((i,o)=>{const{asChild:a,...c}=i,u=a?n:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),h.jsx(u,{...c,ref:o})});return r.displayName=`Primitive.${e}`,{...t,[e]:r}},{}),CW="Label",C2=x.forwardRef((t,e)=>h.jsx(EW.label,{...t,ref:e,onMouseDown:n=>{n.target.closest("button, input, select, textarea")||(t.onMouseDown?.(n),!n.defaultPrevented&&n.detail>1&&n.preventDefault())}}));C2.displayName=CW;var TW=C2;const tt=x.forwardRef(({className:t,...e},n)=>h.jsx(TW,{ref:n,className:Wt("text-[11px] text-foregroundScale-2 font-medium content-center pr-[3px] leading-none",t),...e}));function Kt({className:t,...e}){return h.jsx("input",{className:Wt("flex h-3 w-full rounded-sm border border-borderScale-0 bg-inputScale-2 px-3 py-2 text-xs text-foreground shadow-sm","focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring","disabled:cursor-not-allowed text-white disabled:opacity-50",t),...e})}var rm="Switch",[NW]=Wr(rm),[AW,kW]=NW(rm),T2=x.forwardRef((t,e)=>{const{__scopeSwitch:n,name:r,checked:i,defaultChecked:o,required:a,disabled:c,value:u="on",onCheckedChange:f,form:p,...g}=t,[v,y]=x.useState(null),w=ht(e,k=>y(k)),S=x.useRef(!1),C=v?p||!!v.closest("form"):!0,[T,N]=Di({prop:i,defaultProp:o??!1,onChange:f,caller:rm});return h.jsxs(AW,{scope:n,checked:T,disabled:c,children:[h.jsx(it.button,{type:"button",role:"switch","aria-checked":T,"aria-required":a,"data-state":D2(T),"data-disabled":c?"":void 0,disabled:c,value:u,...g,ref:w,onClick:Ve(t.onClick,k=>{N(D=>!D),C&&(S.current=k.isPropagationStopped(),S.current||k.stopPropagation())})}),C&&h.jsx(k2,{control:v,bubbles:!S.current,name:r,value:u,checked:T,required:a,disabled:c,form:p,style:{transform:"translateX(-100%)"}})]})});T2.displayName=rm;var N2="SwitchThumb",A2=x.forwardRef((t,e)=>{const{__scopeSwitch:n,...r}=t,i=kW(N2,n);return h.jsx(it.span,{"data-state":D2(i.checked),"data-disabled":i.disabled?"":void 0,...r,ref:e})});A2.displayName=N2;var DW="SwitchBubbleInput",k2=x.forwardRef(({__scopeSwitch:t,control:e,checked:n,bubbles:r=!0,...i},o)=>{const a=x.useRef(null),c=ht(a,o),u=jp(n),f=Mp(e);return x.useEffect(()=>{const p=a.current;if(!p)return;const g=window.HTMLInputElement.prototype,y=Object.getOwnPropertyDescriptor(g,"checked").set;if(u!==n&&y){const w=new Event("click",{bubbles:r});y.call(p,n),p.dispatchEvent(w)}},[u,n,r]),h.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:n,...i,tabIndex:-1,ref:c,style:{...i.style,...f,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});k2.displayName=DW;function D2(t){return t?"checked":"unchecked"}var OW=T2,MW=A2;const od=x.forwardRef(({className:t,...e},n)=>h.jsx(OW,{ref:n,className:Wt("peer inline-flex h-4 w-7 shrink-0 cursor-pointer items-center rounded-full border border-borderScale-0","bg-inputScale-2 transition-colors","focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring","disabled:cursor-not-allowed disabled:opacity-50","data-[state=checked]:bg-accent",t),...e,children:h.jsx(MW,{className:Wt("pointer-events-none block h-3 w-3 rounded-full bg-white shadow","transition-transform data-[state=checked]:translate-x-3 data-[state=unchecked]:translate-x-0")})}));od.displayName="Switch";var im="Checkbox",[RW]=Wr(im),[jW,C0]=RW(im);function IW(t){const{__scopeCheckbox:e,checked:n,children:r,defaultChecked:i,disabled:o,form:a,name:c,onCheckedChange:u,required:f,value:p="on",internal_do_not_use_render:g}=t,[v,y]=Di({prop:n,defaultProp:i??!1,onChange:u,caller:im}),[w,S]=x.useState(null),[C,T]=x.useState(null),N=x.useRef(!1),k=w?!!a||!!w.closest("form"):!0,D={checked:v,disabled:o,setChecked:y,control:w,setControl:S,name:c,form:a,value:p,hasConsumerStoppedPropagationRef:N,required:f,defaultChecked:fs(i)?!1:i,isFormControl:k,bubbleInput:C,setBubbleInput:T};return h.jsx(jW,{scope:e,...D,children:_W(g)?g(D):r})}var O2="CheckboxTrigger",M2=x.forwardRef(({__scopeCheckbox:t,onKeyDown:e,onClick:n,...r},i)=>{const{control:o,value:a,disabled:c,checked:u,required:f,setControl:p,setChecked:g,hasConsumerStoppedPropagationRef:v,isFormControl:y,bubbleInput:w}=C0(O2,t),S=ht(i,p),C=x.useRef(u);return x.useEffect(()=>{const T=o?.form;if(T){const N=()=>g(C.current);return T.addEventListener("reset",N),()=>T.removeEventListener("reset",N)}},[o,g]),h.jsx(it.button,{type:"button",role:"checkbox","aria-checked":fs(u)?"mixed":u,"aria-required":f,"data-state":P2(u),"data-disabled":c?"":void 0,disabled:c,value:a,...r,ref:S,onKeyDown:Ve(e,T=>{T.key==="Enter"&&T.preventDefault()}),onClick:Ve(n,T=>{g(N=>fs(N)?!0:!N),w&&y&&(v.current=T.isPropagationStopped(),v.current||T.stopPropagation())})})});M2.displayName=O2;var R2=x.forwardRef((t,e)=>{const{__scopeCheckbox:n,name:r,checked:i,defaultChecked:o,required:a,disabled:c,value:u,onCheckedChange:f,form:p,...g}=t;return h.jsx(IW,{__scopeCheckbox:n,checked:i,defaultChecked:o,disabled:c,required:a,onCheckedChange:f,name:r,form:p,value:u,internal_do_not_use_render:({isFormControl:v})=>h.jsxs(h.Fragment,{children:[h.jsx(M2,{...g,ref:e,__scopeCheckbox:n}),v&&h.jsx(L2,{__scopeCheckbox:n})]})})});R2.displayName=im;var j2="CheckboxIndicator",I2=x.forwardRef((t,e)=>{const{__scopeCheckbox:n,forceMount:r,...i}=t,o=C0(j2,n);return h.jsx(pr,{present:r||fs(o.checked)||o.checked===!0,children:h.jsx(it.span,{"data-state":P2(o.checked),"data-disabled":o.disabled?"":void 0,...i,ref:e,style:{pointerEvents:"none",...t.style}})})});I2.displayName=j2;var _2="CheckboxBubbleInput",L2=x.forwardRef(({__scopeCheckbox:t,...e},n)=>{const{control:r,hasConsumerStoppedPropagationRef:i,checked:o,defaultChecked:a,required:c,disabled:u,name:f,value:p,form:g,bubbleInput:v,setBubbleInput:y}=C0(_2,t),w=ht(n,y),S=jp(o),C=Mp(r);x.useEffect(()=>{const N=v;if(!N)return;const k=window.HTMLInputElement.prototype,M=Object.getOwnPropertyDescriptor(k,"checked").set,R=!i.current;if(S!==o&&M){const O=new Event("click",{bubbles:R});N.indeterminate=fs(o),M.call(N,fs(o)?!1:o),N.dispatchEvent(O)}},[v,S,o,i]);const T=x.useRef(fs(o)?!1:o);return h.jsx(it.input,{type:"checkbox","aria-hidden":!0,defaultChecked:a??T.current,required:c,disabled:u,name:f,value:p,form:g,...e,tabIndex:-1,ref:w,style:{...e.style,...C,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});L2.displayName=_2;function _W(t){return typeof t=="function"}function fs(t){return t==="indeterminate"}function P2(t){return fs(t)?"indeterminate":t?"checked":"unchecked"}const T0=x.forwardRef(({className:t,...e},n)=>h.jsx(R2,{ref:n,className:Wt("h-4 w-4 shrink-0 rounded-sm border border-borderScale-0 bg-inputScale-2","focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring","disabled:cursor-not-allowed disabled:opacity-50","data-[state=checked]:bg-accent data-[state=checked]:text-white",t),...e,children:h.jsx(I2,{className:"flex items-center justify-center",children:h.jsx(Cp,{className:"h-3 w-3"})})}));T0.displayName="Checkbox";var z2=["PageUp","PageDown"],B2=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],F2={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},ec="Slider",[_x,LW,PW]=gb(ec),[$2]=Wr(ec,[PW]),[zW,om]=$2(ec),H2=x.forwardRef((t,e)=>{const{name:n,min:r=0,max:i=100,step:o=1,orientation:a="horizontal",disabled:c=!1,minStepsBetweenThumbs:u=0,defaultValue:f=[r],value:p,onValueChange:g=()=>{},onValueCommit:v=()=>{},inverted:y=!1,form:w,...S}=t,C=x.useRef(new Set),T=x.useRef(0),k=a==="horizontal"?BW:FW,[D=[],M]=Di({prop:p,defaultProp:f,onChange:Y=>{[...C.current][T.current]?.focus(),g(Y)}}),R=x.useRef(D);function O(Y){const W=qW(D,Y);U(Y,W)}function I(Y){U(Y,T.current)}function z(){const Y=R.current[T.current];D[T.current]!==Y&&v(D)}function U(Y,W,{commit:j}={commit:!1}){const G=KW(o),oe=XW(Math.round((Y-r)/o)*o+r,G),L=Nu(oe,[r,i]);M(($=[])=>{const V=UW($,L,W);if(YW(V,u*o)){T.current=V.indexOf(L);const we=String(V)!==String($);return we&&j&&v(V),we?V:$}else return $})}return h.jsx(zW,{scope:t.__scopeSlider,name:n,disabled:c,min:r,max:i,valueIndexToChangeRef:T,thumbs:C.current,values:D,orientation:a,form:w,children:h.jsx(_x.Provider,{scope:t.__scopeSlider,children:h.jsx(_x.Slot,{scope:t.__scopeSlider,children:h.jsx(k,{"aria-disabled":c,"data-disabled":c?"":void 0,...S,ref:e,onPointerDown:Ve(S.onPointerDown,()=>{c||(R.current=D)}),min:r,max:i,inverted:y,onSlideStart:c?void 0:O,onSlideMove:c?void 0:I,onSlideEnd:c?void 0:z,onHomeKeyDown:()=>!c&&U(r,0,{commit:!0}),onEndKeyDown:()=>!c&&U(i,D.length-1,{commit:!0}),onStepKeyDown:({event:Y,direction:W})=>{if(!c){const oe=z2.includes(Y.key)||Y.shiftKey&&B2.includes(Y.key)?10:1,L=T.current,$=D[L],V=o*oe*W;U($+V,L,{commit:!0})}}})})})})});H2.displayName=ec;var[U2,V2]=$2(ec,{startEdge:"left",endEdge:"right",size:"width",direction:1}),BW=x.forwardRef((t,e)=>{const{min:n,max:r,dir:i,inverted:o,onSlideStart:a,onSlideMove:c,onSlideEnd:u,onStepKeyDown:f,...p}=t,[g,v]=x.useState(null),y=ht(e,k=>v(k)),w=x.useRef(void 0),S=Ku(i),C=S==="ltr",T=C&&!o||!C&&o;function N(k){const D=w.current||g.getBoundingClientRect(),M=[0,D.width],O=N0(M,T?[n,r]:[r,n]);return w.current=D,O(k-D.left)}return h.jsx(U2,{scope:t.__scopeSlider,startEdge:T?"left":"right",endEdge:T?"right":"left",direction:T?1:-1,size:"width",children:h.jsx(q2,{dir:S,"data-orientation":"horizontal",...p,ref:y,style:{...p.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:k=>{const D=N(k.clientX);a?.(D)},onSlideMove:k=>{const D=N(k.clientX);c?.(D)},onSlideEnd:()=>{w.current=void 0,u?.()},onStepKeyDown:k=>{const M=F2[T?"from-left":"from-right"].includes(k.key);f?.({event:k,direction:M?-1:1})}})})}),FW=x.forwardRef((t,e)=>{const{min:n,max:r,inverted:i,onSlideStart:o,onSlideMove:a,onSlideEnd:c,onStepKeyDown:u,...f}=t,p=x.useRef(null),g=ht(e,p),v=x.useRef(void 0),y=!i;function w(S){const C=v.current||p.current.getBoundingClientRect(),T=[0,C.height],k=N0(T,y?[r,n]:[n,r]);return v.current=C,k(S-C.top)}return h.jsx(U2,{scope:t.__scopeSlider,startEdge:y?"bottom":"top",endEdge:y?"top":"bottom",size:"height",direction:y?1:-1,children:h.jsx(q2,{"data-orientation":"vertical",...f,ref:g,style:{...f.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:S=>{const C=w(S.clientY);o?.(C)},onSlideMove:S=>{const C=w(S.clientY);a?.(C)},onSlideEnd:()=>{v.current=void 0,c?.()},onStepKeyDown:S=>{const T=F2[y?"from-bottom":"from-top"].includes(S.key);u?.({event:S,direction:T?-1:1})}})})}),q2=x.forwardRef((t,e)=>{const{__scopeSlider:n,onSlideStart:r,onSlideMove:i,onSlideEnd:o,onHomeKeyDown:a,onEndKeyDown:c,onStepKeyDown:u,...f}=t,p=om(ec,n);return h.jsx(it.span,{...f,ref:e,onKeyDown:Ve(t.onKeyDown,g=>{g.key==="Home"?(a(g),g.preventDefault()):g.key==="End"?(c(g),g.preventDefault()):z2.concat(B2).includes(g.key)&&(u(g),g.preventDefault())}),onPointerDown:Ve(t.onPointerDown,g=>{const v=g.target;v.setPointerCapture(g.pointerId),g.preventDefault(),p.thumbs.has(v)?v.focus():r(g)}),onPointerMove:Ve(t.onPointerMove,g=>{g.target.hasPointerCapture(g.pointerId)&&i(g)}),onPointerUp:Ve(t.onPointerUp,g=>{const v=g.target;v.hasPointerCapture(g.pointerId)&&(v.releasePointerCapture(g.pointerId),o(g))})})}),G2="SliderTrack",W2=x.forwardRef((t,e)=>{const{__scopeSlider:n,...r}=t,i=om(G2,n);return h.jsx(it.span,{"data-disabled":i.disabled?"":void 0,"data-orientation":i.orientation,...r,ref:e})});W2.displayName=G2;var Lx="SliderRange",Y2=x.forwardRef((t,e)=>{const{__scopeSlider:n,...r}=t,i=om(Lx,n),o=V2(Lx,n),a=x.useRef(null),c=ht(e,a),u=i.values.length,f=i.values.map(v=>J2(v,i.min,i.max)),p=u>1?Math.min(...f):0,g=100-Math.max(...f);return h.jsx(it.span,{"data-orientation":i.orientation,"data-disabled":i.disabled?"":void 0,...r,ref:c,style:{...t.style,[o.startEdge]:p+"%",[o.endEdge]:g+"%"}})});Y2.displayName=Lx;var Px="SliderThumb",K2=x.forwardRef((t,e)=>{const n=LW(t.__scopeSlider),[r,i]=x.useState(null),o=ht(e,c=>i(c)),a=x.useMemo(()=>r?n().findIndex(c=>c.ref.current===r):-1,[n,r]);return h.jsx($W,{...t,ref:o,index:a})}),$W=x.forwardRef((t,e)=>{const{__scopeSlider:n,index:r,name:i,...o}=t,a=om(Px,n),c=V2(Px,n),[u,f]=x.useState(null),p=ht(e,N=>f(N)),g=u?a.form||!!u.closest("form"):!0,v=Mp(u),y=a.values[r],w=y===void 0?0:J2(y,a.min,a.max),S=VW(r,a.values.length),C=v?.[c.size],T=C?GW(C,w,c.direction):0;return x.useEffect(()=>{if(u)return a.thumbs.add(u),()=>{a.thumbs.delete(u)}},[u,a.thumbs]),h.jsxs("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[c.startEdge]:`calc(${w}% + ${T}px)`},children:[h.jsx(_x.ItemSlot,{scope:t.__scopeSlider,children:h.jsx(it.span,{role:"slider","aria-label":t["aria-label"]||S,"aria-valuemin":a.min,"aria-valuenow":y,"aria-valuemax":a.max,"aria-orientation":a.orientation,"data-orientation":a.orientation,"data-disabled":a.disabled?"":void 0,tabIndex:a.disabled?void 0:0,...o,ref:p,style:y===void 0?{display:"none"}:t.style,onFocus:Ve(t.onFocus,()=>{a.valueIndexToChangeRef.current=r})})}),g&&h.jsx(X2,{name:i??(a.name?a.name+(a.values.length>1?"[]":""):void 0),form:a.form,value:y},r)]})});K2.displayName=Px;var HW="RadioBubbleInput",X2=x.forwardRef(({__scopeSlider:t,value:e,...n},r)=>{const i=x.useRef(null),o=ht(i,r),a=jp(e);return x.useEffect(()=>{const c=i.current;if(!c)return;const u=window.HTMLInputElement.prototype,p=Object.getOwnPropertyDescriptor(u,"value").set;if(a!==e&&p){const g=new Event("input",{bubbles:!0});p.call(c,e),c.dispatchEvent(g)}},[a,e]),h.jsx(it.input,{style:{display:"none"},...n,ref:o,defaultValue:e})});X2.displayName=HW;function UW(t=[],e,n){const r=[...t];return r[n]=e,r.sort((i,o)=>i-o)}function J2(t,e,n){const o=100/(n-e)*(t-e);return Nu(o,[0,100])}function VW(t,e){return e>2?`Value ${t+1} of ${e}`:e===2?["Minimum","Maximum"][t]:void 0}function qW(t,e){if(t.length===1)return 0;const n=t.map(i=>Math.abs(i-e)),r=Math.min(...n);return n.indexOf(r)}function GW(t,e,n){const r=t/2,o=N0([0,50],[0,r]);return(r-o(e)*n)*n}function WW(t){return t.slice(0,-1).map((e,n)=>t[n+1]-e)}function YW(t,e){if(e>0){const n=WW(t);return Math.min(...n)>=e}return!0}function N0(t,e){return n=>{if(t[0]===t[1]||e[0]===e[1])return e[0];const r=(e[1]-e[0])/(t[1]-t[0]);return e[0]+r*(n-t[0])}}function KW(t){return(String(t).split(".")[1]||"").length}function XW(t,e){const n=Math.pow(10,e);return Math.round(t*n)/n}var JW=H2,QW=W2,ZW=Y2,eY=K2;const Q2=x.forwardRef(({className:t,...e},n)=>h.jsxs(JW,{ref:n,className:Wt("relative flex w-full touch-none select-none items-center",t),...e,children:[h.jsx(QW,{className:"relative h-1 w-full grow overflow-hidden rounded-full bg-inputScale-2 border border-borderScale-0",children:h.jsx(ZW,{className:"absolute h-full bg-accent"})}),h.jsx(eY,{className:Wt("block h-3 w-3 rounded-full bg-white shadow","border border-borderScale-0","focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring","disabled:pointer-events-none disabled:opacity-50")})]}));Q2.displayName="Slider";var tY=Symbol("radix.slottable");function nY(t){const e=({children:n})=>h.jsx(h.Fragment,{children:n});return e.displayName=`${t}.Slottable`,e.__radixId=tY,e}var[sm]=Wr("Tooltip",[Wl]),am=Wl(),Z2="TooltipProvider",rY=700,zx="tooltip.open",[iY,A0]=sm(Z2),eR=t=>{const{__scopeTooltip:e,delayDuration:n=rY,skipDelayDuration:r=300,disableHoverableContent:i=!1,children:o}=t,a=x.useRef(!0),c=x.useRef(!1),u=x.useRef(0);return x.useEffect(()=>{const f=u.current;return()=>window.clearTimeout(f)},[]),h.jsx(iY,{scope:e,isOpenDelayedRef:a,delayDuration:n,onOpen:x.useCallback(()=>{window.clearTimeout(u.current),a.current=!1},[]),onClose:x.useCallback(()=>{window.clearTimeout(u.current),u.current=window.setTimeout(()=>a.current=!0,r)},[r]),isPointerInTransitRef:c,onPointerInTransitChange:x.useCallback(f=>{c.current=f},[]),disableHoverableContent:i,children:o})};eR.displayName=Z2;var Hu="Tooltip",[oY,sd]=sm(Hu),tR=t=>{const{__scopeTooltip:e,children:n,open:r,defaultOpen:i,onOpenChange:o,disableHoverableContent:a,delayDuration:c}=t,u=A0(Hu,t.__scopeTooltip),f=am(e),[p,g]=x.useState(null),v=Ci(),y=x.useRef(0),w=a??u.disableHoverableContent,S=c??u.delayDuration,C=x.useRef(!1),[T,N]=Di({prop:r,defaultProp:i??!1,onChange:O=>{O?(u.onOpen(),document.dispatchEvent(new CustomEvent(zx))):u.onClose(),o?.(O)},caller:Hu}),k=x.useMemo(()=>T?C.current?"delayed-open":"instant-open":"closed",[T]),D=x.useCallback(()=>{window.clearTimeout(y.current),y.current=0,C.current=!1,N(!0)},[N]),M=x.useCallback(()=>{window.clearTimeout(y.current),y.current=0,N(!1)},[N]),R=x.useCallback(()=>{window.clearTimeout(y.current),y.current=window.setTimeout(()=>{C.current=!0,N(!0),y.current=0},S)},[S,N]);return x.useEffect(()=>()=>{y.current&&(window.clearTimeout(y.current),y.current=0)},[]),h.jsx(Nb,{...f,children:h.jsx(oY,{scope:e,contentId:v,open:T,stateAttribute:k,trigger:p,onTriggerChange:g,onTriggerEnter:x.useCallback(()=>{u.isOpenDelayedRef.current?R():D()},[u.isOpenDelayedRef,R,D]),onTriggerLeave:x.useCallback(()=>{w?M():(window.clearTimeout(y.current),y.current=0)},[M,w]),onOpen:D,onClose:M,disableHoverableContent:w,children:n})})};tR.displayName=Hu;var Bx="TooltipTrigger",nR=x.forwardRef((t,e)=>{const{__scopeTooltip:n,...r}=t,i=sd(Bx,n),o=A0(Bx,n),a=am(n),c=x.useRef(null),u=ht(e,c,i.onTriggerChange),f=x.useRef(!1),p=x.useRef(!1),g=x.useCallback(()=>f.current=!1,[]);return x.useEffect(()=>()=>document.removeEventListener("pointerup",g),[g]),h.jsx(Rp,{asChild:!0,...a,children:h.jsx(it.button,{"aria-describedby":i.open?i.contentId:void 0,"data-state":i.stateAttribute,...r,ref:u,onPointerMove:Ve(t.onPointerMove,v=>{v.pointerType!=="touch"&&!p.current&&!o.isPointerInTransitRef.current&&(i.onTriggerEnter(),p.current=!0)}),onPointerLeave:Ve(t.onPointerLeave,()=>{i.onTriggerLeave(),p.current=!1}),onPointerDown:Ve(t.onPointerDown,()=>{i.open&&i.onClose(),f.current=!0,document.addEventListener("pointerup",g,{once:!0})}),onFocus:Ve(t.onFocus,()=>{f.current||i.onOpen()}),onBlur:Ve(t.onBlur,i.onClose),onClick:Ve(t.onClick,i.onClose)})})});nR.displayName=Bx;var k0="TooltipPortal",[sY,aY]=sm(k0,{forceMount:void 0}),rR=t=>{const{__scopeTooltip:e,forceMount:n,children:r,container:i}=t,o=sd(k0,e);return h.jsx(sY,{scope:e,forceMount:n,children:h.jsx(pr,{present:n||o.open,children:h.jsx(Qu,{asChild:!0,container:i,children:r})})})};rR.displayName=k0;var Pl="TooltipContent",iR=x.forwardRef((t,e)=>{const n=aY(Pl,t.__scopeTooltip),{forceMount:r=n.forceMount,side:i="top",...o}=t,a=sd(Pl,t.__scopeTooltip);return h.jsx(pr,{present:r||a.open,children:a.disableHoverableContent?h.jsx(oR,{side:i,...o,ref:e}):h.jsx(lY,{side:i,...o,ref:e})})}),lY=x.forwardRef((t,e)=>{const n=sd(Pl,t.__scopeTooltip),r=A0(Pl,t.__scopeTooltip),i=x.useRef(null),o=ht(e,i),[a,c]=x.useState(null),{trigger:u,onClose:f}=n,p=i.current,{onPointerInTransitChange:g}=r,v=x.useCallback(()=>{c(null),g(!1)},[g]),y=x.useCallback((w,S)=>{const C=w.currentTarget,T={x:w.clientX,y:w.clientY},N=hY(T,C.getBoundingClientRect()),k=pY(T,N),D=mY(S.getBoundingClientRect()),M=yY([...k,...D]);c(M),g(!0)},[g]);return x.useEffect(()=>()=>v(),[v]),x.useEffect(()=>{if(u&&p){const w=C=>y(C,p),S=C=>y(C,u);return u.addEventListener("pointerleave",w),p.addEventListener("pointerleave",S),()=>{u.removeEventListener("pointerleave",w),p.removeEventListener("pointerleave",S)}}},[u,p,y,v]),x.useEffect(()=>{if(a){const w=S=>{const C=S.target,T={x:S.clientX,y:S.clientY},N=u?.contains(C)||p?.contains(C),k=!gY(T,a);N?v():k&&(v(),f())};return document.addEventListener("pointermove",w),()=>document.removeEventListener("pointermove",w)}},[u,p,a,f,v]),h.jsx(oR,{...t,ref:o})}),[cY,uY]=sm(Hu,{isInside:!1}),dY=nY("TooltipContent"),oR=x.forwardRef((t,e)=>{const{__scopeTooltip:n,children:r,"aria-label":i,onEscapeKeyDown:o,onPointerDownOutside:a,...c}=t,u=sd(Pl,n),f=am(n),{onClose:p}=u;return x.useEffect(()=>(document.addEventListener(zx,p),()=>document.removeEventListener(zx,p)),[p]),x.useEffect(()=>{if(u.trigger){const g=v=>{v.target?.contains(u.trigger)&&p()};return window.addEventListener("scroll",g,{capture:!0}),()=>window.removeEventListener("scroll",g,{capture:!0})}},[u.trigger,p]),h.jsx(Xu,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:o,onPointerDownOutside:a,onFocusOutside:g=>g.preventDefault(),onDismiss:p,children:h.jsxs(Ab,{"data-state":u.stateAttribute,...f,...c,ref:e,style:{...c.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[h.jsx(dY,{children:r}),h.jsx(cY,{scope:n,isInside:!0,children:h.jsx(UB,{id:u.contentId,role:"tooltip",children:i||r})})]})})});iR.displayName=Pl;var sR="TooltipArrow",fY=x.forwardRef((t,e)=>{const{__scopeTooltip:n,...r}=t,i=am(n);return uY(sR,n).isInside?null:h.jsx(kb,{...i,...r,ref:e})});fY.displayName=sR;function hY(t,e){const n=Math.abs(e.top-t.y),r=Math.abs(e.bottom-t.y),i=Math.abs(e.right-t.x),o=Math.abs(e.left-t.x);switch(Math.min(n,r,i,o)){case o:return"left";case i:return"right";case n:return"top";case r:return"bottom";default:throw new Error("unreachable")}}function pY(t,e,n=5){const r=[];switch(e){case"top":r.push({x:t.x-n,y:t.y+n},{x:t.x+n,y:t.y+n});break;case"bottom":r.push({x:t.x-n,y:t.y-n},{x:t.x+n,y:t.y-n});break;case"left":r.push({x:t.x+n,y:t.y-n},{x:t.x+n,y:t.y+n});break;case"right":r.push({x:t.x-n,y:t.y-n},{x:t.x-n,y:t.y+n});break}return r}function mY(t){const{top:e,right:n,bottom:r,left:i}=t;return[{x:i,y:e},{x:n,y:e},{x:n,y:r},{x:i,y:r}]}function gY(t,e){const{x:n,y:r}=t;let i=!1;for(let o=0,a=e.length-1;o<e.length;a=o++){const c=e[o],u=e[a],f=c.x,p=c.y,g=u.x,v=u.y;p>r!=v>r&&n<(g-f)*(r-p)/(v-p)+f&&(i=!i)}return i}function yY(t){const e=t.slice();return e.sort((n,r)=>n.x<r.x?-1:n.x>r.x?1:n.y<r.y?-1:n.y>r.y?1:0),vY(e)}function vY(t){if(t.length<=1)return t.slice();const e=[];for(let r=0;r<t.length;r++){const i=t[r];for(;e.length>=2;){const o=e[e.length-1],a=e[e.length-2];if((o.x-a.x)*(i.y-a.y)>=(o.y-a.y)*(i.x-a.x))e.pop();else break}e.push(i)}e.pop();const n=[];for(let r=t.length-1;r>=0;r--){const i=t[r];for(;n.length>=2;){const o=n[n.length-1],a=n[n.length-2];if((o.x-a.x)*(i.y-a.y)>=(o.y-a.y)*(i.x-a.x))n.pop();else break}n.push(i)}return n.pop(),e.length===1&&n.length===1&&e[0].x===n[0].x&&e[0].y===n[0].y?e:e.concat(n)}var xY=eR,bY=tR,wY=nR,SY=rR,EY=iR;const D0=xY,CY=bY,TY=wY,aR=x.forwardRef(function({className:e,sideOffset:n=6,...r},i){return h.jsx(SY,{children:h.jsx(EY,{ref:i,sideOffset:n,className:Wt("z-50 max-w-[240px] rounded-md border border-border bg-background px-2 py-1 text-[11px] text-foreground shadow-md","animate-in fade-in-0 zoom-in-95","data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95",e),...r})})});aR.displayName="TooltipContent";function lR({children:t,variant:e="pill",size:n="sm",className:r,side:i="top",sideOffset:o=6,delayDuration:a=150}){const c=n==="md"?"h-5 w-5 text-[11px]":"h-4 w-4 text-[10px]";return h.jsx(D0,{delayDuration:a,children:h.jsxs(CY,{children:[h.jsx(TY,{asChild:!0,children:h.jsx("span",{className:Wt("inline-flex items-center justify-center rounded-full cursor-help select-none","border border-border bg-muted text-muted-foreground","hover:bg-accent hover:text-accent-foreground",c,r),children:"?"})}),h.jsx(aR,{side:i,sideOffset:o,children:t})]})})}function ot({schema:t,value:e,onChange:n}){const r=t??{},i=r.type,o=(f,p)=>{n?.({...e??{},[f]:p})},a=(f,p=0)=>{const g=Number(f);return Number.isFinite(g)?g:p},c=()=>r.description?h.jsx(D0,{children:h.jsx("div",{className:"flex justify-end pt-[2px]",children:h.jsx(lR,{children:r.description})})}):null;if(i==="button")return h.jsx("div",{className:r.className,children:h.jsxs("div",{className:"flex items-center justify-between gap-2",children:[h.jsx(_e,{type:"button",variant:r.buttonVariant??"default",size:r.buttonSize??"sm",disabled:r.disabled,onClick:()=>r.onAction?.({value:e}),children:r.label??"Action"}),c()]})});if(!r.key)return h.jsxs("div",{className:"text-xs text-red-500",children:["FormInput schema missing ",h.jsx("code",{children:"key"})]});const u=e?.[r.key];if(i==="text-input")return h.jsxs("div",{className:`${r.className??""} text-xs`,children:[(r.label||r.description)&&h.jsxs("div",{style:{minHeight:"18px"},className:"flex items-center justify-between gap-2",children:[r.label&&h.jsx(tt,{children:r.label}),c()]}),h.jsx(Kt,{type:"text",value:u??"",placeholder:r.placeholder,disabled:r.disabled,onChange:f=>o(r.key,f.target.value),onKeyDown:r.onKeyDown,onBlur:r.onBlur,onFocus:r.onFocus})]});if(i==="number-input")return h.jsxs("div",{className:`${r.className??""}`,children:[(r.label||r.description)&&h.jsxs("div",{style:{minHeight:"18px"},className:"flex items-center justify-between gap-2",children:[r.label&&h.jsx(tt,{children:r.label}),c()]}),h.jsx(Kt,{type:"number",value:Number.isFinite(u)?u:u??0,min:r.min,max:r.max,step:r.step,placeholder:r.placeholder,disabled:r.disabled,onChange:f=>o(r.key,a(f.target.value,u??0)),onKeyDown:r.onKeyDown,onBlur:r.onBlur,onFocus:r.onFocus})]});if(i==="select"){const f=r.options??[];return h.jsxs("div",{className:`${r.className??""}`,children:[(r.label||r.description)&&h.jsxs("div",{style:{minHeight:"18px"},className:"flex items-center justify-between gap-2",children:[r.label&&h.jsx(tt,{children:r.label}),c()]}),h.jsxs(Pt,{value:u??void 0,onValueChange:p=>o(r.key,p),disabled:r.disabled,children:[h.jsx(zt,{className:"w-full",children:h.jsx(Bt,{placeholder:r.placeholder??"Select"})}),h.jsx(Ft,{...r.contentProps??{},children:f.map(p=>h.jsx(wt,{value:p.value,children:p.label},p.value))})]})]})}if(i==="toggle"){const f=!!u;return h.jsxs("div",{className:`${r.className??""}`,children:[h.jsxs("div",{style:{minHeight:"18px"},className:"flex items-center gap-2",children:[r.label&&h.jsx(tt,{children:r.label}),c()]}),h.jsx(od,{checked:f,disabled:r.disabled,onCheckedChange:p=>o(r.key,!!p)})]})}if(i==="checkbox"){const f=!!u;return h.jsx("div",{className:`${r.className??""}`,children:h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx(T0,{checked:f,disabled:r.disabled,onCheckedChange:p=>o(r.key,!!p)}),h.jsxs("div",{className:"flex items-center gap-2",children:[r.label&&h.jsx(tt,{children:r.label}),c()]})]})})}if(i==="slider"){const f=a(r.sliderMin??r.min,0),p=a(r.sliderMax??r.max,100),g=a(r.sliderStep??r.step,1),v=r.showValue!==!1,y=r.valueSuffix??"",w=Number.isFinite(Number(u))?Number(u):a(u,f),S=Math.min(p,Math.max(f,w));return h.jsxs("div",{className:`${r.className??""}`,children:[h.jsxs("div",{className:"flex items-center justify-between gap-3",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[r.label&&h.jsx(tt,{children:r.label}),c()]}),v&&h.jsxs("div",{className:"text-[11px] text-foregroundScale-2 tabular-nums",children:[S,y]})]}),h.jsx("div",{className:"pt-2",children:h.jsx(Q2,{disabled:r.disabled,min:f,max:p,step:g,value:[S],onValueChange:C=>{const T=Array.isArray(C)?C[0]:C;o(r.key,a(T,S))}})})]})}return h.jsxs("div",{className:"text-xs text-red-500",children:["Unknown FormInput type: ",h.jsx("code",{children:String(i)})]})}const NY=Object.entries(ch).map(([t,e])=>({value:t,label:e.label,description:e.description,icon:e.icon}));function O0({occurrence:t,onUpdate:e,entityType:n="instance",compact:r=!1}){const i=t?.iteration?.mode||"specific",o=c=>{e?.({iteration:{...t?.iteration||{},mode:c}})},a=c=>{const u=ch[c];if(!u)return"";if(n==="panel")switch(c){case"persistent":return"Panel shows on all days/weeks/months";case"specific":return"Panel only shows on its specific date";case"untilDone":return"Panel shows until all items are completed";default:return u.description}if(n==="container")switch(c){case"persistent":return"Container shows on all iterations (category list)";case"specific":return"Container only shows on its specific date";case"untilDone":return"Container shows until completed";default:return u.description}switch(c){case"persistent":return"Template - always available to copy from";case"specific":return"Only exists on this specific date";case"untilDone":return"Shows daily until checked off, then stays on completion date";default:return u.description}};return h.jsxs("div",{className:r?"space-y-1":"space-y-2",children:[h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsx(tt,{className:r?"text-[10px]":"text-xs",children:"Iteration Mode"}),h.jsxs("span",{className:`${r?"text-[9px]":"text-[10px]"} opacity-70`,children:[ch[i]?.icon," ",ch[i]?.label]})]}),h.jsxs(Pt,{value:i,onValueChange:o,children:[h.jsx(zt,{className:r?"h-7 text-xs":"h-8 text-sm",children:h.jsx(Bt,{})}),h.jsx(Ft,{children:NY.map(c=>h.jsx(wt,{value:c.value,children:h.jsxs("span",{className:"flex items-center gap-2",children:[h.jsx("span",{children:c.icon}),h.jsx("span",{children:c.label})]})},c.value))})]}),h.jsx("p",{className:`${r?"text-[9px]":"text-[10px]"} text-muted-foreground/80`,children:a(i)})]})}const GN={bg:null,textColor:null,border:null,borderRadius:null,opacity:null,fontSize:null,padding:null};function Fx(t,e){if(!e)return t||null;if(!t)return e;const n={},r=new Set([...Object.keys(t),...Object.keys(e)]);for(const i of r){const o=e[i];n[i]=o??t[i]??null}return n}function AY(t,e){const n=e?.childContainerStyle||null;return t?.styleMode==="own"&&t?.ownStyle?Fx(n,t.ownStyle):n}function kY(t,e,n){let r=n?.childInstanceStyle||null;return e?.childInstanceStyle&&(r=Fx(r,e.childInstanceStyle)),t?.styleMode==="own"&&t?.ownStyle?Fx(r,t.ownStyle):r}function cR(t){if(!t)return{};const e={};return t.bg!=null&&(e.backgroundColor=t.bg),t.textColor!=null&&(e.color=t.textColor),t.border!=null&&(e.border=t.border),t.borderRadius!=null&&(e.borderRadius=t.borderRadius),t.opacity!=null&&(e.opacity=t.opacity),t.fontSize!=null&&(e.fontSize=t.fontSize),t.padding!=null&&(e.padding=t.padding),e}const DY=[{value:null,label:"None",swatch:"transparent"},{value:"rgba(59,130,246,0.15)",label:"Blue",swatch:"rgba(59,130,246,0.5)"},{value:"rgba(34,197,94,0.15)",label:"Green",swatch:"rgba(34,197,94,0.5)"},{value:"rgba(168,85,247,0.15)",label:"Purple",swatch:"rgba(168,85,247,0.5)"},{value:"rgba(249,115,22,0.15)",label:"Orange",swatch:"rgba(249,115,22,0.5)"},{value:"rgba(236,72,153,0.15)",label:"Pink",swatch:"rgba(236,72,153,0.5)"},{value:"rgba(234,179,8,0.15)",label:"Yellow",swatch:"rgba(234,179,8,0.5)"},{value:"rgba(20,184,166,0.15)",label:"Teal",swatch:"rgba(20,184,166,0.5)"},{value:"rgba(239,68,68,0.15)",label:"Red",swatch:"rgba(239,68,68,0.5)"}],OY=[{value:null,label:"Default"},{value:"#ffffff",label:"White"},{value:"#94a3b8",label:"Slate"},{value:"#60a5fa",label:"Blue"},{value:"#4ade80",label:"Green"},{value:"#c084fc",label:"Purple"},{value:"#fb923c",label:"Orange"},{value:"#f472b6",label:"Pink"},{value:"#fbbf24",label:"Yellow"}],MY=[{value:null,label:"Default"},{value:"10px",label:"10px"},{value:"11px",label:"11px"},{value:"12px",label:"12px"},{value:"13px",label:"13px"},{value:"14px",label:"14px"},{value:"16px",label:"16px"}],RY=[{value:null,label:"Default"},{value:"0px",label:"None"},{value:"4px",label:"4px"},{value:"8px",label:"8px"},{value:"12px",label:"12px"},{value:"16px",label:"16px"}],jY=[{value:null,label:"Default"},{value:"0px",label:"None"},{value:"4px",label:"4px"},{value:"8px",label:"8px"},{value:"12px",label:"12px"},{value:"16px",label:"16px"}];function Uu({styleMode:t="inherit",ownStyle:e,onStyleModeChange:n,onOwnStyleChange:r,label:i="Style",inheritLabel:o="Parent"}){const a=e||{...GN},c=x.useCallback((f,p)=>{r?.({...a,[f]:p})},[a,r]),u=t==="own";return h.jsxs("div",{className:"py-2",children:[h.jsxs("div",{className:"flex items-center justify-between mb-2",children:[h.jsx("h4",{className:"text-xs font-semibold text-foregroundScale-2",children:i}),h.jsxs(Pt,{value:t,onValueChange:n,children:[h.jsx(zt,{className:"h-6 text-[10px] w-[100px]",children:h.jsx(Bt,{})}),h.jsxs(Ft,{children:[h.jsx(wt,{value:"inherit",children:"Inherit"}),h.jsx(wt,{value:"own",children:"Own"})]})]})]}),!u&&h.jsxs("p",{className:"text-[10px] text-foregroundScale-2/80",children:["Inherits style from ",o,"."]}),u&&h.jsxs("div",{className:"space-y-2.5 mt-1",children:[h.jsxs("div",{children:[h.jsx(tt,{className:"text-[10px] text-muted-foreground",children:"Background"}),h.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:DY.map(f=>h.jsx("button",{type:"button",className:"w-5 h-5 rounded border border-border hover:ring-1 hover:ring-ring transition-all",style:{backgroundColor:f.swatch,outline:a.bg===f.value?"2px solid rgba(59,130,246,0.8)":"none",outlineOffset:1},title:f.label,onClick:()=>c("bg",f.value)},f.label))}),h.jsx(Kt,{type:"text",value:a.bg||"",onChange:f=>c("bg",f.target.value||null),placeholder:"Custom: rgba(...) or #hex",className:"h-6 text-[10px] mt-1"})]}),h.jsxs("div",{children:[h.jsx(tt,{className:"text-[10px] text-muted-foreground",children:"Text Color"}),h.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:OY.map(f=>h.jsx("button",{type:"button",className:"w-5 h-5 rounded border border-border hover:ring-1 hover:ring-ring transition-all",style:{backgroundColor:f.value||"transparent",outline:a.textColor===f.value?"2px solid rgba(59,130,246,0.8)":"none",outlineOffset:1},title:f.label,onClick:()=>c("textColor",f.value)},f.label))})]}),h.jsxs("div",{children:[h.jsx(tt,{className:"text-[10px] text-muted-foreground",children:"Border"}),h.jsx(Kt,{type:"text",value:a.border||"",onChange:f=>c("border",f.target.value||null),placeholder:"e.g. 1px solid #444",className:"h-6 text-[10px]"})]}),h.jsxs("div",{children:[h.jsx(tt,{className:"text-[10px] text-muted-foreground",children:"Border Radius"}),h.jsxs(Pt,{value:a.borderRadius||"__default",onValueChange:f=>c("borderRadius",f==="__default"?null:f),children:[h.jsx(zt,{className:"h-6 text-[10px]",children:h.jsx(Bt,{})}),h.jsx(Ft,{children:jY.map(f=>h.jsx(wt,{value:f.value||"__default",children:f.label},f.label))})]})]}),h.jsxs("div",{children:[h.jsxs(tt,{className:"text-[10px] text-muted-foreground",children:["Opacity: ",a.opacity!=null?a.opacity:"default"]}),h.jsx("input",{type:"range",min:"0",max:"1",step:"0.05",value:a.opacity??1,onChange:f=>{const p=parseFloat(f.target.value);c("opacity",p===1?null:p)},className:"w-full h-4 accent-blue-500"})]}),h.jsxs("div",{children:[h.jsx(tt,{className:"text-[10px] text-muted-foreground",children:"Font Size"}),h.jsxs(Pt,{value:a.fontSize||"__default",onValueChange:f=>c("fontSize",f==="__default"?null:f),children:[h.jsx(zt,{className:"h-6 text-[10px]",children:h.jsx(Bt,{})}),h.jsx(Ft,{children:MY.map(f=>h.jsx(wt,{value:f.value||"__default",children:f.label},f.label))})]})]}),h.jsxs("div",{children:[h.jsx(tt,{className:"text-[10px] text-muted-foreground",children:"Padding"}),h.jsxs(Pt,{value:a.padding||"__default",onValueChange:f=>c("padding",f==="__default"?null:f),children:[h.jsx(zt,{className:"h-6 text-[10px]",children:h.jsx(Bt,{})}),h.jsx(Ft,{children:RY.map(f=>h.jsx(wt,{value:f.value||"__default",children:f.label},f.label))})]})]}),h.jsx(_e,{type:"button",variant:"ghost",size:"sm",className:"text-[10px] h-6 w-full",onClick:()=>r?.({...GN}),children:"Reset All"})]})]})}const IY=[{id:"grid-cards",label:"Grid Cards",Icon:ub,hint:"Responsive dashboard grid",description:"Responsive card grid. Uses auto-fill columns (based on Min width) so items wrap into as many columns as fit.",autoFill:!0,values:{display:"grid",flow:"row",columns:0,rows:0,widthMode:"auto",minWidthPx:0,maxWidthPx:0,heightMode:"auto",minHeightPx:0,maxHeightPx:0,alignItems:"start",alignContent:"start",justify:"start",wrap:"wrap",gapPx:12,gapPreset:"md",scrollX:"none",scrollY:"auto",scrollType:"auto"}},{id:"h-scroll-row",label:"H Scroll",Icon:UP,hint:"Single row, scroll sideways",description:"One horizontal row (no wrap). Items keep a fixed width and you scroll sideways to see more.",autoFill:!1,values:{display:"flex",flow:"row",wrap:"nowrap",columns:0,rows:0,widthMode:"fixed",fixedWidth:280,minWidthPx:0,maxWidthPx:0,heightMode:"auto",minHeightPx:0,maxHeightPx:0,alignItems:"start",alignContent:"start",justify:"start",gapPx:12,gapPreset:"md",scrollX:"always",scrollY:"none",scrollType:"always"}},{id:"v-stack",label:"V Stack",Icon:KP,hint:"Classic vertical list",description:"Classic vertical list. Full-width items stacked top  bottom with vertical scrolling.",autoFill:!1,values:{display:"flex",flow:"col",wrap:"wrap",columns:0,rows:0,widthMode:"auto",minWidthPx:0,maxWidthPx:0,heightMode:"auto",minHeightPx:0,maxHeightPx:0,alignItems:"stretch",alignContent:"start",justify:"start",gapPx:8,gapPreset:"sm",scrollX:"none",scrollY:"auto",scrollType:"auto"}},{id:"schedule",label:"Schedule",Icon:FP,hint:"Full-width column list",description:"Vertical list with full-width containers, tight spacing, ideal for schedule/timeline layouts.",autoFill:!1,values:{display:"flex",flow:"col",wrap:"nowrap",columns:0,rows:0,widthMode:"auto",minWidthPx:0,maxWidthPx:0,heightMode:"auto",minHeightPx:0,maxHeightPx:0,alignItems:"stretch",alignContent:"start",justify:"start",gapPx:2,gapPreset:"none",padding:"none",scrollX:"none",scrollY:"auto",scrollType:"auto"}},{id:"grid-3col",label:"3 Columns",Icon:h3,hint:"Exactly 3 columns",description:"Locked column count. Always exactly 3 columns, regardless of viewport width (items resize within those tracks).",autoFill:!1,values:{display:"grid",flow:"row",columns:3,rows:0,widthMode:"auto",minWidthPx:0,maxWidthPx:0,heightMode:"auto",minHeightPx:0,maxHeightPx:0,alignItems:"stretch",alignContent:"start",justify:"start",gapPx:12,gapPreset:"md",scrollX:"none",scrollY:"auto",scrollType:"auto"}},{id:"masonryish",label:"Masonry-ish",Icon:tC,hint:"Dense packed feel",description:"Auto-fill grid with a larger Min width for Pinterest-ish density. Note: this is not true masonry (CSS Grid wont stack into columns by height).",autoFill:!0,values:{display:"grid",flow:"row",columns:0,rows:0,widthMode:"auto",minWidthPx:220,maxWidthPx:0,heightMode:"auto",minHeightPx:0,maxHeightPx:0,alignItems:"start",alignContent:"start",justify:"start",gapPx:8,gapPreset:"sm",dense:!0,scrollX:"none",scrollY:"auto",scrollType:"auto"}},{id:"masonry-columns",label:"Masonry",Icon:tC,hint:"True column masonry (CSS columns)",description:"True masonry via CSS columns. Items flow topbottom per column (no shared grid rows).",autoFill:!0,values:{display:"columns",flow:"col",columns:0,rows:0,widthMode:"auto",minWidthPx:220,maxWidthPx:0,heightMode:"auto",minHeightPx:0,maxHeightPx:0,alignItems:"start",alignContent:"start",justify:"start",wrap:"wrap",gapPx:8,gapPreset:"sm",dense:!0,scrollX:"none",scrollY:"auto",scrollType:"auto"}}];function _Y(t,e){const n=t?.name??"";return{...t,...e,name:n}}function _t(t){const e=t??{},n=e?.lock??{};return{...e,lock:{enabled:n?.enabled??!1,containersDrag:n?.containersDrag??!0,containersDrop:n?.containersDrop??!0,instancesDrag:n?.instancesDrag??!0,instancesDrop:n?.instancesDrop??!0}}}const LY=[{value:"inherit",label:"Inherit from Grid"},{value:"own",label:"Use own iteration"}],PY=[{value:"daily",label:"Daily"},{value:"weekly",label:"Weekly"},{value:"monthly",label:"Monthly"},{value:"yearly",label:"Yearly"}],zY=[{value:"move",label:"Move (relocate occurrence)"},{value:"copy",label:"Copy (create new occurrence)"},{value:"copylink",label:"Copylink (linked occurrence)"}];function BY({value:t,onChange:e,onCommit:n,onDeletePanel:r,panelId:i,panel:o,onPanelStyleUpdate:a,iteration:c,onIterationChange:u,defaultDragMode:f,onDragModeChange:p,occurrence:g,onOccurrenceUpdate:v,currentViewType:y,onViewTypeChange:w}){const S=_t(t),C=c||{mode:"inherit",timeFilter:"daily"},T=S?.display??"grid",N=S?.flow??"row",k=T==="grid",D=T==="flex",M=T==="columns",R=k||M,O=[{value:"0",label:"Auto"},...Array.from({length:12},(j,G)=>{const oe=G+1;return{value:String(oe),label:String(oe)}})],I=D&&N==="row",z=S?.widthMode??"auto",U=S?.heightMode??"auto",Y=j=>{e?.({...S,lock:{...S.lock,...j}})},W=!!S?.lock?.enabled;return h.jsxs("div",{className:"font-mono max-h-[70vh] overflow-y-auto pr-1 text-xs space-y-2",children:[h.jsx("h4",{className:"text-sm font-semibold text-white",children:"Panel Settings"}),h.jsx(ot,{schema:{type:"text-input",key:"name",label:"Name",placeholder:"Panel layout name",onKeyDown:j=>{j.key==="Enter"&&(j.preventDefault(),j.currentTarget.blur())},onBlur:()=>{n?.(_t(S))}},value:S,onChange:j=>e?.(_t(j))}),w&&h.jsxs("div",{className:"space-y-1",children:[h.jsx("label",{className:"text-[10px] text-muted-foreground font-semibold uppercase",children:"View Type"}),h.jsxs("select",{value:y||"list",onChange:w,className:"w-full text-xs bg-muted border border-border rounded px-2 py-1 text-foreground focus:outline-none focus:ring-1 focus:ring-ring cursor-pointer",children:[h.jsx("option",{value:"list",children:"List"}),h.jsx("option",{value:"notebook",children:"Notebook"}),h.jsx("option",{value:"artifact-viewer",children:"Artifact Viewer"}),h.jsx("option",{value:"doc-viewer",children:"Doc Viewer"}),h.jsx("option",{value:"file-manager",children:"File Manager"})]})]}),h.jsx(Rt,{}),h.jsx(Uu,{styleMode:o?.childContainerStyle?"own":"inherit",ownStyle:o?.childContainerStyle,onStyleModeChange:j=>{j==="inherit"&&a?.({childContainerStyle:null})},onOwnStyleChange:j=>a?.({childContainerStyle:j}),label:"Container Defaults",inheritLabel:"Theme"}),h.jsx(Rt,{}),h.jsx(Uu,{styleMode:o?.childInstanceStyle?"own":"inherit",ownStyle:o?.childInstanceStyle,onStyleModeChange:j=>{j==="inherit"&&a?.({childInstanceStyle:null})},onOwnStyleChange:j=>a?.({childInstanceStyle:j}),label:"Instance Defaults",inheritLabel:"Theme"}),h.jsx(Rt,{}),h.jsxs("div",{className:"pt-2",children:[h.jsx("h4",{className:"text-xs font-semibold text-red-400",children:"Danger zone"}),h.jsx("p",{className:"text-[10px] text-foregroundScale-2/80 mt-1",children:"This deletes the panel and all UI inside it (containers/instances will be orphaned unless your backend cascades)."}),h.jsx("div",{className:"mt-2",children:h.jsx(_e,{type:"button",variant:"destructive",size:"sm",onClick:()=>{window.confirm(`Delete this panel${i?` (${i})`:""}? This cannot be undone.`)&&r?.()},disabled:!r,children:"Delete panel"})})]}),h.jsx(Rt,{}),h.jsxs("div",{className:"pt-2",children:[h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsx("h4",{className:"text-xs font-semibold text-foregroundScale-2",children:"Lock"}),h.jsx("span",{className:"text-[10px] opacity-70",children:"Drag/drop permissions"})]}),h.jsxs("div",{className:"mt-2 grid grid-cols-2 gap-2",children:[h.jsx(ot,{schema:{type:"toggle",key:"__lockEnabled",label:"Lock panel interactions",description:"When enabled, the options below decide what dragging/dropping is allowed inside this panel."},value:{__lockEnabled:W},onChange:j=>Y({enabled:!!j?.__lockEnabled})}),h.jsx("div",{className:"text-[10px] leading-snug text-foregroundScale-2/80 border border-borderScale-0/40 rounded-md p-2",children:"Tip: you can freeze a panel by turning off drag/drop for both Containers and Instances."})]}),h.jsxs("div",{className:Wt("mt-2 grid grid-cols-2 gap-2",!W&&"opacity-60"),children:[h.jsx(ot,{schema:{type:"toggle",key:"__containersDrag",label:"Containers can drag",description:"Allow reordering / moving containers."},value:{__containersDrag:!!S.lock.containersDrag},onChange:j=>Y({containersDrag:!!j?.__containersDrag}),disabled:!W}),h.jsx(ot,{schema:{type:"toggle",key:"__containersDrop",label:"Containers can drop",description:"Allow dropping containers into this panel."},value:{__containersDrop:!!S.lock.containersDrop},onChange:j=>Y({containersDrop:!!j?.__containersDrop}),disabled:!W}),h.jsx(ot,{schema:{type:"toggle",key:"__instancesDrag",label:"Instances can drag",description:"Allow dragging instances within/between containers."},value:{__instancesDrag:!!S.lock.instancesDrag},onChange:j=>Y({instancesDrag:!!j?.__instancesDrag}),disabled:!W}),h.jsx(ot,{schema:{type:"toggle",key:"__instancesDrop",label:"Instances can drop",description:"Allow dropping instances into this panel/containers."},value:{__instancesDrop:!!S.lock.instancesDrop},onChange:j=>Y({instancesDrop:!!j?.__instancesDrop}),disabled:!W})]})]}),h.jsx(Rt,{}),h.jsxs("div",{className:"pt-2",children:[h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsx("h4",{className:"text-xs font-semibold text-foregroundScale-2",children:"Iteration"}),h.jsx("span",{className:"text-[10px] opacity-70",children:"Time-based filtering"})]}),h.jsxs("div",{className:"mt-2 grid grid-cols-2 gap-2",children:[h.jsx(ot,{schema:{type:"select",key:"__iterMode",label:"Mode",options:LY,description:"Inherit uses the grid's current iteration. Own sets a specific time filter for this panel."},value:{__iterMode:C.mode||"inherit"},onChange:j=>u?.({...C,mode:j?.__iterMode||"inherit"})}),C.mode==="own"&&h.jsx(ot,{schema:{type:"select",key:"__iterTimeFilter",label:"Time Filter",options:PY,description:"How occurrences are grouped for this panel."},value:{__iterTimeFilter:C.timeFilter||"daily"},onChange:j=>u?.({...C,timeFilter:j?.__iterTimeFilter||"daily"})})]}),C.mode==="inherit"&&h.jsx("p",{className:"mt-2 text-[10px] text-foregroundScale-2/80",children:"This panel inherits iteration settings from the grid. Change the grid's iteration to affect this panel's time filtering."})]}),h.jsx(Rt,{}),h.jsxs("div",{className:"pt-2",children:[h.jsx("h4",{className:"text-xs font-semibold text-foregroundScale-2 mb-2",children:"Drag Behavior"}),h.jsx(ot,{schema:{type:"select",key:"__defaultDragMode",label:"Default Mode",options:zY,description:"Default behavior when dragging this panel."},value:{__defaultDragMode:f||"move"},onChange:j=>p?.(j?.__defaultDragMode||"move")})]}),h.jsx(Rt,{}),g&&h.jsxs(h.Fragment,{children:[h.jsxs("div",{className:"pt-2",children:[h.jsx("h4",{className:"text-xs font-semibold text-foregroundScale-2 mb-2",children:"Persistence"}),h.jsx(O0,{occurrence:g,onUpdate:v,entityType:"panel",compact:!0})]}),h.jsx(Rt,{})]}),h.jsxs("div",{className:"pt-2",children:[h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsx("h4",{className:"text-xs font-semibold text-foregroundScale-2",children:"Presets"}),h.jsx("span",{className:"text-[10px] opacity-70",children:"Tap to autofill"})]}),h.jsx(D0,{children:h.jsx("div",{className:"mt-2 grid grid-cols-3 gap-1",children:IY.map(j=>{const G=j.Icon,oe=S?.presetId===j.id;return h.jsx("div",{className:"flex flex-col gap-1",children:h.jsxs("div",{className:"flex items-start",children:[h.jsxs(_e,{type:"button",variant:oe?"secondary":"ghost",size:"sm",className:Wt("h-10 px-2 flex-1 flex flex-col items-center justify-center gap-1","rounded-md border border-borderScale-0/40"),onClick:()=>{e?.(_t(_Y({...S,presetId:j.id},j.values)))},children:[h.jsx(G,{className:"h-4 w-4"}),h.jsx("span",{className:"text-[9px] leading-none",children:j.label})]}),h.jsx(lR,{size:"sm",children:h.jsxs("div",{className:"space-y-1",children:[h.jsx("div",{className:"text-[11px] font-semibold",children:j.label}),j.hint&&h.jsx("div",{className:"text-[10px] text-muted-foreground",children:j.hint}),j.description&&h.jsx("div",{className:"text-[11px] leading-snug",children:j.description}),h.jsxs("div",{className:"pt-1 text-[10px] text-muted-foreground",children:["Auto-fill:"," ",h.jsx("span",{className:"text-foreground",children:j.autoFill?"Yes":"No"})]})]})})]})},j.id)})})}),h.jsx("p",{className:"mt-2 text-[11px] text-foregroundScale-2",children:"Presets set a known-good combo. Everything below still works as overrides."}),h.jsxs("p",{className:"mt-1 text-[10px] text-foregroundScale-2/80",children:["In your ",h.jsx("span",{className:"text-foregroundScale-1",children:"ListWrapper"}),","," ",h.jsx("span",{className:"text-foregroundScale-1",children:"Columns = Auto (0)"})," uses"," ",h.jsx("span",{className:"text-foregroundScale-1",children:"repeat(auto-fill, minmax(MinWidth, ...))"}),". Thats the autofill behavior for Grid."]}),h.jsxs("p",{className:"mt-1 text-[10px] text-foregroundScale-2/80",children:["For ",h.jsx("span",{className:"text-foregroundScale-1",children:"Masonry (Columns)"}),","," ",h.jsx("span",{className:"text-foregroundScale-1",children:"Columns = Auto (0)"})," uses"," ",h.jsx("span",{className:"text-foregroundScale-1",children:"column-width"})," (based on Min width), and items flow topbottom per column."]})]}),h.jsx(Rt,{}),h.jsx(ot,{schema:{type:"select",key:"display",label:"Display",options:[{value:"grid",label:"Grid"},{value:"flex",label:"Flex"},{value:"columns",label:"Masonry (Columns)"}]},value:S,onChange:j=>{const G=j?.display??"grid",oe=_t({...j,display:G});if(G==="grid"||G==="columns"){e?.({...oe,columns:Number.isFinite(Number(oe.columns))?Number(oe.columns):0});return}e?.({...oe,wrap:oe.wrap??"wrap"})}}),h.jsx(ot,{schema:{type:"select",key:"flow",label:"Flow direction",options:[{value:"row",label:"Row (left  right)"},{value:"col",label:"Column (top  bottom)"}]},value:S,onChange:j=>e?.(_t(j))}),I&&h.jsx(ot,{schema:{type:"select",key:"wrap",label:"Wrap",options:[{value:"wrap",label:"Wrap"},{value:"nowrap",label:"No wrap"}],description:"Only applies to Flex + Row flow."},value:S,onChange:j=>e?.(_t(j))}),h.jsx(Rt,{}),h.jsxs("div",{className:"grid pt-[5px] grid-cols-2 gap-2",children:[h.jsx(ot,{schema:{type:"select",key:"widthMode",label:"Width mode",options:[{value:"auto",label:"Auto"},{value:"fixed",label:"Fixed"}]},value:S,onChange:j=>e?.(_t(j))}),z==="fixed"?h.jsx(ot,{schema:{type:"number-input",key:"fixedWidth",label:"Fixed width (px)",min:120,max:4e3,description:"Sets list width directly."},value:S,onChange:j=>e?.(_t(j))}):h.jsx(ot,{schema:{type:"number-input",key:"minWidthPx",label:"Min width (px)",min:0,max:4e3,description:M?"0 = none (auto). In columns mode this is the column-width baseline.":"0 = none (auto)."},value:S,onChange:j=>e?.(_t(j))}),h.jsx(ot,{schema:{type:"number-input",key:"maxWidthPx",label:"Max width (px)",min:0,max:8e3,description:z==="fixed"?"Optional clamp. 0 = none.":"0 = none."},value:S,onChange:j=>e?.(_t(j))})]}),h.jsxs("div",{className:"grid pt-[5px] grid-cols-2 gap-2",children:[h.jsx(ot,{schema:{type:"select",key:"heightMode",label:"Height mode",options:[{value:"auto",label:"Auto"},{value:"fixed",label:"Fixed"}]},value:S,onChange:j=>e?.(_t(j))}),U==="fixed"?h.jsx(ot,{schema:{type:"number-input",key:"fixedHeight",label:"Fixed height (px)",min:0,max:8e3,description:"Sets list height directly. 0 = none."},value:S,onChange:j=>e?.(_t(j))}):h.jsx(ot,{schema:{type:"number-input",key:"minHeightPx",label:"Min height (px)",min:0,max:8e3,description:"0 = none (auto)."},value:S,onChange:j=>e?.(_t(j))}),h.jsx(ot,{schema:{type:"number-input",key:"maxHeightPx",label:"Max height (px)",min:0,max:8e3,description:U==="fixed"?"Optional clamp. 0 = none.":"0 = none."},value:S,onChange:j=>e?.(_t(j))})]}),h.jsx(ot,{schema:{type:"select",key:"alignItems",label:"Align items",options:[{value:"start",label:"Start"},{value:"center",label:"Center"},{value:"end",label:"End"},{value:"stretch",label:"Stretch"},...D?[{value:"baseline",label:"Baseline"}]:[]],description:"align-items (cross-axis alignment of items)."},value:S,onChange:j=>e?.(_t(j))}),h.jsx(ot,{schema:{type:"select",key:"alignContent",label:"Align content",options:[{value:"start",label:"Start"},{value:"center",label:"Center"},{value:"end",label:"End"},{value:"between",label:"Space between"},{value:"around",label:"Space around"},{value:"evenly",label:"Space evenly"},{value:"stretch",label:"Stretch"}],description:"align-content (only matters when theres extra space: flex-wrap or grid with spare space)."},value:S,onChange:j=>e?.(_t(j))}),h.jsx(ot,{schema:{type:"select",key:"justify",label:"Justify",options:[{value:"start",label:"Start"},{value:"center",label:"Center"},{value:"end",label:"End"},{value:"between",label:"Space between"},{value:"around",label:"Space around"},{value:"evenly",label:"Space evenly"}],description:"Applies justify-content to the list container."},value:S,onChange:j=>e?.(_t(j))}),h.jsx(Rt,{}),h.jsxs("div",{className:"grid pt-[5px] grid-cols-2 gap-2",children:[R&&h.jsx(ot,{schema:{type:"select",key:"columns",label:"Columns",options:O,description:M?"Auto = responsive by Min width (column-width). Set a number to force a fixed column count.":"Auto = auto-fill by min item width."},value:{...S,columns:String(S?.columns??0)},onChange:j=>{const G=j?.columns??"0",oe=Number(G);e?.(_t({...S,...j,columns:Number.isFinite(oe)?oe:0}))}}),h.jsx(ot,{schema:{type:"slider",key:"gapPx",label:"Gap",sliderMin:0,sliderMax:32,sliderStep:1,showValue:!0,valueSuffix:"px",description:"Snaps to none/sm/md/lg internally."},value:S,onChange:j=>{const G=j?.gapPx??0;e?.(_t({...j,gapPreset:(L=>{const $=Number(L)||0;return $<=0?"none":$<=8?"sm":$<=16?"md":"lg"})(G)}))}}),h.jsx(ot,{schema:{type:"select",key:"gapPreset",label:"Gap preset",options:[{value:"none",label:"None"},{value:"sm",label:"Small"},{value:"md",label:"Medium"},{value:"lg",label:"Large"}]},value:S,onChange:j=>{const G=j?.gapPreset??"md";e?.(_t({...j,gapPx:{none:0,sm:8,md:12,lg:20}[G]??12}))}}),h.jsx(ot,{schema:{type:"number-input",key:"rows",label:"Rows",min:0,max:24,description:"Reserved for later; 0 = auto."},value:S,onChange:j=>e?.(_t(j))}),h.jsx(ot,{schema:{type:"toggle",key:"dense",label:"Dense",description:"Tighter list spacing."},value:S,onChange:j=>e?.(_t(j))})]}),h.jsx(Rt,{}),h.jsxs("div",{className:"grid pt-[5px] grid-cols-2 gap-2",children:[h.jsx(ot,{schema:{type:"select",key:"insetX",label:"Inset X",options:[{value:"panel",label:"Inset"},{value:"none",label:"None"}]},value:S,onChange:j=>e?.(_t(j))}),h.jsx(ot,{schema:{type:"select",key:"padding",label:"Padding",options:[{value:"none",label:"None"},{value:"sm",label:"Small"},{value:"md",label:"Medium"}]},value:S,onChange:j=>e?.(_t(j))}),h.jsx(ot,{schema:{type:"select",key:"variant",label:"Variant",options:[{value:"default",label:"Default"},{value:"panel",label:"Panel"}]},value:S,onChange:j=>e?.(_t(j))})]}),h.jsx(Rt,{}),h.jsxs("div",{className:"grid pt-[5px] grid-cols-2 gap-2",children:[h.jsx(ot,{schema:{type:"select",key:"scrollType",label:"Scrollbar UI",options:[{value:"auto",label:"Auto"},{value:"always",label:"Always"},{value:"scroll",label:"Scroll"},{value:"hover",label:"Hover"}]},value:S,onChange:j=>e?.(_t(j))}),h.jsx(ot,{schema:{type:"select",key:"scrollX",label:"Scroll X",options:[{value:"none",label:"None"},{value:"auto",label:"Auto"},{value:"always",label:"Always"}]},value:S,onChange:j=>e?.(_t(j))}),h.jsx(ot,{schema:{type:"select",key:"scrollY",label:"Scroll Y",options:[{value:"none",label:"None"},{value:"auto",label:"Auto"},{value:"always",label:"Always"}]},value:S,onChange:j=>e?.(_t(j))}),h.jsx(ot,{schema:{type:"number-input",key:"scrollHideDelay",label:"Hide delay (ms)",min:0,max:5e3},value:S,onChange:j=>e?.(_t(j))})]})]})}const lm=x.createContext({state:{userId:null,gridId:null,grid:null,panels:[],containers:[],instances:[],occurrences:[],fields:[],activeId:null,activeSize:null,softTick:0},containersRender:[]});function FY({name:t,options:e,selected:n,onChange:r,onAddOption:i,disabled:o,compact:a,showLabel:c,randomize:u=!1}){const[f,p]=x.useState(!1),[g,v]=x.useState(""),y=x.useMemo(()=>e.filter(T=>n.includes(T.value)),[e,n]),w=x.useCallback(T=>{n.includes(T)?r(n.filter(N=>N!==T)):r([...n,T])},[n,r]),S=x.useCallback((T,N)=>{N?.stopPropagation(),r(n.filter(k=>k!==T))},[n,r]),C=x.useCallback(()=>{if(!g.trim())return;const T=g.toLowerCase().replace(/\s+/g,"_"),N={value:T,label:g.trim()};i?.(N),r([...n,T]),v("")},[g,n,r,i]);return h.jsxs("div",{className:"field-input field-input-select-multi",children:[c&&h.jsx(tt,{className:"text-xs text-muted-foreground mb-1",children:t}),h.jsxs("div",{className:"flex items-center gap-1",children:[h.jsxs(fo,{open:f,onOpenChange:p,children:[h.jsx(ho,{asChild:!0,children:h.jsxs(_e,{variant:"outline",role:"combobox","aria-expanded":f,disabled:o,className:`w-full justify-between font-normal ${a?"h-6 text-xs":"h-7 text-sm"}`,children:[y.length===0?h.jsx("span",{className:"text-muted-foreground",children:a?t:"Select..."}):h.jsxs("div",{className:"flex flex-wrap gap-1 items-center overflow-hidden",children:[y.slice(0,2).map(T=>h.jsxs("span",{className:"inline-flex items-center gap-0.5 px-1.5 py-0 text-[10px] rounded-full bg-primary/20 text-primary",children:[T.label,h.jsx(Hl,{className:"h-2.5 w-2.5 cursor-pointer",onClick:N=>S(T.value,N)})]},T.value)),y.length>2&&h.jsxs("span",{className:"text-[10px] text-muted-foreground",children:["+",y.length-2]})]}),h.jsx(Yu,{className:"h-3 w-3 opacity-50 flex-shrink-0"})]})}),h.jsxs(po,{className:"w-56 p-0",align:"start",children:[i&&h.jsxs("div",{className:"flex items-center gap-1 p-2 border-b border-border",children:[h.jsx(Kt,{type:"text",value:g,onChange:T=>v(T.target.value),onKeyDown:T=>T.key==="Enter"&&C(),className:"h-6 text-xs flex-1",placeholder:"Add new..."}),h.jsx(_e,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:C,disabled:!g.trim(),children:h.jsx(li,{className:"h-3 w-3"})})]}),h.jsx("div",{className:"max-h-48 overflow-y-auto p-1",children:e.length===0?h.jsx("div",{className:"py-4 text-center text-xs text-muted-foreground",children:"No options available"}):e.map(T=>{const N=n.includes(T.value);return h.jsxs("button",{type:"button",onClick:()=>w(T.value),className:`
                      w-full flex items-center gap-2 px-2 py-1.5 rounded-sm
                      text-left text-xs transition-colors
                      ${N?"bg-primary/10 text-primary":"hover:bg-muted"}
                    `,children:[h.jsx("div",{className:`
                      w-4 h-4 rounded border flex items-center justify-center flex-shrink-0
                      ${N?"bg-primary border-primary":"border-muted-foreground/30"}
                    `,children:N&&h.jsx(Cp,{className:"h-3 w-3 text-primary-foreground"})}),h.jsx("span",{className:"truncate",children:T.label})]},T.value)})})]})]}),u&&e.length>0&&h.jsx(_e,{variant:"ghost",size:"icon",className:a?"h-6 w-6":"h-7 w-7",title:"Pick random",disabled:o,onClick:()=>{const T=e[Math.floor(Math.random()*e.length)];T&&r([T.value])},children:h.jsx(_A,{className:"h-3.5 w-3.5"})})]})]})}function WN({flow:t="in",onChange:e,compact:n=!1,disabled:r=!1}){const[i,o]=x.useState(!1),a={in:{icon:hh,color:"text-green-400 bg-green-500/20 border-green-500/30",label:"In (+)",desc:"Positive value"},out:{icon:sb,color:"text-red-400 bg-red-500/20 border-red-500/30",label:"Out ()",desc:"Negative value"},replace:{icon:lb,color:"text-blue-400 bg-blue-500/20 border-blue-500/30",label:"Replace",desc:"Overwrites"}},c=["in","out","replace"],u=a[t]||a.in,f=u.icon,p=x.useCallback(g=>{e?.(g),o(!1)},[e]);return h.jsxs(fo,{open:i,onOpenChange:o,children:[h.jsx(ho,{asChild:!0,children:h.jsx("button",{type:"button",disabled:r,title:`Flow: ${u.label}`,className:`
            inline-flex items-center justify-center rounded border
            transition-colors flex-shrink-0
            ${r?"opacity-50 cursor-not-allowed":"cursor-pointer hover:brightness-125"}
            ${u.color}
            ${n?"w-5 h-5":"w-6 h-6"}
          `,children:h.jsx(f,{className:n?"w-3 h-3":"w-3.5 h-3.5"})})}),h.jsx(po,{className:"w-36 p-1",align:"start",side:"bottom",children:c.map(g=>{const v=a[g],y=v.icon,w=t===g;return h.jsxs("button",{type:"button",onClick:()=>p(g),className:`
                w-full flex items-center gap-2 px-2 py-1.5 rounded-sm text-xs transition-colors
                ${w?"bg-accent text-accent-foreground":"hover:bg-muted"}
              `,children:[h.jsx(y,{className:`w-3 h-3 ${w?"":"opacity-60"}`}),h.jsx("span",{children:v.label}),h.jsx("span",{className:"text-[9px] text-muted-foreground ml-auto",children:v.desc})]},g)})})]})}function $Y({field:t,binding:e,value:n,flow:r,onChange:i,onCommit:o,onFlowChange:a,disabled:c=!1,compact:u=!1,usedCompletedValues:f=[],onAddOption:p}){const g=O=>O&&typeof O=="object"&&"value"in O?O.value:O,[v,y]=x.useState(()=>g(n));x.useEffect(()=>{y(g(n))},[n]);const w=x.useCallback(O=>{y(O),i?.(O)},[i]),S=x.useCallback(()=>{o?.(v)},[v,o]),C=x.useCallback(O=>{O.key==="Enter"&&(O.preventDefault(),S())},[S]);if(!t)return null;const{type:T,name:N,unit:k,meta:D}=t,M=!u&&e?.display?.showLabel!==!1,R=k&&e?.display?.showUnit!==!1;if(T==="number")return h.jsxs("div",{className:"field-input field-input-number",children:[M&&h.jsx(tt,{className:"text-xs text-muted-foreground mb-1",children:N}),h.jsxs("div",{className:"flex items-center gap-1",children:[h.jsx(WN,{flow:r||"in",onChange:a,compact:u,disabled:c}),h.jsx(Kt,{type:"number",value:v??"",disabled:c,placeholder:u?N:"",className:u?"h-6 text-xs w-16":"h-7 text-sm",onChange:O=>w(O.target.value===""?null:Number(O.target.value)),onBlur:S,onKeyDown:C,min:D?.min,max:D?.max,step:D?.step}),R&&h.jsx("span",{className:"text-xs text-muted-foreground",children:k})]})]});if(T==="text")return h.jsxs("div",{className:"field-input field-input-text",children:[M&&h.jsx(tt,{className:"text-xs text-muted-foreground mb-1",children:N}),h.jsx(Kt,{type:"text",value:v??"",disabled:c,placeholder:u?N:"",className:u?"h-6 text-xs":"h-7 text-sm",onChange:O=>w(O.target.value),onBlur:S,onKeyDown:C})]});if(T==="boolean"){const O=D?.variant!=="checkbox"&&e?.display?.variant!=="checkbox";return h.jsx("div",{className:"field-input field-input-boolean flex items-center gap-2",children:O?h.jsxs(h.Fragment,{children:[h.jsx(od,{checked:!!v,disabled:c,onCheckedChange:I=>{w(I),o?.(I)}}),M&&h.jsx(tt,{className:"text-xs",children:N})]}):h.jsxs(h.Fragment,{children:[h.jsx(T0,{checked:!!v,disabled:c,onCheckedChange:I=>{w(I),o?.(I)}}),M&&h.jsx(tt,{className:"text-xs",children:N})]})})}if(T==="select"){const O=D?.options||[],I=D?.multiSelect===!0,U=D?.removeOnComplete===!0?O.filter(W=>!f.includes(W.value)):O,Y=I?Array.isArray(v)?v:v?[v]:[]:[];return I?h.jsx(FY,{name:N,options:U,selected:Y,onChange:W=>{w(W),o?.(W)},onAddOption:p,disabled:c,compact:u,showLabel:M,randomize:!!D?.randomize}):h.jsxs("div",{className:"field-input field-input-select",children:[M&&h.jsx(tt,{className:"text-xs text-muted-foreground mb-1",children:N}),h.jsxs("div",{className:"flex items-center gap-1",children:[h.jsxs(Pt,{value:v??"",disabled:c,onValueChange:W=>{w(W),o?.(W)},children:[h.jsx(zt,{className:u?"h-6 text-xs":"h-7 text-sm",children:h.jsx(Bt,{placeholder:u?N:"Select..."})}),h.jsx(Ft,{children:U.map(W=>h.jsx(wt,{value:W.value,children:W.label},W.value))})]}),D?.randomize&&U.length>0&&h.jsx(_e,{variant:"ghost",size:"icon",className:u?"h-6 w-6 flex-shrink-0":"h-7 w-7 flex-shrink-0",title:"Pick random",disabled:c,onClick:()=>{const W=U[Math.floor(Math.random()*U.length)];W&&(w(W.value),o?.(W.value))},children:h.jsx(_A,{className:"h-3.5 w-3.5"})})]})]})}if(T==="date")return h.jsxs("div",{className:"field-input field-input-date",children:[M&&h.jsx(tt,{className:"text-xs text-muted-foreground mb-1",children:N}),h.jsx(Kt,{type:"date",value:v??"",disabled:c,className:u?"h-6 text-xs":"h-7 text-sm",onChange:O=>w(O.target.value),onBlur:S})]});if(T==="rating"){const O=D?.max||5,I=v??0;return h.jsxs("div",{className:"field-input field-input-rating",children:[M&&h.jsx(tt,{className:"text-xs text-muted-foreground mb-1",children:N}),h.jsx("div",{className:"flex items-center gap-0.5",children:Array.from({length:O},(z,U)=>U+1).map(z=>h.jsx("button",{type:"button",disabled:c,className:`p-0.5 transition-colors ${c?"cursor-not-allowed opacity-50":"cursor-pointer hover:scale-110"}`,onClick:()=>{const U=z===I?0:z;w(U),o?.(U)},children:h.jsx("svg",{className:`${u?"w-4 h-4":"w-5 h-5"} ${z<=I?"text-yellow-400 fill-yellow-400":"text-gray-400 fill-transparent"}`,viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:h.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})},z))})]})}if(T==="duration"){const O=v??0,I=Math.floor(O/60),z=O%60,U=(Y,W)=>{const j=Y*60+W;w(j)};return h.jsxs("div",{className:"field-input field-input-duration",children:[M&&h.jsx(tt,{className:"text-xs text-muted-foreground mb-1",children:N}),h.jsxs("div",{className:"flex items-center gap-1",children:[h.jsx(WN,{flow:r||"in",onChange:a,compact:u,disabled:c}),h.jsx(Kt,{type:"number",value:I,disabled:c,min:0,max:23,className:u?"h-6 text-xs w-12":"h-7 text-sm w-14",onChange:Y=>U(parseInt(Y.target.value)||0,z),onBlur:S,onKeyDown:C}),h.jsx("span",{className:"text-xs text-muted-foreground",children:"h"}),h.jsx(Kt,{type:"number",value:z,disabled:c,min:0,max:59,step:5,className:u?"h-6 text-xs w-12":"h-7 text-sm w-14",onChange:Y=>U(I,parseInt(Y.target.value)||0),onBlur:S,onKeyDown:C}),h.jsx("span",{className:"text-xs text-muted-foreground",children:"m"})]})]})}return h.jsxs("div",{className:"text-xs text-muted-foreground",children:["Unknown field type: ",T]})}const Tv=Se.memo($Y);function HY(t){const e={},n={},r={},i={},o={};return(t.panels||[]).forEach(a=>{a.id&&(e[a.id]=a)}),(t.containers||[]).forEach(a=>{a.id&&(n[a.id]=a)}),(t.instances||[]).forEach(a=>{a.id&&(r[a.id]=a)}),(t.occurrences||[]).forEach(a=>{a.id&&(i[a.id]=a)}),(t.fields||[]).forEach(a=>{a.id&&(o[a.id]=a)}),{panelsById:e,containersById:n,instancesById:r,occurrencesById:i,fieldsById:o}}function UY(t,e){if(!t)return t;const n={...t};switch(t.targetType){case"panel":t.targetId&&e.panelsById[t.targetId]&&(n.panel=e.panelsById[t.targetId]);break;case"container":t.targetId&&e.containersById[t.targetId]&&(n.container=e.containersById[t.targetId]);break;case"instance":t.targetId&&e.instancesById[t.targetId]&&(n.instance=e.instancesById[t.targetId]);break}return n}function VY(t){if(!t.grid)return[];const e=HY(t);return(t.grid.occurrences||[]).map(n=>e.occurrencesById[n]).filter(Boolean).map(n=>UY(n,e))}function uR(t,e,n={}){return y2(t,e,n)}function qY({field:t,binding:e,value:n,state:r,context:i,compact:o=!1}){const a=x.useMemo(()=>t?t.mode==="derived"&&r?uR(r,t,i):n&&typeof n=="object"&&"value"in n?n.value:n:null,[t,n,r,i]),c=x.useMemo(()=>{if(!t)return"";if(a==null)return o?"-":"";const{type:C}=t;switch(C){case"number":{const T=Number(a);if(isNaN(T))return a;const N=e?.display?.precision??2;return Number.isInteger(T)?T.toString():T.toFixed(N)}case"boolean":return a?"Yes":"No";case"date":{if(!a)return"";try{return new Date(a).toLocaleDateString()}catch{return a}}case"select":return(t.meta?.options||[]).find(k=>k.value===a)?.label??a;case"rating":return a;case"duration":{const T=Number(a);if(isNaN(T))return a;const N=Math.floor(T/60),k=T%60;return N===0?`${k}m`:k===0?`${N}h`:`${N}h ${k}m`}default:return String(a)}},[t,a,o,e]),u=x.useMemo(()=>!t||t.mode!=="derived"||!t.metric?null:{sum:"Total",count:"Count",countTrue:"Completed",avg:"Average",min:"Min",max:"Max",last:"Latest",first:"First",range:"Range",median:"Median",mode:"Mode",stdDev:"Std Dev",product:"Product",concat:"Combined",unique:"Unique"}[t.metric.aggregation]||null,[t]),f=i?.currentIteration||"daily",p=x.useMemo(()=>{const C=t?.metric?.target;if(!C||a===null||typeof C.value!="number")return null;const N=Number(a);if(isNaN(N))return null;const k=g2(C,f),D=TG(N,C,f)??0,M=m2(N,C,f)??!1;return{progress:D,met:M,target:k}},[t,a,f]);if(!t)return null;const{name:g,unit:v}=t,y=!o&&e?.display?.showLabel!==!1,w=v&&e?.display?.showUnit!==!1,S=(C,T=5,N="w-4 h-4")=>{const k=Number(C)||0;return h.jsx("div",{className:"flex items-center gap-0.5",children:Array.from({length:T},(D,M)=>M+1).map(D=>h.jsx("svg",{className:`${N} ${D<=k?"text-yellow-400 fill-yellow-400":"text-gray-400 fill-transparent"}`,viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:h.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})},D))})};return o?t.type==="rating"?h.jsx("div",{className:"field-display field-display-compact",children:S(a,t.meta?.max||5,"w-3 h-3")}):h.jsxs("div",{className:"field-display field-display-compact flex items-center gap-1",children:[h.jsx("span",{className:"text-xs font-medium",children:c}),w&&h.jsx("span",{className:"text-xs text-muted-foreground",children:v})]}):t.type==="rating"?h.jsxs("div",{className:"field-display",children:[y&&h.jsx("div",{className:"text-xs text-muted-foreground mb-0.5",children:g}),S(a,t.meta?.max||5,"w-5 h-5")]}):h.jsxs("div",{className:"field-display",children:[y&&h.jsxs("div",{className:"flex items-center gap-1 mb-0.5",children:[h.jsx("span",{className:"text-xs text-muted-foreground",children:g}),u&&h.jsxs("span",{className:"text-[10px] text-muted-foreground/60",children:["(",u,")"]})]}),h.jsxs("div",{className:"flex items-center gap-1",children:[h.jsx("span",{className:"text-sm font-medium",children:c}),w&&h.jsx("span",{className:"text-xs text-muted-foreground",children:v})]}),p&&h.jsxs("div",{className:"mt-1",children:[h.jsx("div",{className:"h-1 bg-muted rounded-full overflow-hidden",children:h.jsx("div",{className:`h-full transition-all ${p.met?"bg-green-500":"bg-blue-500"}`,style:{width:`${p.progress}%`}})}),h.jsx("div",{className:"text-[10px] text-muted-foreground mt-0.5",children:p.met?"Target met":`Target: ${p.target}${v?` ${v}`:""}`})]})]})}const Nv=Se.memo(qY);function GY({field:t,value:e,flow:n="in",onChange:r,onCommit:i,onFlowChange:o,disabled:a=!1,compact:c=!1}){const[u,f]=x.useState(!1),p=x.useRef(null),g=L=>L&&typeof L=="object"&&"value"in L?L.value:L,[v,y]=x.useState(()=>g(e));x.useEffect(()=>{u||y(g(e))},[e,u]),x.useEffect(()=>{u&&p.current&&(p.current.focus(),p.current.select())},[u]);const w=x.useCallback(()=>{a||f(!0)},[a]),S=x.useCallback(L=>{const $=t?.type==="number"?L.target.value===""?null:Number(L.target.value):L.target.value;y($),r?.($)},[t?.type,r]),C=x.useCallback(()=>{f(!1),i?.(v)},[v,i]),T=x.useCallback(L=>{L.key==="Enter"?(L.preventDefault(),C()):L.key==="Escape"&&(f(!1),y(g(e)))},[C,e]),N=x.useCallback(()=>{C()},[C]),k=t?.meta?.prefix||"",D=t?.meta?.postfix||"",R=(t?.name??"")||null,O=t?.type||"text",z=`${k}${v??(O==="number"?0:"")}${D}`,U=()=>n==="out"?"bg-red-500/20 text-red-300 border-red-500/30":n==="replace"?"bg-blue-500/20 text-blue-300 border-blue-500/30":"bg-green-500/20 text-green-300 border-green-500/30",Y={in:hh,out:sb,replace:lb},W={in:"In (+)",out:"Out ()",replace:"Replace"},j=Y[n]||hh,G=x.useCallback(L=>{L.stopPropagation();const $=["in","out","replace"],V=($.indexOf(n)+1)%$.length;o?.($[V])},[n,o]),oe=()=>{switch(O){case"number":return"number";case"date":return"date";default:return"text"}};return u?h.jsxs("div",{className:"field-pill-input editing inline-flex items-center gap-0.5",children:[h.jsx("button",{type:"button",onClick:G,title:`Flow: ${W[n]}  click to cycle`,className:`
            inline-flex items-center justify-center rounded border w-5 h-5 flex-shrink-0 transition-colors
            ${n==="out"?"text-red-400 bg-red-500/20 border-red-500/30":n==="replace"?"text-blue-400 bg-blue-500/20 border-blue-500/30":"text-green-400 bg-green-500/20 border-green-500/30"}
          `,children:h.jsx(j,{className:"w-3 h-3"})}),k&&h.jsx("span",{className:"text-[10px] text-muted-foreground",children:k}),h.jsx(Kt,{ref:p,type:oe(),value:v??"",onChange:S,onKeyDown:T,onBlur:N,disabled:a,className:`${c?"h-5 text-[10px] w-14":"h-6 text-xs w-16"} px-1 text-center`,style:{minWidth:40}}),D&&h.jsx("span",{className:"text-[10px] text-muted-foreground",children:D})]}):h.jsxs("button",{type:"button",onClick:w,disabled:a,className:`
        field-pill-input
        inline-flex items-center gap-1
        ${c?"px-1.5 py-0.5 text-[10px]":"px-2 py-1 text-xs"}
        rounded-full border
        transition-all
        ${a?"opacity-50 cursor-not-allowed":"cursor-pointer hover:brightness-110"}
        ${U()}
      `,title:R?`${R}: ${W[n]}  Click to edit`:`${W[n]}  Click to edit`,children:[h.jsx("span",{onClick:G,className:"inline-flex items-center opacity-70 hover:opacity-100",children:h.jsx(j,{className:"w-2.5 h-2.5"})}),R&&h.jsxs("span",{className:"opacity-70",children:[R,":"]}),h.jsx("span",{children:z})]})}function WY({field:t,state:e,context:n,compact:r=!1}){const i=x.useMemo(()=>NG(e,t,n),[e.occurrences,t,n]),o=x.useMemo(()=>!t||t.mode!=="derived"?null:uR(e,t,n),[i]),a=t?.meta?.prefix||"",c=t?.meta?.postfix||"",f=(t?.name??"")||null,p=t?.metric?.aggregation||"sum",g=t?.metric?.target,v=g?.value!==void 0,y=n?.currentIteration||"daily",w=x.useMemo(()=>g2(g,y),[g,y]),S=o??0,C=typeof S=="number"?Number.isInteger(S)?S:S.toFixed(2):S,T=typeof w=="number"?Number.isInteger(w)?w:w.toFixed(2):w,N=v?`${a}${C}/${T}${c}`:`${a}${C}${c}`,k=x.useMemo(()=>v?m2(S,g,y):null,[v,g,S,y]),D=DG(p);if(!t)return null;const M=()=>v?k?"bg-green-500/20 text-green-300 border-green-500/30":"bg-red-500/20 text-red-300 border-red-500/30":"bg-violet-500/20 text-violet-300 border-violet-500/30";return h.jsxs("div",{className:`
        field-pill-display
        inline-flex items-center gap-1
        ${r?"px-1.5 py-0.5 text-[10px]":"px-2 py-1 text-xs"}
        rounded-full border
        ${M()}
      `,title:f?`${f}: ${p}(${t?.metric?.fieldId||"?"})`:`${p}(${t?.metric?.fieldId||"?"})`,children:[f&&h.jsxs("span",{className:"opacity-70",children:[f,":"]}),!v&&h.jsx("span",{className:"opacity-70",children:D}),h.jsx("span",{className:"font-bold",children:N})]})}function YY({field:t,binding:e,occurrence:n,instance:r,context:i,state:o,dispatch:a,socket:c,compact:u=!1}){const{value:f,flow:p}=x.useMemo(()=>{if(!n?.fields||!t?.id)return{value:void 0,flow:"in"};const C=n.fields[t.id];return C&&typeof C=="object"&&"value"in C?{value:C.value,flow:C.flow||"in"}:{value:C,flow:t?.meta?.flow||"in"}},[n?.fields,t?.id,t?.meta?.flow]),g=x.useCallback(C=>{},[]),v=x.useCallback((C,T)=>{if(!n?.id||!t?.id)return;const N=T||p||t?.meta?.flow||"in",k=t.mode==="input"?{value:C,flow:N}:C,D={...n.fields||{},[t.id]:k};ai({dispatch:a,socket:c,occurrence:{id:n.id,fields:D},emit:!0})},[n,t?.id,p,t?.meta?.flow,t?.mode,a,c]),y=x.useCallback(C=>{if(!n?.id||!t?.id)return;const T=n.fields?.[t.id],N=T&&typeof T=="object"&&"value"in T?T.value:T,k={...n.fields||{},[t.id]:{value:N,flow:C}};ai({dispatch:a,socket:c,occurrence:{id:n.id,fields:k},emit:!0})},[n,t?.id,a,c]);if(!t)return null;const w=e?.role||"input",S=t.mode==="derived";return u?S?h.jsx(WY,{field:t,state:o,context:i,compact:u}):t.type==="boolean"||t.type==="select"?h.jsx(Tv,{field:t,binding:e,value:f,onChange:g,onCommit:v,compact:!0}):h.jsx(GY,{field:t,value:f,flow:p,onChange:g,onCommit:v,onFlowChange:y,compact:u}):S?h.jsx(Nv,{field:t,binding:e,value:f,state:o,context:i,compact:u}):w==="display"?h.jsx(Nv,{field:t,binding:e,value:f,compact:u}):w==="both"?h.jsxs("div",{className:"field-renderer-both",children:[h.jsx(Nv,{field:t,binding:e,value:f,compact:u}),h.jsx(Tv,{field:t,binding:e,value:f,flow:p,onChange:g,onCommit:v,onFlowChange:y,compact:u})]}):h.jsx(Tv,{field:t,binding:e,value:f,flow:p,onChange:g,onCommit:v,onFlowChange:y,compact:u})}const dR=Se.memo(YY);function Zr(t=[]){const e=Object.create(null);for(const n of t)n?.id&&(e[n.id]=n);return e}function zl(t,e){return!t||!e?null:e[t]||null}function fR(t,e,n,r){return t?.occurrences?(t.occurrences||[]).map(i=>{const o=zl(i,e);return o?zl(o.targetId,n):null}).filter(Boolean):[]}function KY(t,e,n,r){return t?.occurrences?(t.occurrences||[]).map(i=>{const o=zl(i,e);if(!o)return null;const a=zl(o.targetId,n);return a?{instance:a,occurrence:o}:null}).filter(Boolean):[]}function YN(t,e,n){return t?.occurrences?(t.occurrences||[]).map(r=>{const i=zl(r,e);return i?zl(i.targetId,n):null}).filter(Boolean):[]}function Gf(t,e,n){if(!t||!Array.isArray(e)||!n)return null;for(const r of e){const i=n[r];if(i&&i.targetId===t)return r}return null}function Sr(t,e,n){if(!t||!Array.isArray(e)||!n)return-1;for(let r=0;r<e.length;r++){const i=n[e[r]];if(i&&i.targetId===t)return r}return-1}function go(t){return!t||t.id?t:t._id?{...t,id:String(t._id)}:t}function mp(t=[],e){return(t||[]).filter(n=>n!==e)}function M0(t=[],e){const n=t||[];return n.includes(e)?n:[...n,e]}function hR(t=[],e,n){const i=[...t||[]].filter(a=>a!==n),o=Math.max(0,Math.min(i.length,e));return i.splice(o,0,n),i}function pR(t=[],e,n){const r=[...t||[]];if(e===n||e<0||e>=r.length)return r;const[i]=r.splice(e,1),o=Math.max(0,Math.min(r.length,n));return r.splice(o,0,i),r}function mR({dispatch:t,socket:e,grid:n,panel:r,placement:i,userId:o,emit:a=!0}){if(!n||!r?.id||!o)return;const c=n._id?.toString()||n.id,u=kn();RG({dispatch:t,socket:e,panel:r,emit:a});const f={id:u,userId:o,targetType:"panel",targetId:r.id,gridId:c,iteration:{key:"time",value:new Date,timeValue:new Date,timeFilter:"daily",mode:"persistent"},timestamp:new Date,placement:i||{row:0,col:0,width:1,height:1},fields:{},meta:{}};return t({type:"CREATE_OCCURRENCE",payload:{occurrence:f}}),a&&e.emit("create_occurrence",{occurrence:f}),ZY({dispatch:t,socket:e,grid:n,occurrenceId:u,emit:a}),{panel:r,occurrence:f}}function gR({dispatch:t,socket:e,gridId:n,panel:r,container:i,userId:o,index:a=null,emit:c=!0}){if(!n||!r||!i?.id||!o)return;const u=r.id||r._id?.toString(),f=kn();v2({dispatch:t,socket:e,container:i,emit:c});const p={id:f,userId:o,targetType:"container",targetId:i.id,gridId:n,iteration:{key:"time",value:new Date,timeValue:new Date,timeFilter:"daily",mode:"persistent"},timestamp:new Date,fields:{},meta:{panelId:u}};return t({type:"CREATE_OCCURRENCE",payload:{occurrence:p}}),c&&e.emit("create_occurrence",{occurrence:p}),yR({dispatch:t,socket:e,panel:r,occurrenceId:f,index:a,emit:c}),{container:i,occurrence:p}}function uh({dispatch:t,socket:e,gridId:n,container:r,instance:i,userId:o,index:a=null,iterationMode:c="specific",emit:u=!0}){if(!n||!r||!i?.id||!o)return;const f=r.id||r._id?.toString(),p=kn();_G({dispatch:t,socket:e,containerId:f,instance:i,emit:u});const g={id:p,userId:o,targetType:"instance",targetId:i.id,gridId:n,iteration:{key:"time",value:new Date,timeValue:new Date,timeFilter:"daily",mode:c},timestamp:new Date,fields:{},meta:{containerId:f}};return t({type:"CREATE_OCCURRENCE",payload:{occurrence:g}}),u&&e.emit("create_occurrence",{occurrence:g}),R0({dispatch:t,socket:e,container:r,occurrenceId:p,index:a,emit:u}),{instance:i,occurrence:g}}function XY({dispatch:t,socket:e,gridId:n,sourceInstanceId:r,toContainer:i,userId:o,toIndex:a=null,emit:c=!0,iterationMode:u="specific",iterationValue:f=null,sourceOccurrence:p=null}){if(!n||!r||!i||!o)return null;const g=i.id||i._id?.toString(),v=kn(),y=f||new Date;let w={};if(p?.fields&&typeof p.fields=="object")try{w=JSON.parse(JSON.stringify(p.fields))}catch{w={...p.fields}}const S={id:v,userId:o,targetType:"instance",targetId:r,gridId:n,iteration:{key:"time",value:y,mode:u},timestamp:new Date,fields:w,meta:{containerId:g}};return t({type:"CREATE_OCCURRENCE",payload:{occurrence:S}}),c&&e.emit("create_occurrence",{occurrence:S}),R0({dispatch:t,socket:e,container:i,occurrenceId:v,index:a,emit:c}),{occurrence:S}}function JY({dispatch:t,socket:e,gridId:n,sourceInstanceId:r,sourceOccurrenceId:i,toContainer:o,userId:a,toIndex:c=null,emit:u=!0,iterationMode:f="specific",iterationValue:p=null,sourceOccurrence:g=null}){if(!n||!r||!o||!a)return null;const v=o.id||o._id?.toString(),y=kn(),w=p||new Date,S=g?.linkedGroupId||i||kn();let C={};if(g?.fields&&typeof g.fields=="object")try{C=JSON.parse(JSON.stringify(g.fields))}catch{C={...g.fields}}const T={id:y,userId:a,targetType:"instance",targetId:r,gridId:n,iteration:{key:"time",value:w,mode:f},timestamp:new Date,fields:C,linkedGroupId:S,meta:{containerId:v}};return i&&!g?.linkedGroupId&&ai({dispatch:t,socket:e,occurrence:{id:i,linkedGroupId:S},emit:u}),t({type:"CREATE_OCCURRENCE",payload:{occurrence:T}}),u&&e.emit("create_occurrence",{occurrence:T}),R0({dispatch:t,socket:e,container:o,occurrenceId:y,index:c,emit:u}),{occurrence:T,linkedGroupId:S}}function QY({dispatch:t,socket:e,gridId:n,sourceContainerId:r,toPanel:i,userId:o,toIndex:a=null,emit:c=!0,iterationMode:u="specific",iterationValue:f=null}){if(!n||!r||!i||!o)return null;const p=i.id||i._id?.toString(),g=kn(),y={id:g,userId:o,targetType:"container",targetId:r,gridId:n,iteration:{key:"time",value:f||new Date,mode:u},timestamp:new Date,fields:{},meta:{panelId:p}};return t({type:"CREATE_OCCURRENCE",payload:{occurrence:y}}),c&&e.emit("create_occurrence",{occurrence:y}),yR({dispatch:t,socket:e,panel:i,occurrenceId:g,index:a,emit:c}),{occurrence:y}}function ZY({dispatch:t,socket:e,grid:n,occurrenceId:r,emit:i=!0}){if(!n||!r)return;const o={...n,occurrences:M0(n.occurrences||[],r)},a=o?._id??o?.id;a&&ti({dispatch:t,socket:e,gridId:String(a),grid:o,emit:i})}function yR({dispatch:t,socket:e,panel:n,occurrenceId:r,index:i=null,emit:o=!0}){if(!n||!r)return;const a=n.occurrences||[],c=i==null?M0(a,r):hR(a,i,r),u=go({...n,occurrences:c});qn({dispatch:t,socket:e,panel:u,emit:o})}function KN({dispatch:t,socket:e,panel:n,fromIndex:r,toIndex:i,emit:o=!0}){if(!n)return;const a=pR(n.occurrences||[],r,i),c=go({...n,occurrences:a});qn({dispatch:t,socket:e,panel:c,emit:o})}function eK({dispatch:t,socket:e,fromPanel:n,toPanel:r,occurrenceId:i,toIndex:o=null,emit:a=!0}){if(!n||!r||!i)return;const c=mp(n.occurrences||[],i),u=mp(r.occurrences||[],i);let f;o==null||o<0||o>u.length?f=[...u,i]:(f=[...u],f.splice(o,0,i));const p=go({...n,occurrences:c}),g=go({...r,occurrences:f});qn({dispatch:t,socket:e,panel:p,emit:a}),qn({dispatch:t,socket:e,panel:g,emit:a})}function fl({dispatch:t,socket:e,panel:n,display:r,emit:i=!0}){const o=go(n);if(!o?.id)return;const a=o.layout||{},c=a.style&&typeof a.style=="object"?a.style:{},u={...o,layout:{...a,style:{...c,display:r??"block"}}};qn({dispatch:t,socket:e,panel:u,emit:i})}function R0({dispatch:t,socket:e,container:n,occurrenceId:r,index:i=null,emit:o=!0}){if(!n||!r)return;const a=n.occurrences||[],c=i==null?M0(a,r):hR(a,i,r),u=go({...n,occurrences:c});oo({dispatch:t,socket:e,container:u,emit:o})}function XN({dispatch:t,socket:e,container:n,fromIndex:r,toIndex:i,emit:o=!0}){if(!n)return;const a=pR(n.occurrences||[],r,i),c=go({...n,occurrences:a});oo({dispatch:t,socket:e,container:c,emit:o})}function tK({dispatch:t,socket:e,fromContainer:n,toContainer:r,occurrenceId:i,toIndex:o=null,emit:a=!0}){if(!n||!r||!i)return;const c=mp(n.occurrences||[],i),u=mp(r.occurrences||[],i);let f;o==null||o<0||o>u.length?f=[...u,i]:(f=[...u],f.splice(o,0,i));const p=go({...n,occurrences:c}),g=go({...r,occurrences:f});oo({dispatch:t,socket:e,container:p,emit:a}),oo({dispatch:t,socket:e,container:g,emit:a})}function nK(t){var e=t.dragEnter,n=e.type,r=e.relatedTarget;return n!=="dragenter"?!1:Jl()?Xq({dragEnter:e}):r==null?!0:i2()?o2(r):r instanceof HTMLIFrameElement}function j0(t){var e=t.type,n=t.value;return!(e===d2||e===jx&&n===u2)}function rK(t){return Array.from(t.types).filter(function(e){return j0({type:e,value:t.getData(e)})})}function iK(t){return Array.from(t.items).filter(function(e){return e.kind==="file"||j0({type:e.type,value:t.getData(e.type)})})}var $x=!1,vR=c2({typeKey:"external",defaultDropEffect:"copy",mount:function(e){return mo.bind(window,{type:"dragenter",listener:function(r){if(!$x&&r.dataTransfer&&e.canStart(r)&&nK({dragEnter:r})){var i=rK(r.dataTransfer);if(i.length){var o={types:i,items:[],getStringData:function(){return null}};e.start({event:r,dragType:{type:"external",startedFrom:"external",payload:o,getDropPayload:function(c){if(!c.dataTransfer)return o;var u=iK(c.dataTransfer),f=c.dataTransfer.getData.bind(c.dataTransfer);return{types:i,items:u,getStringData:function(g){if(!i.includes(g))return null;var v=f(g);return j0({type:g,value:v})?v:null}}}}})}}}})}});function xR(t){return vR.dropTarget(t)}(function(){if(typeof window>"u")return;vR.registerUsage();var e={type:"idle"},n=e;function r(){n.type==="dragging"&&($x=!1,n.cleanup(),n=e)}function i(){return mo.bindAll(window,[{type:"dragend",listener:r}].concat(b0(s2({onDragEnd:r}))),{capture:!0})}mo.bind(window,{type:"dragstart",listener:function(){n.type==="idle"&&($x=!0,n={type:"dragging",cleanup:i()})},options:{capture:!0}})})();var Vu=new Map,dh=new Set;function bR(t){oK(t);var e=Vu.get(t);if(e)return e;var n={timeOfEngagementStart:Date.now()};return Vu.set(t,n),n}function oK(t){dh.add(t)}function sK(t){dh.clear(),t(),Vu.forEach(function(e,n){dh.has(n)||Vu.delete(n)}),dh.clear()}function aK(){Vu.clear()}var JN=new Map;function lK(t){var e=JN.get(t);if(e)return e;var n=cK(t);return JN.set(t,n),n}function cK(t){var e={type:"idle"},n=[];function r(u){if(e.type==="running"){var f=u-e.timeLastFrameFinished,p=e,g=p.latestArgs,v=x0({x:g.location.current.input.clientX,y:g.location.current.input.clientY});sK(function(){n.forEach(function(y){return y({underUsersPointer:v,latestArgs:g,timeSinceLastFrame:f})})}),e.timeLastFrameFinished=u,e.frameId=requestAnimationFrame(r)}}function i(){e.type!=="idle"&&(cancelAnimationFrame(e.frameId),aK(),e={type:"idle"})}function o(u){e.type==="idle"&&(e={type:"initializing",latestArgs:u,frameId:requestAnimationFrame(function(f){e.type==="initializing"&&(e={type:"running",timeLastFrameFinished:f,latestArgs:e.latestArgs,frameId:requestAnimationFrame(r)})})})}function a(u){if(e.type==="idle"){o(u);return}e.latestArgs=u}t({onDragStart:o,onDropTargetChange:a,onDrag:a,onDrop:i});var c={onFrame:function(f){n.push(f)}};return c}var Hx="data-auto-scrollable",uK="[".concat(Hx,'="true"]');function dK(t){return t.setAttribute(Hx,"true"),function(){return t.removeAttribute(Hx)}}function QN(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function ZN(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?QN(Object(n),!0).forEach(function(r){si(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):QN(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}var fK={startHitboxAtPercentageRemainingOfElement:{top:.25,right:.25,bottom:.25,left:.25},maxScrollAtPercentageRemainingOfHitbox:{top:.5,right:.5,bottom:.5,left:.5},timeDampeningDurationMs:300,maxMainAxisHitboxSize:180},hK={standard:900,fast:1500};function wR(t){var e;return ZN(ZN({},fK),{},{maxPixelScrollPerSecond:hK[(e=t?.maxScrollSpeed)!==null&&e!==void 0?e:"standard"]})}var pK={top:function(e){return e.scrollTop>0},right:function(e){return Math.ceil(e.scrollLeft)+e.clientWidth<e.scrollWidth},bottom:function(e){return Math.ceil(e.scrollTop)+e.clientHeight<e.scrollHeight},left:function(e){return e.scrollLeft>0}},mK=["top","right","bottom","left"],gK={top:"vertical",right:"horizontal",bottom:"vertical",left:"horizontal"},eA={start:"top",end:"bottom",point:"y",size:"height"},tA={start:"left",end:"right",point:"x",size:"width"},SR={vertical:{mainAxis:eA,crossAxis:tA},horizontal:{mainAxis:tA,crossAxis:eA}},I0={top:"start",right:"end",bottom:"end",left:"start"};function Wf(t){var e=t.edge,n=t.axis;return function(i){var o,a=i.clientRect,c=i.config,u=SR[n],f=u.mainAxis,p=u.crossAxis,g=I0[e],v=Math.min(c.startHitboxAtPercentageRemainingOfElement[e]*a[f.size],c.maxMainAxisHitboxSize);return DOMRect.fromRect((o={},si(o,f.point,g==="start"?a[f.point]:a[f.point]+a[f.size]-v),si(o,p.point,a[p.point]),si(o,f.size,v),si(o,p.size,a[p.size]),o))}}var yK={top:Wf({axis:"vertical",edge:"top"}),right:Wf({axis:"horizontal",edge:"right"}),bottom:Wf({axis:"vertical",edge:"bottom"}),left:Wf({axis:"horizontal",edge:"left"})};function Ux(t){var e=t.startOfRange,n=t.endOfRange,r=t.value,i=e<n;if(!i||r<e)return 0;if(r>n)return 1;var o=n-e;return(r-e)/o}function vK(t){var e=t.timeSinceLastFrame,n=t.config,r=n.maxPixelScrollPerSecond/1e3,i=Math.ceil(r*e),o=n.maxPixelScrollPerSecond/60;return Math.min(i,o)}function xK(t){var e=t.client,n=t.axis,r=t.edge,i=t.hitbox,o=t.config,a=SR[n].mainAxis,c=I0[r],u=i[a.size]*o.maxScrollAtPercentageRemainingOfHitbox[r];if(c==="end")return Ux({startOfRange:i[a.start],endOfRange:i[a.end]-u,value:e[a.point]});var f=Ux({startOfRange:i[a.start]+u,endOfRange:i[a.end],value:e[a.point]});return 1-f}function Yf(t){var e=t.client,n=t.timeSinceLastFrame,r=t.engagement,i=t.axis,o=t.hitbox,a=t.edge,c=t.isDistanceDampeningEnabled,u=t.config,f=vK({timeSinceLastFrame:n,config:u}),p=c?xK({client:e,edge:a,hitbox:o,axis:i,config:u}):1,g=Ux({startOfRange:r.timeOfEngagementStart,endOfRange:r.timeOfEngagementStart+u.timeDampeningDurationMs,value:Date.now()}),v=p*g,y=Math.max(f*v,1),w=I0[a];return w==="end"?y:-1*y}function bK(t,e){return e==="all"||t===e}function wK(t){var e=t.client,n=t.clientRect;return e.x>=n.x&&e.x<=n.x+n.width&&e.y>=n.y&&e.y<=n.y+n.height}function SK(t){return t.getBoundingClientRect()}function ER(t){var e=t.element,n=t.input,r=t.timeSinceLastFrame,i=t.engagement,o=t.config,a=t.allowedAxis,c=t.getRect,u=c===void 0?SK:c,f={x:n.clientX,y:n.clientY},p=u(e),g=mK.reduce(function(w,S){var C=yK[S]({clientRect:p,config:o}),T=gK[S];return!bK(T,a)||!wK({client:f,clientRect:C})||!pK[S](e)||w.set(S,{edge:S,hitbox:C}),w},new Map),v=(function(){var w="horizontal",S=g.get("left");if(S)return Yf({client:f,edge:S.edge,hitbox:S.hitbox,axis:w,timeSinceLastFrame:r,engagement:i,isDistanceDampeningEnabled:!0,config:o});var C=g.get("right");return C?Yf({client:f,edge:C.edge,hitbox:C.hitbox,axis:w,timeSinceLastFrame:r,engagement:i,isDistanceDampeningEnabled:!0,config:o}):0})(),y=(function(){var w="vertical",S=g.get("bottom");if(S)return Yf({client:f,edge:S.edge,hitbox:S.hitbox,axis:w,timeSinceLastFrame:r,engagement:i,isDistanceDampeningEnabled:!0,config:o});var C=g.get("top");return C?Yf({client:f,edge:C.edge,hitbox:C.hitbox,axis:w,timeSinceLastFrame:r,engagement:i,isDistanceDampeningEnabled:!0,config:o}):0})();return{left:v,top:y}}function EK(t,e){var n=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=CK(t))||e){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(f){throw f},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o=!0,a=!1,c;return{s:function(){n=n.call(t)},n:function(){var f=n.next();return o=f.done,f},e:function(f){a=!0,c=f},f:function(){try{!o&&n.return!=null&&n.return()}finally{if(a)throw c}}}}function CK(t,e){if(t){if(typeof t=="string")return nA(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return nA(t,e)}}function nA(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function CR(t){return!!(t.top||t.left)}function TR(t){var e,n,r,i=t.target,o=t.input,a=t.source,c=t.findEntry,u=t.timeSinceLastFrame,f=t.available,p=f===void 0?{top:!0,left:!0}:f;if(!CR(p)||!i)return p;var g=i.closest(uK);if(!g)return p;var v=c(g);if(!v)return p;function y(){var D;return TR({target:(D=g?.parentElement)!==null&&D!==void 0?D:null,findEntry:c,source:a,timeSinceLastFrame:u,input:o,available:p})}var w={input:o,source:a,element:g};if(v.canScroll&&!v.canScroll(w))return y();var S=bR(g),C=wR((e=v.getConfiguration)===null||e===void 0?void 0:e.call(v,w)),T=(n=(r=v.getAllowedAxis)===null||r===void 0?void 0:r.call(v,w))!==null&&n!==void 0?n:"all",N=ER({element:g,engagement:S,input:o,timeSinceLastFrame:u,allowedAxis:T,config:C}),k={top:0,left:0};return p.top&&N.top!==0&&(k.top=N.top,p.top=!1),p.left&&N.left!==0&&(k.left=N.left,p.left=!1),(k.top!==0||k.left!==0)&&g.scrollBy(k),y()}function TK(t){var e=t.input,n=t.timeSinceLastFrame,r=t.available,i=t.source,o=t.entries,a=document.documentElement,c={input:e,source:i,element:a},u=EK(o),f;try{for(u.s();!(f=u.n()).done;){var p,g,v,y=f.value;if(!(y.canScroll&&!y.canScroll(c))){var w=bR(a),S=wR((p=y.getConfiguration)===null||p===void 0?void 0:p.call(y,c)),C=(g=(v=y.getAllowedAxis)===null||v===void 0?void 0:v.call(y,c))!==null&&g!==void 0?g:"all",T=ER({element:a,engagement:w,input:e,config:S,allowedAxis:C,getRect:function(D){return DOMRect.fromRect({y:0,x:0,width:D.clientWidth,height:D.clientHeight})},timeSinceLastFrame:n}),N={top:r.top?T.top:0,left:r.left?T.left:0};(N.top!==0||N.left!==0)&&a.scrollBy(N);break}}}catch(k){u.e(k)}finally{u.f()}}function NK(t){var e=t.input,n=t.findEntry,r=t.timeSinceLastFrame,i=t.source,o=t.getWindowScrollEntries,a=t.underUsersPointer,c=TR({target:a,timeSinceLastFrame:r,input:e,source:i,findEntry:n});CR(c)&&TK({input:e,source:i,entries:o(),timeSinceLastFrame:r,available:c})}function rA(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function AK(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?rA(Object(n),!0).forEach(function(r){si(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):rA(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function kK(t){var e=t.monitor,n=new Map,r=new Set;function i(f){return n.set(f.element,f),Ql(dK(f.element),function(){return n.delete(f.element)})}function o(){var f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},p=AK({},f);return r.add(p),function(){return r.delete(p)}}function a(f){var p;return(p=n.get(f))!==null&&p!==void 0?p:null}function c(){return Array.from(r)}function u(f){var p=f.latestArgs,g=f.underUsersPointer,v=f.timeSinceLastFrame;NK({input:p.location.current.input,source:p.source,findEntry:a,underUsersPointer:g,timeSinceLastFrame:v,getWindowScrollEntries:c})}return lK(e).onFrame(u),{autoScroll:i,autoScrollWindow:o}}var DK=kK({monitor:f2}),OK=DK.autoScroll;function MK(){return{x:0,y:0}}function NR(t){var e=t.render,n=t.nativeSetDragImage,r=t.getOffset,i=r===void 0?MK:r,o=document.createElement("div");Object.assign(o.style,{position:"fixed",top:0,left:0,zIndex:r2,pointerEvents:"none"}),document.body.append(o);var a=e({container:o});queueMicrotask(function(){var f=i({container:o});if(Jl()){var p=o.getBoundingClientRect();if(p.width===0)return;o.style.left="-".concat(p.width-1e-4,"px")}n?.(o,f.x,f.y)});function c(){u(),a?.(),document.body.removeChild(o)}var u=f2({onDragStart:c,onDrop:c})}const gp="application/x-daytracker-dnd",qe={PANEL:"panel",CONTAINER:"container",INSTANCE:"instance",ARTIFACT:"artifact",EXTERNAL:"external",FILE:"file",TEXT:"text",URL:"url"},Bl={GRID_CELL:[qe.PANEL],PANEL_CONTENT:[qe.CONTAINER,qe.INSTANCE,qe.ARTIFACT,qe.EXTERNAL,qe.FILE,qe.TEXT,qe.URL],CONTAINER_LIST:[qe.INSTANCE,qe.ARTIFACT,qe.EXTERNAL,qe.FILE,qe.TEXT,qe.URL],INSTANCE:[qe.INSTANCE,qe.ARTIFACT,qe.FILE,qe.TEXT,qe.URL]},AR=x.createContext(null);function Ts(){const t=x.useContext(AR);if(!t)throw new Error("useDraggable/useDroppable must be used within DragProvider");return t}let Av=null;function kR(){return Av||(Av=crypto?.randomUUID?.()||`win-${Date.now()}-${Math.random().toString(36).slice(2)}`),Av}function DR(t,e,n,r={}){return{type:t,id:e,data:n,context:r,sourceWindowId:kR()}}function OR(t){return JSON.stringify({v:1,type:t.type,id:t.id,context:t.context,data:t.data,meta:{label:t.data?.label||t.data?.name||""},sourceWindowId:t.sourceWindowId})}function xl(t){const e=t&&typeof t.getStringData=="function",n=Array.from(t?.types||[]),r=a=>e?t.getStringData(a):t?.getData?.(a)||"";if(n.includes(gp))try{const a=r(gp),c=JSON.parse(a);return{type:c.type,id:c.id,data:c.data,context:c.context||{},isCrossWindow:c.sourceWindowId!==kR(),meta:c.meta}}catch{}let i=[];if(e&&t.items?i=t.items.filter(a=>a.kind==="file").map(a=>a.getAsFile()):t?.files&&(i=Array.from(t.files)),i.length>0)return{type:qe.FILE,id:"__file__",data:{files:i,name:i[0]?.name},context:{},isCrossWindow:!1};if(n.includes("text/uri-list"))return{type:qe.URL,id:"__url__",data:{url:r("text/uri-list")},context:{},isCrossWindow:!1};const o=r("text/plain")||"";return{type:qe.TEXT,id:"__text__",data:{text:o.slice(0,200)},context:{},isCrossWindow:!1}}function RK({type:t,id:e,data:n={},context:r={},disabled:i=!1,nativeEnabled:o=!0}){const a=x.useRef(null),c=Ts(),[u,f]=x.useState(!1);return x.useEffect(()=>{const p=a.current;if(!p||i)return;const g=DR(t,e,n,r);return id({element:p,getInitialData:()=>g,getInitialDataForExternal:()=>({[gp]:OR(g),"text/plain":n.label||n.name||e}),onGenerateDragPreview:({nativeSetDragImage:y})=>{o&&NR({nativeSetDragImage:y,getOffset:()=>({x:0,y:0}),render:({container:w})=>{const S=p.cloneNode(!0);S.style.opacity="1",S.style.transform="none",w.appendChild(S)}})},onDragStart:({location:y})=>{f(!0);const w=y.current.input.clientX,S=y.current.input.clientY;c.handleDragStart(g,w,S)},onDrag:({location:y})=>{const w=y.current.input.clientX,S=y.current.input.clientY;c.handleDragMove(w,S)},onDrop:()=>{f(!1),setTimeout(()=>{c.handleDragEnd()},0)}})},[t,e,JSON.stringify(n),JSON.stringify(r),i,o,c]),{ref:a,isDragging:u,dragProps:{"data-draggable":"true","data-drag-type":t,"data-drag-id":e}}}function qu({type:t,id:e,context:n={},accepts:r=[],disabled:i=!1}){const o=x.useRef(null),a=Ts(),[c,u]=x.useState(!1);return x.useEffect(()=>{const f=o.current;if(!f||i)return;const p=y=>{const w=y?.data?.type;return r.length===0?!0:r.includes(w)},g=()=>r.includes(qe.INSTANCE)||r.includes(qe.FILE)||r.includes(qe.TEXT)||r.includes(qe.URL)||r.includes(qe.EXTERNAL);return Ql(Zl({element:f,canDrop:({source:y})=>p(y),getData:()=>({type:t,id:e,context:n}),onDragEnter:({self:y,source:w})=>{p(w)&&u(!0)},onDrag:({self:y,source:w,location:S})=>{const C=S.current.input.clientX,T=S.current.input.clientY;a.handleDragOver?.({type:t,id:e,context:n,clientX:C,clientY:T})},onDragLeave:()=>{u(!1)},onDrop:({self:y,source:w,location:S,nativeEvent:C})=>{u(!1);const T=S.current.input.clientX,N=S.current.input.clientY;a.handleDrop({type:t,id:e,context:n,clientX:T,clientY:N,source:w.data,dataTransfer:C?.dataTransfer})}}),xR({element:f,canDrop:()=>g(),getData:()=>({type:t,id:e,context:n}),onDragEnter:()=>{g()&&u(!0)},onDrag:({location:y})=>{const w=y.current.input.clientX,S=y.current.input.clientY;a.handleDragOver?.({type:t,id:e,context:n,clientX:w,clientY:S})},onDragLeave:()=>{u(!1)},onDrop:({location:y,source:w})=>{u(!1);const S=y.current.input.clientX,C=y.current.input.clientY,T=xl(w);a.handleDrop({type:t,id:e,context:n,clientX:S,clientY:C,source:{type:T.type,id:T.id,data:T.data,context:T.context||{}},dataTransfer:w})}}))},[t,e,JSON.stringify(n),JSON.stringify(r),i,a]),{ref:o,isOver:c,dropProps:{"data-droppable":"true","data-drop-type":t,"data-drop-id":e}}}function MR({type:t,id:e,data:n={},context:r={},disabled:i=!1,nativeEnabled:o=!0,accepts:a=[],allowedEdges:c=["top","bottom"]}){const u=x.useRef(null),f=Ts(),[p,g]=x.useState(!1),[v,y]=x.useState(!1),[w,S]=x.useState(null);return x.useEffect(()=>{const C=u.current;if(!C||i)return;const T=DR(t,e,n,r),N=M=>{const R=M?.data?.type;return a.length===0?!0:a.includes(R)},k=()=>a.includes(qe.INSTANCE)||a.includes(qe.FILE)||a.includes(qe.TEXT)||a.includes(qe.URL)||a.includes(qe.EXTERNAL);return Ql(id({element:C,getInitialData:()=>T,getInitialDataForExternal:()=>({[gp]:OR(T),"text/plain":n.label||n.name||e}),onGenerateDragPreview:({nativeSetDragImage:M})=>{o&&NR({nativeSetDragImage:M,getOffset:()=>({x:0,y:0}),render:({container:R})=>{const O=C.cloneNode(!0);O.style.opacity="1",O.style.transform="none",R.appendChild(O)}})},onDragStart:({location:M})=>{g(!0);const R=M.current.input.clientX,O=M.current.input.clientY,I=n?.defaultDragMode||"move";f.handleDragStart(T,R,O,{mode:I})},onDrag:({location:M})=>{const R=M.current.input.clientX,O=M.current.input.clientY;f.handleDragMove(R,O)},onDrop:()=>{g(!1),setTimeout(()=>{f.handleDragEnd()},0)}}),Zl({element:C,canDrop:({source:M})=>N(M),getData:({input:M,element:R})=>Ix({type:t,id:e,context:r,instanceId:e},{input:M,element:R,allowedEdges:c}),onDragEnter:({source:M,self:R})=>{if(N(M)){y(!0);const O=io(R.data);S(O)}},onDrag:({location:M,self:R})=>{const O=M.current.input.clientX,I=M.current.input.clientY;f.handleDragOver?.({type:t,id:e,context:r,clientX:O,clientY:I});const z=io(R.data);S(z)},onDragLeave:()=>{y(!1),S(null)},onDrop:({source:M,location:R,nativeEvent:O,self:I})=>{y(!1),S(null);const z=R.current.input.clientX,U=R.current.input.clientY,Y=io(I.data);f.handleDrop({type:t,id:e,context:{...r,instanceId:e,closestEdge:Y},clientX:z,clientY:U,source:M.data,dataTransfer:O?.dataTransfer})}}),xR({element:C,canDrop:()=>k(),getData:({input:M,element:R})=>Ix({type:t,id:e,context:r,instanceId:e},{input:M,element:R,allowedEdges:c}),onDragEnter:({self:M})=>{if(k()){y(!0);const R=io(M.data);S(R)}},onDrag:({location:M,self:R})=>{const O=M.current.input.clientX,I=M.current.input.clientY,z=io(R.data);S(z),f.handleDragOver?.({type:t,id:e,context:r,clientX:O,clientY:I})},onDragLeave:()=>{y(!1),S(null)},onDrop:({location:M,source:R,self:O})=>{y(!1),S(null);const I=M.current.input.clientX,z=M.current.input.clientY,U=io(O.data),Y=xl(R);f.handleDrop({type:t,id:e,context:{...r,instanceId:e,closestEdge:U},clientX:I,clientY:z,source:{type:Y.type,id:Y.id,data:Y.data,context:Y.context||{}},dataTransfer:R})}}))},[t,e,JSON.stringify(n),JSON.stringify(r),i,o,JSON.stringify(a),JSON.stringify(c),f]),{ref:u,isDragging:p,isOver:v,closestEdge:w,props:{"data-draggable":"true","data-drag-type":t,"data-drag-id":e,"data-droppable":"true","data-drop-type":t,"data-drop-id":e}}}function jK(){return OK({element:document.documentElement,canScroll:({element:t})=>{if(t===document.documentElement||t===document.body)return!0;const e=window.getComputedStyle(t);return(e.overflow==="auto"||e.overflow==="scroll"||e.overflowY==="auto"||e.overflowY==="scroll"||e.overflowX==="auto"||e.overflowX==="scroll")&&(t.scrollHeight>t.clientHeight||t.scrollWidth>t.clientWidth)}})}function IK(){return{name:"",display:"grid",flow:"row",wrap:"wrap",columns:0,rows:0,gapPx:12,alignItems:"start",alignContent:"start",justify:"start",dense:!1,padding:"none",scrollY:"auto",widthMode:"auto",fixedWidth:340,heightMode:"auto",fixedHeight:0,style:{display:"block"},lock:{enabled:!1,containersDrag:!0,containersDrop:!0,instancesDrag:!0,instancesDrop:!0}}}function kv(t){const e=IK(),n=t&&typeof t=="object"?t:{};return{...e,...n,style:{...e.style,...n.style||{}},lock:{...e.lock,...n.lock||{}}}}function _K({panel:t,components:e,dispatch:n,socket:r,cols:i,rows:o,addContainerToPanel:a,addInstanceToContainer:c,sizesRef:u,fullscreenPanelId:f,setFullscreenPanelId:p,forceFullscreen:g=!1}){const[v,y]=x.useState(!1),[w,S]=x.useState(!1),[C,T]=x.useState(null),[N,k]=x.useState(null);x.useRef(null);const D=t?.defaultDragMode||"move",M=x.useCallback((de,De)=>{k({instance:de,occurrence:De})},[]),{occurrencesById:R,instancesById:O,containersById:I,viewsById:z,manifestsById:U,fieldsById:Y}=x.useContext(Rn),{state:W}=x.useContext(lm),j=Ts(),{hotTarget:G,isContainerDrag:oe,isInstanceDrag:L,isExternalDrag:$,getStackForPanel:V,cyclePanelStack:we,dragMode:pe,toggleDragMode:P}=j,K=x.useMemo(()=>kv(t?.layout),[t?.layout]),B=x.useRef(null);x.useEffect(()=>()=>window.clearTimeout(B.current),[]);const Z=x.useCallback(()=>{qn({dispatch:n,socket:r,panel:{...t,defaultDragMode:D==="move"?"copy":"move"},emit:!0})},[t,D,n,r]),le=x.useCallback(de=>{if(!t)return;const De=t.layout||{},yt=kv({...De,...de});qn({dispatch:n,socket:r,panel:{...t,layout:yt},emit:!0})},[t,r,n]),be=x.useCallback(de=>{t&&qn({dispatch:n,socket:r,panel:{...t,iteration:de},emit:!0})},[t,r,n]),H=x.useCallback(de=>{t&&qn({dispatch:n,socket:r,panel:{...t,defaultDragMode:de},emit:!0})},[t,r,n]),ce=x.useCallback(de=>{t&&qn({dispatch:n,socket:r,panel:{...t,...de},emit:!0})},[t,r,n]),te=x.useMemo(()=>Object.values(R).find(de=>de.targetType==="panel"&&de.targetId===t.id),[R,t.id]),me=x.useCallback(de=>{te?.id&&ai({dispatch:n,socket:r,occurrence:{id:te.id,...de},emit:!0})},[te,n,r]),Te=t.viewId?z[t.viewId]:null,re=Te?.viewType||(t.kind==="notebook"?"notebook":t.kind==="artifact-viewer"?"artifact-viewer":"list"),he=x.useCallback(de=>{const De=de.target.value;if(De!==re)if(Te)cu({dispatch:n,socket:r,view:{...Te,viewType:De},emit:!0});else{const yt=crypto.randomUUID();zG({dispatch:n,socket:r,view:{id:yt,userId:t.userId,gridId:t.gridId,panelId:t.id,name:"Default View",viewType:De},emit:!0}),qn({dispatch:n,socket:r,panel:{...t,viewId:yt},emit:!0})}},[Te,re,t,n,r]),Ae=x.useCallback(de=>{if(!t)return;const De=t.layout||{},yt=kv({...De,...de});qn({dispatch:n,socket:r,panel:{...t,layout:yt},emit:!1}),window.clearTimeout(B.current),B.current=window.setTimeout(()=>{qn({dispatch:n,socket:r,panel:{...t,layout:yt},emit:!0})},150)},[t,r,n]),Le=(K?.style?.display??"block")==="none",ae=g||f===t.id,[Me,J]=x.useState({w:null,h:null});x.useCallback(()=>p?.(t.id),[p,t.id]),x.useCallback(()=>p?.(null),[p]);const X=x.useMemo(()=>V?.(t)||[],[V,t]),ve=X.length>1,Ce=x.useMemo(()=>{const de=K;return de.display==="flex"?de.flow==="row"?"horizontal":"vertical":de.display==="grid"&&(de.columns||0)>1?"horizontal":"vertical"},[K]),Oe=oe||L||$,Ye=x.useMemo(()=>{const De=YN(t,R,I).map(yt=>({...yt,instanceObjects:fR(yt,R,O)}));return{...t,containerObjects:De}},[t,R,I,O]),{ref:et,isDragging:at}=RK({type:qe.PANEL,id:t.id,data:Ye,context:{panelId:t.id,cellId:`cell-${t.row}-${t.col}`},disabled:Le||Oe}),{ref:ct,isOver:ze}=qu({type:"panel-header",id:`panel-header:${t.id}`,context:{panelId:t.id,insertAt:0},accepts:Bl.PANEL_CONTENT,disabled:Le||Ce!=="vertical"}),{ref:He,isOver:ke}=qu({type:"panel-content",id:`panel-content:${t.id}`,context:{panelId:t.id},accepts:Bl.PANEL_CONTENT,disabled:Le}),rt=G?.panelId===t.id,Ge=e.SortableContainer,pt=x.useMemo(()=>YN(t,R,I),[t,R,I]),Ke=()=>{const de=K,De={};if(de.display==="grid"){De.display="grid";const yt=de.minWidthPx>0?`${de.minWidthPx}px`:"280px";De.gridTemplateColumns=de.columns>0?`repeat(${de.columns}, 1fr)`:`repeat(auto-fill, minmax(${yt}, 1fr))`,de.rows>0&&(De.gridTemplateRows=`repeat(${de.rows}, auto)`),de.dense&&(De.gridAutoFlow="dense")}else de.display==="flex"?(De.display="flex",De.flexDirection=de.flow==="column"||de.flow==="col"?"column":"row",De.flexWrap=de.wrap==="nowrap"?"nowrap":"wrap"):de.display==="columns"?(De.display="block",De.columnCount=de.columns>0?de.columns:"auto",de.minWidthPx>0&&(De.columnWidth=`${de.minWidthPx}px`),De.columnGap=`${de.gapPx||12}px`):De.display="block";return de.display!=="columns"&&(De.gap=`${de.gapPx||12}px`),De.alignItems=de.alignItems||"start",De.alignContent=de.alignContent||"start",De.justifyContent=de.justify||"start",de.widthMode==="fixed"&&de.fixedWidth>0&&(De.width=`${de.fixedWidth}px`),de.minWidthPx>0&&de.display!=="grid"&&(De.minWidth=`${de.minWidthPx}px`),de.maxWidthPx>0&&(De.maxWidth=`${de.maxWidthPx}px`),de.heightMode==="fixed"&&de.fixedHeight>0&&(De.height=`${de.fixedHeight}px`),de.minHeightPx>0&&(De.minHeight=`${de.minHeightPx}px`),de.maxHeightPx>0&&(De.maxHeight=`${de.maxHeightPx}px`),De};if(Le&&!g)return null;const ut=Me.w!==null?Me.w:t.width||1,Qe=Me.h!==null?Me.h:t.height||1,jt=ut>1||Qe>1,dt=j.isPanelDrag;return h.jsxs("div",{role:"region","aria-label":K.name||t.label||`Panel ${t.id}`,"data-panel-id":t.id,className:"panel-shell bg-background rounded-lg border border-border shadow-md",style:{gridRow:ae?"auto":`${t.row+1} / span ${Qe}`,gridColumn:ae?"auto":`${t.col+1} / span ${ut}`,position:"relative",display:"flex",flexDirection:"column",overflow:"hidden",minHeight:0,minWidth:0,opacity:at?.4:1,margin:ae?0:"6px",zIndex:jt?60:1,pointerEvents:dt&&!at?"none":"auto",...ae&&{position:"fixed",top:16,left:16,right:16,bottom:16,zIndex:1e3}},children:[h.jsxs("div",{ref:de=>{typeof et=="function"?et(de):et&&(et.current=de),typeof ct=="function"?ct(de):ct&&(ct.current=de)},className:"panel-header no-select border-b border-gray-700 border-solid",style:{userSelect:"none",cursor:Oe?"default":"grab",display:"flex",alignItems:"center",flex:"0 0 auto",position:"relative"},children:[h.jsxs(fo,{open:v,onOpenChange:y,children:[h.jsx(ho,{asChild:!0,children:h.jsx("div",{style:{position:"relative",zIndex:50,display:"flex",height:"100%"},onPointerDown:de=>de.stopPropagation(),onMouseDown:de=>de.stopPropagation(),children:h.jsx(sa,{dragMode:D,onToggleDragMode:Z,onSettings:()=>y(!0),onAddChild:de=>{const De=de?.currentTarget?.getBoundingClientRect?.();T(De?{top:De.bottom+8,left:De.left}:null),S(!0)},addLabel:"Container",size:"sm"})})}),h.jsx(po,{align:"start",side:"right",className:"w-auto",children:h.jsx(BY,{value:K,onChange:Ae,onCommit:le,panelId:t.id,panel:t,onPanelStyleUpdate:ce,iteration:t.iteration,onIterationChange:be,defaultDragMode:t.defaultDragMode,onDragModeChange:H,occurrence:te,onOccurrenceUpdate:me,currentViewType:re,onViewTypeChange:he})})]}),ze&&Ce==="vertical"&&pt.length>0&&h.jsx("div",{style:{position:"absolute",bottom:-1,left:8,right:8,height:2,backgroundColor:"rgb(50, 150, 255)",borderRadius:1,zIndex:10}}),h.jsxs("span",{className:"text-sm font-small pl-1 truncate flex-1 flex items-center gap-1",children:[K.name||t.id,te?.linkedGroupId&&h.jsx(Nl,{className:"w-3 h-3 text-blue-400 opacity-60 flex-shrink-0",title:"Linked"})]}),h.jsx("div",{className:"ml-auto mr-2 flex items-center",onPointerDown:de=>de.stopPropagation(),children:h.jsx(uD,{occurrence:te,onUpdate:me,showModeToggle:!0,compact:!0,alwaysExpanded:!0})}),ve&&h.jsxs("div",{className:"flex items-center gap-1 mr-2",children:[h.jsx(_e,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:()=>we?.({panelId:t.id,dir:-1}),children:h.jsx(Cu,{className:"h-3 w-3"})}),h.jsxs("span",{className:"text-xs text-muted-foreground",children:[X.findIndex(de=>de.id===t.id)+1,"/",X.length]}),h.jsx(_e,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:()=>we?.({panelId:t.id,dir:1}),children:h.jsx(hs,{className:"h-3 w-3"})})]})]}),N?(()=>{const{instance:de,occurrence:De}=N,yt=(de?.fieldBindings||[]).map(We=>({field:Y[We.fieldId],binding:We})).filter(We=>We.field),mt={gridId:De?.gridId,containerId:De?.meta?.containerId,currentIteration:W?.grid?.iterations?.find(We=>We.id===W?.grid?.selectedIterationId)?.timeFilter||"daily"};return h.jsxs("div",{className:"flex-1 flex flex-col min-h-0 overflow-auto p-4",children:[h.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[h.jsxs(_e,{variant:"ghost",size:"sm",onClick:()=>k(null),className:"h-7 text-xs gap-1",children:[h.jsx(qP,{className:"w-3 h-3"})," Back"]}),h.jsx("span",{className:"text-sm font-medium",children:de?.label||"Untitled"})]}),h.jsxs("div",{className:"space-y-3",children:[yt.map(({field:We,binding:Be})=>h.jsx(dR,{field:We,binding:Be,occurrence:De,instance:de,context:mt,state:W,dispatch:n,socket:r,compact:!1},We.id)),yt.length===0&&h.jsx("div",{className:"text-xs text-muted-foreground italic",children:"No fields bound to this instance"})]})]})})():null,!N&&t.viewId?h.jsx(VN,{panel:t,view:z[t.viewId],containers:pt,dispatch:n,socket:r,addContainerToPanel:a,containerContent:h.jsxs("div",{ref:He,className:"panel-content",style:{flex:1,minHeight:0,overflowY:K.scrollY==="auto"?"auto":K.scrollY==="scroll"?"scroll":"hidden",overflowX:K.scrollX==="auto"?"auto":K.scrollX==="scroll"?"scroll":"hidden",padding:0,outline:ke&&oe?"2px solid rgba(50,150,255,0.5)":"none",outlineOffset:-2,position:"relative"},children:[h.jsx("div",{style:{position:"absolute",inset:"5px",borderRadius:"6px",background:"rgba(20, 25, 30, 0.4)",border:"1px solid rgba(0, 0, 0, 0.5)",boxShadow:"inset 0 2px 4px rgba(0, 0, 0, 0.3)",pointerEvents:"none",zIndex:0}}),h.jsxs("div",{style:{...Ke(),position:"relative",minHeight:"100%",zIndex:1,padding:K.padding==="none"?"5px":"12px"},children:[pt.map(de=>h.jsx(Ge,{container:de,panel:t,panelId:t.id,panelLayoutOrientation:Ce,addInstanceToContainer:c,isHot:rt&&G?.containerId===de.id,dispatch:n,socket:r,gapPx:K.gapPx||12},de.id)),pt.length===0&&h.jsx("div",{className:"text-xs text-muted-foreground text-center",style:{fontStyle:"italic",opacity:.6,position:"absolute",top:"40%",left:"50%",transform:"translate(-50%, -50%)",zIndex:2},children:"Drop containers here"})]})]})}):!N&&(t.kind==="notebook"||t.kind==="artifact-viewer")?h.jsx(VN,{panel:t,view:{viewType:t.kind==="notebook"?"notebook":"artifact-viewer"},containers:pt,dispatch:n,socket:r,addContainerToPanel:a}):N?null:h.jsxs("div",{ref:He,className:"panel-content",style:{flex:1,minHeight:0,overflowY:K.scrollY==="auto"?"auto":K.scrollY==="scroll"?"scroll":"hidden",overflowX:K.scrollX==="auto"?"auto":K.scrollX==="scroll"?"scroll":"hidden",padding:0,outline:ke&&oe?"2px solid rgba(50,150,255,0.5)":"none",outlineOffset:-2,position:"relative"},children:[h.jsx("div",{style:{position:"absolute",inset:"5px",borderRadius:"6px",background:"rgba(20, 25, 30, 0.4)",border:"1px solid rgba(0, 0, 0, 0.5)",boxShadow:"inset 0 2px 4px rgba(0, 0, 0, 0.3)",pointerEvents:"none",zIndex:0}}),h.jsxs("div",{style:{...Ke(),position:"relative",minHeight:"100%",zIndex:1,padding:K.padding==="none"?"5px":"12px"},children:[pt.map(de=>h.jsx(Ge,{container:de,panel:t,panelId:t.id,panelLayoutOrientation:Ce,addInstanceToContainer:c,isHot:rt&&G?.containerId===de.id,dispatch:n,socket:r,gapPx:K.gapPx||12,onInstanceFocus:M},de.id)),pt.length===0&&h.jsx("div",{className:"text-xs text-muted-foreground text-center",style:{fontStyle:"italic",opacity:.6,position:"absolute",top:"40%",left:"50%",transform:"translate(-50%, -50%)",zIndex:2},children:"Drop containers here"})]})]}),!ae&&h.jsx(jP,{panel:t,cols:i,rows:o,onResize:({width:de,height:De})=>J({w:de,h:De}),onResizeEnd:({width:de,height:De})=>{J({w:null,h:null}),(de!==t.width||De!==t.height)&&qn({dispatch:n,socket:r,panel:{...t,width:de,height:De},emit:!0})}}),h.jsx(_5,{open:w,onClose:()=>S(!1),onSelect:de=>{a?.(t.id,de),S(!1)},position:C})]})}const RR=Se.memo(_K);function LK({fullscreenPanelId:t,setFullscreenPanelId:e,panelsById:n,components:r,panelProps:i,cols:o,rows:a}){const c=x.useMemo(()=>{const g=Object.values(n??{});return g.sort((v,y)=>{const w=v?.row??0,S=v?.col??0,C=y?.row??0,T=y?.col??0;return w!==C?w-C:S!==T?S-T:String(v?.id).localeCompare(String(y?.id))}),g},[n]),u=n?.[t],f=x.useMemo(()=>u?c.findIndex(g=>g?.id===u.id):-1,[c,u]);if(!u)return null;const p=g=>{const v=c.length;if(v<=1)return;const w=((f>=0?f:0)+g+v)%v,S=c[w]?.id;S&&e(S)};return h.jsxs("div",{"data-fullscreen-overlay":"true",style:{position:"fixed",inset:10,zIndex:999999,pointerEvents:"auto"},children:[h.jsx("div",{style:{position:"absolute",inset:0,background:"rgba(0,0,0,0.55)",borderRadius:12},onClick:()=>e(null)}),h.jsxs("div",{style:{position:"absolute",inset:0,borderRadius:12,overflow:"hidden",zIndex:1e6,pointerEvents:"auto"},children:[h.jsxs("div",{style:{position:"absolute",bottom:0,left:"50%",transform:"translateX(-50%)",zIndex:1000002,display:"flex",alignItems:"center",gap:8,padding:"0px 8px",borderRadius:999,background:"rgba(0,0,0,0.45)",border:"1px solid rgba(255,255,255,0.12)",pointerEvents:"auto"},onClick:g=>g.stopPropagation(),onPointerDown:g=>g.stopPropagation(),children:[h.jsx("button",{type:"button",onClick:g=>{g.preventDefault(),g.stopPropagation(),p(-1)},style:{padding:8,borderRadius:999,background:"transparent",color:"white"},"aria-label":"Previous panel (global)",children:h.jsx(Cu,{className:"h-5 w-5"})}),h.jsx("div",{style:{width:220},children:h.jsx(ot,{value:{activePanelId:u.id},onChange:g=>{const v=g?.activePanelId;v&&e(v)},schema:{type:"select",key:"activePanelId",placeholder:"Select panel",options:c.map((g,v)=>{const y=(g?.layout?.name??"").trim();return{value:g.id,label:y||`Panel ${v+1}`}}),className:"text-[11px] font-mono",contentProps:{side:"top",sideOffset:6,align:"center"}}})}),h.jsx("button",{type:"button",onClick:g=>{g.preventDefault(),g.stopPropagation(),p(1)},style:{padding:8,borderRadius:999,background:"transparent",color:"white"},"aria-label":"Next panel (global)",children:h.jsx(hs,{className:"h-5 w-5"})})]}),h.jsx("div",{style:{position:"absolute",inset:0,zIndex:1e6,pointerEvents:"auto"},children:h.jsx(RR,{panel:u,components:r,cols:o,rows:a,...i,forceFullscreen:!0,fullscreenPanelId:t,setFullscreenPanelId:e})})]})]})}function PK(t){const e=zK(t),n=x.forwardRef((r,i)=>{const{children:o,...a}=r,c=x.Children.toArray(o),u=c.find(FK);if(u){const f=u.props.children,p=c.map(g=>g===u?x.Children.count(f)>1?x.Children.only(null):x.isValidElement(f)?f.props.children:null:g);return h.jsx(e,{...a,ref:i,children:x.isValidElement(f)?x.cloneElement(f,void 0,p):null})}return h.jsx(e,{...a,ref:i,children:o})});return n.displayName=`${t}.Slot`,n}function zK(t){const e=x.forwardRef((n,r)=>{const{children:i,...o}=n;if(x.isValidElement(i)){const a=HK(i),c=$K(o,i.props);return i.type!==x.Fragment&&(c.ref=r?ga(r,a):a),x.cloneElement(i,c)}return x.Children.count(i)>1?x.Children.only(null):null});return e.displayName=`${t}.SlotClone`,e}var BK=Symbol("radix.slottable");function FK(t){return x.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===BK}function $K(t,e){const n={...e};for(const r in e){const i=t[r],o=e[r];/^on[A-Z]/.test(r)?i&&o?n[r]=(...c)=>{const u=o(...c);return i(...c),u}:i&&(n[r]=i):r==="style"?n[r]={...i,...o}:r==="className"&&(n[r]=[i,o].filter(Boolean).join(" "))}return{...t,...n}}function HK(t){let e=Object.getOwnPropertyDescriptor(t.props,"ref")?.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=Object.getOwnPropertyDescriptor(t,"ref")?.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}var cm="Dialog",[jR]=Wr(cm),[UK,di]=jR(cm),IR=t=>{const{__scopeDialog:e,children:n,open:r,defaultOpen:i,onOpenChange:o,modal:a=!0}=t,c=x.useRef(null),u=x.useRef(null),[f,p]=Di({prop:r,defaultProp:i??!1,onChange:o,caller:cm});return h.jsx(UK,{scope:e,triggerRef:c,contentRef:u,contentId:Ci(),titleId:Ci(),descriptionId:Ci(),open:f,onOpenChange:p,onOpenToggle:x.useCallback(()=>p(g=>!g),[p]),modal:a,children:n})};IR.displayName=cm;var _R="DialogTrigger",VK=x.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,i=di(_R,n),o=ht(e,i.triggerRef);return h.jsx(it.button,{type:"button","aria-haspopup":"dialog","aria-expanded":i.open,"aria-controls":i.contentId,"data-state":P0(i.open),...r,ref:o,onClick:Ve(t.onClick,i.onOpenToggle)})});VK.displayName=_R;var _0="DialogPortal",[qK,LR]=jR(_0,{forceMount:void 0}),PR=t=>{const{__scopeDialog:e,forceMount:n,children:r,container:i}=t,o=di(_0,e);return h.jsx(qK,{scope:e,forceMount:n,children:x.Children.map(r,a=>h.jsx(pr,{present:n||o.open,children:h.jsx(Qu,{asChild:!0,container:i,children:a})}))})};PR.displayName=_0;var yp="DialogOverlay",zR=x.forwardRef((t,e)=>{const n=LR(yp,t.__scopeDialog),{forceMount:r=n.forceMount,...i}=t,o=di(yp,t.__scopeDialog);return o.modal?h.jsx(pr,{present:r||o.open,children:h.jsx(WK,{...i,ref:e})}):null});zR.displayName=yp;var GK=PK("DialogOverlay.RemoveScroll"),WK=x.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,i=di(yp,n);return h.jsx(_p,{as:GK,allowPinchZoom:!0,shards:[i.contentRef],children:h.jsx(it.div,{"data-state":P0(i.open),...r,ref:e,style:{pointerEvents:"auto",...r.style}})})}),ma="DialogContent",BR=x.forwardRef((t,e)=>{const n=LR(ma,t.__scopeDialog),{forceMount:r=n.forceMount,...i}=t,o=di(ma,t.__scopeDialog);return h.jsx(pr,{present:r||o.open,children:o.modal?h.jsx(YK,{...i,ref:e}):h.jsx(KK,{...i,ref:e})})});BR.displayName=ma;var YK=x.forwardRef((t,e)=>{const n=di(ma,t.__scopeDialog),r=x.useRef(null),i=ht(e,n.contentRef,r);return x.useEffect(()=>{const o=r.current;if(o)return Db(o)},[]),h.jsx(FR,{...t,ref:i,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Ve(t.onCloseAutoFocus,o=>{o.preventDefault(),n.triggerRef.current?.focus()}),onPointerDownOutside:Ve(t.onPointerDownOutside,o=>{const a=o.detail.originalEvent,c=a.button===0&&a.ctrlKey===!0;(a.button===2||c)&&o.preventDefault()}),onFocusOutside:Ve(t.onFocusOutside,o=>o.preventDefault())})}),KK=x.forwardRef((t,e)=>{const n=di(ma,t.__scopeDialog),r=x.useRef(!1),i=x.useRef(!1);return h.jsx(FR,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:o=>{t.onCloseAutoFocus?.(o),o.defaultPrevented||(r.current||n.triggerRef.current?.focus(),o.preventDefault()),r.current=!1,i.current=!1},onInteractOutside:o=>{t.onInteractOutside?.(o),o.defaultPrevented||(r.current=!0,o.detail.originalEvent.type==="pointerdown"&&(i.current=!0));const a=o.target;n.triggerRef.current?.contains(a)&&o.preventDefault(),o.detail.originalEvent.type==="focusin"&&i.current&&o.preventDefault()}})}),FR=x.forwardRef((t,e)=>{const{__scopeDialog:n,trapFocus:r,onOpenAutoFocus:i,onCloseAutoFocus:o,...a}=t,c=di(ma,n),u=x.useRef(null),f=ht(e,u);return yb(),h.jsxs(h.Fragment,{children:[h.jsx(Np,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:i,onUnmountAutoFocus:o,children:h.jsx(Xu,{role:"dialog",id:c.contentId,"aria-describedby":c.descriptionId,"aria-labelledby":c.titleId,"data-state":P0(c.open),...a,ref:f,onDismiss:()=>c.onOpenChange(!1)})}),h.jsxs(h.Fragment,{children:[h.jsx(XK,{titleId:c.titleId}),h.jsx(QK,{contentRef:u,descriptionId:c.descriptionId})]})]})}),L0="DialogTitle",$R=x.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,i=di(L0,n);return h.jsx(it.h2,{id:i.titleId,...r,ref:e})});$R.displayName=L0;var HR="DialogDescription",UR=x.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,i=di(HR,n);return h.jsx(it.p,{id:i.descriptionId,...r,ref:e})});UR.displayName=HR;var VR="DialogClose",qR=x.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,i=di(VR,n);return h.jsx(it.button,{type:"button",...r,ref:e,onClick:Ve(t.onClick,()=>i.onOpenChange(!1))})});qR.displayName=VR;function P0(t){return t?"open":"closed"}var GR="DialogTitleWarning",[AZ,WR]=I4(GR,{contentName:ma,titleName:L0,docsSlug:"dialog"}),XK=({titleId:t})=>{const e=WR(GR),n=`\`${e.contentName}\` requires a \`${e.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${e.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${e.docsSlug}`;return x.useEffect(()=>{t&&(document.getElementById(t)||console.error(n))},[n,t]),null},JK="DialogDescriptionWarning",QK=({contentRef:t,descriptionId:e})=>{const r=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${WR(JK).contentName}}.`;return x.useEffect(()=>{const i=t.current?.getAttribute("aria-describedby");e&&i&&(document.getElementById(e)||console.warn(r))},[r,t,e]),null},ZK=IR,eX=PR,YR=zR,KR=BR,XR=$R,JR=UR,tX=qR;const QR=ZK,nX=eX,ZR=x.forwardRef(({className:t,...e},n)=>h.jsx(YR,{ref:n,className:Wt("fixed inset-0 z-[1100] bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...e}));ZR.displayName=YR.displayName;const z0=x.forwardRef(({className:t,children:e,...n},r)=>h.jsxs(nX,{children:[h.jsx(ZR,{}),h.jsxs(KR,{ref:r,className:Wt("fixed left-[50%] top-[50%] z-[1100] grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...n,children:[e,h.jsxs(tX,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[h.jsx(Hl,{className:"h-4 w-4"}),h.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));z0.displayName=KR.displayName;const B0=({className:t,...e})=>h.jsx("div",{className:Wt("flex flex-col space-y-1.5 text-center sm:text-left",t),...e});B0.displayName="DialogHeader";const F0=x.forwardRef(({className:t,...e},n)=>h.jsx(XR,{ref:n,className:Wt("text-lg font-semibold leading-none tracking-tight",t),...e}));F0.displayName=XR.displayName;const rX=x.forwardRef(({className:t,...e},n)=>h.jsx(JR,{ref:n,className:Wt("text-sm text-muted-foreground",t),...e}));rX.displayName=JR.displayName;var Dv="rovingFocusGroup.onEntryFocus",iX={bubbles:!1,cancelable:!0},ad="RovingFocusGroup",[Vx,ej,oX]=gb(ad),[sX,tj]=Wr(ad,[oX]),[aX,lX]=sX(ad),nj=x.forwardRef((t,e)=>h.jsx(Vx.Provider,{scope:t.__scopeRovingFocusGroup,children:h.jsx(Vx.Slot,{scope:t.__scopeRovingFocusGroup,children:h.jsx(cX,{...t,ref:e})})}));nj.displayName=ad;var cX=x.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:n,orientation:r,loop:i=!1,dir:o,currentTabStopId:a,defaultCurrentTabStopId:c,onCurrentTabStopIdChange:u,onEntryFocus:f,preventScrollOnEntryFocus:p=!1,...g}=t,v=x.useRef(null),y=ht(e,v),w=Ku(o),[S,C]=Di({prop:a,defaultProp:c??null,onChange:u,caller:ad}),[T,N]=x.useState(!1),k=Qn(f),D=ej(n),M=x.useRef(!1),[R,O]=x.useState(0);return x.useEffect(()=>{const I=v.current;if(I)return I.addEventListener(Dv,k),()=>I.removeEventListener(Dv,k)},[k]),h.jsx(aX,{scope:n,orientation:r,dir:w,loop:i,currentTabStopId:S,onItemFocus:x.useCallback(I=>C(I),[C]),onItemShiftTab:x.useCallback(()=>N(!0),[]),onFocusableItemAdd:x.useCallback(()=>O(I=>I+1),[]),onFocusableItemRemove:x.useCallback(()=>O(I=>I-1),[]),children:h.jsx(it.div,{tabIndex:T||R===0?-1:0,"data-orientation":r,...g,ref:y,style:{outline:"none",...t.style},onMouseDown:Ve(t.onMouseDown,()=>{M.current=!0}),onFocus:Ve(t.onFocus,I=>{const z=!M.current;if(I.target===I.currentTarget&&z&&!T){const U=new CustomEvent(Dv,iX);if(I.currentTarget.dispatchEvent(U),!U.defaultPrevented){const Y=D().filter(L=>L.focusable),W=Y.find(L=>L.active),j=Y.find(L=>L.id===S),oe=[W,j,...Y].filter(Boolean).map(L=>L.ref.current);oj(oe,p)}}M.current=!1}),onBlur:Ve(t.onBlur,()=>N(!1))})})}),rj="RovingFocusGroupItem",ij=x.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:n,focusable:r=!0,active:i=!1,tabStopId:o,children:a,...c}=t,u=Ci(),f=o||u,p=lX(rj,n),g=p.currentTabStopId===f,v=ej(n),{onFocusableItemAdd:y,onFocusableItemRemove:w,currentTabStopId:S}=p;return x.useEffect(()=>{if(r)return y(),()=>w()},[r,y,w]),h.jsx(Vx.ItemSlot,{scope:n,id:f,focusable:r,active:i,children:h.jsx(it.span,{tabIndex:g?0:-1,"data-orientation":p.orientation,...c,ref:e,onMouseDown:Ve(t.onMouseDown,C=>{r?p.onItemFocus(f):C.preventDefault()}),onFocus:Ve(t.onFocus,()=>p.onItemFocus(f)),onKeyDown:Ve(t.onKeyDown,C=>{if(C.key==="Tab"&&C.shiftKey){p.onItemShiftTab();return}if(C.target!==C.currentTarget)return;const T=fX(C,p.orientation,p.dir);if(T!==void 0){if(C.metaKey||C.ctrlKey||C.altKey||C.shiftKey)return;C.preventDefault();let k=v().filter(D=>D.focusable).map(D=>D.ref.current);if(T==="last")k.reverse();else if(T==="prev"||T==="next"){T==="prev"&&k.reverse();const D=k.indexOf(C.currentTarget);k=p.loop?hX(k,D+1):k.slice(D+1)}setTimeout(()=>oj(k))}}),children:typeof a=="function"?a({isCurrentTabStop:g,hasTabStop:S!=null}):a})})});ij.displayName=rj;var uX={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function dX(t,e){return e!=="rtl"?t:t==="ArrowLeft"?"ArrowRight":t==="ArrowRight"?"ArrowLeft":t}function fX(t,e,n){const r=dX(t.key,n);if(!(e==="vertical"&&["ArrowLeft","ArrowRight"].includes(r))&&!(e==="horizontal"&&["ArrowUp","ArrowDown"].includes(r)))return uX[r]}function oj(t,e=!1){const n=document.activeElement;for(const r of t)if(r===n||(r.focus({preventScroll:e}),document.activeElement!==n))return}function hX(t,e){return t.map((n,r)=>t[(e+r)%t.length])}var pX=nj,mX=ij,um="Tabs",[gX]=Wr(um,[tj]),sj=tj(),[yX,$0]=gX(um),aj=x.forwardRef((t,e)=>{const{__scopeTabs:n,value:r,onValueChange:i,defaultValue:o,orientation:a="horizontal",dir:c,activationMode:u="automatic",...f}=t,p=Ku(c),[g,v]=Di({prop:r,onChange:i,defaultProp:o??"",caller:um});return h.jsx(yX,{scope:n,baseId:Ci(),value:g,onValueChange:v,orientation:a,dir:p,activationMode:u,children:h.jsx(it.div,{dir:p,"data-orientation":a,...f,ref:e})})});aj.displayName=um;var lj="TabsList",cj=x.forwardRef((t,e)=>{const{__scopeTabs:n,loop:r=!0,...i}=t,o=$0(lj,n),a=sj(n);return h.jsx(pX,{asChild:!0,...a,orientation:o.orientation,dir:o.dir,loop:r,children:h.jsx(it.div,{role:"tablist","aria-orientation":o.orientation,...i,ref:e})})});cj.displayName=lj;var uj="TabsTrigger",dj=x.forwardRef((t,e)=>{const{__scopeTabs:n,value:r,disabled:i=!1,...o}=t,a=$0(uj,n),c=sj(n),u=pj(a.baseId,r),f=mj(a.baseId,r),p=r===a.value;return h.jsx(mX,{asChild:!0,...c,focusable:!i,active:p,children:h.jsx(it.button,{type:"button",role:"tab","aria-selected":p,"aria-controls":f,"data-state":p?"active":"inactive","data-disabled":i?"":void 0,disabled:i,id:u,...o,ref:e,onMouseDown:Ve(t.onMouseDown,g=>{!i&&g.button===0&&g.ctrlKey===!1?a.onValueChange(r):g.preventDefault()}),onKeyDown:Ve(t.onKeyDown,g=>{[" ","Enter"].includes(g.key)&&a.onValueChange(r)}),onFocus:Ve(t.onFocus,()=>{const g=a.activationMode!=="manual";!p&&!i&&g&&a.onValueChange(r)})})})});dj.displayName=uj;var fj="TabsContent",hj=x.forwardRef((t,e)=>{const{__scopeTabs:n,value:r,forceMount:i,children:o,...a}=t,c=$0(fj,n),u=pj(c.baseId,r),f=mj(c.baseId,r),p=r===c.value,g=x.useRef(p);return x.useEffect(()=>{const v=requestAnimationFrame(()=>g.current=!1);return()=>cancelAnimationFrame(v)},[]),h.jsx(pr,{present:i||p,children:({present:v})=>h.jsx(it.div,{"data-state":p?"active":"inactive","data-orientation":c.orientation,role:"tabpanel","aria-labelledby":u,hidden:!v,id:f,tabIndex:0,...a,ref:e,style:{...t.style,animationDuration:g.current?"0s":void 0},children:v&&o})})});hj.displayName=fj;function pj(t,e){return`${t}-trigger-${e}`}function mj(t,e){return`${t}-content-${e}`}var vX=aj,gj=cj,yj=dj,vj=hj;const xX=vX,xj=x.forwardRef(({className:t,...e},n)=>h.jsx(gj,{ref:n,className:Wt("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",t),...e}));xj.displayName=gj.displayName;const uu=x.forwardRef(({className:t,...e},n)=>h.jsx(yj,{ref:n,className:Wt("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",t),...e}));uu.displayName=yj.displayName;const du=x.forwardRef(({className:t,...e},n)=>h.jsx(vj,{ref:n,className:Wt("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",t),...e}));du.displayName=vj.displayName;const ee={FIELD:"field",LITERAL:"literal",VARIABLE:"variable",OPERATOR:"operator",COMPARISON:"comparison",LOGICAL:"logical",AGGREGATION:"aggregation",FUNCTION:"function",CONDITION:"condition",LOOP:"loop",SET_VARIABLE:"set_var",ON_DROP:"on_drop",ON_CHANGE:"on_change"},ii={REPORTER:"reporter",STATEMENT:"statement",C_BLOCK:"c_block",HAT:"hat",CAP:"cap"};function bX(t){switch(t){case ee.FIELD:case ee.LITERAL:case ee.VARIABLE:case ee.OPERATOR:case ee.COMPARISON:case ee.LOGICAL:case ee.AGGREGATION:case ee.FUNCTION:return ii.REPORTER;case ee.SET_VARIABLE:return ii.STATEMENT;case ee.CONDITION:case ee.LOOP:return ii.C_BLOCK;case ee.ON_DROP:case ee.ON_CHANGE:return ii.HAT;default:return ii.REPORTER}}const bj={[ee.FIELD]:"bg-blue-500",[ee.LITERAL]:"bg-gray-500",[ee.VARIABLE]:"bg-red-400",[ee.OPERATOR]:"bg-green-500",[ee.COMPARISON]:"bg-cyan-500",[ee.LOGICAL]:"bg-cyan-600",[ee.AGGREGATION]:"bg-purple-500",[ee.FUNCTION]:"bg-teal-500",[ee.CONDITION]:"bg-orange-500",[ee.LOOP]:"bg-yellow-500",[ee.SET_VARIABLE]:"bg-red-500",[ee.ON_DROP]:"bg-amber-600",[ee.ON_CHANGE]:"bg-amber-600"};function kt(t,e={},n={}){const r=n.shape||bX(t),i=n.id||`block-${Date.now()}-${Math.random().toString(36).slice(2,8)}`;return{id:i,type:t,shape:r,label:n.label||wX(t,e),color:bj[t]||"bg-gray-500",slots:SX(t,e),innerSlots:r===ii.C_BLOCK?[{id:`inner-${i}`,connected:[]}]:void 0,data:e}}function wX(t,e){switch(t){case ee.FIELD:return e.fieldName||"Field";case ee.LITERAL:return String(e.value??"?");case ee.VARIABLE:return e.varName||"var";case ee.OPERATOR:return e.op||"+";case ee.COMPARISON:return tm[e.op]?.label||e.op||"=";case ee.LOGICAL:return e.op?.toUpperCase()||"AND";case ee.AGGREGATION:return ba[e.aggregation]?.label||e.aggregation||"sum";case ee.FUNCTION:return e.fn||"round";case ee.CONDITION:return"if";case ee.LOOP:return e.loopType==="repeat"?"repeat":"for each";case ee.SET_VARIABLE:return"set";case ee.ON_DROP:return"when dropped";case ee.ON_CHANGE:return"when changed";default:return t}}function SX(t,e){switch(t){case ee.FIELD:case ee.LITERAL:case ee.VARIABLE:return[];case ee.OPERATOR:return[{id:"left",label:"",accepts:[ee.FIELD,ee.LITERAL,ee.OPERATOR,ee.AGGREGATION,ee.FUNCTION],connected:null},{id:"right",label:"",accepts:[ee.FIELD,ee.LITERAL,ee.OPERATOR,ee.AGGREGATION,ee.FUNCTION],connected:null}];case ee.COMPARISON:return[{id:"left",label:"",accepts:[ee.FIELD,ee.LITERAL,ee.OPERATOR,ee.AGGREGATION,ee.FUNCTION],connected:null},{id:"right",label:"",accepts:[ee.FIELD,ee.LITERAL,ee.OPERATOR,ee.AGGREGATION,ee.FUNCTION],connected:null}];case ee.LOGICAL:return e.op==="not"?[{id:"value",label:"",accepts:[ee.COMPARISON,ee.LOGICAL],connected:null}]:[{id:"left",label:"",accepts:[ee.COMPARISON,ee.LOGICAL],connected:null},{id:"right",label:"",accepts:[ee.COMPARISON,ee.LOGICAL],connected:null}];case ee.AGGREGATION:return[{id:"source",label:"of",accepts:[ee.FIELD],connected:null}];case ee.FUNCTION:return[{id:"value",label:"",accepts:[ee.FIELD,ee.LITERAL,ee.OPERATOR,ee.AGGREGATION,ee.FUNCTION],connected:null}];case ee.CONDITION:return[{id:"condition",label:"if",accepts:[ee.COMPARISON,ee.LOGICAL],connected:null}];case ee.LOOP:return e.loopType==="repeat"?[{id:"count",label:"times",accepts:[ee.LITERAL,ee.FIELD,ee.OPERATOR],connected:null}]:[{id:"collection",label:"in",accepts:[ee.FIELD],connected:null}];case ee.SET_VARIABLE:return[{id:"varName",label:"set",accepts:[ee.VARIABLE],connected:null},{id:"value",label:"to",accepts:[ee.FIELD,ee.LITERAL,ee.OPERATOR,ee.AGGREGATION,ee.FUNCTION],connected:null}];case ee.ON_DROP:case ee.ON_CHANGE:return[];default:return[]}}const EX={fields:{id:"fields",label:"Fields",color:"blue",description:"Field values from your data",blocks:[]},values:{id:"values",label:"Values",color:"gray",description:"Constant values and variables",blocks:[kt(ee.LITERAL,{value:0,valueType:"number"},{label:"0"}),kt(ee.LITERAL,{value:"",valueType:"text"},{label:'""'}),kt(ee.LITERAL,{value:!0,valueType:"boolean"},{label:"true"}),kt(ee.VARIABLE,{varName:"result"},{label:"result"})]},math:{id:"math",label:"Math",color:"green",description:"Mathematical operations",blocks:[kt(ee.OPERATOR,{op:"+"},{label:"+"}),kt(ee.OPERATOR,{op:"-"},{label:""}),kt(ee.OPERATOR,{op:"*"},{label:""}),kt(ee.OPERATOR,{op:"/"},{label:""}),kt(ee.OPERATOR,{op:"%"},{label:"mod"})]},aggregations:{id:"aggregations",label:"Aggregations",color:"purple",description:"Aggregate field values",blocks:Object.entries(ba).map(([t,e])=>kt(ee.AGGREGATION,{aggregation:t},{label:`${e.symbol} ${e.label}`}))},logic:{id:"logic",label:"Logic",color:"cyan",description:"Comparisons and boolean logic",blocks:[kt(ee.COMPARISON,{op:">"},{label:">"}),kt(ee.COMPARISON,{op:"<"},{label:"<"}),kt(ee.COMPARISON,{op:"=="},{label:"="}),kt(ee.COMPARISON,{op:"!="},{label:""}),kt(ee.COMPARISON,{op:">="},{label:""}),kt(ee.COMPARISON,{op:"<="},{label:""}),kt(ee.LOGICAL,{op:"and"},{label:"AND"}),kt(ee.LOGICAL,{op:"or"},{label:"OR"}),kt(ee.LOGICAL,{op:"not"},{label:"NOT"})]},functions:{id:"functions",label:"Functions",color:"teal",description:"Built-in functions",blocks:[kt(ee.FUNCTION,{fn:"round"},{label:"round"}),kt(ee.FUNCTION,{fn:"floor"},{label:"floor"}),kt(ee.FUNCTION,{fn:"ceil"},{label:"ceil"}),kt(ee.FUNCTION,{fn:"abs"},{label:"abs"}),kt(ee.FUNCTION,{fn:"sqrt"},{label:""}),kt(ee.FUNCTION,{fn:"min"},{label:"min"}),kt(ee.FUNCTION,{fn:"max"},{label:"max"})]},control:{id:"control",label:"Control",color:"orange",description:"Conditionals and loops",blocks:[kt(ee.CONDITION,{},{label:"if / then"}),kt(ee.LOOP,{loopType:"foreach"},{label:"for each"}),kt(ee.LOOP,{loopType:"repeat"},{label:"repeat"}),kt(ee.SET_VARIABLE,{},{label:"set var"})]},triggers:{id:"triggers",label:"Triggers",color:"amber",description:"Event triggers for automation",blocks:[kt(ee.ON_DROP,{},{label:"when dropped"}),kt(ee.ON_CHANGE,{},{label:"when changed"})]}};function wj(){return Object.values(EX)}function Sj(t=[],e={}){const{includeInput:n=!0,includeDerived:r=!0,filterByType:i=null}=e;return t.filter(o=>i&&o.type!==i?!1:!!(o.mode==="input"&&n||o.mode==="derived"&&r)).map(o=>{const a=o.mode==="input",c=o.name||o.type,u=a?c:` ${c}`;return kt(ee.FIELD,{fieldId:o.id,fieldName:o.name,fieldType:o.type,fieldMode:o.mode,metric:o.mode==="derived"?o.metric:void 0},{label:u})})}function ia(t){const e=`block-${Date.now()}-${Math.random().toString(36).slice(2,8)}`;return{...t,id:e,slots:t.slots?.map(r=>({...r,id:`${r.id}-${e}`,connected:r.connected?ia(r.connected):null})),innerSlots:t.innerSlots?.map(r=>({...r,id:`${r.id}-${e}`,connected:r.connected?.map(i=>ia(i))||[]}))}}function Ov(t,e){return!t||!e?!1:t.accepts.includes(e.type)}const Ej=x.createContext(null);function H0(){return x.useContext(Ej)}function Cj({children:t,onBlockMove:e,onBlockConnect:n}){const[r,i]=x.useState(null),[o,a]=x.useState(null),c=x.useCallback(g=>{i(g)},[]),u=x.useCallback(()=>{i(null),a(null)},[]),f=x.useCallback(g=>{if(!r)return;const{targetType:v,targetId:y,slotId:w,edge:S}=g;v==="slot"?n?.(r,y,w):v==="canvas"?e?.(r,{x:g.x,y:g.y}):v==="block-stack"&&e?.(r,{stackId:y,edge:S}),u()},[r,n,e,u]),p={activeBlock:r,dropTarget:o,setDropTarget:a,handleDragStart:c,handleDragEnd:u,handleDrop:f};return h.jsx(Ej.Provider,{value:p,children:t})}function CX({block:t,disabled:e=!1,onDragStart:n,isPalette:r=!1}){const i=x.useRef(null),[o,a]=x.useState(!1),c=H0();return x.useEffect(()=>{const u=i.current;return!u||e?void 0:id({element:u,getInitialData:()=>({type:"block",block:t,isPalette:r}),onDragStart:()=>{a(!0),c?.handleDragStart(t),n?.(t)},onDrop:()=>{a(!1)}})},[t,e,r,c,n]),{ref:i,isDragging:o,dragProps:{"data-block-id":t?.id,"data-block-type":t?.type,"data-dragging":o}}}function TX({slot:t,parentBlockId:e,disabled:n=!1,onConnect:r}){const i=x.useRef(null),[o,a]=x.useState(!1),[c,u]=x.useState(!1),f=H0();return x.useEffect(()=>{const p=i.current;return!p||n?void 0:Zl({element:p,canDrop:({source:v})=>{const y=v.data?.block;return y?Ov(t,y):!1},getData:()=>({targetType:"slot",targetId:e,slotId:t.id}),onDragEnter:({source:v})=>{const y=v.data?.block,w=Ov(t,y);a(!0),u(w),w&&f?.setDropTarget({type:"slot",slotId:t.id,parentBlockId:e})},onDragLeave:()=>{a(!1),u(!1),f?.setDropTarget(null)},onDrop:({source:v})=>{a(!1),u(!1);const y=v.data?.block,w=v.data?.isPalette;y&&Ov(t,y)&&(r?.(y,w),f?.handleDrop({targetType:"slot",targetId:e,slotId:t.id}))}})},[t,e,n,f,r]),{ref:i,isOver:o,canDrop:c,dropProps:{"data-slot-id":t?.id,"data-slot-over":o,"data-slot-can-drop":c}}}function Tj({disabled:t=!1,onDrop:e}){const n=x.useRef(null),[r,i]=x.useState(!1),o=H0();return x.useEffect(()=>{const a=n.current;return!a||t?void 0:Zl({element:a,canDrop:({source:u})=>u.data?.type==="block",getData:({input:u,element:f})=>{const p=f.getBoundingClientRect();return{targetType:"canvas",x:u.clientX-p.left,y:u.clientY-p.top}},onDragEnter:()=>{i(!0)},onDragLeave:()=>{i(!1)},onDrop:({source:u,self:f})=>{i(!1);const p=u.data?.block,g=u.data?.isPalette;p&&e?.(p,g,{x:f.data.x,y:f.data.y})}})},[t,o,e]),{ref:n,isOver:r,dropProps:{"data-canvas":"true","data-canvas-over":r}}}function U0(t,e={}){if(!t)return null;const{state:n={},fieldsById:r={},variables:i={}}=e;switch(t.type){case ee.FIELD:{const{fieldId:o}=t.data;if(!o)return null;const a=n.occurrences||[],c=$u(a,o,{flowFilter:"any"});return c.length===0?null:r[o]?.type==="number"?c.reduce((f,p)=>f+p,0):c[c.length-1]}case ee.LITERAL:return t.data.value;case ee.VARIABLE:{const{varName:o}=t.data;return i[o]??null}case ee.OPERATOR:{const o=Er(t,"left",e),a=Er(t,"right",e);if(o===null||a===null)return null;const c=Number(o),u=Number(a);switch(t.data.op){case"+":return c+u;case"-":return c-u;case"*":return c*u;case"/":return u!==0?c/u:null;case"%":return u!==0?c%u:null;default:return null}}case ee.COMPARISON:{const o=Er(t,"left",e),a=Er(t,"right",e);if(o===null||a===null)return null;switch(t.data.op){case">":return o>a;case"<":return o<a;case">=":return o>=a;case"<=":return o<=a;case"==":return o===a;case"!=":return o!==a;default:return!1}}case ee.LOGICAL:switch(t.data.op){case"and":{const o=Er(t,"left",e),a=Er(t,"right",e);return!!o&&!!a}case"or":{const o=Er(t,"left",e),a=Er(t,"right",e);return!!o||!!a}case"not":return!Er(t,"value",e);default:return!1}case ee.AGGREGATION:{const{aggregation:o}=t.data;if(!o||!ba[o])return null;const c=t.slots?.find(g=>g.id==="source")?.connected;if(!c||c.type!==ee.FIELD)return null;const{fieldId:u}=c.data;if(!u)return null;const f=n.occurrences||[],p=$u(f,u,{flowFilter:"any"});return E0(p,o)}case ee.FUNCTION:{const o=Er(t,"value",e);if(o===null)return null;const a=Number(o);switch(t.data.fn){case"round":return Math.round(a);case"floor":return Math.floor(a);case"ceil":return Math.ceil(a);case"abs":return Math.abs(a);case"sqrt":return a>=0?Math.sqrt(a):null;case"min":return a;case"max":return a;default:return o}}case ee.CONDITION:return Er(t,"condition",e)?Mv(t,0,e):Mv(t,1,e);case ee.LOOP:if(t.data.loopType==="repeat"){const o=Er(t,"count",e),a=Number(o)||0;let c=null;for(let u=0;u<a;u++)c=Mv(t,0,{...e,variables:{...e.variables,index:u}});return c}else return null;case ee.SET_VARIABLE:{const o=t.slots?.find(c=>c.id==="varName")?.connected,a=Er(t,"value",e);return o?.type===ee.VARIABLE?{varName:o.data.varName,value:a}:null}case ee.ON_DROP:case ee.ON_CHANGE:return null;default:return console.warn(`Unknown block type: ${t.type}`),null}}function Er(t,e,n){const r=t.slots?.find(i=>i.id===e);return r?.connected?U0(r.connected,n):null}function Mv(t,e,n){const r=t.innerSlots?.[e];if(!r?.connected?.length)return null;let i=null;for(const o of r.connected)i=U0(o,n);return i}function NX(t,e={}){const n={value:null,variables:{...e.variables},errors:[]};try{n.value=U0(t,{...e,variables:n.variables})}catch(r){n.errors.push({message:r.message,blockId:t?.id})}return n}function Nj(t){if(!t)return"empty";switch(t.type){case ee.FIELD:return t.data.fieldName||"field";case ee.LITERAL:return String(t.data.value);case ee.VARIABLE:return t.data.varName||"var";case ee.OPERATOR:{const e=yi(t,"left"),n=yi(t,"right");return`(${e} ${t.data.op} ${n})`}case ee.COMPARISON:{const e=yi(t,"left"),n=yi(t,"right");return`(${e} ${t.data.op} ${n})`}case ee.LOGICAL:{if(t.data.op==="not")return`NOT ${yi(t,"value")}`;const e=yi(t,"left"),n=yi(t,"right");return`(${e} ${t.data.op.toUpperCase()} ${n})`}case ee.AGGREGATION:{const e=yi(t,"source");return`${ba[t.data.aggregation]?.symbol||t.data.aggregation}(${e})`}case ee.FUNCTION:{const e=yi(t,"value");return`${t.data.fn}(${e})`}case ee.CONDITION:return`if ${yi(t,"condition")} then ...`;default:return t.label||t.type}}function yi(t,e){const n=t.slots?.find(r=>r.id===e);return n?.connected?Nj(n.connected):"?"}function qx(t){return t?{type:t.type,data:t.data,slots:t.slots?.map(e=>({id:e.id,connected:qx(e.connected)})).filter(e=>e.connected),innerSlots:t.innerSlots?.map(e=>({id:e.id,connected:e.connected?.map(n=>qx(n)).filter(Boolean)})).filter(e=>e.connected?.length>0)}:null}function Gx(t,e={}){if(!t)return null;const{createBlock:n}=require("./blockTypes"),r=n(t.type,t.data);for(const i of t.slots||[]){const o=r.slots?.find(a=>a.id===i.id);o&&i.connected&&(o.connected=Gx(i.connected,e))}for(const i of t.innerSlots||[]){const o=r.innerSlots?.find(a=>a.id===i.id);o&&i.connected&&(o.connected=i.connected.map(a=>Gx(a,e)))}return r}function Fr({slot:t,parentBlockId:e,onConnect:n,renderConnected:r,disabled:i=!1}){const{ref:o,isOver:a,canDrop:c,dropProps:u}=TX({slot:t,parentBlockId:e,disabled:i,onConnect:n}),f=!!t.connected;return h.jsx("span",{ref:o,...u,className:`
        inline-slot
        inline-flex items-center
        ${f?"":`
          px-1.5 py-0.5
          border border-dashed rounded
          ${a&&c?"border-white bg-white/20":"border-white/30 bg-black/10"}
          ${a&&!c?"border-red-400":""}
        `}
      `,children:f?r?r(t.connected):h.jsx("span",{className:"text-xs",children:t.connected.label}):h.jsx("span",{className:"text-[10px] text-white/50 min-w-[16px] text-center",children:t.label||"?"})})}function Rv({innerSlot:t,parentBlockId:e,onInsert:n,renderBlocks:r,disabled:i=!1}){const o=t?.connected?.length>0;return h.jsx("div",{className:`
        c-block-inner
        ml-4 my-1.5 p-2
        min-h-[32px]
        bg-black/15 rounded
        border border-dashed border-white/20
      `,children:o?r(t.connected):h.jsx("div",{className:"text-[10px] text-white/40 text-center py-1",children:"drop blocks here"})})}function Gu({block:t,nested:e=!1,isPalette:n=!1,onSlotConnect:r,onInnerInsert:i,onRemove:o,disabled:a=!1}){const{ref:c,isDragging:u,dragProps:f}=CX({block:t,disabled:a,isPalette:n}),p=x.useCallback(C=>(T,N)=>{r?.(t.id,C,T,N)},[t.id,r]),g=x.useCallback(C=>(T,N,k)=>{i?.(t.id,C,T,N,k)},[t.id,i]),v=x.useCallback(C=>h.jsx(Gu,{block:C,nested:!0,onSlotConnect:r,onInnerInsert:i,onRemove:o}),[r,i,o]),y=x.useCallback(C=>h.jsx("div",{className:"block-stack space-y-1",children:C.map((T,N)=>h.jsx(Gu,{block:T,onSlotConnect:r,onInnerInsert:i,onRemove:o},T.id))}),[r,i,o]),w=kX(t.shape,e),S=bj[t.type]||"bg-gray-500";return h.jsxs("div",{ref:c,...f,className:`
        block-wrapper
        relative inline-flex items-center
        text-white font-medium
        cursor-grab active:cursor-grabbing
        select-none
        transition-opacity
        ${w}
        ${S}
        ${u?"opacity-50":"opacity-100"}
        ${e?"text-xs":"text-sm"}
      `,children:[!n&&!e&&o&&h.jsx("button",{className:"absolute -top-1 -right-1 w-4 h-4 rounded-full bg-red-500 hover:bg-red-600 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",onClick:C=>{C.stopPropagation(),o(t.id)},children:h.jsx(Hl,{className:"w-2.5 h-2.5"})}),AX({block:t,nested:e,handleConnect:p,handleInnerInsert:g,renderConnected:v,renderInnerBlocks:y,disabled:a})]})}function AX({block:t,nested:e,handleConnect:n,handleInnerInsert:r,renderConnected:i,renderInnerBlocks:o,disabled:a}){switch(t.type){case ee.FIELD:case ee.LITERAL:case ee.VARIABLE:return h.jsx("span",{children:t.label});case ee.OPERATOR:case ee.COMPARISON:{const c=t.slots?.find(f=>f.id==="left"),u=t.slots?.find(f=>f.id==="right");return h.jsxs("div",{className:"flex items-center gap-1",children:[c&&h.jsx(Fr,{slot:c,parentBlockId:t.id,onConnect:n("left"),renderConnected:i,disabled:a}),h.jsx("span",{className:"px-1",children:t.label}),u&&h.jsx(Fr,{slot:u,parentBlockId:t.id,onConnect:n("right"),renderConnected:i,disabled:a})]})}case ee.LOGICAL:{if(t.data.op==="not"){const f=t.slots?.find(p=>p.id==="value");return h.jsxs("div",{className:"flex items-center gap-1",children:[h.jsx("span",{children:"NOT"}),f&&h.jsx(Fr,{slot:f,parentBlockId:t.id,onConnect:n("value"),renderConnected:i,disabled:a})]})}const c=t.slots?.find(f=>f.id==="left"),u=t.slots?.find(f=>f.id==="right");return h.jsxs("div",{className:"flex items-center gap-1",children:[c&&h.jsx(Fr,{slot:c,parentBlockId:t.id,onConnect:n("left"),renderConnected:i,disabled:a}),h.jsx("span",{className:"px-1",children:t.label}),u&&h.jsx(Fr,{slot:u,parentBlockId:t.id,onConnect:n("right"),renderConnected:i,disabled:a})]})}case ee.AGGREGATION:{const c=t.slots?.find(u=>u.id==="source");return h.jsxs("div",{className:"flex items-center gap-1",children:[h.jsx("span",{children:t.label}),h.jsx("span",{children:"("}),c&&h.jsx(Fr,{slot:c,parentBlockId:t.id,onConnect:n("source"),renderConnected:i,disabled:a}),h.jsx("span",{children:")"})]})}case ee.FUNCTION:{const c=t.slots?.find(u=>u.id==="value");return h.jsxs("div",{className:"flex items-center gap-1",children:[h.jsx("span",{children:t.label}),h.jsx("span",{children:"("}),c&&h.jsx(Fr,{slot:c,parentBlockId:t.id,onConnect:n("value"),renderConnected:i,disabled:a}),h.jsx("span",{children:")"})]})}case ee.CONDITION:{const c=t.slots?.find(f=>f.id==="condition"),u=t.innerSlots?.[0];return h.jsxs("div",{className:"flex flex-col",children:[h.jsxs("div",{className:"flex items-center gap-1",children:[h.jsx("span",{children:"if"}),c&&h.jsx(Fr,{slot:c,parentBlockId:t.id,onConnect:n("condition"),renderConnected:i,disabled:a}),h.jsx("span",{children:"then"})]}),u&&h.jsx(Rv,{innerSlot:u,parentBlockId:t.id,onInsert:r(u.id),renderBlocks:o,disabled:a})]})}case ee.LOOP:{const c=t.innerSlots?.[0];if(t.data.loopType==="repeat"){const f=t.slots?.find(p=>p.id==="count");return h.jsxs("div",{className:"flex flex-col",children:[h.jsxs("div",{className:"flex items-center gap-1",children:[h.jsx("span",{children:"repeat"}),f&&h.jsx(Fr,{slot:f,parentBlockId:t.id,onConnect:n("count"),renderConnected:i,disabled:a}),h.jsx("span",{children:"times"})]}),c&&h.jsx(Rv,{innerSlot:c,parentBlockId:t.id,onInsert:r(c.id),renderBlocks:o,disabled:a})]})}const u=t.slots?.find(f=>f.id==="collection");return h.jsxs("div",{className:"flex flex-col",children:[h.jsxs("div",{className:"flex items-center gap-1",children:[h.jsx("span",{children:"for each in"}),u&&h.jsx(Fr,{slot:u,parentBlockId:t.id,onConnect:n("collection"),renderConnected:i,disabled:a})]}),c&&h.jsx(Rv,{innerSlot:c,parentBlockId:t.id,onInsert:r(c.id),renderBlocks:o,disabled:a})]})}case ee.SET_VARIABLE:{const c=t.slots?.find(f=>f.id==="varName"),u=t.slots?.find(f=>f.id==="value");return h.jsxs("div",{className:"flex items-center gap-1",children:[h.jsx("span",{children:"set"}),c&&h.jsx(Fr,{slot:c,parentBlockId:t.id,onConnect:n("varName"),renderConnected:i,disabled:a}),h.jsx("span",{children:"to"}),u&&h.jsx(Fr,{slot:u,parentBlockId:t.id,onConnect:n("value"),renderConnected:i,disabled:a})]})}case ee.ON_DROP:case ee.ON_CHANGE:return h.jsx("span",{children:t.label});default:return h.jsx("span",{children:t.label||t.type})}}function kX(t,e=!1){const n=e?"px-1.5 py-0.5":"px-3 py-1.5";switch(t){case ii.REPORTER:return`rounded-full ${n}`;case ii.STATEMENT:return`rounded ${n}`;case ii.C_BLOCK:return"rounded-lg px-3 py-2";case ii.HAT:return`rounded-t-lg rounded-b ${n}`;case ii.CAP:return`rounded-t rounded-b-lg ${n}`;default:return`rounded ${n}`}}function Aj({block:t,onDragStart:e}){return h.jsx(Gu,{block:t,isPalette:!0,onSlotConnect:()=>{},onInnerInsert:()=>{}})}function DX({fields:t=[],collapsed:e=!1,onBlockDragStart:n}){const[r,i]=x.useState({fields:!0,values:!1,math:!0,aggregations:!0,logic:!1,functions:!1,control:!1,triggers:!1}),o=x.useMemo(()=>Sj(t),[t]),a=x.useMemo(()=>{const u=wj(),f=u.find(p=>p.id==="fields");return f&&(f.blocks=o),u},[o]),c=u=>{i(f=>({...f,[u]:!f[u]}))};return h.jsxs("div",{className:`
      block-palette
      flex flex-col
      h-full overflow-y-auto
      bg-muted/50 border-r border-border
      ${e?"w-12":"w-48"}
    `,children:[h.jsx("div",{className:"p-2 border-b border-border",children:h.jsx("h3",{className:`text-xs font-semibold text-muted-foreground ${e?"hidden":""}`,children:"Blocks"})}),h.jsx("div",{className:"flex-1 overflow-y-auto p-1 space-y-1",children:a.map(u=>h.jsx(OX,{category:u,expanded:r[u.id],onToggle:()=>c(u.id),collapsed:e,onBlockDragStart:n},u.id))})]})}function OX({category:t,expanded:e,onToggle:n,collapsed:r,onBlockDragStart:i}){const o=MX(t.color),a=t.blocks?.length>0;return h.jsxs("div",{className:"palette-category",children:[h.jsxs("button",{onClick:n,className:`
          w-full flex items-center gap-1.5
          px-2 py-1.5 rounded
          text-xs font-medium
          hover:bg-muted
          transition-colors
          ${o}
        `,children:[e?h.jsx(Yu,{className:"w-3 h-3 flex-shrink-0"}):h.jsx(hs,{className:"w-3 h-3 flex-shrink-0"}),!r&&h.jsxs(h.Fragment,{children:[h.jsx("span",{className:"flex-1 text-left",children:t.label}),h.jsx("span",{className:"text-[10px] opacity-50",children:t.blocks?.length||0})]})]}),e&&a&&!r&&h.jsx("div",{className:"pl-4 pr-1 py-1 space-y-1",children:t.blocks.map(c=>h.jsx("div",{className:"palette-block-wrapper",onMouseDown:()=>i?.(c),children:h.jsx(Aj,{block:c})},c.id))}),e&&!a&&!r&&h.jsx("div",{className:"pl-4 pr-1 py-2",children:h.jsx("span",{className:"text-[10px] text-muted-foreground italic",children:t.id==="fields"?"No input fields available":"No blocks"})})]})}function MX(t){switch(t){case"blue":return"text-blue-400";case"gray":return"text-gray-400";case"green":return"text-green-400";case"purple":return"text-purple-400";case"cyan":return"text-cyan-400";case"teal":return"text-teal-400";case"orange":return"text-orange-400";case"amber":return"text-amber-400";case"red":return"text-red-400";default:return"text-muted-foreground"}}function RX({fields:t=[],showCategories:e=["fields","math","aggregations"],onBlockDragStart:n}){const r=x.useMemo(()=>Sj(t),[t]),i=x.useMemo(()=>wj().filter(o=>e.includes(o.id)).map(o=>o.id==="fields"?{...o,blocks:r}:o),[r,e]);return h.jsx("div",{className:"mini-palette flex flex-wrap gap-1 p-2 bg-muted/30 rounded border border-border",children:i.map(o=>h.jsx("div",{className:"flex flex-wrap gap-1",children:o.blocks?.map(a=>h.jsx("div",{className:"palette-block-wrapper",onMouseDown:()=>n?.(a),children:h.jsx(Aj,{block:a})},a.id))},o.id))})}function jX({rootBlock:t,onChange:e,disabled:n=!1}){const r=x.useCallback((p,g,v)=>{const y=g?ia(p):p;if(!t){e(y);return}e(y)},[t,e]),{ref:i,isOver:o,dropProps:a}=Tj({disabled:n,onDrop:r}),c=x.useCallback((p,g,v,y)=>{if(!t)return;const w=y?ia(v):v,S=vp(t,p,g,w);e(S)},[t,e]),u=x.useCallback((p,g,v,y,w)=>{if(!t)return;const S=y?ia(v):v,C=Wx(t,p,g,S,w);e(C)},[t,e]),f=x.useCallback(p=>{if(!t)return;if(t.id===p){e(null);return}const g=xp(t,p);e(g)},[t,e]);return h.jsx("div",{ref:i,...a,className:`
        operations-canvas
        flex-1 min-h-[120px]
        p-4
        bg-background/50
        border-2 border-dashed rounded-lg
        transition-colors
        ${o?"border-primary bg-primary/5":"border-muted-foreground/20"}
        ${n?"opacity-50 pointer-events-none":""}
      `,children:t?h.jsx("div",{className:"canvas-content",children:h.jsx(Gu,{block:t,onSlotConnect:c,onInnerInsert:u,onRemove:f})}):h.jsx("div",{className:"canvas-empty flex items-center justify-center h-full min-h-[80px]",children:h.jsx("p",{className:"text-sm text-muted-foreground",children:"Drag blocks here to build an expression"})})})}function vp(t,e,n,r){if(t.id===e)return{...t,slots:t.slots?.map(a=>a.id===n?{...a,connected:r}:a)};const i=t.slots?.map(a=>a.connected?{...a,connected:vp(a.connected,e,n,r)}:a),o=t.innerSlots?.map(a=>({...a,connected:a.connected?.map(c=>vp(c,e,n,r))}));return{...t,slots:i,innerSlots:o}}function Wx(t,e,n,r,i){if(t.id===e)return{...t,innerSlots:t.innerSlots?.map(c=>{if(c.id!==n)return c;const u=c.connected||[];return{...c,connected:i==="top"?[r,...u]:[...u,r]}})};const o=t.slots?.map(c=>c.connected?{...c,connected:Wx(c.connected,e,n,r,i)}:c),a=t.innerSlots?.map(c=>({...c,connected:c.connected?.map(u=>Wx(u,e,n,r,i))}));return{...t,slots:o,innerSlots:a}}function xp(t,e){const n=t.slots?.map(i=>i.connected?.id===e?{...i,connected:null}:i.connected?{...i,connected:xp(i.connected,e)}:i),r=t.innerSlots?.map(i=>({...i,connected:i.connected?.filter(o=>o.id!==e).map(o=>xp(o,e))}));return{...t,slots:n,innerSlots:r}}function IX({rootBlock:t,onChange:e,disabled:n=!1,placeholder:r="Drop a block"}){const i=x.useCallback((p,g)=>{const v=g?ia(p):p;e(v)},[e]),{ref:o,isOver:a,dropProps:c}=Tj({disabled:n,onDrop:i}),u=x.useCallback((p,g,v,y)=>{if(!t)return;const w=y?ia(v):v,S=vp(t,p,g,w);e(S)},[t,e]),f=x.useCallback(p=>{if(!t)return;if(t.id===p){e(null);return}const g=xp(t,p);e(g)},[t,e]);return h.jsx("div",{ref:o,...c,className:`
        compact-canvas
        min-h-[40px] p-2
        border border-dashed rounded
        transition-colors
        ${a?"border-primary bg-primary/5":"border-border"}
        ${n?"opacity-50":""}
      `,children:t?h.jsx(Gu,{block:t,onSlotConnect:u,onRemove:f}):h.jsx("span",{className:"text-xs text-muted-foreground",children:r})})}function Yx({initialBlocks:t,availableFields:e=[],context:n={},onChange:r,onEvaluate:i,disabled:o=!1,compact:a=!1}){const[c,u]=x.useState(()=>t?t.id?t:Gx(t,{}):null),f=x.useMemo(()=>{const T={};for(const N of e)T[N.id]=N;return T},[e]),[p,g]=x.useState(null),[v,y]=x.useState("");x.useEffect(()=>{if(!c){g(null),y(""),i?.(null);return}const T=NX(c,{state:n.state||{},fieldsById:f,variables:{}});g(T.value),y(Nj(c)),i?.(T.value)},[c,n.state,f,i]);const w=x.useCallback(T=>{u(T);const N=qx(T);r?.(N)},[r]),S=x.useCallback((T,N)=>{},[]),C=x.useCallback((T,N,k)=>{},[]);return a?h.jsx(_X,{rootBlock:c,availableFields:e,result:p,description:v,onChange:w,disabled:o}):h.jsx(Cj,{onBlockMove:S,onBlockConnect:C,children:h.jsxs("div",{className:`
        operations-builder
        flex flex-col h-full
        border border-border rounded-lg
        bg-card overflow-hidden
        ${o?"opacity-50 pointer-events-none":""}
      `,children:[h.jsxs("div",{className:"builder-header flex items-center justify-between px-3 py-2 border-b border-border bg-muted/30",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("span",{className:"text-xs font-medium text-muted-foreground",children:"Expression:"}),h.jsx("code",{className:"text-xs text-foreground bg-background px-2 py-0.5 rounded",children:v||"(empty)"})]}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("span",{className:"text-xs text-muted-foreground",children:"Result:"}),h.jsx("span",{className:`
              text-sm font-mono px-2 py-0.5 rounded
              ${p!==null?"bg-primary/20 text-primary":"bg-muted text-muted-foreground"}
            `,children:p!==null?kj(p):""})]})]}),h.jsxs("div",{className:"builder-content flex flex-1 overflow-hidden",children:[h.jsx(DX,{fields:e}),h.jsx("div",{className:"builder-canvas flex-1 p-4 overflow-auto",children:h.jsx(jX,{rootBlock:c,onChange:w,disabled:o})})]})]})})}function _X({rootBlock:t,availableFields:e,result:n,description:r,onChange:i,disabled:o}){const[a,c]=x.useState(!1);return h.jsx(Cj,{children:h.jsxs("div",{className:"compact-operations-builder space-y-2",children:[h.jsx(IX,{rootBlock:t,onChange:i,disabled:o,placeholder:"Click to add blocks"}),t&&h.jsxs("div",{className:"flex items-center justify-between text-xs",children:[h.jsx("code",{className:"text-muted-foreground truncate max-w-[200px]",children:r}),h.jsxs("span",{className:"font-mono text-primary",children:["= ",n!==null?kj(n):"?"]})]}),h.jsx("button",{onClick:()=>c(!a),className:"text-xs text-primary hover:underline",children:a?"Hide blocks":"Show blocks"}),a&&h.jsx(RX,{fields:e,showCategories:["fields","math","aggregations"]})]})})}function kj(t){return t==null?"":typeof t=="boolean"?t?"true":"false":typeof t=="number"?Number.isInteger(t)?String(t):t.toFixed(2):typeof t=="string"?`"${t}"`:String(t)}const LX=[{value:"number",label:"Number",defaultValue:0},{value:"text",label:"Text",defaultValue:""},{value:"boolean",label:"Boolean",defaultValue:!1},{value:"select",label:"Select",defaultValue:null},{value:"date",label:"Date",defaultValue:null},{value:"rating",label:"Rating",defaultValue:0},{value:"duration",label:"Duration",defaultValue:0}],PX=[{value:"input",label:"Input"},{value:"derived",label:"Derived (Calculated)"}],zX=Object.entries(EG).map(([t,e])=>({value:t,label:e.label})),Dj=Object.entries(nm).map(([t,e])=>({value:t,label:e.label})),BX=Object.entries(tm).map(([t,e])=>({value:t,label:e.label})),FX=[{value:"onDrop",label:"When Dropped"},{value:"onChange",label:"When Changed"},{value:"onComplete",label:"When Completed"}];function $X({open:t,onOpenChange:e,gridId:n,fields:r=[],panels:i=[],containers:o=[],instances:a=[],onCreateField:c,onUpdateField:u,onDeleteField:f}){const[p,g]=x.useState(null),[v,y]=x.useState(!1),w=x.useMemo(()=>r.filter(D=>D.gridId===n),[r,n]),S=x.useMemo(()=>w.find(D=>D.id===p),[w,p]),C=x.useCallback(()=>{const D={id:kn()};g(D.id),y(!0)},[n]),T=x.useCallback(D=>{g(D),y(!1)},[]),N=x.useCallback(D=>{v?(c?.(D),y(!1)):u?.(D)},[v,c,u]),k=x.useCallback(D=>{f?.(D),p===D&&g(null)},[p,f]);return h.jsx(QR,{open:t,onOpenChange:e,children:h.jsxs(z0,{className:"max-w-4xl max-h-[85vh] overflow-hidden flex flex-col",children:[h.jsx(B0,{children:h.jsxs(F0,{className:"flex items-center gap-2",children:[h.jsx(p5,{className:"w-5 h-5"}),"Field Bank"]})}),h.jsxs("div",{className:"flex-1 flex gap-4 overflow-hidden",children:[h.jsxs("div",{className:"w-48 flex flex-col border-r border-border pr-4",children:[h.jsxs("div",{className:"flex items-center justify-between mb-2",children:[h.jsx(tt,{className:"text-xs text-muted-foreground",children:"Fields"}),h.jsx(_e,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:C,children:h.jsx(li,{className:"h-4 w-4"})})]}),h.jsxs("div",{className:"flex-1 overflow-y-auto space-y-1",children:[w.map(D=>h.jsxs("button",{onClick:()=>T(D.id),className:`
                    w-full text-left px-2 py-1.5 rounded text-sm
                    flex items-center gap-2
                    ${p===D.id?"bg-primary/20 text-primary":"hover:bg-muted"}
                  `,children:[h.jsx("span",{className:`
                    w-2 h-2 rounded-full
                    ${D.mode==="input"?"bg-blue-500":"bg-purple-500"}
                  `}),h.jsx("span",{className:"flex-1 truncate",children:D.name||D.type}),h.jsx("span",{className:"text-[10px] text-muted-foreground",children:D.type})]},D.id)),w.length===0&&h.jsx("div",{className:"text-xs text-muted-foreground text-center py-4",children:"No fields yet"})]})]}),h.jsx("div",{className:"flex-1 overflow-y-auto",children:p||v?h.jsx(HX,{field:S||{id:p,gridId:n,name:"",type:"number",mode:"input",meta:{},metric:null,conditions:null,triggers:[],display:{role:"input",showLabel:!0,order:0}},allFields:w,panels:i,containers:o,instances:a,isNew:v,onSave:N,onDelete:()=>k(p)}):h.jsx("div",{className:"flex items-center justify-center h-full text-muted-foreground",children:"Select a field or create a new one"})})]})]})})}function HX({field:t,allFields:e,panels:n,containers:r,instances:i,isNew:o,onSave:a,onDelete:c}){const[u,f]=x.useState(t),[p,g]=x.useState("basic");x.useMemo(()=>{f(t)},[t.id]);const v=x.useCallback((N,k)=>{f(D=>({...D,[N]:k}))},[]),y=x.useCallback((N,k)=>{f(D=>({...D,meta:{...D.meta||{},[N]:k}}))},[]),w=x.useCallback((N,k)=>{f(D=>({...D,metric:{...D.metric||{},[N]:k}}))},[]),S=x.useCallback((N,k)=>{f(D=>({...D,display:{...D.display||{},[N]:k}}))},[]),C=x.useCallback(N=>{f(k=>({...k,conditions:{...k.conditions||{},blockTree:N}}))},[]),T=x.useCallback(()=>{a(u)},[u,a]);return h.jsxs("div",{className:"space-y-4",children:[h.jsxs(xX,{value:p,onValueChange:g,children:[h.jsxs(xj,{className:"grid w-full grid-cols-4",children:[h.jsx(uu,{value:"basic",children:"Basic"}),h.jsx(uu,{value:"calculation",children:"Calculation"}),h.jsx(uu,{value:"conditions",children:"Conditions"}),h.jsx(uu,{value:"triggers",children:"Triggers"})]}),h.jsxs(du,{value:"basic",className:"space-y-4 mt-4",children:[h.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[h.jsxs("div",{children:[h.jsx(tt,{children:"Field Name"}),h.jsx(Kt,{value:u.name||"",onChange:N=>v("name",N.target.value),placeholder:"Field name"})]}),h.jsxs("div",{children:[h.jsx(tt,{children:"Type"}),h.jsxs(Pt,{value:u.type,onValueChange:N=>v("type",N),children:[h.jsx(zt,{children:h.jsx(Bt,{})}),h.jsx(Ft,{children:LX.map(N=>h.jsx(wt,{value:N.value,children:N.label},N.value))})]})]})]}),h.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[h.jsxs("div",{children:[h.jsx(tt,{children:"Mode"}),h.jsxs(Pt,{value:u.mode,onValueChange:N=>{v("mode",N),N==="derived"&&!u.metric&&v("metric",{scope:"container",blockTree:null})},children:[h.jsx(zt,{children:h.jsx(Bt,{})}),h.jsx(Ft,{children:PX.map(N=>h.jsx(wt,{value:N.value,children:N.label},N.value))})]})]}),h.jsxs("div",{children:[h.jsx(tt,{children:"Display Role"}),h.jsxs(Pt,{value:u.display?.role||"input",onValueChange:N=>S("role",N),children:[h.jsx(zt,{children:h.jsx(Bt,{})}),h.jsxs(Ft,{children:[h.jsx(wt,{value:"input",children:"Input"}),h.jsx(wt,{value:"display",children:"Display Only"}),h.jsx(wt,{value:"both",children:"Both"})]})]})]})]}),u.type==="number"&&h.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[h.jsxs("div",{children:[h.jsx(tt,{className:"text-xs",children:"Prefix"}),h.jsx(Kt,{value:u.meta?.prefix||"",onChange:N=>y("prefix",N.target.value),placeholder:"$",className:"h-8"})]}),h.jsxs("div",{children:[h.jsx(tt,{className:"text-xs",children:"Postfix"}),h.jsx(Kt,{value:u.meta?.postfix||"",onChange:N=>y("postfix",N.target.value),placeholder:"kg",className:"h-8"})]}),h.jsxs("div",{children:[h.jsx(tt,{className:"text-xs",children:"Increment"}),h.jsx(Kt,{type:"number",value:u.meta?.increment??1,onChange:N=>y("increment",Number(N.target.value)),className:"h-8"})]})]}),u.type==="select"&&h.jsx(UX,{options:u.meta?.options||[],onChange:N=>y("options",N)})]}),h.jsx(du,{value:"calculation",className:"space-y-4 mt-4",children:u.mode==="derived"?h.jsxs(h.Fragment,{children:[h.jsx(Yx,{initialBlocks:u.metric?.blockTree||null,availableFields:e,context:{scope:u.metric?.scope||"container",timeFilter:u.metric?.timeFilter||"all"},onChange:N=>w("blockTree",N)}),h.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[h.jsxs("div",{children:[h.jsx(tt,{className:"text-xs",children:"Scope"}),h.jsxs(Pt,{value:u.metric?.scope||"container",onValueChange:N=>w("scope",N),children:[h.jsx(zt,{className:"h-8",children:h.jsx(Bt,{})}),h.jsx(Ft,{children:zX.map(N=>h.jsx(wt,{value:N.value,children:N.label},N.value))})]})]}),h.jsxs("div",{children:[h.jsx(tt,{className:"text-xs",children:"Time Period"}),h.jsxs(Pt,{value:u.metric?.timeFilter||"all",onValueChange:N=>w("timeFilter",N),children:[h.jsx(zt,{className:"h-8",children:h.jsx(Bt,{})}),h.jsx(Ft,{children:Dj.map(N=>h.jsx(wt,{value:N.value,children:N.label},N.value))})]})]})]}),h.jsx("div",{className:"pt-3 border-t",children:h.jsx(VX,{allowedFields:u.metric?.allowedFields||[],allFields:e,panels:n,containers:r,onChange:N=>w("allowedFields",N)})}),u.type==="number"&&h.jsxs("div",{className:"pt-2 border-t",children:[h.jsx(tt,{className:"text-xs",children:"Target"}),h.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[h.jsxs(Pt,{value:u.metric?.target?.op||">=",onValueChange:N=>w("target",{...u.metric?.target||{},op:N}),children:[h.jsx(zt,{className:"h-8 w-24",children:h.jsx(Bt,{})}),h.jsx(Ft,{children:BX.map(N=>h.jsx(wt,{value:N.value,children:N.label},N.value))})]}),h.jsx(Kt,{type:"number",value:u.metric?.target?.value??"",onChange:N=>w("target",{...u.metric?.target||{},op:u.metric?.target?.op||">=",value:N.target.value===""?void 0:Number(N.target.value)}),placeholder:"Target value",className:"h-8 w-24"})]})]})]}):h.jsx("div",{className:"text-muted-foreground text-sm text-center py-8",children:'Switch to "Derived" mode to configure calculations'})}),h.jsxs(du,{value:"conditions",className:"space-y-4 mt-4",children:[h.jsx("div",{className:"text-sm text-muted-foreground mb-4",children:"Define when this field should be active. Leave empty to always be active."}),h.jsx(Yx,{initialBlocks:u.conditions?.blockTree||null,availableFields:e,context:{panels:n,containers:r,instances:i},onChange:C}),h.jsxs("div",{className:"pt-4 border-t space-y-3",children:[h.jsx(tt,{className:"text-xs text-muted-foreground",children:"Quick Filters"}),h.jsxs("div",{children:[h.jsx(tt,{className:"text-xs",children:"Only in Panels"}),h.jsxs("div",{className:"flex flex-wrap gap-1 mt-1",children:[n.map(N=>h.jsx("button",{onClick:()=>{const k=u.conditions?.panelIds||[],D=k.includes(N.id)?k.filter(M=>M!==N.id):[...k,N.id];f(M=>({...M,conditions:{...M.conditions||{},panelIds:D}}))},className:`
                      px-2 py-0.5 text-xs rounded
                      ${(u.conditions?.panelIds||[]).includes(N.id)?"bg-primary text-primary-foreground":"bg-muted hover:bg-muted/80"}
                    `,children:N.label||"Panel"},N.id)),n.length===0&&h.jsx("span",{className:"text-xs text-muted-foreground",children:"No panels"})]})]}),h.jsxs("div",{children:[h.jsx(tt,{className:"text-xs",children:"Only for Instance Types"}),h.jsxs("div",{className:"flex flex-wrap gap-1 mt-1",children:[i.map(N=>h.jsx("button",{onClick:()=>{const k=u.conditions?.instanceIds||[],D=k.includes(N.id)?k.filter(M=>M!==N.id):[...k,N.id];f(M=>({...M,conditions:{...M.conditions||{},instanceIds:D}}))},className:`
                      px-2 py-0.5 text-xs rounded
                      ${(u.conditions?.instanceIds||[]).includes(N.id)?"bg-primary text-primary-foreground":"bg-muted hover:bg-muted/80"}
                    `,children:N.label||"Instance"},N.id)),i.length===0&&h.jsx("span",{className:"text-xs text-muted-foreground",children:"No instances"})]})]})]})]}),h.jsxs(du,{value:"triggers",className:"space-y-4 mt-4",children:[h.jsx("div",{className:"text-sm text-muted-foreground mb-4",children:"Automations that run when events occur."}),h.jsx(qX,{triggers:u.triggers||[],allFields:e,onChange:N=>v("triggers",N)})]})]}),h.jsxs("div",{className:"flex items-center justify-between pt-4 border-t",children:[h.jsxs(_e,{variant:"destructive",size:"sm",onClick:c,disabled:o,children:[h.jsx(ps,{className:"w-4 h-4 mr-1"}),"Delete Field"]}),h.jsx(_e,{onClick:T,children:o?"Create Field":"Save Changes"})]})]})}function UX({options:t,onChange:e}){const[n,r]=x.useState(""),i=x.useCallback(()=>{if(!n.trim())return;const o=n.toLowerCase().replace(/\s+/g,"_");e([...t,{value:o,label:n.trim()}]),r("")},[n,t,e]);return h.jsxs("div",{className:"space-y-2",children:[h.jsx(tt,{className:"text-xs",children:"Select Options"}),h.jsx("div",{className:"space-y-1",children:t.map((o,a)=>h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx(Kt,{value:o.label,onChange:c=>{const u=t.map((f,p)=>p===a?{...f,label:c.target.value}:f);e(u)},className:"h-7 text-sm"}),h.jsx(_e,{variant:"ghost",size:"icon",className:"h-7 w-7",onClick:()=>e(t.filter((c,u)=>u!==a)),children:h.jsx(ps,{className:"h-3 w-3"})})]},a))}),h.jsxs("div",{className:"flex gap-2",children:[h.jsx(Kt,{value:n,onChange:o=>r(o.target.value),onKeyDown:o=>o.key==="Enter"&&i(),placeholder:"Add option...",className:"h-7 text-sm"}),h.jsx(_e,{variant:"outline",size:"sm",onClick:i,disabled:!n.trim(),children:h.jsx(li,{className:"h-3 w-3"})})]})]})}function VX({allowedFields:t=[],allFields:e,panels:n,containers:r,onChange:i}){const o=x.useCallback(()=>{i([...t,{fieldId:null,destinations:[],flowFilter:"any"}])},[t,i]),a=x.useCallback((y,w)=>{i(t.map((S,C)=>C===y?{...S,...w}:S))},[t,i]),c=x.useCallback(y=>{i(t.filter((w,S)=>S!==y))},[t,i]),u=x.useCallback(y=>{const w=t[y];a(y,{destinations:[...w.destinations||[],{id:null,timeFilter:"all"}]})},[t,a]),f=x.useCallback((y,w,S)=>{const T=(t[y].destinations||[]).map((N,k)=>k===w?{...N,...S}:N);a(y,{destinations:T})},[t,a]),p=x.useCallback((y,w)=>{const S=t[y];a(y,{destinations:(S.destinations||[]).filter((C,T)=>T!==w)})},[t,a]),g=x.useMemo(()=>{const y=[];return n.forEach(w=>{y.push({value:`panel:${w.id}`,label:`Panel: ${w.label||w.id}`,type:"panel"})}),r.forEach(w=>{y.push({value:`container:${w.id}`,label:`Container: ${w.label||w.id}`,type:"container"})}),y},[n,r]),v=x.useMemo(()=>e.filter(y=>y.mode==="input"),[e]);return h.jsxs("div",{className:"space-y-3",children:[h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsx(tt,{className:"text-xs text-muted-foreground",children:"Source Fields"}),h.jsxs(_e,{variant:"ghost",size:"sm",onClick:o,className:"h-6 text-xs",children:[h.jsx(li,{className:"h-3 w-3 mr-1"}),"Add Field"]})]}),t.length===0&&h.jsx("div",{className:"text-xs text-muted-foreground text-center py-4 border border-dashed rounded",children:"No source fields configured. Add fields to define what values to aggregate."}),t.map((y,w)=>h.jsxs("div",{className:"border rounded-lg p-3 space-y-2 bg-muted/20",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsxs(Pt,{value:y.fieldId||"",onValueChange:S=>a(w,{fieldId:S}),children:[h.jsx(zt,{className:"h-7 flex-1",children:h.jsx(Bt,{placeholder:"Select field..."})}),h.jsx(Ft,{children:v.map(S=>h.jsx(wt,{value:S.id,children:S.name||S.type},S.id))})]}),h.jsx("div",{className:"flex items-center gap-0.5",children:[{key:"in",label:"In",color:"text-green-400 border-green-500/40 bg-green-500/10"},{key:"out",label:"Out",color:"text-red-400 border-red-500/40 bg-red-500/10"},{key:"replace",label:"=",color:"text-blue-400 border-blue-500/40 bg-blue-500/10"}].map(S=>{const C=y.flowFilter||"any",T=C==="any"?["in","out","replace"]:Array.isArray(C)?C:[C],N=T.includes(S.key);return h.jsx("button",{type:"button",onClick:()=>{let k;N?(k=T.filter(M=>M!==S.key),k.length===0&&(k=[S.key])):k=[...T,S.key];const D=k.length===3?"any":k;a(w,{flowFilter:D})},className:`
                      px-1.5 py-0.5 text-[10px] rounded border transition-colors
                      ${N?S.color+" font-semibold":"text-muted-foreground/40 border-border/40 opacity-40"}
                    `,title:`${N?"Exclude":"Include"} ${S.label} flows`,children:S.label},S.key)})}),h.jsx(_e,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:()=>c(w),children:h.jsx(ps,{className:"h-3 w-3"})})]}),h.jsxs("div",{className:"pl-4 border-l-2 border-muted space-y-1",children:[h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsx("span",{className:"text-[10px] text-muted-foreground",children:"From destinations:"}),h.jsxs(_e,{variant:"ghost",size:"sm",onClick:()=>u(w),className:"h-5 text-[10px] px-1",children:[h.jsx(li,{className:"h-2 w-2 mr-0.5"}),"Add"]})]}),(y.destinations||[]).length===0&&h.jsx("span",{className:"text-[10px] text-muted-foreground italic",children:"All locations (no filter)"}),(y.destinations||[]).map((S,C)=>h.jsxs("div",{className:"flex items-center gap-1",children:[h.jsxs(Pt,{value:S.id||"",onValueChange:T=>f(w,C,{id:T}),children:[h.jsx(zt,{className:"h-6 text-[10px] flex-1",children:h.jsx(Bt,{placeholder:"Select location..."})}),h.jsx(Ft,{children:g.map(T=>h.jsx(wt,{value:T.value,children:T.label},T.value))})]}),h.jsxs(Pt,{value:S.timeFilter||"all",onValueChange:T=>f(w,C,{timeFilter:T}),children:[h.jsx(zt,{className:"h-6 text-[10px] w-16",children:h.jsx(Bt,{})}),h.jsx(Ft,{children:Dj.map(T=>h.jsx(wt,{value:T.value,children:T.label},T.value))})]}),h.jsx(_e,{variant:"ghost",size:"icon",className:"h-5 w-5",onClick:()=>p(w,C),children:h.jsx(ps,{className:"h-2 w-2"})})]},C))]})]},w))]})}function qX({triggers:t,allFields:e,onChange:n}){const r=x.useCallback(()=>{n([...t,{event:"onDrop",blockTree:null,targetFieldId:null,action:"set",value:null}])},[t,n]),i=x.useCallback((a,c,u)=>{n(t.map((f,p)=>p===a?{...f,[c]:u}:f))},[t,n]),o=x.useCallback(a=>{n(t.filter((c,u)=>u!==a))},[t,n]);return h.jsxs("div",{className:"space-y-3",children:[t.map((a,c)=>h.jsxs("div",{className:"p-3 border rounded-lg space-y-2",children:[h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx(D5,{className:"w-4 h-4 text-amber-500"}),h.jsxs(Pt,{value:a.event,onValueChange:u=>i(c,"event",u),children:[h.jsx(zt,{className:"h-7 w-36",children:h.jsx(Bt,{})}),h.jsx(Ft,{children:FX.map(u=>h.jsx(wt,{value:u.value,children:u.label},u.value))})]})]}),h.jsx(_e,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:()=>o(c),children:h.jsx(ps,{className:"h-3 w-3"})})]}),h.jsx(Yx,{initialBlocks:a.blockTree,availableFields:e,onChange:u=>i(c,"blockTree",u),compact:!0})]},c)),h.jsxs(_e,{variant:"outline",size:"sm",onClick:r,className:"w-full",children:[h.jsx(li,{className:"w-4 h-4 mr-1"}),"Add Trigger"]})]})}function GX({onUndo:t,onRedo:e,canUndo:n=!1,canRedo:r=!1,onFields:i,onSettings:o,disabled:a=!1}){const c=x.useMemo(()=>[{icon:hb,label:"Undo",onClick:n?t:null,color:n?"bg-amber-600 hover:bg-amber-500":"bg-slate-700 opacity-50"},{icon:db,label:"Redo",onClick:r?e:null,color:r?"bg-amber-600 hover:bg-amber-500":"bg-slate-700 opacity-50"},{icon:g3,label:"Fields Bank",onClick:i,color:"bg-purple-600 hover:bg-purple-500"}],[t,e,n,r,i]);return h.jsx("div",{className:"grid-radial-menu fixed bottom-4 right-4 z-50",children:h.jsx(sa,{items:c,forceDirection:"down",handleIcon:oa,handleTitle:"Grid Settings - Click for menu",handleClassName:"bg-slate-700 hover:bg-slate-600 rounded-lg shadow-lg border border-white/20",size:"md",disabled:a})})}var WX={large:700};function YX(t){t.animate([{backgroundColor:"var(--ds-background-selected, #E9F2FE)"},{}],{duration:WX.large,easing:"cubic-bezier(0.25, 0.1, 0.25, 1.0)",iterations:1})}const hl=250;function KX(){const t=x.useRef(new Map),e=x.useCallback((c=[])=>{const u=new Map;return c.forEach(f=>{const p=document.querySelector(`[data-occurrence-id="${f}"]`);if(p){const g=p.getBoundingClientRect();u.set(f,{x:g.left,y:g.top,width:g.width,height:g.height,el:p})}}),t.current=u,u},[]),n=x.useCallback(()=>{const c=new Map;return document.querySelectorAll("[data-occurrence-id]").forEach(f=>{const p=f.getAttribute("data-occurrence-id");if(p){const g=f.getBoundingClientRect();c.set(p,{x:g.left,y:g.top,width:g.width,height:g.height,el:f})}}),t.current=c,c},[]),r=x.useCallback((c=[])=>new Promise(u=>{requestAnimationFrame(()=>{const f=t.current;let p=0,g=!1;const v=()=>{!g&&p===0&&(g=!0,u())};c.forEach(y=>{const w=f.get(y);if(!w)return;const S=document.querySelector(`[data-occurrence-id="${y}"]`);if(!S)return;const C=S.getBoundingClientRect(),T={x:C.left,y:C.top},N=w.x-T.x,k=w.y-T.y;if(Math.abs(N)<2&&Math.abs(k)<2)return;p++,S.style.transform=`translate(${N}px, ${k}px)`,S.style.transition="none",S.offsetHeight,S.style.transition=`transform ${hl}ms ease-out`,S.style.transform="";const D=()=>{S.style.transition="",S.style.transform="",S.removeEventListener("transitionend",D),p--,v()};S.addEventListener("transitionend",D),setTimeout(()=>{S.style.transition&&D()},hl+50)}),v()})}),[]),i=x.useCallback(c=>{requestAnimationFrame(()=>{const u=document.querySelector(`[data-occurrence-id="${c}"]`);u&&YX(u)})},[]),o=x.useCallback(()=>new Promise(c=>{const u=window.innerWidth/2,f=window.innerHeight/2;requestAnimationFrame(()=>{const p=document.querySelectorAll("[data-occurrence-id]");let g=p.length;if(g===0){c();return}p.forEach(v=>{const y=v.getBoundingClientRect(),w=y.left+y.width/2,S=y.top+y.height/2,C=u-w,T=f-S,N=Math.sqrt(C*C+T*T),k=Math.sqrt(u*u+f*f),D=N/k*150;v.style.transform=`translate(${C}px, ${T}px) scale(0.85)`,v.style.opacity="0",v.style.transition="none",v.offsetHeight,setTimeout(()=>{v.style.transition=`transform ${hl}ms ease-out, opacity ${hl*.7}ms ease-out`,v.style.transform="",v.style.opacity="";const M=()=>{v.style.transition="",v.style.transform="",v.style.opacity="",g--,g===0&&c(),v.removeEventListener("transitionend",M)};v.addEventListener("transitionend",M),setTimeout(()=>{v.style.transition&&M()},hl+D+50)},D)})})}),[]),a=x.useCallback(c=>{if(!c||c.length===0)return Promise.resolve();const u=c.map(f=>f.occurrenceId);return e(u),new Promise(f=>{setTimeout(()=>{r(u).then(()=>{u.forEach(i),f()})},100)})},[e,r,i]);return{capturePositions:e,captureAllPositions:n,animateToNewPositions:r,animateFromCenter:o,animateUndoMoves:a,flashElement:i,ANIMATION_DURATION:hl}}function Kf(t,e,n){return Math.max(e,Math.min(n,t))}function iA(t=[]){return t.map(e=>({...e,layout:e.layout?{...e.layout,style:{...e.layout.style||{}}}:e.layout,occurrences:[...e.occurrences||[]]}))}function oA(t=[]){return t.map(e=>({...e,occurrences:[...e.occurrences||[]]}))}function Zc(t){return`cell-${t.row}-${t.col}`}function XX(t){return t?.layout?.style?.display??"block"}function Ws(){return crypto?.randomUUID?.()||`id-${Date.now()}-${Math.random().toString(36).slice(2)}`}function JX({children:t,state:e,dispatch:n,socket:r,gridRef:i,rows:o=1,cols:a=1,rowSizes:c=[],colSizes:u=[],visiblePanels:f=[],onTick:p}){const[g,v]=x.useState(null),[y,w]=x.useState(null),[S,C]=x.useState(null),[T,N]=x.useState("move"),k=g?.type||null,D=g?.id||null,M=g!==null,R=x.useRef({dragging:!1,payload:null,startPanels:null,startContainers:null,draftPanels:null,draftContainers:null}),O=x.useRef({x:0,y:0}),I=x.useRef(0),z=x.useRef({payload:null,containerId:null,timestamp:0}),U=x.useMemo(()=>Array.isArray(f)?f:[],[f]),Y=x.useMemo(()=>{const ae=Array.isArray(e?.panels)?e.panels:[];return ae.length?ae:U},[e?.panels,U]),W=x.useMemo(()=>Array.isArray(e?.containers)?e.containers:[],[e?.containers]),j=x.useMemo(()=>{const ae=Object.create(null),Me=Array.isArray(e?.occurrences)?e.occurrences:[];for(const J of Me)J?.id&&(ae[J.id]=J);return ae},[e?.occurrences]),G=x.useCallback(()=>{const ae=R.current;return ae.dragging&&ae.draftPanels?ae.draftPanels:U},[U]),oe=x.useCallback(()=>{const ae=R.current;return ae.dragging&&ae.draftPanels?ae.draftPanels:Y},[Y]),L=x.useCallback(()=>{const ae=R.current;return ae.dragging&&ae.draftContainers?ae.draftContainers:W},[W]),$=x.useCallback((ae,Me)=>{const J=i?.current;if(!J)return null;const X=J.getBoundingClientRect(),ve=(ae-X.left)/X.width,Ce=(Me-X.top)/X.height,Oe=(u||[]).reduce((ze,He)=>ze+He,0)||1,Ye=(c||[]).reduce((ze,He)=>ze+He,0)||1;let et=0,at=0;for(let ze=0;ze<u.length;ze++)if(et+=u[ze],ve<=et/Oe){at=ze;break}et=0;let ct=0;for(let ze=0;ze<c.length;ze++)if(et+=c[ze],Ce<=et/Ye){ct=ze;break}return{row:Kf(ct,0,o-1),col:Kf(at,0,a-1),cellId:`cell-${Kf(ct,0,o-1)}-${Kf(at,0,a-1)}`}},[i,o,a,c,u]),V=x.useCallback((ae,Me,J)=>{const X=document.elementsFromPoint(ae,Me);for(const ve of X){const Ce=ve.getAttribute(J);if(Ce)return Ce}return null},[]),we=x.useCallback(()=>V(O.current.x,O.current.y,"data-panel-id"),[V]),pe=x.useCallback(()=>V(O.current.x,O.current.y,"data-container-id"),[V]),P=x.useCallback(()=>V(O.current.x,O.current.y,"data-instance-id"),[V]),K=x.useCallback((ae,Me="move")=>{const J=R.current;J.dragging||(J.dragging=!0,J.payload=ae,J.mode=Me,J.startPanels=iA(U),J.startContainers=oA(W),J.draftPanels=iA(U),J.draftContainers=oA(W),v(ae),N(Me))},[U,W]),B=x.useCallback(()=>{const ae=R.current;ae.dragging=!1,ae.payload=null,ae.mode="move",ae.startPanels=null,ae.startContainers=null,ae.draftPanels=null,ae.draftContainers=null,v(null),w(null),C(null),I.current&&cancelAnimationFrame(I.current),I.current=0,p?.()},[p]),Z=x.useCallback(({occurrenceId:ae,toContainerId:Me,toIndex:J})=>{const X=R.current;if(!X.draftContainers||!ae)return;for(const Oe of X.draftContainers)Oe.occurrences=(Oe.occurrences||[]).filter(Ye=>Ye!==ae);const ve=X.draftContainers.find(Oe=>Oe.id===Me);if(!ve)return;const Ce=ve.occurrences||[];J!=null&&J>=0?Ce.splice(J,0,ae):Ce.push(ae),ve.occurrences=Ce},[]),le=x.useCallback(({occurrenceId:ae,toPanelId:Me,toIndex:J})=>{const X=R.current;if(!X.draftPanels||!ae)return;for(const Oe of X.draftPanels)Oe.occurrences=(Oe.occurrences||[]).filter(Ye=>Ye!==ae);const ve=X.draftPanels.find(Oe=>Oe.id===Me);if(!ve)return;const Ce=ve.occurrences||[];J!=null&&J>=0?Ce.splice(J,0,ae):Ce.push(ae),ve.occurrences=Ce},[]),be=x.useCallback(()=>{N(ae=>ae==="move"?"copy":ae==="copy"?"copylink":"move")},[]),H=x.useCallback((ae,Me,J,X={})=>{O.current={x:Me,y:J};const ve=X.mode||"move";K(ae,ve);const Ce=$(Me,J);ae.type===qe.PANEL&&C(Ce?.cellId||null),w({role:ae.type,cellId:Ce?.cellId,panelId:we(),containerId:pe(),overInstanceId:P()}),p?.()},[K,$,we,pe,P,p]),ce=x.useCallback((ae,Me)=>{const J=R.current;J.dragging&&(O.current={x:ae,y:Me},!I.current&&(I.current=requestAnimationFrame(()=>{I.current=0;const X=we(),ve=pe(),Ce=P(),Oe=$(ae,Me);w({role:J.payload?.type||"",cellId:Oe?.cellId,panelId:X,containerId:ve,overInstanceId:Ce}),J.payload?.type===qe.PANEL&&C(Oe?.cellId||null);const Ye=J.payload?.type===qe.PANEL;if(X&&!Ye){const et=document.querySelector(`[data-panel-id="${X}"]`);if(et){const at=et.getBoundingClientRect(),ct=et.querySelector(".panel-content");ct&&ct.scrollHeight>ct.clientHeight&&(Me<at.top+80?ct.scrollTop=Math.max(0,ct.scrollTop-10):Me>at.bottom-80&&(ct.scrollTop=Math.min(ct.scrollHeight-ct.clientHeight,ct.scrollTop+10)))}}if(J.payload?.type===qe.INSTANCE&&ve){const et=J.draftContainers?.find(He=>He.id===ve),at=J.startContainers?.find(He=>He.id===J.payload.context?.containerId);let ct=null;const ze=at?Gf(J.payload.id,at.occurrences||[],j):null;if(et&&Ce&&Ce!==J.payload.id&&ze){const He=Sr(Ce,et.occurrences||[],j);if(He!==-1){const ke=document.querySelector(`[data-instance-id="${Ce}"]`);if(ke){const rt=ke.getBoundingClientRect(),{x:Ge,y:pt}=O.current;if(et.layout?.orientation==="horizontal"){const ut=rt.left+rt.width/2;ct=Ge<ut?He:He+1}else{const ut=rt.top+rt.height/2;ct=pt<ut?He:He+1}if(at&&at.id===et.id){const ut=Sr(J.payload.id,at.occurrences||[],j);ut!==-1&&ut<He&&(ct=Math.max(0,ct-1))}}}}ze&&Z({occurrenceId:ze,toContainerId:ve,toIndex:ct})}if(J.payload?.type===qe.CONTAINER&&X){const et=J.draftPanels?.find(ke=>ke.id===X),at=J.startPanels?.find(ke=>ke.id===J.payload.context?.panelId),ct=pe();let ze=null;const He=at?Gf(J.payload.id,at.occurrences||[],j):null;if(et&&ct&&ct!==J.payload.id&&He){const ke=Sr(ct,et.occurrences||[],j);if(ke!==-1){const rt=document.querySelector(`[data-container-id="${ct}"]`);if(rt){const Ge=rt.getBoundingClientRect(),{x:pt,y:Ke}=O.current,ut=Math.abs(Ke-Ge.top),Qe=Math.abs(Ke-Ge.bottom),jt=Math.abs(pt-Ge.left),dt=Math.abs(pt-Ge.right),de=Math.min(ut,Qe,jt,dt);let De;if(de===ut?De="top":de===Qe?De="bottom":de===jt?De="left":De="right",De==="top"||De==="left"?ze=ke:ze=ke+1,at&&at.id===et.id){const yt=Sr(J.payload.id,at.occurrences||[],j);yt!==-1&&yt<ke&&(ze=Math.max(0,ze-1))}}}}He&&le({occurrenceId:He,toPanelId:X,toIndex:ze})}p?.()})))},[$,we,pe,P,Z,le,j,p]),te=x.useCallback(ae=>{R.current.dragging&&w(J=>({...J,panelId:ae.context?.panelId||J?.panelId,containerId:ae.context?.containerId||J?.containerId,overInstanceId:ae.context?.instanceId||J?.overInstanceId}))},[]),me=x.useCallback(ae=>{const Me=R.current,J=Me?.payload||ae?.source;if(!Me.dragging&&!J){B();return}ae.clientX!==void 0&&ae.clientY!==void 0&&(O.current={x:ae.clientX,y:ae.clientY});const{x:X,y:ve}=O.current,Ce=ae.context?.panelId||we(),Oe=ae.context?.containerId||pe(),Ye=ae.context?.instanceId||P(),et=Date.now(),at=z.current;if(!(at.payload===J?.id&&at.containerId===Oe&&et-at.timestamp<100)){if(z.current={payload:J?.id,containerId:Oe,timestamp:et},J?.type===qe.PANEL){let ze=!1;ae.dataTransfer&&(ze=xl(ae.dataTransfer).isCrossWindow);let He=null;if(ae.type==="grid-cell"&&ae.context?.row!==void 0&&ae.context?.col!==void 0?He={row:ae.context.row,col:ae.context.col,cellId:ae.context.cellId}:He=$(X,ve),He&&ze){const ke=J.data,rt=Ws(),Ge=[];(ke?.containerObjects||[]).forEach(Qe=>{const jt=Ws();Ge.push(jt);const dt=Qe?.instanceObjects||[],de=[];dt.forEach(yt=>{const mt=Ws();de.push(mt);const We={id:mt,label:yt.label||"Instance"};IG({dispatch:n,socket:r,instance:We,emit:!0})});const De={id:jt,label:Qe.label||"Container",occurrences:de};v2({dispatch:n,socket:r,container:De,emit:!0})});const Ke={id:rt,containers:Ge,layout:ke?.layout||{}};mR({dispatch:n,socket:r,grid:e?.grid,panel:Ke,placement:{row:He.row,col:He.col,width:ke?.width||1,height:ke?.height||1},userId:e?.userId,emit:!0}),Y.filter(Qe=>Qe.row===He.row&&Qe.col===He.col).forEach(Qe=>{fl({dispatch:n,socket:r,panel:Qe,display:"none",emit:!0})})}else if(He){const ke=Y.find(rt=>rt.id===J.id);if(ke&&(ke.row!==He.row||ke.col!==He.col)){const rt=ke.row,Ge=ke.col,pt=He.row,Ke=He.col,ut=ke._occurrenceId,Qe=ut?j[ut]:null;Qe&&ai({dispatch:n,socket:r,occurrence:{...Qe,placement:{...Qe.placement||{},row:pt,col:Ke}},emit:!0});const jt={...ke,layout:{...ke.layout||{},style:{...ke.layout?.style||{},display:"block"}}};qn({dispatch:n,socket:r,panel:jt,emit:!0});const dt=Y,de=`cell-${rt}-${Ge}`,De=`cell-${pt}-${Ke}`,yt=dt.filter(We=>We.id!==J.id&&Zc(We)===de),mt=dt.filter(We=>We.id!==J.id&&Zc(We)===De);yt.length>0&&yt[0]&&(fl({dispatch:n,socket:r,panel:yt[0],display:"block",emit:!0}),yt.slice(1).forEach(We=>{We&&fl({dispatch:n,socket:r,panel:We,display:"none",emit:!0})})),mt.forEach(We=>{fl({dispatch:n,socket:r,panel:We,display:"none",emit:!0})})}}}if(J?.type===qe.CONTAINER&&Ce){let ze=!1;if(ae.dataTransfer&&(ze=xl(ae.dataTransfer).isCrossWindow),ze){const He=J.data,ke=Y.find(Qe=>Qe.id===Ce);if(!ke){B();return}const rt=e?.gridId||e?.grid?._id;let Ge=null;if(ae.context?.insertAt!==void 0)Ge=ae.context.insertAt;else if(Oe){const Qe=Sr(Oe,ke.occurrences||[],j);if(Qe!==-1){const jt=ae.context?.closestEdge;jt==="top"||jt==="left"?Ge=Qe:(jt==="bottom"||jt==="right")&&(Ge=Qe+1)}}const pt=Ws(),Ke={id:pt,label:He?.label||"Container",occurrences:[]};gR({dispatch:n,socket:r,gridId:rt,panel:ke,container:Ke,userId:e?.userId,index:Ge,emit:!0}),(He?.instanceObjects||[]).forEach(Qe=>{const dt={id:Ws(),label:Qe.label||"Instance"};uh({dispatch:n,socket:r,gridId:rt,container:{...Ke,id:pt},instance:dt,userId:e?.userId,emit:!0})})}else{const He=Y,ke=He.find(Ge=>Ge.id===J.context?.panelId),rt=He.find(Ge=>Ge.id===Ce);if(ke&&rt){const Ge=J.id,pt=Gf(Ge,ke.occurrences||[],j);if(!pt){console.warn("[CONTAINER DROP] Could not find occurrence for container:",Ge),B();return}let Ke=null;if(ae.context?.insertAt!==void 0)Ke=ae.context.insertAt;else if(Oe){const dt=Sr(Oe,rt.occurrences||[],j);if(dt!==-1){const de=ae.context?.closestEdge;if(de==="top"||de==="left"?Ke=dt:(de==="bottom"||de==="right")&&(Ke=dt+1),ke.id===rt.id){const De=Sr(Ge,ke.occurrences||[],j);De!==-1&&De<dt&&(Ke=Math.max(0,Ke-1))}}}const ut=e?.gridId||e?.grid?._id,Qe=R.current.mode==="copy",jt=ke.id===rt.id;if(Qe&&jt){const dt=Sr(Ge,ke.occurrences||[],j);if(dt!==-1){const de=Ke!==null?Ke:(ke.occurrences||[]).length;dt!==de&&KN({dispatch:n,socket:r,panel:ke,fromIndex:dt,toIndex:de,emit:!0})}}else if(Qe)QY({dispatch:n,socket:r,gridId:ut,sourceContainerId:Ge,toPanel:rt,userId:e?.userId,toIndex:Ke,emit:!0});else if(ke.id===rt.id){const dt=Sr(Ge,ke.occurrences||[],j);if(dt!==-1){const de=Ke!==null?Ke:(ke.occurrences||[]).length;dt!==de&&KN({dispatch:n,socket:r,panel:ke,fromIndex:dt,toIndex:de,emit:!0})}}else eK({dispatch:n,socket:r,fromPanel:ke,toPanel:rt,occurrenceId:pt,toIndex:Ke,emit:!0})}}}if(J?.type===qe.INSTANCE&&Oe){if(ae.dataTransfer&&xl(ae.dataTransfer).isCrossWindow)return;const ze=W.find(ke=>ke.id===J.context?.containerId),He=W.find(ke=>ke.id===Oe);if(ze&&He){if(He.kind==="doc"){B();return}const ke=J.id,rt=Gf(ke,ze.occurrences||[],j);if(!rt){console.warn("[INSTANCE DROP] Could not find occurrence for instance:",ke),B();return}let Ge=null;if(ae.context?.insertAt!==void 0)Ge=ae.context.insertAt;else if(Ye&&He){const mt=Sr(Ye,He.occurrences||[],j);if(mt!==-1){const We=ae.context?.closestEdge;if(We==="top"||We==="left"?Ge=mt:We==="bottom"||We==="right"?Ge=mt+1:Ge=mt,ze.id===He.id){const Be=Sr(ke,ze.occurrences||[],j);Be!==-1&&Be<mt&&(Ge=Math.max(0,Ge-1))}}}const pt=e?.gridId||e?.grid?._id,Ke=e?.grid,ut=Ke?.iterations||[],Qe=e?.selectedIterationId||Ke?.selectedIterationId||"default",jt=ut.find(mt=>mt.id===Qe)||ut[0],dt=e?.currentIterationValue||jt?.currentDate||new Date,de=R.current.mode==="copy",De=R.current.mode==="copylink",yt=ze.id===He.id;if((De||de)&&yt){const mt=Sr(ke,ze.occurrences||[],j);if(mt!==-1){const We=Ge!==null?Ge:(ze.occurrences||[]).length;mt!==We&&XN({dispatch:n,socket:r,container:ze,fromIndex:mt,toIndex:We,emit:!0})}}else if(De)JY({dispatch:n,socket:r,gridId:pt,sourceInstanceId:ke,sourceOccurrenceId:rt,toContainer:He,userId:e?.userId,toIndex:Ge,emit:!0,iterationMode:"specific",iterationValue:dt,sourceOccurrence:rt?j[rt]:null});else if(de){const mt=XY({dispatch:n,socket:r,gridId:pt,sourceInstanceId:ke,toContainer:He,userId:e?.userId,toIndex:Ge,emit:!0,iterationMode:"specific",iterationValue:dt,sourceOccurrence:rt?j[rt]:null}),We=(e?.instances||[]).find(Be=>Be.id===ke);if(We?.meta?.autoCheckOnDrop&&mt?.occurrence?.id){const Be=(We.fieldBindings||[]).filter(Dt=>(e?.fields||[]).find(Tn=>Tn.id===Dt.fieldId)?.type==="boolean");if(Be.length>0){const Dt={};Be.forEach(rn=>{Dt[rn.fieldId]={value:!0,flow:"in"}}),ai({dispatch:n,socket:r,occurrence:{id:mt.occurrence.id,fields:Dt},emit:!0})}}}else if(ze.id===He.id){const mt=Sr(ke,ze.occurrences||[],j);if(mt!==-1){const We=Ge!==null?Ge:(ze.occurrences||[]).length;mt!==We&&XN({dispatch:n,socket:r,container:ze,fromIndex:mt,toIndex:We,emit:!0})}}else{tK({dispatch:n,socket:r,fromContainer:ze,toContainer:He,occurrenceId:rt,toIndex:Ge,emit:!0});const mt=(e?.instances||[]).find(We=>We.id===ke);if(mt?.meta?.autoCheckOnDrop&&rt){const We=(mt.fieldBindings||[]).filter(Be=>(e?.fields||[]).find(rn=>rn.id===Be.fieldId)?.type==="boolean");if(We.length>0){const Be={};We.forEach(Dt=>{Be[Dt.fieldId]={value:!0,flow:"in"}}),ai({dispatch:n,socket:r,occurrence:{id:rt,fields:Be},emit:!0})}}}}}if([qe.FILE,qe.TEXT,qe.URL,qe.EXTERNAL].includes(J?.type)&&Oe){let ze="Untitled";J.type===qe.FILE?ze=J.data?.name||"File":J.type===qe.TEXT?ze=(J.data?.text||"").slice(0,80)||"Text":J.type===qe.URL&&(ze=J.data?.url||"Link");const He=Ws();let ke=ae.context?.insertAt??null;const rt=W.find(pt=>pt.id===Oe);if(!rt){B();return}if(ke===null){const pt=rt.occurrences||[];if(pt.length>0){let Ke=0,ut=1/0;pt.forEach((jt,dt)=>{const de=j[jt];if(de&&de.targetType==="instance"){const De=document.querySelector(`[data-instance-id="${de.targetId}"]`);if(De){const yt=De.getBoundingClientRect(),mt=yt.top+yt.height/2,We=Math.abs(ve-mt);We<ut&&(ut=We,Ke=dt)}}});const Qe=j[pt[Ke]];if(Qe){const jt=document.querySelector(`[data-instance-id="${Qe.targetId}"]`);if(jt){const dt=jt.getBoundingClientRect(),de=dt.top+dt.height/2;ve<de?ke=Ke:ke=Ke+1}}}}const Ge=e?.gridId||e?.grid?._id;uh({dispatch:n,socket:r,gridId:Ge,container:rt,instance:{id:He,label:ze},userId:e?.userId,index:ke,emit:!0})}if(ae.dataTransfer&&Oe){const ze=xl(ae.dataTransfer);if(ze.isCrossWindow&&ze.type===qe.INSTANCE){const He=Ws();let ke=ae.context?.insertAt??null;const rt=W.find(Ke=>Ke.id===Oe);if(!rt){B();return}if(ke===null){const Ke=rt.occurrences||[];if(Ke.length>0){let ut=0,Qe=1/0;Ke.forEach((dt,de)=>{const De=j[dt];if(De&&De.targetType==="instance"){const yt=document.querySelector(`[data-instance-id="${De.targetId}"]`);if(yt){const mt=yt.getBoundingClientRect(),We=mt.top+mt.height/2,Be=Math.abs(ve-We);Be<Qe&&(Qe=Be,ut=de)}}});const jt=j[Ke[ut]];if(jt){const dt=document.querySelector(`[data-instance-id="${jt.targetId}"]`);if(dt){const de=dt.getBoundingClientRect(),De=de.top+de.height/2;ve<De?ke=ut:ke=ut+1}}}}const Ge=e?.gridId||e?.grid?._id,pt=ze.meta?.label||ze.data?.label||"Untitled";uh({dispatch:n,socket:r,gridId:Ge,container:rt,instance:{id:He,label:pt},userId:e?.userId,index:ke,emit:!0})}}B()}},[n,r,$,we,pe,P,Y,W,j,B,e]),Te=x.useCallback(()=>{B()},[B]);x.useEffect(()=>jK(),[]);const re=x.useCallback(()=>{const ae=G(),Me=new Map;for(const J of ae){const X=Zc(J);Me.has(X)||Me.set(X,[]),Me.get(X).push(J)}return Me},[G]),he=x.useCallback(ae=>ae?re().get(Zc(ae))||[]:[],[re]),Ae=x.useCallback((ae,Me,J)=>{const X=G(),ve=`cell-${ae}-${Me}`,Ce=X.filter(Oe=>Zc(Oe)===ve);Ce.length<=1||Ce.forEach(Oe=>{fl({dispatch:n,socket:r,panel:Oe,display:Oe.id===J?"block":"none",emit:!0})})},[n,r,G]),Re=x.useCallback(({panelId:ae,dir:Me=1})=>{const X=G().find(et=>et.id===ae);if(!X)return;const ve=he(X);if(ve.length<=1)return;const Ce=ve.findIndex(et=>XX(et)!=="none"),Ye=((Ce>=0?Ce:0)+(Me>=0?1:-1)+ve.length)%ve.length;ve.forEach((et,at)=>{fl({dispatch:n,socket:r,panel:et,display:at===Ye?"block":"none",emit:!0})})},[n,r,G,he]),Le=x.useMemo(()=>({handleDragStart:H,handleDragMove:ce,handleDragOver:te,handleDrop:me,handleDragEnd:Te,getActiveType:()=>R.current.payload?.type||null,activePayload:g,activeType:k,activeId:D,isDragging:M,hotTarget:y,panelOverCellId:S,dragMode:T,setDragMode:N,toggleDragMode:be,isCopyMode:T==="copy",isMoveMode:T==="move",isCopylinkMode:T==="copylink",isPanelDrag:k===qe.PANEL,isContainerDrag:k===qe.CONTAINER,isInstanceDrag:k===qe.INSTANCE,isExternalDrag:[qe.EXTERNAL,qe.FILE,qe.TEXT,qe.URL].includes(k),getWorkingPanels:G,getWorkingAllPanels:oe,getWorkingContainers:L,getStacksByCell:re,getStackForPanel:he,setActivePanelInCell:Ae,cyclePanelStack:Re,getHoveredPanelId:we,getHoveredContainerId:pe}),[H,ce,te,me,Te,g,k,D,M,y,S,T,be,G,oe,L,re,he,Ae,Re,we,pe]);return h.jsx(AR.Provider,{value:Le,children:t})}const QX=Se.memo(function({r:e,c:n,dark:r,hasPanel:i}){const o=Ts(),{isPanelDrag:a,panelOverCellId:c}=o,u=`cell-${e}-${n}`,{ref:f,isOver:p}=qu({type:"grid-cell",id:u,context:{row:e,col:n,cellId:u},accepts:Bl.GRID_CELL,disabled:!a}),g=a&&(c===u||p);return h.jsx("div",{ref:f,"data-id":u,className:["grid-cell",g?"is-highlight":""].join(" "),style:{gridRow:e+1,gridColumn:n+1},children:!i&&h.jsx("div",{style:{position:"absolute",inset:"6px",borderRadius:"8px",background:"rgba(69, 72, 74, 0.4)",border:"1px solid rgba(0, 0, 0, 0.5)",boxShadow:"inset 0 2px 4px rgba(0, 0, 0, 0.3)",pointerEvents:"none",display:"flex",alignItems:"center",justifyContent:"center"},children:h.jsx("div",{className:"text-xs text-muted-foreground p-2 text-center",style:{fontStyle:"italic",opacity:.6},children:"Drop panel here"})})})});function ZX({components:t,gridRef:e,rows:n,cols:r,colTemplate:i,rowTemplate:o,colSizes:a,rowSizes:c,panelsRender:u,dispatch:f,socket:p,fullscreenPanelId:g,setFullscreenPanelId:v,addContainerToPanel:y,addInstanceToContainer:w,sizesRef:S,onStartColResize:C,onStartRowResize:T}){const N=x.useMemo(()=>{const M=[];for(let R=0;R<n;R++)for(let O=0;O<r;O++){const I=u.some(z=>(z?.layout?.style?.display??"block")!=="none"&&z.row===R&&z.col===O);M.push({r:R,c:O,dark:(R+O)%2===0,hasPanel:I})}return M},[n,r,u]),k=x.useCallback(M=>{const R=a.reduce((I,z)=>I+z,0);return a.slice(0,M+1).reduce((I,z)=>I+z,0)/R*100},[a]),D=x.useCallback(M=>{const R=c.reduce((I,z)=>I+z,0);return c.slice(0,M+1).reduce((I,z)=>I+z,0)/R*100},[c]);return h.jsxs("div",{ref:e,className:["bg-background2 rounded-xl border border-border shadow-inner ring-1 ring-black/30",g!==null?"pointer-events-none opacity-0":""].join(" "),style:{display:"grid",gridTemplateColumns:i,gridTemplateRows:o,width:"100%",height:"100%",position:"relative",overflow:"hidden",borderRadius:12,transition:"opacity 0.15s ease"},children:[N.map(({r:M,c:R,dark:O,hasPanel:I})=>h.jsx(QX,{r:M,c:R,dark:O,hasPanel:I},`cell-${M}-${R}`)),[...Array(r-1)].map((M,R)=>h.jsx("div",{onMouseDown:O=>C(O,R),onTouchStart:O=>C(O,R),style:{position:"absolute",top:0,bottom:0,left:`${k(R)}%`,width:6,transform:"translateX(-50%)",cursor:"col-resize",zIndex:50,background:"#8f969eff",borderRadius:2,display:"flex",alignItems:"center",justifyContent:"center"},children:h.jsxs("svg",{width:"4",height:"16",viewBox:"0 0 4 16",style:{opacity:.6},children:[h.jsx("circle",{cx:"2",cy:"4",r:"1",fill:"white"}),h.jsx("circle",{cx:"2",cy:"8",r:"1",fill:"white"}),h.jsx("circle",{cx:"2",cy:"12",r:"1",fill:"white"})]})},`col-resize-${R}`)),[...Array(n-1)].map((M,R)=>h.jsx("div",{onMouseDown:O=>T(O,R),onTouchStart:O=>T(O,R),style:{position:"absolute",left:0,right:0,top:`${D(R)}%`,height:6,transform:"translateY(-50%)",cursor:"row-resize",zIndex:50,background:"#8f969eff",borderRadius:2,display:"flex",alignItems:"center",justifyContent:"center"},children:h.jsxs("svg",{width:"16",height:"4",viewBox:"0 0 16 4",style:{opacity:.6},children:[h.jsx("circle",{cx:"4",cy:"2",r:"1",fill:"white"}),h.jsx("circle",{cx:"8",cy:"2",r:"1",fill:"white"}),h.jsx("circle",{cx:"12",cy:"2",r:"1",fill:"white"})]})},`row-resize-${R}`)),u.map(M=>(M?.layout?.style?.display??"block")==="none"?null:h.jsx(RR,{panel:M,dispatch:f,socket:p,cols:r,rows:n,components:t,addContainerToPanel:y,addInstanceToContainer:w,sizesRef:S,fullscreenPanelId:g,setFullscreenPanelId:v},M.id))]})}function eJ({components:t}){const{state:e}=x.useContext(lm),[n,r]=x.useState(0),i=x.useCallback(()=>r(re=>re+1),[]),[o,a]=x.useState(!1),{dispatch:c,socket:u,addContainerToPanel:f,addInstanceToContainer:p,createField:g,updateField:v,deleteField:y,canUndo:w,canRedo:S,undo:C,redo:T,isProcessing:N}=x.useContext(Rn),k=e.grid,D=k?._id,{animateUndoMoves:M}=KX();x.useEffect(()=>{if(!u)return;const re=({success:he,reversedOps:Ae,animate:Re})=>{if(he&&Re&&Ae){const Le=Ae.filter(ae=>ae.type==="move_back");Le.length>0&&M(Le)}};return u.on("undo_result",re),()=>u.off("undo_result",re)},[u,M]);const R=k?.rows??1,O=k?.cols??1,I=x.useRef(null),z=x.useMemo(()=>VY(e).filter(he=>he.targetType==="panel"&&he.panel).map(he=>({...he.panel,row:he.placement?.row??he.panel?.row??0,col:he.placement?.col??he.panel?.col??0,width:he.placement?.width??1,height:he.placement?.height??1,_occurrenceId:he.id,_occurrence:he})),[e]);x.useEffect(()=>{if(!z||z.length===0)return;const re=new Map;for(const he of z){const Ae=`${he.row}-${he.col}`;re.has(Ae)||re.set(Ae,[]),re.get(Ae).push(he)}for(const[he,Ae]of re){if(Ae.length===0)continue;if(Ae.every(Le=>(Le?.layout?.style?.display??"block")==="none")){const Le=Ae[0];qn({dispatch:c,socket:u,panel:{...Le,layout:{...Le.layout||{},style:{...Le.layout?.style||{},display:"block"}}},emit:!0})}}},[z,c,u]);const[U,Y]=x.useState(null),W=(re,he)=>!Array.isArray(re)||re.length===0?Array(he).fill(1):re.length===he?re:re.length<he?[...re,...Array(he-re.length).fill(1)]:re.slice(0,he),j=(re=[],he=[])=>{if(re===he)return!0;if(re.length!==he.length)return!1;for(let Ae=0;Ae<re.length;Ae++)if(re[Ae]!==he[Ae])return!1;return!0},[G,oe]=x.useState(()=>W(k?.colSizes,O)),[L,$]=x.useState(()=>W(k?.rowSizes,R)),V=x.useRef({colSizes:[],rowSizes:[]});x.useEffect(()=>{V.current={colSizes:G,rowSizes:L}},[G,L]),x.useEffect(()=>{const re=W(k?.colSizes,O);oe(he=>j(he,re)?he:re)},[O,k?._id]),x.useEffect(()=>{const re=W(k?.rowSizes,R);$(he=>j(he,re)?he:re)},[R,k?._id]);const we=G.map(re=>`${re}fr`).join(" "),pe=L.map(re=>`${re}fr`).join(" "),P=x.useMemo(()=>{const re=Object.create(null);for(const he of e.panels||[])re[he.id]=he;return re},[e.panels]),K=x.useRef({rowSizes:null,colSizes:null}),B=x.useCallback(()=>{const re=K.current;if(!re.rowSizes&&!re.colSizes||!D)return;const he=re.rowSizes??L,Ae=re.colSizes??G;ti({dispatch:c,socket:u,gridId:D,grid:{rowSizes:he,colSizes:Ae},emit:!0}),K.current={rowSizes:null,colSizes:null}},[D,L,G,c,u]),Z=()=>I.current?.clientWidth||1,le=()=>I.current?.clientHeight||1,be=x.useCallback((re,he)=>{const Ae=Z();oe(Re=>{const Le=re+1;if(Le>=Re.length)return Re;const ae=Re.reduce((X,ve)=>X+ve,0),Me=he/Ae*ae,J=[...Re];return J[re]=Math.max(.3,J[re]+Me),J[Le]=Math.max(.3,J[Le]-Me),K.current.colSizes=J,J})},[]),H=x.useCallback((re,he)=>{const Ae=le();$(Re=>{const Le=re+1;if(Le>=Re.length)return Re;const ae=Re.reduce((X,ve)=>X+ve,0),Me=he/Ae*ae,J=[...Re];return J[re]=Math.max(.3,J[re]+Me),J[Le]=Math.max(.3,J[Le]-Me),K.current.rowSizes=J,J})},[]),ce=re=>re.touches?re.touches[0].clientX:re.clientX,te=re=>re.touches?re.touches[0].clientY:re.clientY,me=x.useCallback((re,he)=>{re.preventDefault();let Ae=ce(re);const Re=ae=>{ae.preventDefault();const Me=ce(ae),J=Me-Ae;Ae=Me,be(he,J)},Le=()=>{window.removeEventListener("mousemove",Re),window.removeEventListener("mouseup",Le),window.removeEventListener("touchmove",Re),window.removeEventListener("touchend",Le),B()};window.addEventListener("mousemove",Re),window.addEventListener("mouseup",Le),window.addEventListener("touchmove",Re),window.addEventListener("touchend",Le)},[be,B]),Te=x.useCallback((re,he)=>{re.preventDefault();let Ae=te(re);const Re=ae=>{ae.preventDefault();const Me=te(ae),J=Me-Ae;Ae=Me,H(he,J)},Le=()=>{window.removeEventListener("mousemove",Re),window.removeEventListener("mouseup",Le),window.removeEventListener("touchmove",Re),window.removeEventListener("touchend",Le),B()};window.addEventListener("mousemove",Re),window.addEventListener("mouseup",Le),window.addEventListener("touchmove",Re),window.addEventListener("touchend",Le)},[H,B]);return h.jsxs(JX,{state:e,dispatch:c,socket:u,gridRef:I,rows:R,cols:O,rowSizes:L,colSizes:G,visiblePanels:z,onTick:i,children:[h.jsx(ZX,{components:t,gridRef:I,rows:R,cols:O,colTemplate:we,rowTemplate:pe,colSizes:G,rowSizes:L,panelsRender:z,dispatch:c,socket:u,fullscreenPanelId:U,setFullscreenPanelId:Y,addContainerToPanel:f,addInstanceToContainer:p,sizesRef:V,onStartColResize:me,onStartRowResize:Te}),h.jsx(LK,{fullscreenPanelId:U,setFullscreenPanelId:Y,panelsById:P,components:t,cols:O,rows:R}),h.jsx(GX,{onUndo:C,onRedo:T,canUndo:w&&!N,canRedo:S&&!N,onFields:()=>a(!0),disabled:N}),h.jsx($X,{open:o,onOpenChange:a,gridId:D,fields:e.fields||[],panels:e.panels||[],containers:e.containers||[],instances:e.instances||[],onCreateField:g,onUpdateField:v,onDeleteField:y})]})}function tJ(){const[t,e]=x.useState(""),[n,r]=x.useState(""),i=()=>{Lt.emit("login",{email:t,password:n})},o=()=>{Lt.emit("register",{email:t,password:n})};return h.jsxs("div",{style:{height:"100vh",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",background:"#1D2125",color:"white",gap:12},children:[h.jsx("img",{src:"/moduli_logo_true_vector.svg",alt:"Moduli",style:{width:120,height:120,marginBottom:8}}),h.jsx("h1",{style:{fontSize:28,fontWeight:700,letterSpacing:2,margin:0},children:"+moduli+"}),h.jsx("div",{style:{height:16}}),h.jsx("input",{style:{padding:8,width:240},placeholder:"Email",value:t,onChange:a=>e(a.target.value)}),h.jsx("input",{type:"password",style:{padding:8,width:240},placeholder:"Password",value:n,onChange:a=>r(a.target.value)}),h.jsx("button",{style:{padding:8,width:240},onClick:i,children:"Login"}),h.jsx("button",{style:{padding:8,width:240},onClick:o,children:"Register"})]})}function nJ(t,e){switch(e.type){case ue.FULL_STATE:{const{gridId:n=null,grid:r=null,panels:i=[],grids:o=[],containers:a=[],instances:c=[],occurrences:u=[],fields:f=[],manifests:p=[],views:g=[],docs:v=[],folders:y=[],artifacts:w=[]}=e.payload||{};return{...t,gridId:n??t.gridId,grid:r,panels:i||[],availableGrids:o||[],containers:a||[],instances:c||[],occurrences:u||[],fields:f||[],manifests:p||[],views:g||[],docs:v||[],folders:y||[],artifacts:w||[],hydrated:!0}}case ue.SET_GRID_ID:{const n=typeof e.payload=="string"?e.payload:e.payload?.gridId;return{...t,gridId:n??t.gridId}}case ue.SET_USER_ID:{const n=typeof e.payload=="string"?e.payload:e.payload?.userId;return{...t,userId:n??t.userId}}case ue.LOGOUT:return{...t,userId:null,gridId:null,grid:null,panels:[],availableGrids:[],containers:[],instances:[],occurrences:[],fields:[],manifests:[],views:[],docs:[],folders:[],artifacts:[],hydrated:!1};case ue.SET_AVAILABLE_GRIDS:{const n=e.payload?.availableGrids??e.payload?.grids??[];return{...t,availableGrids:n}}case ue.SET_GRID:{const n=e.payload?.grid??null;return{...t,grid:n}}case ue.CREATE_GRID:{const n=e.payload?.grid;if(!n)return t;const r=n._id?.toString?.()||n.id||t.gridId;return{...t,gridId:r,grid:n}}case ue.UPDATE_GRID:{const{gridId:n,grid:r}=e.payload||{};if(!n||!r)return t;const i=t.gridId||t.grid?._id;if(i&&n!==i){const c=(t.availableGrids||[]).map(u=>(u.id||u._id)===n?{...u,...r}:u);return{...t,availableGrids:c}}const o={...t.grid||{},...r},a=(t.availableGrids||[]).map(c=>(c.id||c._id)===n?{...c,...r}:c);return{...t,grid:o,availableGrids:a}}case ue.DELETE_GRID:{const n=e.payload?.gridId??e.payload;return!n||t.gridId!==n?t:{...t,gridId:null,grid:null,panels:[]}}case ue.SET_PANELS:{const n=e.payload?.panels??[];return{...t,panels:n}}case ue.CREATE_PANEL:case ue.UPDATE_PANEL:{const n=e.payload?.panel??e.payload;if(!n?.id)return t;const r=(t.panels||[]).some(i=>i.id===n.id);return{...t,panels:r?t.panels.map(i=>i.id===n.id?{...i,...n}:i):[...t.panels||[],n]}}case ue.DELETE_PANEL:{const n=e.payload?.panelId??e.payload;return n?{...t,panels:(t.panels||[]).filter(r=>r.id!==n)}:t}case ue.SET_CONTAINERS:{const n=e.payload?.containers??[];return{...t,containers:n}}case ue.CREATE_CONTAINER:{const n=e.payload?.container??e.payload,r=n?.id;return!r||(t.containers||[]).some(o=>o.id===r)?t:{...t,containers:[...t.containers||[],{...n,id:r,label:n.label??"Untitled",occurrences:Array.isArray(n.occurrences)?n.occurrences:[]}]}}case ue.UPDATE_CONTAINER:{const n=e.payload?.container??e.payload;return n?.id?{...t,containers:(t.containers||[]).map(r=>r.id===n.id?{...r,...n}:r)}:t}case ue.UPDATE_CONTAINER_OCCURRENCES:{const n=e.payload?.containerId,r=e.payload?.occurrences||e.payload?.items;return!n||!Array.isArray(r)?t:{...t,containers:(t.containers||[]).map(i=>i.id===n?{...i,occurrences:[...r]}:i)}}case ue.DELETE_CONTAINER:{const n=e.payload?.containerId??e.payload;return n?{...t,containers:(t.containers||[]).filter(r=>r.id!==n)}:t}case ue.SET_INSTANCES:{const n=e.payload?.instances??[];return{...t,instances:n}}case ue.CREATE_INSTANCE_IN_CONTAINER:{const{instance:n}=e.payload||{};if(!n?.id)return t;const i=(t.instances||[]).some(o=>o.id===n.id)?t.instances:[...t.instances||[],n];return{...t,instances:i}}case ue.CREATE_INSTANCE:{const n=e.payload?.instance??e.payload;return!n?.id||(t.instances||[]).some(i=>i.id===n.id)?t:{...t,instances:[...t.instances||[],n]}}case ue.UPDATE_INSTANCE:{const n=e.payload?.instance??e.payload;if(!n?.id)return t;const r=(t.instances||[]).some(i=>i.id===n.id);return{...t,instances:r?t.instances.map(i=>i.id===n.id?{...i,...n}:i):[...t.instances||[],n]}}case ue.DELETE_INSTANCE:{const n=e.payload?.instanceId??e.payload;return n?{...t,instances:(t.instances||[]).filter(r=>r.id!==n)}:t}case ue.SET_OCCURRENCES:{const n=e.payload?.occurrences??[];return{...t,occurrences:n}}case ue.CREATE_OCCURRENCE:case ue.UPDATE_OCCURRENCE:{const n=e.payload?.occurrence??e.payload;if(!n?.id)return t;const r=(t.occurrences||[]).some(i=>i.id===n.id);return{...t,occurrences:r?t.occurrences.map(i=>i.id===n.id?{...i,...n}:i):[...t.occurrences||[],n]}}case ue.DELETE_OCCURRENCE:{const n=e.payload?.occurrenceId??e.payload;return n?{...t,occurrences:(t.occurrences||[]).filter(r=>r.id!==n)}:t}case ue.SET_FIELDS:{const n=e.payload?.fields??[];return{...t,fields:n}}case ue.CREATE_FIELD:case ue.UPDATE_FIELD:{const n=e.payload?.field??e.payload;if(!n?.id)return t;const r=(t.fields||[]).some(i=>i.id===n.id);return{...t,fields:r?t.fields.map(i=>i.id===n.id?{...i,...n}:i):[...t.fields||[],n]}}case ue.DELETE_FIELD:{const n=e.payload?.fieldId??e.payload;return n?{...t,fields:(t.fields||[]).filter(r=>r.id!==n)}:t}case ue.CREATE_MANIFEST:case ue.UPDATE_MANIFEST:{const n=e.payload?.manifest??e.payload;if(!n?.id)return t;const r=(t.manifests||[]).some(i=>i.id===n.id);return{...t,manifests:r?t.manifests.map(i=>i.id===n.id?{...i,...n}:i):[...t.manifests||[],n]}}case ue.DELETE_MANIFEST:{const n=e.payload?.manifestId??e.payload;return n?{...t,manifests:(t.manifests||[]).filter(r=>r.id!==n)}:t}case ue.CREATE_VIEW:case ue.UPDATE_VIEW:{const n=e.payload?.view??e.payload;if(!n?.id)return t;const r=(t.views||[]).some(i=>i.id===n.id);return{...t,views:r?t.views.map(i=>i.id===n.id?{...i,...n}:i):[...t.views||[],n]}}case ue.DELETE_VIEW:{const n=e.payload?.viewId??e.payload;return n?{...t,views:(t.views||[]).filter(r=>r.id!==n)}:t}case ue.CREATE_DOC:case ue.UPDATE_DOC:{const n=e.payload?.doc??e.payload;if(!n?.id)return t;const r=(t.docs||[]).some(i=>i.id===n.id);return{...t,docs:r?t.docs.map(i=>i.id===n.id?{...i,...n}:i):[...t.docs||[],n]}}case ue.DELETE_DOC:{const n=e.payload?.docId??e.payload;return n?{...t,docs:(t.docs||[]).filter(r=>r.id!==n)}:t}case ue.CREATE_FOLDER:case ue.UPDATE_FOLDER:{const n=e.payload?.folder??e.payload;if(!n?.id)return t;const r=(t.folders||[]).some(i=>i.id===n.id);return{...t,folders:r?t.folders.map(i=>i.id===n.id?{...i,...n}:i):[...t.folders||[],n]}}case ue.DELETE_FOLDER:{const n=e.payload?.folderId??e.payload;return n?{...t,folders:(t.folders||[]).filter(r=>r.id!==n)}:t}case ue.CREATE_ARTIFACT:case ue.UPDATE_ARTIFACT:{const n=e.payload?.artifact??e.payload;if(!n?.id)return t;const r=(t.artifacts||[]).some(i=>i.id===n.id);return{...t,artifacts:r?t.artifacts.map(i=>i.id===n.id?{...i,...n}:i):[...t.artifacts||[],n]}}case ue.DELETE_ARTIFACT:{const n=e.payload?.artifactId??e.payload;return n?{...t,artifacts:(t.artifacts||[]).filter(r=>r.id!==n)}:t}case ue.SET_ACTIVE_ID:return{...t,activeId:e.payload?.activeId};case ue.SET_ACTIVE_SIZE:return{...t,activeSize:e.payload?.activeSize};case ue.SOFT_TICK:return{...t,softTick:(t.softTick||0)+1};default:return t}}const rJ={userId:localStorage.getItem("moduli-userId")||null,gridId:localStorage.getItem("moduli-gridId")||null,grid:null,availableGrids:[],panels:[],containers:[],instances:[],occurrences:[],fields:[],activeId:null,activeSize:null,softTick:0,hydrated:!1},iJ="moduli-sync",oJ=new Set([ue.UPDATE_INSTANCE,ue.CREATE_INSTANCE,ue.DELETE_INSTANCE,ue.CREATE_INSTANCE_IN_CONTAINER,ue.UPDATE_CONTAINER,ue.UPDATE_CONTAINER_OCCURRENCES,ue.CREATE_CONTAINER,ue.DELETE_CONTAINER,ue.UPDATE_OCCURRENCE,ue.CREATE_OCCURRENCE,ue.DELETE_OCCURRENCE,ue.UPDATE_FIELD,ue.CREATE_FIELD,ue.DELETE_FIELD,ue.UPDATE_PANEL,ue.DELETE_PANEL,ue.UPDATE_GRID,ue.CREATE_MANIFEST,ue.UPDATE_MANIFEST,ue.DELETE_MANIFEST,ue.CREATE_VIEW,ue.UPDATE_VIEW,ue.DELETE_VIEW,ue.CREATE_DOC,ue.UPDATE_DOC,ue.DELETE_DOC,ue.CREATE_FOLDER,ue.UPDATE_FOLDER,ue.DELETE_FOLDER,ue.CREATE_ARTIFACT,ue.UPDATE_ARTIFACT,ue.DELETE_ARTIFACT]);function sJ(t){const e=x.useRef(null),n=x.useRef(`tab-${Date.now()}-${Math.random().toString(36).slice(2,8)}`);return x.useEffect(()=>{if(typeof BroadcastChannel>"u")return;const i=new BroadcastChannel(iJ);return e.current=i,i.onmessage=o=>{const{action:a,sourceTabId:c}=o.data||{};c!==n.current&&a?.type&&t(a)},()=>{i.close(),e.current=null}},[t]),x.useCallback(i=>{if(t(i),e.current&&i?.type&&oJ.has(i.type)&&!i._fromSocket&&!i._fromBroadcast)try{e.current.postMessage({action:i,sourceTabId:n.current})}catch{}},[t])}function aJ(){const[t,e]=x.useReducer(nJ,rJ),n=sJ(e);return{state:t,dispatch:n}}function Kx({options:t=[],selected:e=[],onChange:n,placeholder:r="Select items...",emptyMessage:i="No items available",maxDisplay:o=3,allowSelectAll:a=!0,disabled:c=!1,compact:u=!1}){const[f,p]=x.useState(!1),g=x.useMemo(()=>t.filter(N=>e.includes(N.value)),[t,e]);x.useMemo(()=>t.filter(N=>!e.includes(N.value)),[t,e]);const v=x.useCallback(N=>{e.includes(N)?n?.(e.filter(k=>k!==N)):n?.([...e,N])},[e,n]),y=x.useCallback((N,k)=>{k?.stopPropagation(),n?.(e.filter(D=>D!==N))},[e,n]),w=x.useCallback(()=>{n?.(t.map(N=>N.value))},[t,n]),S=x.useCallback(()=>{n?.([])},[n]),C=g.slice(0,o),T=g.length-o;return h.jsx("div",{className:"multi-select-pills",children:h.jsxs(fo,{open:f,onOpenChange:p,children:[h.jsx(ho,{asChild:!0,children:h.jsx(_e,{variant:"outline",role:"combobox","aria-expanded":f,disabled:c,className:`
              w-full justify-start font-normal
              ${u?"h-7 text-[10px]":"h-8 text-xs"}
              ${g.length===0?"text-muted-foreground":""}
            `,children:g.length===0?h.jsx("span",{children:r}):h.jsxs("div",{className:"flex flex-wrap gap-1 items-center",children:[C.map(N=>h.jsxs("span",{className:`
                      inline-flex items-center gap-0.5
                      ${u?"px-1 py-0 text-[9px]":"px-1.5 py-0.5 text-[10px]"}
                      rounded-full
                      ${N.color||"bg-primary/20 text-primary"}
                    `,children:[N.label,h.jsx(Hl,{className:u?"h-2 w-2":"h-2.5 w-2.5",onClick:k=>y(N.value,k)})]},N.value)),T>0&&h.jsxs("span",{className:`${u?"text-[9px]":"text-[10px]"} text-muted-foreground`,children:["+",T," more"]})]})})}),h.jsxs(po,{className:"w-64 p-0",align:"start",children:[a&&t.length>0&&h.jsxs("div",{className:"flex items-center justify-between px-2 py-1.5 border-b border-border",children:[h.jsx(_e,{variant:"ghost",size:"sm",className:"h-5 text-[10px] px-2",onClick:w,children:"Select All"}),h.jsx(_e,{variant:"ghost",size:"sm",className:"h-5 text-[10px] px-2",onClick:S,children:"Clear"})]}),h.jsx("div",{className:"max-h-48 overflow-y-auto p-1",children:t.length===0?h.jsx("div",{className:"py-4 text-center text-xs text-muted-foreground",children:i}):t.map(N=>{const k=e.includes(N.value);return h.jsxs("button",{type:"button",onClick:()=>v(N.value),className:`
                      w-full flex items-center gap-2 px-2 py-1.5 rounded-sm
                      text-left text-xs
                      transition-colors
                      ${k?"bg-primary/10 text-primary":"hover:bg-muted"}
                    `,children:[h.jsx("div",{className:`
                      w-4 h-4 rounded border flex items-center justify-center
                      ${k?"bg-primary border-primary":"border-muted-foreground/30"}
                    `,children:k&&h.jsx(Cp,{className:"h-3 w-3 text-primary-foreground"})}),h.jsxs("div",{className:"flex-1 min-w-0",children:[h.jsx("div",{className:"truncate",children:N.label}),N.description&&h.jsx("div",{className:"text-[10px] text-muted-foreground truncate",children:N.description})]})]},N.value)})})]})]})})}const lJ=[{value:"move",label:"Move (relocate occurrence)"},{value:"copy",label:"Copy (create new occurrence)"},{value:"copylink",label:"Copylink (linked occurrence)"}];function cJ({value:t,onChange:e,onCommitLabel:n,onDeleteInstance:r,instanceId:i,instance:o,occurrence:a,iteration:c,onIterationChange:u,dispatch:f,socket:p}){const{fieldsById:g,containersById:v,panelsById:y}=x.useContext(Rn),w=x.useCallback(D=>{if(!a?.id)return;const M={...a,...D,iteration:{...a.iteration||{},...D.iteration||{}}};ai({dispatch:f,socket:p,occurrence:M,emit:!0})},[a,f,p]),[S,C]=x.useState(()=>o?.fieldBindings||[]),T=Object.values(g||{}),N=Object.values(y||{}),k=Object.values(v||{});return h.jsxs("div",{className:"font-mono",style:{minWidth:280},children:[h.jsxs("div",{children:[h.jsx("h4",{className:"text-sm font-semibold text-white",children:"Instance settings"}),h.jsx("p",{className:"text-[11px] pt-[2px] text-foregroundScale-2",children:"Edit instance label and fields."})]}),h.jsx(Rt,{}),h.jsx(ot,{schema:{className:"",type:"text-input",key:"label",label:"Label",placeholder:"Untitled",onKeyDown:D=>{D.key==="Enter"&&(D.preventDefault(),n?.(),D.currentTarget.blur())}},value:t,onChange:e}),h.jsx(Rt,{}),h.jsxs("div",{className:"py-2",children:[h.jsx("h4",{className:"text-xs font-semibold text-foregroundScale-2 mb-2",children:"Drag Behavior"}),h.jsx(ot,{schema:{type:"select",key:"__defaultDragMode",label:"Default Mode",options:lJ,description:"Default behavior when dragging this instance."},value:{__defaultDragMode:o?.defaultDragMode||"move"},onChange:D=>{o&&Nr({dispatch:f,socket:p,instance:{id:o.id,defaultDragMode:D?.__defaultDragMode||"move"},emit:!0})}})]}),h.jsxs("div",{className:"flex items-center justify-between gap-2 py-1 px-1",children:[h.jsx(tt,{className:"text-xs",children:"Auto-check on drop"}),h.jsx(od,{checked:o?.meta?.autoCheckOnDrop||!1,onCheckedChange:D=>{o&&Nr({dispatch:f,socket:p,instance:{id:o.id,meta:{...o.meta||{},autoCheckOnDrop:D}},emit:!0})}})]}),h.jsx(Rt,{}),h.jsx(uJ,{instance:o,dispatch:f,socket:p}),h.jsx(Rt,{}),a&&h.jsxs(h.Fragment,{children:[h.jsxs("div",{className:"py-2",children:[h.jsx("h4",{className:"text-xs font-semibold text-foregroundScale-2 mb-2",children:"Iteration"}),h.jsx(O0,{occurrence:a,onUpdate:w,entityType:"instance",compact:!0})]}),h.jsx(Rt,{})]}),h.jsx(Uu,{styleMode:o?.styleMode||"inherit",ownStyle:o?.ownStyle,onStyleModeChange:D=>{o&&Nr({dispatch:f,socket:p,instance:{id:o.id,styleMode:D},emit:!0})},onOwnStyleChange:D=>{o&&Nr({dispatch:f,socket:p,instance:{id:o.id,ownStyle:D},emit:!0})},label:"Instance Style",inheritLabel:"Container / Panel"}),h.jsx(Rt,{}),h.jsx(yJ,{instance:o,localBindings:S,setLocalBindings:C,allFields:T,fieldsById:g,panels:N,containers:k,dispatch:f,socket:p}),h.jsx(Rt,{}),h.jsxs("div",{className:"pt-2",children:[h.jsx("h4",{className:"text-xs font-semibold text-red-400",children:"Danger zone"}),h.jsx("p",{className:"text-[10px] text-foregroundScale-2/80 mt-1",children:"Deletes this instance and removes it from any containers that reference it."}),h.jsx("div",{className:"mt-2",children:h.jsx(_e,{type:"button",variant:"destructive",size:"sm",onClick:()=>{window.confirm(`Delete this instance${i?` (${i})`:""}? This cannot be undone.`)&&r?.()},disabled:!r,children:"Delete Instance"})})]})]})}function uJ({instance:t,dispatch:e,socket:n}){const[r,i]=x.useState(""),o=t?.siblingLinks||[],a=x.useCallback(()=>{const u=r.trim();if(!u||!t)return;if(o.includes(u)){i("");return}const f=[...o,u];Nr({dispatch:e,socket:n,instance:{id:t.id,siblingLinks:f},emit:!0}),i("")},[r,t,o,e,n]),c=x.useCallback(u=>{if(!t)return;const f=o.filter(p=>p!==u);Nr({dispatch:e,socket:n,instance:{id:t.id,siblingLinks:f},emit:!0})},[t,o,e,n]);return h.jsxs("div",{className:"py-2",children:[h.jsx("h4",{className:"text-xs font-semibold text-foregroundScale-2 mb-2",children:"Sibling Links"}),o.length>0&&h.jsx("div",{className:"flex flex-wrap gap-1 mb-2",children:o.map(u=>h.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 text-[10px] rounded-full bg-muted/50 text-muted-foreground border border-border",children:[u.length>12?`${u.slice(0,12)}...`:u,h.jsx("button",{type:"button",className:"hover:text-red-400 transition-colors",onClick:()=>c(u),"aria-label":`Remove sibling ${u}`,children:h.jsx(Hl,{className:"h-2.5 w-2.5"})})]},u))}),o.length===0&&h.jsx("p",{className:"text-[10px] text-foregroundScale-2/80 mb-2",children:"No sibling links yet."}),h.jsxs("div",{className:"flex items-center gap-1",children:[h.jsx(Kt,{type:"text",value:r,onChange:u=>i(u.target.value),onKeyDown:u=>{u.key==="Enter"&&(u.preventDefault(),a())},placeholder:"Sibling instance ID",className:"h-6 text-xs flex-1"}),h.jsx(_e,{type:"button",variant:"ghost",size:"sm",className:"h-6 text-[10px] px-2",onClick:a,disabled:!r.trim(),children:"Add"})]})]})}const dJ=Object.entries(nm).map(([t,e])=>({value:t,label:e.label})),fJ=[{value:"inherit",label:"Inherit (use parent iteration)"},{value:"daily",label:"Daily"},{value:"weekly",label:"Weekly"},{value:"monthly",label:"Monthly"},{value:"yearly",label:"Yearly"},{value:"all",label:"All time"}],hJ=[{value:"daily",label:"Daily (per day)"},{value:"weekly",label:"Weekly (per week)"},{value:"monthly",label:"Monthly (per month)"},{value:"yearly",label:"Yearly (per year)"},{value:"inherit",label:"Inherit (match viewing period)"}],pJ=Object.entries(tm).map(([t,e])=>({value:t,label:e.label})),mJ=Object.entries(wG).map(([t,e])=>({value:t,label:e.label})),gJ=Object.entries(SG).map(([t,e])=>({value:t,label:e.label})),sA=[{value:"number",label:"Number"},{value:"text",label:"Text"},{value:"boolean",label:"Boolean"},{value:"date",label:"Date"}];function yJ({instance:t,localBindings:e,setLocalBindings:n,allFields:r,fieldsById:i,panels:o,containers:a,dispatch:c,socket:u}){const f=x.useMemo(()=>r.map(C=>({value:C.id,label:C.name||C.type,description:`${C.type} (${C.mode})`,color:C.mode==="input"?"bg-blue-500/20 text-blue-300":"bg-violet-500/20 text-violet-300"})),[r]),p=x.useMemo(()=>{const C=o.map(N=>({value:`panel:${N.id}`,label:N.name||`Panel ${N.id?.slice(0,6)}`,description:"Panel",color:"bg-cyan-500/20 text-cyan-300"})),T=a.map(N=>({value:`container:${N.id}`,label:N.name||`Container ${N.id?.slice(0,6)}`,description:"Container",color:"bg-orange-500/20 text-orange-300"}));return[...C,...T]},[o,a]),g=x.useMemo(()=>e.map(C=>C.fieldId).filter(Boolean),[e]),v=x.useCallback(C=>{const T=C.map((N,k)=>{const D=e.find(M=>M.fieldId===N);return D||{fieldId:N,role:"input",order:k}});n(T),t&&Nr({dispatch:c,socket:u,instance:{id:t.id,fieldBindings:T},emit:!0})},[e,t,c,u,n]),y=x.useCallback(()=>{const C=kn();PG({dispatch:c,socket:u,field:{id:C,name:"",type:"number",mode:"input",meta:{prefix:"",postfix:"",increment:1},metric:null},emit:!0});const N={fieldId:C,role:"input",order:e.length},k=[...e,N];n(k),t&&Nr({dispatch:c,socket:u,instance:{id:t.id,fieldBindings:k},emit:!0})},[e,t,c,u,n]),w=x.useCallback(C=>{x2({dispatch:c,socket:u,field:C,emit:!0})},[c,u]),S=x.useCallback((C,T)=>{const N=e.map(k=>k.fieldId===C?{...k,...T}:k);n(N),t&&Nr({dispatch:c,socket:u,instance:{id:t.id,fieldBindings:N},emit:!0})},[e,t,c,u,n]);return h.jsxs("div",{className:"py-2",children:[h.jsxs("div",{className:"flex items-center justify-between mb-2",children:[h.jsx("h4",{className:"text-xs font-semibold text-white",children:"Fields"}),h.jsxs(_e,{variant:"ghost",size:"sm",className:"h-6 text-[10px]",onClick:y,children:[h.jsx(li,{className:"h-3 w-3 mr-1"}),"Add New Field"]})]}),h.jsx("p",{className:"text-[10px] text-foregroundScale-2/80 mb-2",children:"Select existing fields or add new ones."}),h.jsx(Kx,{options:f,selected:g,onChange:v,placeholder:"Select existing fields...",emptyMessage:"No fields defined yet",compact:!0}),e.filter(C=>C.fieldId).length>0&&h.jsx("div",{className:"mt-3 space-y-2",children:e.filter(C=>C.fieldId).map(C=>{const T=i[C.fieldId];return T?h.jsx(vJ,{field:T,binding:C,allFields:r,destinationOptions:p,onUpdateField:w,onUpdateBinding:N=>S(C.fieldId,N)},C.fieldId):null})})]})}function vJ({field:t,binding:e,allFields:n,destinationOptions:r,onUpdateField:i,onUpdateBinding:o}){const[a,c]=x.useState(!1),u=t.mode==="input",f=u?"bg-blue-500/20 text-blue-300 border-blue-500/30":"bg-violet-500/20 text-violet-300 border-violet-500/30",p=x.useCallback((N,k)=>{i({...t,[N]:k})},[t,i]),g=x.useCallback((N,k)=>{i({...t,meta:{...t.meta||{},[N]:k}})},[t,i]),v=x.useCallback((N,k)=>{i({...t,metric:{...t.metric||{},[N]:k}})},[t,i]),y=x.useCallback(N=>{i({...t,mode:N?"derived":"input",metric:N?{source:"occurrences",aggregation:"sum",scope:"container",allowedFields:[]}:null})},[t,i]),w=x.useMemo(()=>n.filter(N=>N.mode==="input"&&N.id!==t.id&&N.type===t.type).map(N=>({value:N.id,label:N.name||N.type,description:N.type,color:"bg-blue-500/20 text-blue-300"})),[n,t.id,t.type]),S=t.metric?.allowedFields?.map(N=>N.fieldId)||[],C=x.useCallback(N=>{const k=N.map(D=>t.metric?.allowedFields?.find(R=>R.fieldId===D)||{fieldId:D,destinations:[]});v("allowedFields",k)},[t.metric?.allowedFields,v]),T=x.useCallback((N,k)=>{const D=(t.metric?.allowedFields||[]).map(M=>M.fieldId===N?{...M,destinations:k}:M);v("allowedFields",D)},[t.metric?.allowedFields,v]);return h.jsxs("div",{className:"border border-border rounded-md overflow-hidden",children:[h.jsx("button",{type:"button",className:"w-full flex items-center justify-between px-2 py-1.5 bg-muted/30 hover:bg-muted/50",onClick:()=>c(!a),children:h.jsxs("div",{className:"flex items-center gap-2",children:[a?h.jsx(l3,{className:"h-3 w-3 text-muted-foreground"}):h.jsx(Yu,{className:"h-3 w-3 text-muted-foreground"}),h.jsx("span",{className:`px-2 py-0.5 text-[10px] rounded-full border ${f}`,children:t.name||t.type}),h.jsxs("span",{className:"text-[10px] text-muted-foreground",children:[t.type,"  ",t.mode]})]})}),a&&h.jsxs("div",{className:"p-2 space-y-3 border-t border-border",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx(Kt,{type:"text",value:t.name||"",onChange:N=>p("name",N.target.value),placeholder:"Field name",className:"h-7 text-xs flex-1"}),h.jsxs("div",{className:"flex items-center gap-1.5",children:[h.jsx("span",{className:`text-[10px] ${u?"text-blue-300":"text-muted-foreground"}`,children:"Input"}),h.jsx(od,{checked:!u,onCheckedChange:y,className:"data-[state=checked]:bg-violet-500"}),h.jsx("span",{className:`text-[10px] ${u?"text-muted-foreground":"text-violet-300"}`,children:"Derived"})]})]}),u&&h.jsxs("div",{className:"space-y-2",children:[h.jsxs("div",{children:[h.jsx(tt,{className:"text-[10px] text-muted-foreground",children:"Type"}),h.jsxs(Pt,{value:t.type,onValueChange:N=>p("type",N),children:[h.jsx(zt,{className:"h-7 text-xs",children:h.jsx(Bt,{})}),h.jsx(Ft,{children:sA.map(N=>h.jsx(wt,{value:N.value,children:N.label},N.value))})]})]}),t.type==="number"&&h.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[h.jsxs("div",{children:[h.jsx(tt,{className:"text-[10px] text-muted-foreground",children:"Prefix"}),h.jsx(Kt,{type:"text",value:t.meta?.prefix||"",onChange:N=>g("prefix",N.target.value),placeholder:"e.g., $",className:"h-6 text-xs"})]}),h.jsxs("div",{children:[h.jsx(tt,{className:"text-[10px] text-muted-foreground",children:"Postfix"}),h.jsx(Kt,{type:"text",value:t.meta?.postfix||"",onChange:N=>g("postfix",N.target.value),placeholder:"e.g., kg",className:"h-6 text-xs"})]})]}),t.type==="number"&&h.jsxs("div",{children:[h.jsx(tt,{className:"text-[10px] text-muted-foreground",children:"Flow (how value affects aggregates)"}),h.jsxs(Pt,{value:t.meta?.flow||"in",onValueChange:N=>g("flow",N),children:[h.jsx(zt,{className:"h-7 text-xs",children:h.jsx(Bt,{})}),h.jsx(Ft,{children:mJ.map(N=>h.jsx(wt,{value:N.value,children:N.label},N.value))})]})]})]}),!u&&h.jsxs("div",{className:"space-y-3",children:[h.jsxs("div",{children:[h.jsx(tt,{className:"text-[10px] text-muted-foreground",children:"Type (must match source fields)"}),h.jsxs(Pt,{value:t.type,onValueChange:N=>p("type",N),children:[h.jsx(zt,{className:"h-7 text-xs",children:h.jsx(Bt,{})}),h.jsx(Ft,{children:sA.map(N=>h.jsx(wt,{value:N.value,children:N.label},N.value))})]})]}),h.jsxs("div",{children:[h.jsx(tt,{className:"text-[10px] text-muted-foreground",children:"Aggregation"}),h.jsxs(Pt,{value:t.metric?.aggregation||"sum",onValueChange:N=>v("aggregation",N),children:[h.jsx(zt,{className:"h-7 text-xs",children:h.jsx(Bt,{})}),h.jsx(Ft,{children:kG(t.type).map(N=>h.jsxs(wt,{value:N.value,children:[N.symbol," ",N.label]},N.value))})]})]}),h.jsxs("div",{children:[h.jsx(tt,{className:"text-[10px] text-muted-foreground",children:"Source Time Filter"}),h.jsxs(Pt,{value:t.metric?.timeFilter||"inherit",onValueChange:N=>v("timeFilter",N),children:[h.jsx(zt,{className:"h-7 text-xs",children:h.jsx(Bt,{})}),h.jsx(Ft,{children:fJ.map(N=>h.jsx(wt,{value:N.value,children:N.label},N.value))})]}),h.jsx("p",{className:"text-[9px] text-muted-foreground mt-0.5",children:`"Inherit" uses the parent's iteration (grid  panel  container)`})]}),t.type==="number"&&h.jsxs("div",{className:"space-y-2",children:[h.jsx(tt,{className:"text-[10px] text-muted-foreground",children:"Target"}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsxs(Pt,{value:t.metric?.target?.op||">=",onValueChange:N=>v("target",{...t.metric?.target||{},op:N}),children:[h.jsx(zt,{className:"h-6 text-[10px] w-24",children:h.jsx(Bt,{})}),h.jsx(Ft,{children:pJ.map(N=>h.jsx(wt,{value:N.value,children:N.label},N.value))})]}),h.jsx(Kt,{type:"number",value:t.metric?.target?.value??"",onChange:N=>v("target",N.target.value===""?void 0:{...t.metric?.target||{},op:t.metric?.target?.op||">=",value:Number(N.target.value),timeFilter:t.metric?.target?.timeFilter||"daily"}),placeholder:"Target",className:"h-6 text-[10px] flex-1"})]}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("span",{className:"text-[9px] text-muted-foreground",children:"Target is per:"}),h.jsxs(Pt,{value:t.metric?.target?.timeFilter||"daily",onValueChange:N=>v("target",{...t.metric?.target||{},timeFilter:N}),children:[h.jsx(zt,{className:"h-5 text-[10px] flex-1",children:h.jsx(Bt,{})}),h.jsx(Ft,{children:hJ.map(N=>h.jsx(wt,{value:N.value,children:N.label},N.value))})]})]}),h.jsx("p",{className:"text-[9px] text-muted-foreground",children:'e.g., "3 per day"  viewing weekly shows 21'})]}),t.type==="number"&&h.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[h.jsxs("div",{children:[h.jsx(tt,{className:"text-[10px] text-muted-foreground",children:"Prefix"}),h.jsx(Kt,{type:"text",value:t.meta?.prefix||"",onChange:N=>g("prefix",N.target.value),placeholder:"e.g., $",className:"h-6 text-xs"})]}),h.jsxs("div",{children:[h.jsx(tt,{className:"text-[10px] text-muted-foreground",children:"Postfix"}),h.jsx(Kt,{type:"text",value:t.meta?.postfix||"",onChange:N=>g("postfix",N.target.value),placeholder:"e.g., kg",className:"h-6 text-xs"})]})]}),h.jsxs("div",{className:"pt-2 border-t border-border",children:[h.jsxs(tt,{className:"text-[10px] text-muted-foreground",children:["Source Fields (type: ",t.type,")"]}),h.jsx(Kx,{options:w,selected:S,onChange:C,placeholder:"Select input fields to aggregate...",emptyMessage:`No ${t.type} input fields available`,compact:!0}),(t.metric?.allowedFields||[]).map(N=>{const k=n.find(R=>R.id===N.fieldId);if(!k)return null;const D=(N.destinations||[]).map(R=>R.id),M=R=>{const O=(t.metric?.allowedFields||[]).map(I=>I.fieldId===N.fieldId?{...I,flowFilter:R}:I);v("allowedFields",O)};return h.jsxs("div",{className:"mt-2 p-2 bg-muted/20 rounded",children:[h.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[h.jsx("span",{className:"px-1.5 py-0.5 text-[9px] rounded-full bg-blue-500/20 text-blue-300",children:k.name||k.type}),h.jsx("span",{className:"text-[10px] text-muted-foreground flex-1",children:"config:"})]}),h.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[h.jsx(tt,{className:"text-[9px] text-muted-foreground",children:"Flow:"}),h.jsxs(Pt,{value:N.flowFilter||"any",onValueChange:M,children:[h.jsx(zt,{className:"h-5 text-[9px] flex-1",children:h.jsx(Bt,{})}),h.jsx(Ft,{children:gJ.map(R=>h.jsx(wt,{value:R.value,children:R.label},R.value))})]})]}),h.jsx(tt,{className:"text-[9px] text-muted-foreground",children:"Destinations:"}),h.jsx(Kx,{options:r,selected:D,onChange:R=>{const O=R.map(I=>N.destinations?.find(U=>U.id===I)||{id:I,timeFilter:"all"});T(N.fieldId,O)},placeholder:"All destinations",emptyMessage:"No panels/containers",compact:!0}),(N.destinations||[]).length>0&&h.jsx("div",{className:"mt-1 space-y-1",children:(N.destinations||[]).map(R=>{const O=r.find(I=>I.value===R.id);return h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("span",{className:`px-1 py-0.5 text-[9px] rounded ${O?.color||"bg-muted"}`,children:O?.label||R.id}),h.jsxs(Pt,{value:R.timeFilter||"all",onValueChange:I=>{const z=(N.destinations||[]).map(U=>U.id===R.id?{...U,timeFilter:I}:U);T(N.fieldId,z)},children:[h.jsx(zt,{className:"h-5 text-[9px] flex-1",children:h.jsx(Bt,{})}),h.jsx(Ft,{children:dJ.map(I=>h.jsx(wt,{value:I.value,children:I.label},I.value))})]})]},R.id)})})]},N.fieldId)})]})]})]})]})}function xJ({id:t,label:e,instance:n,occurrence:r,panel:i,container:o,overlay:a=!1,dragAttributes:c,dragListeners:u,onDoubleClick:f,dispatch:p,socket:g}){const{state:v}=x.useContext(lm),{fieldsById:y,addInstanceToContainer:w,occurrencesById:S,instancesById:C}=x.useContext(Rn),T=!a&&v?.activeId===t,N=Ts(),{isDragging:k}=N,D=n?.defaultDragMode||"move",[M,R]=x.useState(()=>({label:e??""})),[O,I]=x.useState(!1),[z,U]=x.useState(!1),Y=x.useMemo(()=>!r?.linkedGroupId||!S?[]:Object.values(S).filter(P=>P.linkedGroupId===r.linkedGroupId&&P.id!==r.id),[r?.linkedGroupId,S]);x.useEffect(()=>{R({label:e??""})},[e,t]);const W=x.useCallback(()=>{const P=(M?.label??"").trim();Nr({dispatch:p,socket:g,instance:{id:t,label:P},emit:!0})},[M?.label,t,p,g]),j=x.useCallback(()=>{LG({dispatch:p,socket:g,instanceId:t,emit:!0})},[t,p,g]),G=x.useCallback(()=>{Nr({dispatch:p,socket:g,instance:{id:t,defaultDragMode:D==="move"?"copy":"move"},emit:!0})},[t,D,p,g]),oe=x.useMemo(()=>!n?.fieldBindings||!y?[]:(n.fieldBindings||[]).map(P=>{const K=y[P.fieldId];return K?{field:K,binding:P}:null}).filter(Boolean).sort((P,K)=>(P.binding.order||0)-(K.binding.order||0)),[n?.fieldBindings,y]),L=x.useMemo(()=>{const P=v?.grid,K=P?.iterations||[],B=P?.selectedIterationId||"default",Z=K.find(le=>le.id===B)||K[0];return{gridId:r?.gridId,containerId:r?.meta?.containerId,currentIteration:Z?.timeFilter||"daily",iterationDate:Z?.currentDate||new Date().toISOString()}},[r?.gridId,r?.meta?.containerId,v?.grid]),$=x.useMemo(()=>cR(kY(n,o,i)),[n,o,i]),V=x.useMemo(()=>r?.linkedGroupId?[{icon:oa,label:"Settings",onClick:()=>I(!0),color:"bg-slate-600 hover:bg-slate-500"},{icon:D==="move"?Tl:mh,label:D==="move"?"Set to Copy":"Set to Move",onClick:G,color:D==="move"?"bg-blue-600 hover:bg-blue-500":"bg-slate-600 hover:bg-slate-500"},{icon:LA,label:"Break Link",onClick:()=>g?.emit("break_link",{occurrenceId:r.id}),color:"bg-orange-600 hover:bg-orange-500"}]:null,[r?.linkedGroupId,r?.id,D,G,g]),we=!!e,pe=oe.length>0;return h.jsxs("div",{role:"listitem","aria-label":e||"Untitled instance",className:"font-mono dnd-instance"+(T?" hidden":""),style:{touchAction:"manipulation",WebkitUserSelect:"none",userSelect:"none",display:"flex",flexDirection:"row",alignItems:"center",gap:4,position:"relative",...$},onDoubleClick:f,...a?{}:c,...a?{}:u,children:[h.jsxs(fo,{open:O,onOpenChange:I,children:[h.jsx(ho,{asChild:!0,children:h.jsx("div",{style:{position:"relative",alignSelf:"stretch",display:"flex"},children:h.jsx(sa,{dragMode:D,onToggleDragMode:G,onSettings:()=>I(!0),addLabel:"Item",size:"sm",items:V})})}),h.jsx(po,{align:"start",side:"right",className:"w-auto",children:h.jsx(cJ,{value:M,onChange:R,onCommitLabel:W,onDeleteInstance:j,instanceId:t,instance:n,occurrence:r,dispatch:p,socket:g})})]}),h.jsxs("div",{style:{flex:1,display:"flex",flexWrap:"wrap",alignItems:"center",gap:8,minWidth:0,paddingLeft:2,paddingRight:8},children:[we&&h.jsxs("div",{style:{flex:pe?"1 1 0%":"1 1 100%",minWidth:"55px",maxWidth:pe?"50%":"100%",fontSize:12,color:"var(--muted-foreground)",overflowWrap:"anywhere"},children:[e,r?.linkedGroupId&&h.jsxs(fo,{open:z,onOpenChange:U,children:[h.jsx(ho,{asChild:!0,children:h.jsx("button",{type:"button",onClick:P=>{P.stopPropagation(),U(K=>!K)},className:"inline-flex items-center ml-1 flex-shrink-0",title:`Linked (${Y.length} sibling${Y.length!==1?"s":""})`,children:h.jsx(Nl,{className:"w-3 h-3 text-blue-400 opacity-60 hover:opacity-100 transition-opacity"})})}),h.jsxs(po,{align:"start",side:"bottom",className:"w-auto min-w-[160px] max-w-[240px] p-2",children:[h.jsxs("div",{className:"text-xs font-medium text-muted-foreground mb-1.5",children:["Linked Occurrences (",Y.length,")"]}),Y.length===0?h.jsx("div",{className:"text-xs text-muted-foreground/60 italic",children:"No other linked copies"}):h.jsx("ul",{className:"space-y-1",children:Y.map(P=>{const B=C?.[P.targetId]?.label||P.targetId||"Unknown",Z=P.meta?.containerId;return h.jsxs("li",{className:"text-xs text-foreground/80 flex items-center gap-1.5 py-0.5 px-1 rounded hover:bg-muted/50",children:[h.jsx(Nl,{className:"w-2.5 h-2.5 text-blue-400 flex-shrink-0"}),h.jsx("span",{className:"truncate",children:B}),Z&&h.jsxs("span",{className:"text-muted-foreground/50 text-[10px] ml-auto flex-shrink-0",children:[Z.slice(0,6),"..."]})]},P.id)})})]})]})]}),pe&&h.jsx("div",{className:"instance-fields",style:{flex:"0 1 auto",minWidth:0,display:"flex",flexWrap:"wrap",gap:4,justifyContent:"flex-end",marginLeft:"auto"},children:oe.map(({field:P,binding:K})=>h.jsx(dR,{field:P,binding:K,occurrence:r,instance:n,context:L,state:v,dispatch:p,socket:g,compact:!0},P.id))})]})]})}const Oj=Se.memo(xJ);function bJ({instance:t,occurrence:e,containerId:n,panelId:r,panel:i,container:o,dispatch:a,socket:c,allowedEdges:u=["top","bottom"],onInstanceFocus:f}){const p=Ts(),{isContainerDrag:g}=p;u.includes("left")||u.includes("right");const{ref:v,isDragging:y,isOver:w,closestEdge:S,props:C}=MR({type:qe.INSTANCE,id:t.id,data:{...t,occurrence:e},context:{containerId:n,panelId:r,instanceId:t.id,occurrenceId:e?.id},disabled:g,nativeEnabled:!0,accepts:Bl.INSTANCE,allowedEdges:u});return h.jsxs("div",{ref:v,"data-instance-id":t.id,"data-occurrence-id":e?.id,tabIndex:0,className:"no-select instance-wrap",style:{touchAction:"none",userSelect:"none",WebkitUserSelect:"none",opacity:y?.4:1,background:"transparent",borderRadius:4,transition:"opacity 0.1s",marginBottom:2,position:"relative"},...C,children:[w&&S==="top"&&h.jsx("div",{style:{position:"absolute",top:-3,left:-1,right:-1,height:3,backgroundColor:"rgb(50, 150, 255)",borderRadius:1,zIndex:100}}),w&&S==="bottom"&&h.jsx("div",{style:{position:"absolute",bottom:-3,left:-1,right:-1,height:3,backgroundColor:"rgb(50, 150, 255)",borderRadius:1,zIndex:100}}),w&&S==="left"&&h.jsx("div",{style:{position:"absolute",left:-3,top:-1,bottom:-1,width:3,backgroundColor:"rgb(50, 150, 255)",borderRadius:1,zIndex:100}}),w&&S==="right"&&h.jsx("div",{style:{position:"absolute",right:-3,top:-1,bottom:-1,width:3,backgroundColor:"rgb(50, 150, 255)",borderRadius:1,zIndex:100}}),h.jsx(Oj,{id:t.id,label:t.label,instance:t,occurrence:e,panel:i,container:o,dispatch:a,socket:c,onDoubleClick:f?()=>f(t,e):void 0})]})}const Mj=Se.memo(bJ),wJ=[{value:"inherit",label:"Inherit from Panel"},{value:"own",label:"Use own iteration"}],SJ=[{value:"daily",label:"Daily"},{value:"weekly",label:"Weekly"},{value:"monthly",label:"Monthly"},{value:"yearly",label:"Yearly"}],EJ=[{value:"move",label:"Move (relocate occurrence)"},{value:"copy",label:"Copy (create new occurrence)"},{value:"copylink",label:"Copylink (linked occurrence)"}];function CJ({value:t,onChange:e,onCommitLabel:n,onDeleteContainer:r,containerId:i,container:o,onContainerUpdate:a,iteration:c,onIterationChange:u,defaultDragMode:f,onDragModeChange:p,occurrence:g,onOccurrenceUpdate:v,onSaveAsTemplate:y,onFillFromTemplate:w,templates:S}){const C=c||{mode:"inherit",timeFilter:"daily"};return h.jsxs("div",{className:"font-mono",children:[h.jsxs("div",{children:[h.jsx("h4",{className:"text-sm font-semibold text-white",children:"Container settings"}),h.jsx("p",{className:"text-[11px] pt-[2px] text-foregroundScale-2",children:"Edit container label."})]}),h.jsx(Rt,{}),h.jsx(ot,{schema:{className:"",type:"text-input",key:"label",label:"Label",placeholder:"Untitled",onKeyDown:T=>{T.key==="Enter"&&(T.preventDefault(),n?.(),T.currentTarget.blur())}},value:t,onChange:e}),h.jsx(Rt,{}),h.jsxs("div",{className:"py-2",children:[h.jsx("h4",{className:"text-xs font-semibold text-foregroundScale-2 mb-2",children:"Drag Behavior"}),h.jsx(ot,{schema:{type:"select",key:"__defaultDragMode",label:"Default Mode",options:EJ,description:"Default behavior when dragging this container."},value:{__defaultDragMode:f||"move"},onChange:T=>p?.(T?.__defaultDragMode||"move")})]}),h.jsx(Rt,{}),g&&h.jsxs(h.Fragment,{children:[h.jsxs("div",{className:"py-2",children:[h.jsx("h4",{className:"text-xs font-semibold text-foregroundScale-2 mb-2",children:"Persistence"}),h.jsx(O0,{occurrence:g,onUpdate:v,entityType:"container",compact:!0})]}),h.jsx(Rt,{})]}),h.jsxs("div",{className:"pt-2",children:[h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsx("h4",{className:"text-xs font-semibold text-foregroundScale-2",children:"Iteration"}),h.jsx("span",{className:"text-[10px] opacity-70",children:"Time-based filtering"})]}),h.jsxs("div",{className:"mt-2 grid grid-cols-1 gap-3",children:[h.jsx(ot,{schema:{type:"select",key:"__iterMode",label:"Mode",options:wJ,description:"Inherit uses the panel's iteration. Own sets a specific time filter."},value:{__iterMode:C.mode||"inherit"},onChange:T=>u?.({...C,mode:T?.__iterMode||"inherit"})}),C.mode==="own"&&h.jsx(ot,{schema:{type:"select",key:"__iterTimeFilter",label:"Time Filter",options:SJ,description:"How occurrences are grouped for this container."},value:{__iterTimeFilter:C.timeFilter||"daily"},onChange:T=>u?.({...C,timeFilter:T?.__iterTimeFilter||"daily"})})]}),C.mode==="inherit"&&h.jsx("p",{className:"mt-2 text-[10px] text-foregroundScale-2/80",children:"This container inherits iteration from its panel."})]}),h.jsx(Rt,{}),h.jsxs("div",{className:"py-2",children:[h.jsx("h4",{className:"text-xs font-semibold text-foregroundScale-2 mb-2",children:"Templates"}),h.jsxs("div",{className:"flex flex-col gap-1.5",children:[y&&h.jsx(_e,{type:"button",variant:"outline",size:"sm",className:"text-xs w-full",onClick:y,children:"Save Current Items as Template"}),(S||[]).length>0&&h.jsx("div",{className:"space-y-1",children:S.map(T=>h.jsxs(_e,{type:"button",variant:"ghost",size:"sm",className:"text-xs w-full justify-start",onClick:()=>w?.(T.id),children:["Fill from: ",T.name]},T.id))}),!(S||[]).length&&h.jsx("p",{className:"text-[10px] text-muted-foreground",children:"No templates saved yet."})]})]}),h.jsx(Rt,{}),h.jsx(Uu,{styleMode:o?.styleMode||"inherit",ownStyle:o?.ownStyle,onStyleModeChange:T=>a?.({styleMode:T}),onOwnStyleChange:T=>a?.({ownStyle:T}),label:"Container Style",inheritLabel:"Panel"}),h.jsx(Rt,{}),h.jsx(Uu,{styleMode:o?.childInstanceStyle?"own":"inherit",ownStyle:o?.childInstanceStyle,onStyleModeChange:T=>{T==="inherit"&&a?.({childInstanceStyle:null})},onOwnStyleChange:T=>a?.({childInstanceStyle:T}),label:"Child Instance Defaults",inheritLabel:"Panel"}),h.jsx(Rt,{}),h.jsxs("div",{className:"pt-2",children:[h.jsx("h4",{className:"text-xs font-semibold text-red-400",children:"Danger zone"}),h.jsx("p",{className:"text-[10px] text-foregroundScale-2/80 mt-1",children:"Deletes this container. (Instances may be deleted too if your backend cascades on container delete.)"}),h.jsx("div",{className:"mt-2",children:h.jsx(_e,{type:"button",variant:"destructive",size:"sm",onClick:()=>{window.confirm(`Delete this container${i?` (${i})`:""}? This cannot be undone.`)&&r?.()},disabled:!r,children:"Delete Container"})})]})]})}function TJ({container:t,panel:e,panelId:n,panelLayoutOrientation:r="vertical",addInstanceToContainer:i,isHot:o=!1,dispatch:a,socket:c,gapPx:u=12,onInstanceFocus:f}){const{occurrencesById:p,instancesById:g,state:v}=x.useContext(Rn),y=Ts(),{isContainerDrag:w,isInstanceDrag:S,isExternalDrag:C,isPanelDrag:T,dragMode:N,toggleDragMode:k}=y,[D,M]=x.useState(()=>({label:t.label??""})),[R,O]=x.useState(!1),[I,z]=x.useState(!1),U=t?.defaultDragMode||"move";x.useEffect(()=>{M({label:t.label??""})},[t.id,t.label]);const Y=x.useCallback(()=>i(t.id),[i,t.id]),W=x.useCallback(()=>{const J=(D?.label??"").trim();J&&oo({dispatch:a,socket:c,container:{...t,label:J},emit:!0})},[D?.label,t,a,c]),j=x.useCallback(()=>{jG({dispatch:a,socket:c,containerId:t.id,emit:!0})},[t.id,a,c]),G=x.useCallback(J=>{oo({dispatch:a,socket:c,container:{...t,iteration:J},emit:!0})},[t,a,c]),oe=x.useCallback(J=>{oo({dispatch:a,socket:c,container:{...t,defaultDragMode:J},emit:!0})},[t,a,c]),L=x.useMemo(()=>Object.values(p).find(J=>J.targetType==="container"&&J.targetId===t.id),[p,t.id]),$=x.useCallback(J=>{L?.id&&ai({dispatch:a,socket:c,occurrence:{id:L.id,...J},emit:!0})},[L,a,c]),V=x.useMemo(()=>cR(AY(t,e)),[t,e]),we=x.useCallback(J=>{oo({dispatch:a,socket:c,container:{...t,...J},emit:!0})},[t,a,c]),pe=v?.grid,P=x.useMemo(()=>pe?.templates||[],[pe?.templates]),K=x.useCallback(()=>{const J=pe?._id;if(!J)return;const X=(t.occurrences||[]).map(Ce=>{const Oe=p[Ce];return Oe?{instanceId:Oe.targetId,fieldDefaults:Oe.fields||{},...Oe.linkedGroupId?{linkedGroupId:Oe.linkedGroupId}:{}}:null}).filter(Boolean),ve=window.prompt("Template name:",t.label||"Template");ve&&UG({socket:c,gridId:J,template:{id:crypto.randomUUID(),name:ve,items:X,createdAt:new Date}})},[t,p,pe,c]),B=x.useCallback(J=>{const X=pe?._id;X&&VG({socket:c,gridId:X,templateId:J,containerId:t.id})},[pe,t.id,c]),Z=x.useMemo(()=>["top","bottom","left","right"],[]),le=x.useMemo(()=>{const J=fR(t,p,g);return{...t,instanceObjects:J}},[t,p,g]),{ref:be,isDragging:H,isOver:ce,closestEdge:te,props:me}=MR({type:qe.CONTAINER,id:t.id,data:le,context:{panelId:n,containerId:t.id},disabled:S||C,accepts:[qe.CONTAINER],allowedEdges:Z}),{ref:Te,isOver:re}=qu({type:"container-header",id:`container-header:${t.id}`,context:{panelId:n,containerId:t.id,insertAt:0},accepts:Bl.CONTAINER_LIST,disabled:w}),{ref:he,isOver:Ae}=qu({type:"container-list",id:`container-list:${t.id}`,context:{panelId:n,containerId:t.id},accepts:Bl.CONTAINER_LIST,disabled:w}),Re=x.useMemo(()=>KY(t,p,g),[t,p,g]),Le=x.useMemo(()=>Re.map(J=>J.instance),[Re]),ae=(o||re||Ae)&&(S||C),Me=x.useCallback(()=>{oo({dispatch:a,socket:c,container:{...t,defaultDragMode:U==="move"?"copy":"move"},emit:!0})},[t,U,a,c]);return h.jsxs("div",{ref:be,"data-container-id":t.id,className:"container-shell bg-background2 rounded-md border border-border shadow-inner",style:{display:"flex",flexDirection:"column",minHeight:0,overflow:"visible",outline:ae?"2px solid rgba(50,150,255,0.9)":"none",outlineOffset:0,borderRadius:10,pointerEvents:H||T?"none":"auto",position:"relative",zIndex:H?0:1,opacity:H?.4:1,transition:"opacity 0.15s, outline 0.1s",...V},...me,children:[ce&&te==="top"&&h.jsx("div",{style:{position:"absolute",top:-2,left:0,right:0,height:2,backgroundColor:"rgb(50, 150, 255)",borderRadius:1,zIndex:10}}),ce&&te==="bottom"&&h.jsx("div",{style:{position:"absolute",bottom:-2,left:0,right:0,height:2,backgroundColor:"rgb(50, 150, 255)",borderRadius:1,zIndex:10}}),ce&&te==="left"&&h.jsx("div",{style:{position:"absolute",left:-2,top:0,bottom:0,width:2,backgroundColor:"rgb(50, 150, 255)",borderRadius:1,zIndex:10}}),ce&&te==="right"&&h.jsx("div",{style:{position:"absolute",right:-2,top:0,bottom:0,width:2,backgroundColor:"rgb(50, 150, 255)",borderRadius:1,zIndex:10}}),h.jsxs("div",{ref:Te,className:"container-header no-select border-b border-gray-700 border-solid",style:{userSelect:"none",flex:"0 0 auto",display:"flex",alignItems:"center",cursor:S||C?"default":"grab",position:"relative",height:"20px"},children:[h.jsxs(fo,{open:I,onOpenChange:z,children:[h.jsx(ho,{asChild:!0,children:h.jsx("div",{style:{position:"relative",zIndex:50,height:"100%",display:"flex"},onPointerDown:J=>J.stopPropagation(),onMouseDown:J=>J.stopPropagation(),children:h.jsx(sa,{dragMode:U,onToggleDragMode:Me,onSettings:()=>z(!0),onAddChild:Y,addLabel:"Item",size:"sm"})})}),h.jsx(po,{align:"start",side:"right",className:"w-auto",children:h.jsx(CJ,{value:D,onChange:M,onCommitLabel:W,onDeleteContainer:j,containerId:t.id,container:t,onContainerUpdate:we,iteration:t.iteration,onIterationChange:G,defaultDragMode:t.defaultDragMode,onDragModeChange:oe,occurrence:L,onOccurrenceUpdate:$,onSaveAsTemplate:K,onFillFromTemplate:B,templates:P})})]}),h.jsxs("span",{className:"text-xs font-medium pl-1 truncate flex items-center gap-1",children:[t.label||"Container",L?.linkedGroupId&&h.jsx(Nl,{className:"w-3 h-3 text-blue-400 opacity-60 flex-shrink-0",title:"Linked"})]}),h.jsx("div",{className:"ml-auto mr-1",onPointerDown:J=>J.stopPropagation(),children:h.jsx(uD,{occurrence:L,onUpdate:$,showModeToggle:!0,compact:!0})}),re&&(S||C)&&Le.length>0&&h.jsx("div",{style:{position:"absolute",bottom:-1,left:4,right:4,height:2,backgroundColor:"rgb(50, 150, 255)",borderRadius:1,zIndex:10}})]}),t.kind==="doc"?h.jsx("div",{ref:he,className:"container-doc",style:{flex:1,minHeight:100,overflow:"auto",position:"relative"},children:h.jsx(Eu,{container:t,occurrence:L,dispatch:a,socket:c,isHot:o})}):h.jsxs("div",{ref:he,className:"container-list",style:{flex:Le.length===0?1:"0 0 auto",minHeight:Le.length===0?40:"fit-content",overflow:"auto",padding:0,display:"flex",flexDirection:"column",position:"relative"},children:[h.jsx("div",{style:{position:"absolute",top:"5px",left:"5px",right:"5px",bottom:Le.length===0?"8px":"36px",minHeight:Le.length===0?"36px":0,borderRadius:"4px",background:"rgba(20, 25, 30, 0.4)",border:"1px solid rgba(0, 0, 0, 0.5)",boxShadow:"inset 0 2px 4px rgba(0, 0, 0, 0.3)",pointerEvents:"none",zIndex:0}}),h.jsxs("div",{role:"list","aria-label":`${t.label||"Container"} items`,style:{position:"relative",zIndex:1,padding:"5px",flex:1,display:"flex",flexDirection:"column"},children:[Re.map(({instance:J,occurrence:X})=>h.jsx(Mj,{instance:J,occurrence:X,containerId:t.id,panelId:n,panel:e,container:t,dispatch:a,socket:c,allowedEdges:Z,onInstanceFocus:f},J.id)),Le.length===0&&h.jsx("div",{className:"text-xs text-muted-foreground p-2 text-center",style:{fontStyle:"italic",opacity:.6,position:"relative",zIndex:2,marginTop:"-5px",minHeight:"36px",flex:1,display:"flex",alignItems:"center",justifyContent:"center"},children:"Drop items here"})]})]}),h.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:u,marginBottom:-u,pointerEvents:"auto",zIndex:2}})]})}const NJ=Se.memo(TJ),AJ=[{value:"daily",label:"Daily"},{value:"weekly",label:"Weekly"},{value:"monthly",label:"Monthly"},{value:"yearly",label:"Yearly"}];function kJ({value:t,onChange:e,onCommitGridName:n,onCommitIterations:r,onDeleteGrid:i,gridId:o}){const a=t?.iterations||[{id:"default",name:"Daily",timeFilter:"daily"}],c=x.useCallback(()=>{const p={id:kn(),name:"",timeFilter:"daily"},g=[...a,p];e?.({...t,iterations:g}),r?.(g)},[a,t,e,r]),u=x.useCallback((p,g,v)=>{const y=a.map(w=>w.id===p?{...w,[g]:v}:w);e?.({...t,iterations:y}),r?.(y)},[a,t,e,r]),f=x.useCallback(p=>{if(a.length<=1)return;const g=a.filter(v=>v.id!==p);e?.({...t,iterations:g}),r?.(g)},[a,t,e,r]);return h.jsxs("div",{className:"font-mono",children:[h.jsxs("div",{children:[h.jsx("h4",{className:"text-sm font-semibold text-white",children:"Grid settings"}),h.jsx("p",{className:"text-[11px] pt-[2px] text-foregroundScale-2",children:"Edit grid name and dimensions."})]}),h.jsx(Rt,{}),h.jsx(ot,{schema:{type:"text-input",key:"gridName",label:"Grid Name",placeholder:"My grid",onKeyDown:p=>{p.key==="Enter"&&(p.preventDefault(),n?.(p.currentTarget.value),p.currentTarget.blur())},onBlur:p=>{n?.(p.currentTarget.value)}},value:t,onChange:e}),h.jsx(Rt,{}),h.jsxs("div",{className:"pt-2",children:[h.jsx("h4",{className:"text-xs font-semibold text-red-400",children:"Danger zone"}),h.jsx("p",{className:"text-[10px] text-foregroundScale-2/80 mt-1",children:"This deletes the panel and all UI inside it (containers/instances will be orphaned unless your backend cascades)."}),h.jsx("div",{className:"mt-2",children:h.jsx(_e,{type:"button",variant:"destructive",size:"sm",onClick:()=>{window.confirm(`Delete this grid${o?` (${o})`:""}? This cannot be undone.`)&&i?.()},disabled:!i,children:"Delete Grid"})})]}),h.jsx(Rt,{}),h.jsxs("div",{className:"grid pt-[5px] grid-cols-2 gap-3",children:[h.jsx(ot,{schema:{type:"number-input",key:"rows",label:"Rows",min:1,max:24},value:t,onChange:e}),h.jsx(ot,{schema:{type:"number-input",key:"cols",label:"Cols",min:1,max:24},value:t,onChange:e})]}),h.jsx(Rt,{}),h.jsxs("div",{className:"py-2",children:[h.jsxs("div",{className:"flex items-center justify-between mb-2",children:[h.jsx("h4",{className:"text-xs font-semibold text-white",children:"Iterations"}),h.jsxs(_e,{variant:"ghost",size:"sm",className:"h-6 text-[10px]",onClick:c,children:[h.jsx(li,{className:"h-3 w-3 mr-1"}),"Add Iteration"]})]}),h.jsx("p",{className:"text-[10px] text-foregroundScale-2/80 mb-2",children:"Define time-based iterations for tracking and filtering data."}),h.jsx("div",{className:"space-y-2",children:a.map(p=>h.jsxs("div",{className:"flex items-center gap-2 p-2 bg-muted/20 rounded border border-border",children:[h.jsx(Kt,{type:"text",value:p.name||"",onChange:g=>u(p.id,"name",g.target.value),placeholder:"Iteration name",className:"h-7 text-xs flex-1"}),h.jsxs(Pt,{value:p.timeFilter||"daily",onValueChange:g=>u(p.id,"timeFilter",g),children:[h.jsx(zt,{className:"h-7 text-xs w-24",children:h.jsx(Bt,{})}),h.jsx(Ft,{children:AJ.map(g=>h.jsx(wt,{value:g.value,children:g.label},g.value))})]}),h.jsx(_e,{variant:"ghost",size:"sm",className:"h-7 w-7 p-0",onClick:()=>f(p.id),disabled:a.length<=1,children:h.jsx(ps,{className:"h-3.5 w-3.5 text-muted-foreground hover:text-red-400"})})]},p.id))})]})]})}function DJ(t,e){if(!t)return"Select date";const n=new Date(t);switch(e){case"daily":return n.toLocaleDateString(void 0,{weekday:"short",month:"short",day:"numeric"});case"weekly":{const r=new Date(n);r.setDate(n.getDate()-n.getDay());const i=new Date(r);return i.setDate(r.getDate()+6),`${r.toLocaleDateString(void 0,{month:"short",day:"numeric"})} - ${i.toLocaleDateString(void 0,{month:"short",day:"numeric"})}`}case"monthly":return n.toLocaleDateString(void 0,{month:"long",year:"numeric"});case"yearly":return n.getFullYear().toString();default:return n.toLocaleDateString()}}function aA(t,e,n){const r=new Date(t),i=n==="next"?1:-1;switch(e){case"daily":r.setDate(r.getDate()+i);break;case"weekly":r.setDate(r.getDate()+i*7);break;case"monthly":r.setMonth(r.getMonth()+i);break;case"yearly":r.setFullYear(r.getFullYear()+i);break}return r}function OJ({currentDate:t,timeFilter:e,onSelect:n}){const r=x.useMemo(()=>{const i=new Date,o=[];if(e==="daily")for(let a=0;a<7;a++){const c=new Date(i);c.setDate(i.getDate()-a),o.push({date:c,label:a===0?"Today":a===1?"Yesterday":c.toLocaleDateString(void 0,{weekday:"short",month:"short",day:"numeric"})})}else if(e==="weekly")for(let a=0;a<5;a++){const c=new Date(i);c.setDate(i.getDate()-a*7);const u=new Date(c);u.setDate(c.getDate()-c.getDay()),o.push({date:c,label:a===0?"This Week":a===1?"Last Week":`Week of ${u.toLocaleDateString(void 0,{month:"short",day:"numeric"})}`})}else if(e==="monthly")for(let a=0;a<6;a++){const c=new Date(i);c.setMonth(i.getMonth()-a),o.push({date:c,label:a===0?"This Month":c.toLocaleDateString(void 0,{month:"long",year:"numeric"})})}else if(e==="yearly")for(let a=0;a<5;a++){const c=new Date(i);c.setFullYear(i.getFullYear()-a),o.push({date:c,label:a===0?"This Year":c.getFullYear().toString()})}return o},[e]);return h.jsx("div",{className:"flex flex-col gap-1",children:r.map((i,o)=>h.jsx(_e,{variant:"ghost",size:"sm",className:"justify-start h-7 text-xs",onClick:()=>n(i.date),children:i.label},o))})}function MJ({iterations:t=[],selectedIterationId:e,onSelectIteration:n,currentValue:r,onValueChange:i}){const a=x.useMemo(()=>t.find(w=>w.id===e)||t[0],[t,e])?.timeFilter||"daily",c=r?new Date(r):new Date,u=x.useCallback(()=>{const w=aA(c,a,"prev");i?.(w)},[c,a,i]),f=x.useCallback(()=>{const w=aA(c,a,"next");i?.(w)},[c,a,i]),p=x.useCallback(w=>{w&&i?.(w)},[i]),g=x.useCallback(()=>{i?.(new Date)},[i]),v=DJ(c,a),y=x.useMemo(()=>{const w=new Date;w.setHours(0,0,0,0);const S=new Date(c);switch(S.setHours(0,0,0,0),a){case"daily":return w.getTime()===S.getTime();case"weekly":{const C=new Date(w);C.setDate(w.getDate()-w.getDay());const T=new Date(S);return T.setDate(S.getDate()-S.getDay()),C.getTime()===T.getTime()}case"monthly":return w.getFullYear()===S.getFullYear()&&w.getMonth()===S.getMonth();case"yearly":return w.getFullYear()===S.getFullYear();default:return!1}},[c,a]);return h.jsxs("div",{className:"iteration-nav flex items-center gap-0.5",children:[t.length>0&&h.jsxs(Pt,{value:e||t[0]?.id,onValueChange:n,children:[h.jsx(zt,{className:"px-1 w-auto min-w-[60px] text-[9px] sm:text-xs bg-inputScale-2 border border-borderScale-0 rounded",children:h.jsx(Bt,{placeholder:"Iteration"})}),h.jsx(Ft,{children:t.map(w=>h.jsx(wt,{value:w.id,children:w.name||w.timeFilter},w.id))})]}),h.jsxs("div",{className:"flex items-center gap-0",children:[h.jsx(_e,{size:"sm",className:"px-0.5",onClick:u,children:h.jsx(Cu,{className:"h-3.5 w-3.5"})}),h.jsxs(fo,{children:[h.jsx(ho,{asChild:!0,children:h.jsxs(_e,{size:"sm",className:`px-1.5 min-w-[80px] ${y?"text-primary":""}`,children:[h.jsx(t3,{className:"h-3 w-3 mr-1"}),v]})}),h.jsxs(po,{className:"w-auto p-2",align:"center",children:[h.jsx(OJ,{currentDate:c,timeFilter:a,onSelect:p}),!y&&h.jsx("div",{className:"pt-2 border-t border-border mt-2",children:h.jsx(_e,{size:"sm",className:"w-full",onClick:g,children:"Go to Today"})})]})]}),h.jsx(_e,{size:"sm",className:"px-0.5",onClick:f,children:h.jsx(hs,{className:"h-3.5 w-3.5"})})]})]})}const RJ=[{kind:"board",label:"Board",description:"Grid of containers and items",icon:ub,color:"bg-blue-600 hover:bg-blue-500"},{kind:"artifact-viewer",label:"Artifact Viewer",description:"Tree sidebar with content viewer",icon:A3,color:"bg-purple-600 hover:bg-purple-500"},{kind:"doc",label:"Document",description:"Single rich text document",icon:Ai,color:"bg-teal-600 hover:bg-teal-500"},{kind:"mixed",label:"Mixed",description:"Flexible container types",icon:RA,color:"bg-amber-600 hover:bg-amber-500"}];function jJ({open:t=!1,onClose:e,onSelect:n,position:r=null}){const[i,o]=x.useState({top:100,left:100}),a=x.useRef(null);x.useEffect(()=>{t&&o(r||{top:window.innerHeight/2-100,left:window.innerWidth/2-100})},[t,r]),x.useEffect(()=>{if(!t)return;const u=f=>{a.current&&!a.current.contains(f.target)&&e?.()};return document.addEventListener("mousedown",u),()=>document.removeEventListener("mousedown",u)},[t,e]),x.useEffect(()=>{if(!t)return;const u=f=>{f.key==="Escape"&&e?.()};return document.addEventListener("keydown",u),()=>document.removeEventListener("keydown",u)},[t,e]);const c=x.useCallback(u=>{n?.(u),e?.()},[n,e]);return t?yo.createPortal(h.jsxs("div",{ref:a,className:"panel-kind-selector fixed z-[9999] bg-background border border-border rounded-lg shadow-xl overflow-hidden",style:{top:i.top,left:i.left,minWidth:220},children:[h.jsx("div",{className:"px-3 py-2 border-b border-border bg-muted/50",children:h.jsx("span",{className:"text-sm font-medium",children:"Panel Type"})}),h.jsx("div",{className:"p-1",children:RJ.map(u=>{const f=u.icon;return h.jsxs("button",{type:"button",onClick:()=>c(u.kind),className:"w-full flex items-center gap-3 px-3 py-2 rounded-md hover:bg-accent transition-colors text-left",children:[h.jsx("span",{className:`p-1.5 rounded-md ${u.color}`,children:h.jsx(f,{className:"w-4 h-4 text-white"})}),h.jsxs("div",{className:"flex-1 min-w-0",children:[h.jsx("div",{className:"text-sm font-medium",children:u.label}),h.jsx("div",{className:"text-xs text-muted-foreground truncate",children:u.description})]})]},u.kind)})})]}),document.body):null}function IJ({gridId:t,availableGrids:e,gridName:n,setGridName:r,rowInput:i,setRowInput:o,colInput:a,setColInput:c,onDeleteGrid:u,onGridChange:f,onCreateNewGrid:p,onCommitGridName:g,onUpdateRows:v,onUpdateCols:y,onAddPanel:w,onCommitIterations:S,iterations:C,selectedIterationId:T,onSelectIteration:N,currentIterationValue:k,onIterationValueChange:D,categoryDimensions:M,selectedCategoryId:R,currentCategoryValue:O,onSelectCategory:I,onCategoryValueChange:z,onUndo:U,onRedo:Y,canUndo:W,canRedo:j,onHistory:G}){const[oe,L]=x.useState(!1),[$,V]=x.useState(null),we=x.useRef(null),pe=()=>{if(we.current){const le=we.current.getBoundingClientRect();V({top:le.bottom+4,left:le.left})}L(!0)},P=le=>{w?.(le),L(!1)},K=x.useMemo(()=>(e||[]).map(le=>{const be=le.id||le._id,H=le.name||le.gridName||"";return{value:be,label:H||`Grid ${String(be).slice(-4)}`}}),[e]),B={gridName:n||`Grid ${String(t||"").slice(-4)}`,rows:i,cols:a,iterations:C||[{id:"default",name:"Daily",timeFilter:"daily"}]},Z=le=>{if(typeof le.gridName=="string"&&r(le.gridName),le.rows!==void 0){const be=String(le.rows);o(be),be!==""&&v?.(be)}if(le.cols!==void 0){const be=String(le.cols);c(be),be!==""&&y?.(be)}};return h.jsx("div",{className:"toolbar shadow-md",style:{position:"relative",zIndex:998,flex:1,backgroundColor:"#041225f1",borderBottom:"3px solid rgb(143, 150, 158)",padding:"1px 5px",fontSize:12,fontFamily:"monospace",display:"flex",width:"100%",marginBottom:"2px"},children:h.jsxs("div",{style:{display:"flex",alignItems:"end",width:"100%",margin:"0 auto",gap:10},children:[h.jsxs("div",{style:{display:"flex",alignItems:"end",gap:6},children:[h.jsxs("div",{className:"header-logo",style:{display:"flex",alignItems:"end"},children:[h.jsx("img",{src:"/moduli_logo.png",alt:"Moduli",style:{height:18,width:"auto",display:"block"}}),h.jsx("div",{className:"site-name text-white pl-1 pr-3 opacity-75",children:"+moduli+"})]}),h.jsx(mW,{label:h.jsx(oa,{className:"h-4 w-4"}),align:"start",side:"bottom",className:"w-[340px]",children:h.jsx(kJ,{value:B,onChange:Z,onCommitGridName:le=>g?.(le),onCommitIterations:S,onDeleteGrid:u,gridId:t})}),h.jsx("div",{style:{minWidth:130},children:h.jsx(ot,{schema:{type:"select",className:"flex content-end grid-select",key:"gridId",label:"",options:K,placeholder:"Select grid"},value:{gridId:t||""},onChange:le=>{const be=le?.gridId??"";f?.({target:{value:be}})}})}),h.jsxs(_e,{ref:we,size:"sm",onClick:pe,children:[h.jsx(iC,{className:"h-4 w-4 pr-[2px]"}),"Panel"]})]}),h.jsx(jJ,{open:oe,onClose:()=>L(!1),onSelect:P,position:$}),C?.length>0&&h.jsx(MJ,{iterations:C,selectedIterationId:T,onSelectIteration:N,currentValue:k,onValueChange:D}),M?.length>0&&h.jsxs("div",{style:{display:"flex",alignItems:"center",gap:4},children:[h.jsx("span",{className:"text-[10px] text-muted-foreground",children:"Filter:"}),h.jsxs("select",{value:R||"",onChange:le=>I?.(le.target.value||null),className:"h-7 text-xs bg-background border border-border rounded px-1 text-foreground",style:{fontSize:11},title:"Filter by category dimension",children:[h.jsx("option",{value:"",children:"No Filter"}),M.map(le=>h.jsx("option",{value:le.id,children:le.name},le.id))]}),R&&(()=>{const le=M.find(H=>H.id===R),be=le?.options||le?.categoryOptions||[];return be.length>0?h.jsxs("select",{value:O||"",onChange:H=>z?.(H.target.value||null),className:"h-7 text-xs bg-background border border-border rounded px-1 text-foreground",style:{fontSize:11},title:`Filter ${le?.name||"category"} value`,children:[h.jsxs("option",{value:"",children:["All ",le?.name||"Values"]}),be.map(H=>h.jsx("option",{value:H,children:H},H))]}):null})()]}),h.jsxs("div",{style:{display:"flex",alignItems:"center",marginLeft:"auto",gap:4},children:[h.jsx(_e,{size:"sm",variant:"ghost",onClick:U,disabled:!W,title:"Undo (Ctrl+Z)",children:h.jsx(hb,{className:"h-4 w-4"})}),h.jsx(_e,{size:"sm",variant:"ghost",onClick:G,title:"Transaction History",children:h.jsx(z3,{className:"h-4 w-4"})}),h.jsx(_e,{size:"sm",variant:"ghost",onClick:Y,disabled:!j,title:"Redo (Ctrl+Y)",children:h.jsx(db,{className:"h-4 w-4"})}),h.jsx("div",{style:{width:1,height:20,background:"rgba(255,255,255,0.2)",margin:"0 4px"}}),h.jsxs(_e,{size:"sm",onClick:()=>p?.(),children:[h.jsx(iC,{className:"h-4 w-4 pr-[2px]"}),"Grid"]})]})]})})}function _J(t,e){return x.useReducer((n,r)=>e[n][r]??n,t)}var V0="ScrollArea",[Rj]=Wr(V0),[LJ,Yr]=Rj(V0),jj=x.forwardRef((t,e)=>{const{__scopeScrollArea:n,type:r="hover",dir:i,scrollHideDelay:o=600,...a}=t,[c,u]=x.useState(null),[f,p]=x.useState(null),[g,v]=x.useState(null),[y,w]=x.useState(null),[S,C]=x.useState(null),[T,N]=x.useState(0),[k,D]=x.useState(0),[M,R]=x.useState(!1),[O,I]=x.useState(!1),z=ht(e,Y=>u(Y)),U=Ku(i);return h.jsx(LJ,{scope:n,type:r,dir:U,scrollHideDelay:o,scrollArea:c,viewport:f,onViewportChange:p,content:g,onContentChange:v,scrollbarX:y,onScrollbarXChange:w,scrollbarXEnabled:M,onScrollbarXEnabledChange:R,scrollbarY:S,onScrollbarYChange:C,scrollbarYEnabled:O,onScrollbarYEnabledChange:I,onCornerWidthChange:N,onCornerHeightChange:D,children:h.jsx(it.div,{dir:U,...a,ref:z,style:{position:"relative","--radix-scroll-area-corner-width":T+"px","--radix-scroll-area-corner-height":k+"px",...t.style}})})});jj.displayName=V0;var Ij="ScrollAreaViewport",_j=x.forwardRef((t,e)=>{const{__scopeScrollArea:n,children:r,nonce:i,...o}=t,a=Yr(Ij,n),c=x.useRef(null),u=ht(e,c,a.onViewportChange);return h.jsxs(h.Fragment,{children:[h.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:i}),h.jsx(it.div,{"data-radix-scroll-area-viewport":"",...o,ref:u,style:{overflowX:a.scrollbarXEnabled?"scroll":"hidden",overflowY:a.scrollbarYEnabled?"scroll":"hidden",...t.style},children:h.jsx("div",{ref:a.onContentChange,style:{minWidth:"100%",display:"table"},children:r})})]})});_j.displayName=Ij;var ji="ScrollAreaScrollbar",q0=x.forwardRef((t,e)=>{const{forceMount:n,...r}=t,i=Yr(ji,t.__scopeScrollArea),{onScrollbarXEnabledChange:o,onScrollbarYEnabledChange:a}=i,c=t.orientation==="horizontal";return x.useEffect(()=>(c?o(!0):a(!0),()=>{c?o(!1):a(!1)}),[c,o,a]),i.type==="hover"?h.jsx(PJ,{...r,ref:e,forceMount:n}):i.type==="scroll"?h.jsx(zJ,{...r,ref:e,forceMount:n}):i.type==="auto"?h.jsx(Lj,{...r,ref:e,forceMount:n}):i.type==="always"?h.jsx(G0,{...r,ref:e}):null});q0.displayName=ji;var PJ=x.forwardRef((t,e)=>{const{forceMount:n,...r}=t,i=Yr(ji,t.__scopeScrollArea),[o,a]=x.useState(!1);return x.useEffect(()=>{const c=i.scrollArea;let u=0;if(c){const f=()=>{window.clearTimeout(u),a(!0)},p=()=>{u=window.setTimeout(()=>a(!1),i.scrollHideDelay)};return c.addEventListener("pointerenter",f),c.addEventListener("pointerleave",p),()=>{window.clearTimeout(u),c.removeEventListener("pointerenter",f),c.removeEventListener("pointerleave",p)}}},[i.scrollArea,i.scrollHideDelay]),h.jsx(pr,{present:n||o,children:h.jsx(Lj,{"data-state":o?"visible":"hidden",...r,ref:e})})}),zJ=x.forwardRef((t,e)=>{const{forceMount:n,...r}=t,i=Yr(ji,t.__scopeScrollArea),o=t.orientation==="horizontal",a=fm(()=>u("SCROLL_END"),100),[c,u]=_J("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return x.useEffect(()=>{if(c==="idle"){const f=window.setTimeout(()=>u("HIDE"),i.scrollHideDelay);return()=>window.clearTimeout(f)}},[c,i.scrollHideDelay,u]),x.useEffect(()=>{const f=i.viewport,p=o?"scrollLeft":"scrollTop";if(f){let g=f[p];const v=()=>{const y=f[p];g!==y&&(u("SCROLL"),a()),g=y};return f.addEventListener("scroll",v),()=>f.removeEventListener("scroll",v)}},[i.viewport,o,u,a]),h.jsx(pr,{present:n||c!=="hidden",children:h.jsx(G0,{"data-state":c==="hidden"?"hidden":"visible",...r,ref:e,onPointerEnter:Ve(t.onPointerEnter,()=>u("POINTER_ENTER")),onPointerLeave:Ve(t.onPointerLeave,()=>u("POINTER_LEAVE"))})})}),Lj=x.forwardRef((t,e)=>{const n=Yr(ji,t.__scopeScrollArea),{forceMount:r,...i}=t,[o,a]=x.useState(!1),c=t.orientation==="horizontal",u=fm(()=>{if(n.viewport){const f=n.viewport.offsetWidth<n.viewport.scrollWidth,p=n.viewport.offsetHeight<n.viewport.scrollHeight;a(c?f:p)}},10);return Fl(n.viewport,u),Fl(n.content,u),h.jsx(pr,{present:r||o,children:h.jsx(G0,{"data-state":o?"visible":"hidden",...i,ref:e})})}),G0=x.forwardRef((t,e)=>{const{orientation:n="vertical",...r}=t,i=Yr(ji,t.__scopeScrollArea),o=x.useRef(null),a=x.useRef(0),[c,u]=x.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),f=$j(c.viewport,c.content),p={...r,sizes:c,onSizesChange:u,hasThumb:f>0&&f<1,onThumbChange:v=>o.current=v,onThumbPointerUp:()=>a.current=0,onThumbPointerDown:v=>a.current=v};function g(v,y){return VJ(v,a.current,c,y)}return n==="horizontal"?h.jsx(BJ,{...p,ref:e,onThumbPositionChange:()=>{if(i.viewport&&o.current){const v=i.viewport.scrollLeft,y=lA(v,c,i.dir);o.current.style.transform=`translate3d(${y}px, 0, 0)`}},onWheelScroll:v=>{i.viewport&&(i.viewport.scrollLeft=v)},onDragScroll:v=>{i.viewport&&(i.viewport.scrollLeft=g(v,i.dir))}}):n==="vertical"?h.jsx(FJ,{...p,ref:e,onThumbPositionChange:()=>{if(i.viewport&&o.current){const v=i.viewport.scrollTop,y=lA(v,c);o.current.style.transform=`translate3d(0, ${y}px, 0)`}},onWheelScroll:v=>{i.viewport&&(i.viewport.scrollTop=v)},onDragScroll:v=>{i.viewport&&(i.viewport.scrollTop=g(v))}}):null}),BJ=x.forwardRef((t,e)=>{const{sizes:n,onSizesChange:r,...i}=t,o=Yr(ji,t.__scopeScrollArea),[a,c]=x.useState(),u=x.useRef(null),f=ht(e,u,o.onScrollbarXChange);return x.useEffect(()=>{u.current&&c(getComputedStyle(u.current))},[u]),h.jsx(zj,{"data-orientation":"horizontal",...i,ref:f,sizes:n,style:{bottom:0,left:o.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:o.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":dm(n)+"px",...t.style},onThumbPointerDown:p=>t.onThumbPointerDown(p.x),onDragScroll:p=>t.onDragScroll(p.x),onWheelScroll:(p,g)=>{if(o.viewport){const v=o.viewport.scrollLeft+p.deltaX;t.onWheelScroll(v),Uj(v,g)&&p.preventDefault()}},onResize:()=>{u.current&&o.viewport&&a&&r({content:o.viewport.scrollWidth,viewport:o.viewport.offsetWidth,scrollbar:{size:u.current.clientWidth,paddingStart:wp(a.paddingLeft),paddingEnd:wp(a.paddingRight)}})}})}),FJ=x.forwardRef((t,e)=>{const{sizes:n,onSizesChange:r,...i}=t,o=Yr(ji,t.__scopeScrollArea),[a,c]=x.useState(),u=x.useRef(null),f=ht(e,u,o.onScrollbarYChange);return x.useEffect(()=>{u.current&&c(getComputedStyle(u.current))},[u]),h.jsx(zj,{"data-orientation":"vertical",...i,ref:f,sizes:n,style:{top:0,right:o.dir==="ltr"?0:void 0,left:o.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":dm(n)+"px",...t.style},onThumbPointerDown:p=>t.onThumbPointerDown(p.y),onDragScroll:p=>t.onDragScroll(p.y),onWheelScroll:(p,g)=>{if(o.viewport){const v=o.viewport.scrollTop+p.deltaY;t.onWheelScroll(v),Uj(v,g)&&p.preventDefault()}},onResize:()=>{u.current&&o.viewport&&a&&r({content:o.viewport.scrollHeight,viewport:o.viewport.offsetHeight,scrollbar:{size:u.current.clientHeight,paddingStart:wp(a.paddingTop),paddingEnd:wp(a.paddingBottom)}})}})}),[$J,Pj]=Rj(ji),zj=x.forwardRef((t,e)=>{const{__scopeScrollArea:n,sizes:r,hasThumb:i,onThumbChange:o,onThumbPointerUp:a,onThumbPointerDown:c,onThumbPositionChange:u,onDragScroll:f,onWheelScroll:p,onResize:g,...v}=t,y=Yr(ji,n),[w,S]=x.useState(null),C=ht(e,z=>S(z)),T=x.useRef(null),N=x.useRef(""),k=y.viewport,D=r.content-r.viewport,M=Qn(p),R=Qn(u),O=fm(g,10);function I(z){if(T.current){const U=z.clientX-T.current.left,Y=z.clientY-T.current.top;f({x:U,y:Y})}}return x.useEffect(()=>{const z=U=>{const Y=U.target;w?.contains(Y)&&M(U,D)};return document.addEventListener("wheel",z,{passive:!1}),()=>document.removeEventListener("wheel",z,{passive:!1})},[k,w,D,M]),x.useEffect(R,[r,R]),Fl(w,O),Fl(y.content,O),h.jsx($J,{scope:n,scrollbar:w,hasThumb:i,onThumbChange:Qn(o),onThumbPointerUp:Qn(a),onThumbPositionChange:R,onThumbPointerDown:Qn(c),children:h.jsx(it.div,{...v,ref:C,style:{position:"absolute",...v.style},onPointerDown:Ve(t.onPointerDown,z=>{z.button===0&&(z.target.setPointerCapture(z.pointerId),T.current=w.getBoundingClientRect(),N.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",y.viewport&&(y.viewport.style.scrollBehavior="auto"),I(z))}),onPointerMove:Ve(t.onPointerMove,I),onPointerUp:Ve(t.onPointerUp,z=>{const U=z.target;U.hasPointerCapture(z.pointerId)&&U.releasePointerCapture(z.pointerId),document.body.style.webkitUserSelect=N.current,y.viewport&&(y.viewport.style.scrollBehavior=""),T.current=null})})})}),bp="ScrollAreaThumb",Bj=x.forwardRef((t,e)=>{const{forceMount:n,...r}=t,i=Pj(bp,t.__scopeScrollArea);return h.jsx(pr,{present:n||i.hasThumb,children:h.jsx(HJ,{ref:e,...r})})}),HJ=x.forwardRef((t,e)=>{const{__scopeScrollArea:n,style:r,...i}=t,o=Yr(bp,n),a=Pj(bp,n),{onThumbPositionChange:c}=a,u=ht(e,g=>a.onThumbChange(g)),f=x.useRef(void 0),p=fm(()=>{f.current&&(f.current(),f.current=void 0)},100);return x.useEffect(()=>{const g=o.viewport;if(g){const v=()=>{if(p(),!f.current){const y=qJ(g,c);f.current=y,c()}};return c(),g.addEventListener("scroll",v),()=>g.removeEventListener("scroll",v)}},[o.viewport,p,c]),h.jsx(it.div,{"data-state":a.hasThumb?"visible":"hidden",...i,ref:u,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...r},onPointerDownCapture:Ve(t.onPointerDownCapture,g=>{const y=g.target.getBoundingClientRect(),w=g.clientX-y.left,S=g.clientY-y.top;a.onThumbPointerDown({x:w,y:S})}),onPointerUp:Ve(t.onPointerUp,a.onThumbPointerUp)})});Bj.displayName=bp;var W0="ScrollAreaCorner",Fj=x.forwardRef((t,e)=>{const n=Yr(W0,t.__scopeScrollArea),r=!!(n.scrollbarX&&n.scrollbarY);return n.type!=="scroll"&&r?h.jsx(UJ,{...t,ref:e}):null});Fj.displayName=W0;var UJ=x.forwardRef((t,e)=>{const{__scopeScrollArea:n,...r}=t,i=Yr(W0,n),[o,a]=x.useState(0),[c,u]=x.useState(0),f=!!(o&&c);return Fl(i.scrollbarX,()=>{const p=i.scrollbarX?.offsetHeight||0;i.onCornerHeightChange(p),u(p)}),Fl(i.scrollbarY,()=>{const p=i.scrollbarY?.offsetWidth||0;i.onCornerWidthChange(p),a(p)}),f?h.jsx(it.div,{...r,ref:e,style:{width:o,height:c,position:"absolute",right:i.dir==="ltr"?0:void 0,left:i.dir==="rtl"?0:void 0,bottom:0,...t.style}}):null});function wp(t){return t?parseInt(t,10):0}function $j(t,e){const n=t/e;return isNaN(n)?0:n}function dm(t){const e=$j(t.viewport,t.content),n=t.scrollbar.paddingStart+t.scrollbar.paddingEnd,r=(t.scrollbar.size-n)*e;return Math.max(r,18)}function VJ(t,e,n,r="ltr"){const i=dm(n),o=i/2,a=e||o,c=i-a,u=n.scrollbar.paddingStart+a,f=n.scrollbar.size-n.scrollbar.paddingEnd-c,p=n.content-n.viewport,g=r==="ltr"?[0,p]:[p*-1,0];return Hj([u,f],g)(t)}function lA(t,e,n="ltr"){const r=dm(e),i=e.scrollbar.paddingStart+e.scrollbar.paddingEnd,o=e.scrollbar.size-i,a=e.content-e.viewport,c=o-r,u=n==="ltr"?[0,a]:[a*-1,0],f=Nu(t,u);return Hj([0,a],[0,c])(f)}function Hj(t,e){return n=>{if(t[0]===t[1]||e[0]===e[1])return e[0];const r=(e[1]-e[0])/(t[1]-t[0]);return e[0]+r*(n-t[0])}}function Uj(t,e){return t>0&&t<e}var qJ=(t,e=()=>{})=>{let n={left:t.scrollLeft,top:t.scrollTop},r=0;return(function i(){const o={left:t.scrollLeft,top:t.scrollTop},a=n.left!==o.left,c=n.top!==o.top;(a||c)&&e(),n=o,r=window.requestAnimationFrame(i)})(),()=>window.cancelAnimationFrame(r)};function fm(t,e){const n=Qn(t),r=x.useRef(0);return x.useEffect(()=>()=>window.clearTimeout(r.current),[]),x.useCallback(()=>{window.clearTimeout(r.current),r.current=window.setTimeout(n,e)},[n,e])}function Fl(t,e){const n=Qn(e);Hn(()=>{let r=0;if(t){const i=new ResizeObserver(()=>{cancelAnimationFrame(r),r=window.requestAnimationFrame(n)});return i.observe(t),()=>{window.cancelAnimationFrame(r),i.unobserve(t)}}},[t,n])}var Vj=jj,GJ=_j,WJ=Fj;const qj=x.forwardRef(({className:t,children:e,...n},r)=>h.jsxs(Vj,{ref:r,className:Wt("relative overflow-hidden",t),...n,children:[h.jsx(GJ,{className:"h-full w-full rounded-[inherit]",children:e}),h.jsx(Gj,{}),h.jsx(WJ,{})]}));qj.displayName=Vj.displayName;const Gj=x.forwardRef(({className:t,orientation:e="vertical",...n},r)=>h.jsx(q0,{ref:r,orientation:e,className:Wt("flex touch-none select-none transition-colors",e==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",e==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",t),...n,children:h.jsx(Bj,{className:"relative flex-1 rounded-full bg-border"})}));Gj.displayName=q0.displayName;function YJ(t){if(typeof document>"u")return;let e=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css",e.appendChild(n),n.styleSheet?n.styleSheet.cssText=t:n.appendChild(document.createTextNode(t))}const KJ=t=>{switch(t){case"success":return QJ;case"info":return eQ;case"warning":return ZJ;case"error":return tQ;default:return null}},XJ=Array(12).fill(0),JJ=({visible:t,className:e})=>Se.createElement("div",{className:["sonner-loading-wrapper",e].filter(Boolean).join(" "),"data-visible":t},Se.createElement("div",{className:"sonner-spinner"},XJ.map((n,r)=>Se.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${r}`})))),QJ=Se.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Se.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),ZJ=Se.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},Se.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),eQ=Se.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Se.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),tQ=Se.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Se.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),nQ=Se.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},Se.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),Se.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),rQ=()=>{const[t,e]=Se.useState(document.hidden);return Se.useEffect(()=>{const n=()=>{e(document.hidden)};return document.addEventListener("visibilitychange",n),()=>window.removeEventListener("visibilitychange",n)},[]),t};let Xx=1;class iQ{constructor(){this.subscribe=e=>(this.subscribers.push(e),()=>{const n=this.subscribers.indexOf(e);this.subscribers.splice(n,1)}),this.publish=e=>{this.subscribers.forEach(n=>n(e))},this.addToast=e=>{this.publish(e),this.toasts=[...this.toasts,e]},this.create=e=>{var n;const{message:r,...i}=e,o=typeof e?.id=="number"||((n=e.id)==null?void 0:n.length)>0?e.id:Xx++,a=this.toasts.find(u=>u.id===o),c=e.dismissible===void 0?!0:e.dismissible;return this.dismissedToasts.has(o)&&this.dismissedToasts.delete(o),a?this.toasts=this.toasts.map(u=>u.id===o?(this.publish({...u,...e,id:o,title:r}),{...u,...e,id:o,dismissible:c,title:r}):u):this.addToast({title:r,...i,dismissible:c,id:o}),o},this.dismiss=e=>(e?(this.dismissedToasts.add(e),requestAnimationFrame(()=>this.subscribers.forEach(n=>n({id:e,dismiss:!0})))):this.toasts.forEach(n=>{this.subscribers.forEach(r=>r({id:n.id,dismiss:!0}))}),e),this.message=(e,n)=>this.create({...n,message:e}),this.error=(e,n)=>this.create({...n,message:e,type:"error"}),this.success=(e,n)=>this.create({...n,type:"success",message:e}),this.info=(e,n)=>this.create({...n,type:"info",message:e}),this.warning=(e,n)=>this.create({...n,type:"warning",message:e}),this.loading=(e,n)=>this.create({...n,type:"loading",message:e}),this.promise=(e,n)=>{if(!n)return;let r;n.loading!==void 0&&(r=this.create({...n,promise:e,type:"loading",message:n.loading,description:typeof n.description!="function"?n.description:void 0}));const i=Promise.resolve(e instanceof Function?e():e);let o=r!==void 0,a;const c=i.then(async f=>{if(a=["resolve",f],Se.isValidElement(f))o=!1,this.create({id:r,type:"default",message:f});else if(sQ(f)&&!f.ok){o=!1;const g=typeof n.error=="function"?await n.error(`HTTP error! status: ${f.status}`):n.error,v=typeof n.description=="function"?await n.description(`HTTP error! status: ${f.status}`):n.description,w=typeof g=="object"&&!Se.isValidElement(g)?g:{message:g};this.create({id:r,type:"error",description:v,...w})}else if(f instanceof Error){o=!1;const g=typeof n.error=="function"?await n.error(f):n.error,v=typeof n.description=="function"?await n.description(f):n.description,w=typeof g=="object"&&!Se.isValidElement(g)?g:{message:g};this.create({id:r,type:"error",description:v,...w})}else if(n.success!==void 0){o=!1;const g=typeof n.success=="function"?await n.success(f):n.success,v=typeof n.description=="function"?await n.description(f):n.description,w=typeof g=="object"&&!Se.isValidElement(g)?g:{message:g};this.create({id:r,type:"success",description:v,...w})}}).catch(async f=>{if(a=["reject",f],n.error!==void 0){o=!1;const p=typeof n.error=="function"?await n.error(f):n.error,g=typeof n.description=="function"?await n.description(f):n.description,y=typeof p=="object"&&!Se.isValidElement(p)?p:{message:p};this.create({id:r,type:"error",description:g,...y})}}).finally(()=>{o&&(this.dismiss(r),r=void 0),n.finally==null||n.finally.call(n)}),u=()=>new Promise((f,p)=>c.then(()=>a[0]==="reject"?p(a[1]):f(a[1])).catch(p));return typeof r!="string"&&typeof r!="number"?{unwrap:u}:Object.assign(r,{unwrap:u})},this.custom=(e,n)=>{const r=n?.id||Xx++;return this.create({jsx:e(r),id:r,...n}),r},this.getActiveToasts=()=>this.toasts.filter(e=>!this.dismissedToasts.has(e.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}}const dr=new iQ,oQ=(t,e)=>{const n=e?.id||Xx++;return dr.addToast({title:t,...e,id:n}),n},sQ=t=>t&&typeof t=="object"&&"ok"in t&&typeof t.ok=="boolean"&&"status"in t&&typeof t.status=="number",aQ=oQ,lQ=()=>dr.toasts,cQ=()=>dr.getActiveToasts(),bl=Object.assign(aQ,{success:dr.success,info:dr.info,warning:dr.warning,error:dr.error,custom:dr.custom,message:dr.message,promise:dr.promise,dismiss:dr.dismiss,loading:dr.loading},{getHistory:lQ,getToasts:cQ});YJ("[data-sonner-toaster][dir=ltr],html[dir=ltr]{--toast-icon-margin-start:-3px;--toast-icon-margin-end:4px;--toast-svg-margin-start:-1px;--toast-svg-margin-end:0px;--toast-button-margin-start:auto;--toast-button-margin-end:0;--toast-close-button-start:0;--toast-close-button-end:unset;--toast-close-button-transform:translate(-35%, -35%)}[data-sonner-toaster][dir=rtl],html[dir=rtl]{--toast-icon-margin-start:4px;--toast-icon-margin-end:-3px;--toast-svg-margin-start:0px;--toast-svg-margin-end:-1px;--toast-button-margin-start:0;--toast-button-margin-end:auto;--toast-close-button-start:unset;--toast-close-button-end:0;--toast-close-button-transform:translate(35%, -35%)}[data-sonner-toaster]{position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1:hsl(0, 0%, 99%);--gray2:hsl(0, 0%, 97.3%);--gray3:hsl(0, 0%, 95.1%);--gray4:hsl(0, 0%, 93%);--gray5:hsl(0, 0%, 90.9%);--gray6:hsl(0, 0%, 88.7%);--gray7:hsl(0, 0%, 85.8%);--gray8:hsl(0, 0%, 78%);--gray9:hsl(0, 0%, 56.1%);--gray10:hsl(0, 0%, 52.3%);--gray11:hsl(0, 0%, 43.5%);--gray12:hsl(0, 0%, 9%);--border-radius:8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:0;z-index:999999999;transition:transform .4s ease}@media (hover:none) and (pointer:coarse){[data-sonner-toaster][data-lifted=true]{transform:none}}[data-sonner-toaster][data-x-position=right]{right:var(--offset-right)}[data-sonner-toaster][data-x-position=left]{left:var(--offset-left)}[data-sonner-toaster][data-x-position=center]{left:50%;transform:translateX(-50%)}[data-sonner-toaster][data-y-position=top]{top:var(--offset-top)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--offset-bottom)}[data-sonner-toast]{--y:translateY(100%);--lift-amount:calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:0;overflow-wrap:anywhere}[data-sonner-toast][data-styled=true]{padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px rgba(0,0,0,.1);width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}[data-sonner-toast]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-y-position=top]{top:0;--y:translateY(-100%);--lift:1;--lift-amount:calc(1 * var(--gap))}[data-sonner-toast][data-y-position=bottom]{bottom:0;--y:translateY(100%);--lift:-1;--lift-amount:calc(var(--lift) * var(--gap))}[data-sonner-toast][data-styled=true] [data-description]{font-weight:400;line-height:1.4;color:#3f3f3f}[data-rich-colors=true][data-sonner-toast][data-styled=true] [data-description]{color:inherit}[data-sonner-toaster][data-sonner-theme=dark] [data-description]{color:#e8e8e8}[data-sonner-toast][data-styled=true] [data-title]{font-weight:500;line-height:1.5;color:inherit}[data-sonner-toast][data-styled=true] [data-icon]{display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}[data-sonner-toast][data-promise=true] [data-icon]>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}[data-sonner-toast][data-styled=true] [data-icon]>*{flex-shrink:0}[data-sonner-toast][data-styled=true] [data-icon] svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}[data-sonner-toast][data-styled=true] [data-content]{display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;font-weight:500;cursor:pointer;outline:0;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}[data-sonner-toast][data-styled=true] [data-button]:focus-visible{box-shadow:0 0 0 2px rgba(0,0,0,.4)}[data-sonner-toast][data-styled=true] [data-button]:first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}[data-sonner-toast][data-styled=true] [data-cancel]{color:var(--normal-text);background:rgba(0,0,0,.08)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-styled=true] [data-cancel]{background:rgba(255,255,255,.3)}[data-sonner-toast][data-styled=true] [data-close-button]{position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);background:var(--normal-bg);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast][data-styled=true] [data-close-button]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-styled=true] [data-disabled=true]{cursor:not-allowed}[data-sonner-toast][data-styled=true]:hover [data-close-button]:hover{background:var(--gray2);border-color:var(--gray5)}[data-sonner-toast][data-swiping=true]::before{content:'';position:absolute;left:-100%;right:-100%;height:100%;z-index:-1}[data-sonner-toast][data-y-position=top][data-swiping=true]::before{bottom:50%;transform:scaleY(3) translateY(50%)}[data-sonner-toast][data-y-position=bottom][data-swiping=true]::before{top:50%;transform:scaleY(3) translateY(-50%)}[data-sonner-toast][data-swiping=false][data-removed=true]::before{content:'';position:absolute;inset:0;transform:scaleY(2)}[data-sonner-toast][data-expanded=true]::after{content:'';position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}[data-sonner-toast][data-mounted=true]{--y:translateY(0);opacity:1}[data-sonner-toast][data-expanded=false][data-front=false]{--scale:var(--toasts-before) * 0.05 + 1;--y:translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}[data-sonner-toast]>*{transition:opacity .4s}[data-sonner-toast][data-x-position=right]{right:0}[data-sonner-toast][data-x-position=left]{left:0}[data-sonner-toast][data-expanded=false][data-front=false][data-styled=true]>*{opacity:0}[data-sonner-toast][data-visible=false]{opacity:0;pointer-events:none}[data-sonner-toast][data-mounted=true][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}[data-sonner-toast][data-removed=true][data-front=true][data-swipe-out=false]{--y:translateY(calc(var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=false]{--y:translateY(40%);opacity:0;transition:transform .5s,opacity .2s}[data-sonner-toast][data-removed=true][data-front=false]::before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y,0)) translateX(var(--swipe-amount-x,0));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width:600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-sonner-theme=light]{--normal-bg:#fff;--normal-border:var(--gray4);--normal-text:var(--gray12);--success-bg:hsl(143, 85%, 96%);--success-border:hsl(145, 92%, 87%);--success-text:hsl(140, 100%, 27%);--info-bg:hsl(208, 100%, 97%);--info-border:hsl(221, 91%, 93%);--info-text:hsl(210, 92%, 45%);--warning-bg:hsl(49, 100%, 97%);--warning-border:hsl(49, 91%, 84%);--warning-text:hsl(31, 92%, 45%);--error-bg:hsl(359, 100%, 97%);--error-border:hsl(359, 100%, 94%);--error-text:hsl(360, 100%, 45%)}[data-sonner-toaster][data-sonner-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg:#000;--normal-border:hsl(0, 0%, 20%);--normal-text:var(--gray1)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg:#fff;--normal-border:var(--gray3);--normal-text:var(--gray12)}[data-sonner-toaster][data-sonner-theme=dark]{--normal-bg:#000;--normal-bg-hover:hsl(0, 0%, 12%);--normal-border:hsl(0, 0%, 20%);--normal-border-hover:hsl(0, 0%, 25%);--normal-text:var(--gray1);--success-bg:hsl(150, 100%, 6%);--success-border:hsl(147, 100%, 12%);--success-text:hsl(150, 86%, 65%);--info-bg:hsl(215, 100%, 6%);--info-border:hsl(223, 43%, 17%);--info-text:hsl(216, 87%, 65%);--warning-bg:hsl(64, 100%, 6%);--warning-border:hsl(60, 100%, 9%);--warning-text:hsl(46, 87%, 65%);--error-bg:hsl(358, 76%, 10%);--error-border:hsl(357, 89%, 16%);--error-text:hsl(358, 100%, 81%)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size:16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:first-child{animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}100%{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}100%{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}100%{opacity:.15}}@media (prefers-reduced-motion){.sonner-loading-bar,[data-sonner-toast],[data-sonner-toast]>*{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}");function Xf(t){return t.label!==void 0}const uQ=3,dQ="24px",fQ="16px",cA=4e3,hQ=356,pQ=14,mQ=45,gQ=200;function vi(...t){return t.filter(Boolean).join(" ")}function yQ(t){const[e,n]=t.split("-"),r=[];return e&&r.push(e),n&&r.push(n),r}const vQ=t=>{var e,n,r,i,o,a,c,u,f;const{invert:p,toast:g,unstyled:v,interacting:y,setHeights:w,visibleToasts:S,heights:C,index:T,toasts:N,expanded:k,removeToast:D,defaultRichColors:M,closeButton:R,style:O,cancelButtonStyle:I,actionButtonStyle:z,className:U="",descriptionClassName:Y="",duration:W,position:j,gap:G,expandByDefault:oe,classNames:L,icons:$,closeButtonAriaLabel:V="Close toast"}=t,[we,pe]=Se.useState(null),[P,K]=Se.useState(null),[B,Z]=Se.useState(!1),[le,be]=Se.useState(!1),[H,ce]=Se.useState(!1),[te,me]=Se.useState(!1),[Te,re]=Se.useState(!1),[he,Ae]=Se.useState(0),[Re,Le]=Se.useState(0),ae=Se.useRef(g.duration||W||cA),Me=Se.useRef(null),J=Se.useRef(null),X=T===0,ve=T+1<=S,Ce=g.type,Oe=g.dismissible!==!1,Ye=g.className||"",et=g.descriptionClassName||"",at=Se.useMemo(()=>C.findIndex(Be=>Be.toastId===g.id)||0,[C,g.id]),ct=Se.useMemo(()=>{var Be;return(Be=g.closeButton)!=null?Be:R},[g.closeButton,R]),ze=Se.useMemo(()=>g.duration||W||cA,[g.duration,W]),He=Se.useRef(0),ke=Se.useRef(0),rt=Se.useRef(0),Ge=Se.useRef(null),[pt,Ke]=j.split("-"),ut=Se.useMemo(()=>C.reduce((Be,Dt,rn)=>rn>=at?Be:Be+Dt.height,0),[C,at]),Qe=rQ(),jt=g.invert||p,dt=Ce==="loading";ke.current=Se.useMemo(()=>at*G+ut,[at,ut]),Se.useEffect(()=>{ae.current=ze},[ze]),Se.useEffect(()=>{Z(!0)},[]),Se.useEffect(()=>{const Be=J.current;if(Be){const Dt=Be.getBoundingClientRect().height;return Le(Dt),w(rn=>[{toastId:g.id,height:Dt,position:g.position},...rn]),()=>w(rn=>rn.filter(Tn=>Tn.toastId!==g.id))}},[w,g.id]),Se.useLayoutEffect(()=>{if(!B)return;const Be=J.current,Dt=Be.style.height;Be.style.height="auto";const rn=Be.getBoundingClientRect().height;Be.style.height=Dt,Le(rn),w(Tn=>Tn.find(on=>on.toastId===g.id)?Tn.map(on=>on.toastId===g.id?{...on,height:rn}:on):[{toastId:g.id,height:rn,position:g.position},...Tn])},[B,g.title,g.description,w,g.id,g.jsx,g.action,g.cancel]);const de=Se.useCallback(()=>{be(!0),Ae(ke.current),w(Be=>Be.filter(Dt=>Dt.toastId!==g.id)),setTimeout(()=>{D(g)},gQ)},[g,D,w,ke]);Se.useEffect(()=>{if(g.promise&&Ce==="loading"||g.duration===1/0||g.type==="loading")return;let Be;return k||y||Qe?(()=>{if(rt.current<He.current){const Tn=new Date().getTime()-He.current;ae.current=ae.current-Tn}rt.current=new Date().getTime()})():ae.current!==1/0&&(He.current=new Date().getTime(),Be=setTimeout(()=>{g.onAutoClose==null||g.onAutoClose.call(g,g),de()},ae.current)),()=>clearTimeout(Be)},[k,y,g,Ce,Qe,de]),Se.useEffect(()=>{g.delete&&(de(),g.onDismiss==null||g.onDismiss.call(g,g))},[de,g.delete]);function De(){var Be;if($?.loading){var Dt;return Se.createElement("div",{className:vi(L?.loader,g==null||(Dt=g.classNames)==null?void 0:Dt.loader,"sonner-loader"),"data-visible":Ce==="loading"},$.loading)}return Se.createElement(JJ,{className:vi(L?.loader,g==null||(Be=g.classNames)==null?void 0:Be.loader),visible:Ce==="loading"})}const yt=g.icon||$?.[Ce]||KJ(Ce);var mt,We;return Se.createElement("li",{tabIndex:0,ref:J,className:vi(U,Ye,L?.toast,g==null||(e=g.classNames)==null?void 0:e.toast,L?.default,L?.[Ce],g==null||(n=g.classNames)==null?void 0:n[Ce]),"data-sonner-toast":"","data-rich-colors":(mt=g.richColors)!=null?mt:M,"data-styled":!(g.jsx||g.unstyled||v),"data-mounted":B,"data-promise":!!g.promise,"data-swiped":Te,"data-removed":le,"data-visible":ve,"data-y-position":pt,"data-x-position":Ke,"data-index":T,"data-front":X,"data-swiping":H,"data-dismissible":Oe,"data-type":Ce,"data-invert":jt,"data-swipe-out":te,"data-swipe-direction":P,"data-expanded":!!(k||oe&&B),"data-testid":g.testId,style:{"--index":T,"--toasts-before":T,"--z-index":N.length-T,"--offset":`${le?he:ke.current}px`,"--initial-height":oe?"auto":`${Re}px`,...O,...g.style},onDragEnd:()=>{ce(!1),pe(null),Ge.current=null},onPointerDown:Be=>{Be.button!==2&&(dt||!Oe||(Me.current=new Date,Ae(ke.current),Be.target.setPointerCapture(Be.pointerId),Be.target.tagName!=="BUTTON"&&(ce(!0),Ge.current={x:Be.clientX,y:Be.clientY})))},onPointerUp:()=>{var Be,Dt,rn;if(te||!Oe)return;Ge.current=null;const Tn=Number(((Be=J.current)==null?void 0:Be.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),xo=Number(((Dt=J.current)==null?void 0:Dt.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),on=new Date().getTime()-((rn=Me.current)==null?void 0:rn.getTime()),tr=we==="x"?Tn:xo,Ns=Math.abs(tr)/on;if(Math.abs(tr)>=mQ||Ns>.11){Ae(ke.current),g.onDismiss==null||g.onDismiss.call(g,g),K(we==="x"?Tn>0?"right":"left":xo>0?"down":"up"),de(),me(!0);return}else{var nr,rr;(nr=J.current)==null||nr.style.setProperty("--swipe-amount-x","0px"),(rr=J.current)==null||rr.style.setProperty("--swipe-amount-y","0px")}re(!1),ce(!1),pe(null)},onPointerMove:Be=>{var Dt,rn,Tn;if(!Ge.current||!Oe||((Dt=window.getSelection())==null?void 0:Dt.toString().length)>0)return;const on=Be.clientY-Ge.current.y,tr=Be.clientX-Ge.current.x;var Ns;const nr=(Ns=t.swipeDirections)!=null?Ns:yQ(j);!we&&(Math.abs(tr)>1||Math.abs(on)>1)&&pe(Math.abs(tr)>Math.abs(on)?"x":"y");let rr={x:0,y:0};const wa=Kr=>1/(1.5+Math.abs(Kr)/20);if(we==="y"){if(nr.includes("top")||nr.includes("bottom"))if(nr.includes("top")&&on<0||nr.includes("bottom")&&on>0)rr.y=on;else{const Kr=on*wa(on);rr.y=Math.abs(Kr)<Math.abs(on)?Kr:on}}else if(we==="x"&&(nr.includes("left")||nr.includes("right")))if(nr.includes("left")&&tr<0||nr.includes("right")&&tr>0)rr.x=tr;else{const Kr=tr*wa(tr);rr.x=Math.abs(Kr)<Math.abs(tr)?Kr:tr}(Math.abs(rr.x)>0||Math.abs(rr.y)>0)&&re(!0),(rn=J.current)==null||rn.style.setProperty("--swipe-amount-x",`${rr.x}px`),(Tn=J.current)==null||Tn.style.setProperty("--swipe-amount-y",`${rr.y}px`)}},ct&&!g.jsx&&Ce!=="loading"?Se.createElement("button",{"aria-label":V,"data-disabled":dt,"data-close-button":!0,onClick:dt||!Oe?()=>{}:()=>{de(),g.onDismiss==null||g.onDismiss.call(g,g)},className:vi(L?.closeButton,g==null||(r=g.classNames)==null?void 0:r.closeButton)},(We=$?.close)!=null?We:nQ):null,(Ce||g.icon||g.promise)&&g.icon!==null&&($?.[Ce]!==null||g.icon)?Se.createElement("div",{"data-icon":"",className:vi(L?.icon,g==null||(i=g.classNames)==null?void 0:i.icon)},g.promise||g.type==="loading"&&!g.icon?g.icon||De():null,g.type!=="loading"?yt:null):null,Se.createElement("div",{"data-content":"",className:vi(L?.content,g==null||(o=g.classNames)==null?void 0:o.content)},Se.createElement("div",{"data-title":"",className:vi(L?.title,g==null||(a=g.classNames)==null?void 0:a.title)},g.jsx?g.jsx:typeof g.title=="function"?g.title():g.title),g.description?Se.createElement("div",{"data-description":"",className:vi(Y,et,L?.description,g==null||(c=g.classNames)==null?void 0:c.description)},typeof g.description=="function"?g.description():g.description):null),Se.isValidElement(g.cancel)?g.cancel:g.cancel&&Xf(g.cancel)?Se.createElement("button",{"data-button":!0,"data-cancel":!0,style:g.cancelButtonStyle||I,onClick:Be=>{Xf(g.cancel)&&Oe&&(g.cancel.onClick==null||g.cancel.onClick.call(g.cancel,Be),de())},className:vi(L?.cancelButton,g==null||(u=g.classNames)==null?void 0:u.cancelButton)},g.cancel.label):null,Se.isValidElement(g.action)?g.action:g.action&&Xf(g.action)?Se.createElement("button",{"data-button":!0,"data-action":!0,style:g.actionButtonStyle||z,onClick:Be=>{Xf(g.action)&&(g.action.onClick==null||g.action.onClick.call(g.action,Be),!Be.defaultPrevented&&de())},className:vi(L?.actionButton,g==null||(f=g.classNames)==null?void 0:f.actionButton)},g.action.label):null)};function uA(){if(typeof window>"u"||typeof document>"u")return"ltr";const t=document.documentElement.getAttribute("dir");return t==="auto"||!t?window.getComputedStyle(document.documentElement).direction:t}function xQ(t,e){const n={};return[t,e].forEach((r,i)=>{const o=i===1,a=o?"--mobile-offset":"--offset",c=o?fQ:dQ;function u(f){["top","right","bottom","left"].forEach(p=>{n[`${a}-${p}`]=typeof f=="number"?`${f}px`:f})}typeof r=="number"||typeof r=="string"?u(r):typeof r=="object"?["top","right","bottom","left"].forEach(f=>{r[f]===void 0?n[`${a}-${f}`]=c:n[`${a}-${f}`]=typeof r[f]=="number"?`${r[f]}px`:r[f]}):u(c)}),n}const bQ=Se.forwardRef(function(e,n){const{id:r,invert:i,position:o="bottom-right",hotkey:a=["altKey","KeyT"],expand:c,closeButton:u,className:f,offset:p,mobileOffset:g,theme:v="light",richColors:y,duration:w,style:S,visibleToasts:C=uQ,toastOptions:T,dir:N=uA(),gap:k=pQ,icons:D,containerAriaLabel:M="Notifications"}=e,[R,O]=Se.useState([]),I=Se.useMemo(()=>r?R.filter(B=>B.toasterId===r):R.filter(B=>!B.toasterId),[R,r]),z=Se.useMemo(()=>Array.from(new Set([o].concat(I.filter(B=>B.position).map(B=>B.position)))),[I,o]),[U,Y]=Se.useState([]),[W,j]=Se.useState(!1),[G,oe]=Se.useState(!1),[L,$]=Se.useState(v!=="system"?v:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),V=Se.useRef(null),we=a.join("+").replace(/Key/g,"").replace(/Digit/g,""),pe=Se.useRef(null),P=Se.useRef(!1),K=Se.useCallback(B=>{O(Z=>{var le;return(le=Z.find(be=>be.id===B.id))!=null&&le.delete||dr.dismiss(B.id),Z.filter(({id:be})=>be!==B.id)})},[]);return Se.useEffect(()=>dr.subscribe(B=>{if(B.dismiss){requestAnimationFrame(()=>{O(Z=>Z.map(le=>le.id===B.id?{...le,delete:!0}:le))});return}setTimeout(()=>{ob.flushSync(()=>{O(Z=>{const le=Z.findIndex(be=>be.id===B.id);return le!==-1?[...Z.slice(0,le),{...Z[le],...B},...Z.slice(le+1)]:[B,...Z]})})})}),[R]),Se.useEffect(()=>{if(v!=="system"){$(v);return}if(v==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?$("dark"):$("light")),typeof window>"u")return;const B=window.matchMedia("(prefers-color-scheme: dark)");try{B.addEventListener("change",({matches:Z})=>{$(Z?"dark":"light")})}catch{B.addListener(({matches:le})=>{try{$(le?"dark":"light")}catch(be){console.error(be)}})}},[v]),Se.useEffect(()=>{R.length<=1&&j(!1)},[R]),Se.useEffect(()=>{const B=Z=>{var le;if(a.every(ce=>Z[ce]||Z.code===ce)){var H;j(!0),(H=V.current)==null||H.focus()}Z.code==="Escape"&&(document.activeElement===V.current||(le=V.current)!=null&&le.contains(document.activeElement))&&j(!1)};return document.addEventListener("keydown",B),()=>document.removeEventListener("keydown",B)},[a]),Se.useEffect(()=>{if(V.current)return()=>{pe.current&&(pe.current.focus({preventScroll:!0}),pe.current=null,P.current=!1)}},[V.current]),Se.createElement("section",{ref:n,"aria-label":`${M} ${we}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},z.map((B,Z)=>{var le;const[be,H]=B.split("-");return I.length?Se.createElement("ol",{key:B,dir:N==="auto"?uA():N,tabIndex:-1,ref:V,className:f,"data-sonner-toaster":!0,"data-sonner-theme":L,"data-y-position":be,"data-x-position":H,style:{"--front-toast-height":`${((le=U[0])==null?void 0:le.height)||0}px`,"--width":`${hQ}px`,"--gap":`${k}px`,...S,...xQ(p,g)},onBlur:ce=>{P.current&&!ce.currentTarget.contains(ce.relatedTarget)&&(P.current=!1,pe.current&&(pe.current.focus({preventScroll:!0}),pe.current=null))},onFocus:ce=>{ce.target instanceof HTMLElement&&ce.target.dataset.dismissible==="false"||P.current||(P.current=!0,pe.current=ce.relatedTarget)},onMouseEnter:()=>j(!0),onMouseMove:()=>j(!0),onMouseLeave:()=>{G||j(!1)},onDragEnd:()=>j(!1),onPointerDown:ce=>{ce.target instanceof HTMLElement&&ce.target.dataset.dismissible==="false"||oe(!0)},onPointerUp:()=>oe(!1)},I.filter(ce=>!ce.position&&Z===0||ce.position===B).map((ce,te)=>{var me,Te;return Se.createElement(vQ,{key:ce.id,icons:D,index:te,toast:ce,defaultRichColors:y,duration:(me=T?.duration)!=null?me:w,className:T?.className,descriptionClassName:T?.descriptionClassName,invert:i,visibleToasts:C,closeButton:(Te=T?.closeButton)!=null?Te:u,interacting:G,position:B,style:T?.style,unstyled:T?.unstyled,classNames:T?.classNames,cancelButtonStyle:T?.cancelButtonStyle,actionButtonStyle:T?.actionButtonStyle,closeButtonAriaLabel:T?.closeButtonAriaLabel,removeToast:K,toasts:I.filter(re=>re.position==ce.position),heights:U.filter(re=>re.position==ce.position),setHeights:Y,expandByDefault:c,gap:k,expanded:W,swipeDirections:e.swipeDirections})})):null}))});function wQ({...t}){return h.jsx(bQ,{theme:"dark",className:"toaster group",position:"top-right",expand:!1,richColors:!1,closeButton:!0,gap:8,toastOptions:{duration:3e3,classNames:{toast:`
            group toast
            !bg-slate-900/95 !backdrop-blur-sm
            !border !border-slate-700/50
            !rounded-lg !shadow-xl !shadow-black/20
            !py-2.5 !px-4 !min-h-0
            !text-sm !font-medium
            !flex !items-center !gap-3
          `,title:"!text-slate-100 !text-sm !font-medium !leading-tight",description:"!text-slate-400 !text-xs !mt-0.5 !leading-snug",actionButton:`
            !bg-slate-700 !text-slate-100 !text-xs !font-medium
            !px-2.5 !py-1 !rounded-md
            hover:!bg-slate-600
          `,cancelButton:`
            !bg-transparent !text-slate-400 !text-xs
            hover:!text-slate-200
          `,closeButton:`
            !bg-transparent !text-slate-500 !border-0
            hover:!text-slate-300
            !-right-1 !-top-1
          `,success:`
            !border-l-2 !border-l-emerald-500
            [&_.sonner-icon]:!text-emerald-400
          `,error:`
            !border-l-2 !border-l-red-500
            [&_.sonner-icon]:!text-red-400
          `,info:`
            !border-l-2 !border-l-blue-500
            [&_.sonner-icon]:!text-blue-400
          `,warning:`
            !border-l-2 !border-l-amber-500
            [&_.sonner-icon]:!text-amber-400
          `,loading:`
            !border-l-2 !border-l-slate-500
            [&_.sonner-icon]:!text-slate-400
          `}},...t})}function Jx(t){"@babel/helpers - typeof";return Jx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Jx(t)}function fi(t,e){if(e.length<t)throw new TypeError(t+" argument"+(t>1?"s":"")+" required, but only "+e.length+" present")}function Wn(t){fi(1,arguments);var e=Object.prototype.toString.call(t);return t instanceof Date||Jx(t)==="object"&&e==="[object Date]"?new Date(t.getTime()):typeof t=="number"||e==="[object Number]"?new Date(t):((typeof t=="string"||e==="[object String]")&&typeof console<"u"&&(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#string-arguments"),console.warn(new Error().stack)),new Date(NaN))}var SQ={};function EQ(){return SQ}function dA(t){var e=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return e.setUTCFullYear(t.getFullYear()),t.getTime()-e.getTime()}function fh(t,e){fi(2,arguments);var n=Wn(t),r=Wn(e),i=n.getTime()-r.getTime();return i<0?-1:i>0?1:i}function CQ(t,e){fi(2,arguments);var n=Wn(t),r=Wn(e),i=n.getFullYear()-r.getFullYear(),o=n.getMonth()-r.getMonth();return i*12+o}function TQ(t,e){return fi(2,arguments),Wn(t).getTime()-Wn(e).getTime()}var NQ={ceil:Math.ceil,round:Math.round,floor:Math.floor,trunc:function(e){return e<0?Math.ceil(e):Math.floor(e)}},AQ="trunc";function kQ(t){return NQ[AQ]}function DQ(t){fi(1,arguments);var e=Wn(t);return e.setHours(23,59,59,999),e}function OQ(t){fi(1,arguments);var e=Wn(t),n=e.getMonth();return e.setFullYear(e.getFullYear(),n+1,0),e.setHours(23,59,59,999),e}function MQ(t){fi(1,arguments);var e=Wn(t);return DQ(e).getTime()===OQ(e).getTime()}function RQ(t,e){fi(2,arguments);var n=Wn(t),r=Wn(e),i=fh(n,r),o=Math.abs(CQ(n,r)),a;if(o<1)a=0;else{n.getMonth()===1&&n.getDate()>27&&n.setDate(30),n.setMonth(n.getMonth()-i*o);var c=fh(n,r)===-i;MQ(Wn(t))&&o===1&&fh(t,r)===1&&(c=!1),a=i*(o-Number(c))}return a===0?0:a}function jQ(t,e,n){fi(2,arguments);var r=TQ(t,e)/1e3;return kQ()(r)}var IQ={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},_Q=function(e,n,r){var i,o=IQ[e];return typeof o=="string"?i=o:n===1?i=o.one:i=o.other.replace("{{count}}",n.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+i:i+" ago":i};function jv(t){return function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=e.width?String(e.width):t.defaultWidth,r=t.formats[n]||t.formats[t.defaultWidth];return r}}var LQ={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},PQ={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},zQ={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},BQ={date:jv({formats:LQ,defaultWidth:"full"}),time:jv({formats:PQ,defaultWidth:"full"}),dateTime:jv({formats:zQ,defaultWidth:"full"})},FQ={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},$Q=function(e,n,r,i){return FQ[e]};function eu(t){return function(e,n){var r=n!=null&&n.context?String(n.context):"standalone",i;if(r==="formatting"&&t.formattingValues){var o=t.defaultFormattingWidth||t.defaultWidth,a=n!=null&&n.width?String(n.width):o;i=t.formattingValues[a]||t.formattingValues[o]}else{var c=t.defaultWidth,u=n!=null&&n.width?String(n.width):t.defaultWidth;i=t.values[u]||t.values[c]}var f=t.argumentCallback?t.argumentCallback(e):e;return i[f]}}var HQ={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},UQ={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},VQ={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},qQ={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},GQ={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},WQ={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},YQ=function(e,n){var r=Number(e),i=r%100;if(i>20||i<10)switch(i%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},KQ={ordinalNumber:YQ,era:eu({values:HQ,defaultWidth:"wide"}),quarter:eu({values:UQ,defaultWidth:"wide",argumentCallback:function(e){return e-1}}),month:eu({values:VQ,defaultWidth:"wide"}),day:eu({values:qQ,defaultWidth:"wide"}),dayPeriod:eu({values:GQ,defaultWidth:"wide",formattingValues:WQ,defaultFormattingWidth:"wide"})};function tu(t){return function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=n.width,i=r&&t.matchPatterns[r]||t.matchPatterns[t.defaultMatchWidth],o=e.match(i);if(!o)return null;var a=o[0],c=r&&t.parsePatterns[r]||t.parsePatterns[t.defaultParseWidth],u=Array.isArray(c)?JQ(c,function(g){return g.test(a)}):XQ(c,function(g){return g.test(a)}),f;f=t.valueCallback?t.valueCallback(u):u,f=n.valueCallback?n.valueCallback(f):f;var p=e.slice(a.length);return{value:f,rest:p}}}function XQ(t,e){for(var n in t)if(t.hasOwnProperty(n)&&e(t[n]))return n}function JQ(t,e){for(var n=0;n<t.length;n++)if(e(t[n]))return n}function QQ(t){return function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=e.match(t.matchPattern);if(!r)return null;var i=r[0],o=e.match(t.parsePattern);if(!o)return null;var a=t.valueCallback?t.valueCallback(o[0]):o[0];a=n.valueCallback?n.valueCallback(a):a;var c=e.slice(i.length);return{value:a,rest:c}}}var ZQ=/^(\d+)(th|st|nd|rd)?/i,eZ=/\d+/i,tZ={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},nZ={any:[/^b/i,/^(a|c)/i]},rZ={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},iZ={any:[/1/i,/2/i,/3/i,/4/i]},oZ={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},sZ={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},aZ={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},lZ={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},cZ={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},uZ={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},dZ={ordinalNumber:QQ({matchPattern:ZQ,parsePattern:eZ,valueCallback:function(e){return parseInt(e,10)}}),era:tu({matchPatterns:tZ,defaultMatchWidth:"wide",parsePatterns:nZ,defaultParseWidth:"any"}),quarter:tu({matchPatterns:rZ,defaultMatchWidth:"wide",parsePatterns:iZ,defaultParseWidth:"any",valueCallback:function(e){return e+1}}),month:tu({matchPatterns:oZ,defaultMatchWidth:"wide",parsePatterns:sZ,defaultParseWidth:"any"}),day:tu({matchPatterns:aZ,defaultMatchWidth:"wide",parsePatterns:lZ,defaultParseWidth:"any"}),dayPeriod:tu({matchPatterns:cZ,defaultMatchWidth:"any",parsePatterns:uZ,defaultParseWidth:"any"})},fZ={code:"en-US",formatDistance:_Q,formatLong:BQ,formatRelative:$Q,localize:KQ,match:dZ,options:{weekStartsOn:0,firstWeekContainsDate:1}};function Wj(t,e){if(t==null)throw new TypeError("assign requires that input parameter not be null or undefined");for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}function hZ(t){return Wj({},t)}var fA=1440,pZ=2520,Iv=43200,mZ=86400;function gZ(t,e,n){var r,i;fi(2,arguments);var o=EQ(),a=(r=(i=n?.locale)!==null&&i!==void 0?i:o.locale)!==null&&r!==void 0?r:fZ;if(!a.formatDistance)throw new RangeError("locale must contain formatDistance property");var c=fh(t,e);if(isNaN(c))throw new RangeError("Invalid time value");var u=Wj(hZ(n),{addSuffix:!!n?.addSuffix,comparison:c}),f,p;c>0?(f=Wn(e),p=Wn(t)):(f=Wn(t),p=Wn(e));var g=jQ(p,f),v=(dA(p)-dA(f))/1e3,y=Math.round((g-v)/60),w;if(y<2)return n!=null&&n.includeSeconds?g<5?a.formatDistance("lessThanXSeconds",5,u):g<10?a.formatDistance("lessThanXSeconds",10,u):g<20?a.formatDistance("lessThanXSeconds",20,u):g<40?a.formatDistance("halfAMinute",0,u):g<60?a.formatDistance("lessThanXMinutes",1,u):a.formatDistance("xMinutes",1,u):y===0?a.formatDistance("lessThanXMinutes",1,u):a.formatDistance("xMinutes",y,u);if(y<45)return a.formatDistance("xMinutes",y,u);if(y<90)return a.formatDistance("aboutXHours",1,u);if(y<fA){var S=Math.round(y/60);return a.formatDistance("aboutXHours",S,u)}else{if(y<pZ)return a.formatDistance("xDays",1,u);if(y<Iv){var C=Math.round(y/fA);return a.formatDistance("xDays",C,u)}else if(y<mZ)return w=Math.round(y/Iv),a.formatDistance("aboutXMonths",w,u)}if(w=RQ(p,f),w<12){var T=Math.round(y/Iv);return a.formatDistance("xMonths",T,u)}else{var N=w%12,k=Math.floor(w/12);return N<3?a.formatDistance("aboutXYears",k,u):N<9?a.formatDistance("overXYears",k,u):a.formatDistance("almostXYears",k+1,u)}}function hA(t,e){return fi(1,arguments),gZ(t,Date.now(),e)}const pA={add:{icon:sb,color:"text-green-400",label:"Added"},remove:{icon:hh,color:"text-red-400",label:"Removed"},move:{icon:WP,color:"text-blue-400",label:"Moved"},copy:{icon:e5,color:"text-purple-400",label:"Copied"},reorder:{icon:RA,color:"text-amber-400",label:"Reordered"},measure:{icon:lb,color:"text-cyan-400",label:"Field Change"}},mA={applied:{label:"Applied",color:"bg-emerald-500/20 text-emerald-400 border-emerald-500/30"},undone:{label:"Undone",color:"bg-red-500/20 text-red-400 border-red-500/30"},redone:{label:"Redone",color:"bg-blue-500/20 text-blue-400 border-blue-500/30"}};function yZ({transaction:t,instancesById:e,containersById:n,panelsById:r,fieldsById:i,onUndo:o,onRedo:a}){const[c,u]=x.useState(!1),f=t.state==="undone",p=t.state==="redone",g=t.state==="applied"||t.state==="redone",v=t.state==="undone",y=t.timestamp?hA(new Date(t.timestamp),{addSuffix:!0}):"Unknown time",w=t.undoneAt?hA(new Date(t.undoneAt),{addSuffix:!0}):null,S=t.operations?.[0],C=S?.occurrenceList?.action||S?.type||"unknown",T=pA[C]||pA.measure,N=T.icon,k=mA[t.state]||mA.applied,D=x.useCallback(()=>{if(!S)return"Unknown operation";if(S.type==="occurrence_list"&&S.occurrenceList){const O=S.occurrenceList,I=e[O.instanceId],z=n[O.from?.containerId],U=n[O.to?.containerId],Y=r[O.from?.panelId],W=r[O.to?.panelId],j=I?.label||"Item";switch(O.action){case"add":return`${j} added to ${U?.label||W?.label||"container"}`;case"remove":return`${j} removed from ${z?.label||Y?.label||"container"}`;case"move":return`${j} moved from ${z?.label||"?"} to ${U?.label||"?"}`;case"copy":return`${j} copied to ${U?.label||"?"}`;default:return`${O.action} operation on ${j}`}}if(S.type==="measure"&&S.measure){const O=S.measure,I=i[O.fieldId],z=e[O.instanceId],U=I?.name||"Field",Y=z?.label||"Item";return O.previousValue!==void 0&&O.previousValue!==O.value?`${U} on ${Y}: ${O.previousValue}  ${O.value}`:`${U} on ${Y} set to ${O.value}`}if(S.type==="entity"&&S.entity){const O=S.entity;return`${O.action} ${O.entityType}`}return"Unknown operation"},[S,e,n,r,i]),M=O=>{O.stopPropagation(),o?.(t.id)},R=O=>{O.stopPropagation(),a?.(t.id)};return h.jsxs("div",{className:`
        transaction-row border-b border-border/50 py-2 px-3
        hover:bg-muted/30 cursor-pointer transition-colors
        ${c?"bg-muted/20":""}
        ${f?"opacity-60":""}
      `,onClick:()=>u(!c),children:[h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("div",{className:`w-0.5 h-8 rounded-full ${f?"bg-red-500":p?"bg-blue-500":"bg-emerald-500"}`}),h.jsx("div",{className:`p-1.5 rounded ${T.color} bg-current/10`,children:h.jsx(N,{className:"w-3.5 h-3.5"})}),h.jsxs("div",{className:"flex-1 min-w-0",children:[h.jsx("div",{className:`text-sm truncate ${f?"line-through text-muted-foreground":""}`,children:D()}),h.jsxs("div",{className:"flex items-center gap-2 text-[10px] text-muted-foreground",children:[h.jsx(ph,{className:"w-3 h-3"}),h.jsx("span",{children:y}),f&&w&&h.jsxs("span",{className:"text-red-400",children:["(undone ",w,")"]})]})]}),h.jsx("div",{className:`text-[9px] px-1.5 py-0.5 rounded border ${k.color}`,children:k.label}),h.jsxs("div",{className:"flex items-center gap-1",onClick:O=>O.stopPropagation(),children:[g&&h.jsx(_e,{variant:"ghost",size:"icon",className:"h-6 w-6 hover:bg-amber-500/20",onClick:M,title:"Undo this transaction",children:h.jsx(hb,{className:"w-3 h-3 text-amber-400"})}),v&&h.jsx(_e,{variant:"ghost",size:"icon",className:"h-6 w-6 hover:bg-blue-500/20",onClick:R,title:"Redo this transaction",children:h.jsx(db,{className:"w-3 h-3 text-blue-400"})})]})]}),c&&h.jsxs("div",{className:"mt-2 ml-8 pl-4 border-l-2 border-border/50 text-xs space-y-1 text-muted-foreground",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("span",{className:"text-muted-foreground/60",children:"ID:"}),h.jsx("code",{className:"text-[10px] bg-muted px-1 rounded",children:t.id})]}),t.operations?.length>1&&h.jsxs("div",{children:[t.operations.length," operations in this transaction"]}),S?.type==="occurrence_list"&&S.occurrenceList?.from&&h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("span",{children:"From:"}),h.jsx("span",{className:"text-foreground",children:n[S.occurrenceList.from.containerId]?.label||r[S.occurrenceList.from.panelId]?.label||"Unknown"})]}),S?.type==="occurrence_list"&&S.occurrenceList?.to&&h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("span",{children:"To:"}),h.jsx("span",{className:"text-foreground",children:n[S.occurrenceList.to.containerId]?.label||r[S.occurrenceList.to.panelId]?.label||"Unknown"})]}),S?.type==="measure"&&S.measure&&h.jsxs(h.Fragment,{children:[h.jsxs("div",{children:["Previous: ",S.measure.previousValue??"none"]}),h.jsxs("div",{children:["New: ",S.measure.value]}),h.jsxs("div",{children:["Flow: ",S.measure.flow||"in"]})]}),f&&h.jsxs("div",{className:"flex items-center gap-2 text-red-400",children:[h.jsx(Hl,{className:"w-3 h-3"}),h.jsxs("span",{children:["Undone by ",t.undoneBy||"user"]})]})]})]})}function vZ({open:t,onOpenChange:e,gridId:n}){const{socket:r,instancesById:i,containersById:o,panelsById:a,fieldsById:c}=x.useContext(Rn),[u,f]=x.useState([]),[p,g]=x.useState(!1),[v,y]=x.useState({type:"all",state:"all",search:""});x.useEffect(()=>{if(!t||!n||!r)return;g(!0),r.emit("get_transactions",{gridId:n,includeUndone:!0});const k=({transactions:D})=>{f(D||[]),g(!1)};return r.on("transactions",k),()=>{r.off("transactions",k)}},[t,n,r]);const w=x.useCallback(()=>{!n||!r||(g(!0),r.emit("get_transactions",{gridId:n,includeUndone:!0}))},[n,r]),S=x.useCallback(k=>{r&&(r.emit("undo_transaction",{transactionId:k,gridId:n}),bl.info("Undoing transaction..."))},[r,n]),C=x.useCallback(k=>{r&&(r.emit("redo_transaction",{transactionId:k,gridId:n}),bl.info("Redoing transaction..."))},[r,n]);x.useEffect(()=>{if(!r)return;const k=()=>{w()};return r.on("undo_result",k),r.on("redo_result",k),()=>{r.off("undo_result",k),r.off("redo_result",k)}},[r,w]);const T=x.useMemo(()=>u.filter(k=>{if(v.state!=="all"&&k.state!==v.state||v.type!=="all"&&!k.operations?.some(M=>v.type==="move"?M.type==="occurrence_list"&&["move","copy","add","remove"].includes(M.occurrenceList?.action):v.type==="measure"?M.type==="measure":!0))return!1;if(v.search){const D=v.search.toLowerCase();if(!k.id?.toLowerCase().includes(D))return!1}return!0}),[u,v]),N=x.useMemo(()=>{const k=u.filter(M=>M.state==="applied"||M.state==="redone").length,D=u.filter(M=>M.state==="undone").length;return{applied:k,undone:D,total:u.length}},[u]);return h.jsx(QR,{open:t,onOpenChange:e,children:h.jsxs(z0,{className:"max-w-2xl max-h-[80vh] flex flex-col",children:[h.jsx(B0,{children:h.jsxs(F0,{className:"flex items-center gap-2",children:[h.jsx(ph,{className:"w-5 h-5"}),"Transaction History",h.jsxs("span",{className:"text-xs font-normal text-muted-foreground ml-2",children:[N.applied," active, ",N.undone," undone"]})]})}),h.jsxs("div",{className:"flex items-center gap-3 py-2 border-b",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx(O3,{className:"w-4 h-4 text-muted-foreground"}),h.jsxs(Pt,{value:v.type,onValueChange:k=>y(D=>({...D,type:k})),children:[h.jsx(zt,{className:"h-7 w-28 text-xs",children:h.jsx(Bt,{})}),h.jsxs(Ft,{children:[h.jsx(wt,{value:"all",children:"All Types"}),h.jsx(wt,{value:"move",children:"Moves"}),h.jsx(wt,{value:"measure",children:"Fields"})]})]}),h.jsxs(Pt,{value:v.state,onValueChange:k=>y(D=>({...D,state:k})),children:[h.jsx(zt,{className:"h-7 w-28 text-xs",children:h.jsx(Bt,{})}),h.jsxs(Ft,{children:[h.jsx(wt,{value:"all",children:"All States"}),h.jsx(wt,{value:"applied",children:"Applied"}),h.jsx(wt,{value:"undone",children:"Undone"}),h.jsx(wt,{value:"redone",children:"Redone"})]})]})]}),h.jsx(Kt,{type:"text",placeholder:"Search...",value:v.search,onChange:k=>y(D=>({...D,search:k.target.value})),className:"h-7 text-xs flex-1"}),h.jsx(_e,{variant:"outline",size:"sm",className:"h-7",onClick:w,disabled:p,children:h.jsx(rC,{className:`w-3.5 h-3.5 ${p?"animate-spin":""}`})})]}),h.jsx(qj,{className:"flex-1 -mx-6 px-6",children:p&&u.length===0?h.jsxs("div",{className:"flex items-center justify-center py-12 text-muted-foreground",children:[h.jsx(rC,{className:"w-5 h-5 animate-spin mr-2"}),"Loading transactions..."]}):T.length===0?h.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-muted-foreground",children:[h.jsx(ph,{className:"w-8 h-8 mb-2 opacity-50"}),h.jsx("div",{children:"No transactions found"}),h.jsx("div",{className:"text-xs mt-1",children:v.type!=="all"||v.state!=="all"||v.search?"Try adjusting your filters":"Transactions will appear here as you make changes"})]}):h.jsx("div",{children:T.map(k=>h.jsx(yZ,{transaction:k,instancesById:i,containersById:o,panelsById:a,fieldsById:c,onUndo:S,onRedo:C},k.id))})}),h.jsxs("div",{className:"flex items-center justify-between pt-3 border-t text-xs text-muted-foreground",children:[h.jsxs("span",{children:[T.length," of ",u.length," transactions"]}),h.jsx(_e,{variant:"ghost",size:"sm",className:"h-7 text-xs",onClick:()=>e(!1),children:"Close"})]})]})})}function xZ({size:t="md",className:e}){const n={xs:"h-3 w-3 border",sm:"h-4 w-4 border-2",md:"h-6 w-6 border-2",lg:"h-8 w-8 border-4"};return h.jsx("div",{className:Wt("animate-spin rounded-full border-muted border-t-foreground",n[t],e),"aria-label":"Loading",role:"status"})}function bZ({label:t="Loading"}){return h.jsxs("div",{className:"absolute inset-0 z-50 flex flex-col items-center justify-center bg-background/60 backdrop-blur-sm gap-4",children:[h.jsx("img",{src:"/moduli_logo_true_vector.svg",alt:"Moduli",className:"w-16 h-16 opacity-80"}),h.jsxs("div",{className:"flex items-center gap-3 rounded-md border border-border bg-background px-4 py-2 shadow-lg",children:[h.jsx(xZ,{}),h.jsx("span",{className:"text-sm text-muted-foreground",children:t})]})]})}function wZ(t,e,n){const[r,i]=x.useState(!1),[o,a]=x.useState(!1),[c,u]=x.useState(null),[f,p]=x.useState(null),[g,v]=x.useState(!1),y=x.useCallback(()=>{!t||!e||t.emit("get_undo_state",{gridId:e})},[t,e]);x.useEffect(()=>{if(!t)return;const C=({canUndo:D,canRedo:M,lastUndoableId:R,lastRedoableId:O})=>{i(D),a(M),u(R),p(O)},T=({success:D,transactionId:M,reversedOps:R,animate:O,error:I})=>{v(!1),D?(bl.success("Undone",{duration:1500}),y()):bl.error(`Undo failed: ${I||"Unknown error"}`)},N=({success:D,transactionId:M,error:R})=>{v(!1),D?(bl.success("Redone",{duration:1500}),y()):bl.error(`Redo failed: ${R||"Unknown error"}`)},k=()=>{y()};return t.on("undo_state",C),t.on("undo_result",T),t.on("redo_result",N),t.on("sync_state",k),y(),()=>{t.off("undo_state",C),t.off("undo_result",T),t.off("redo_result",N),t.off("sync_state",k)}},[t,y,n]),x.useEffect(()=>{y()},[e,y]);const w=x.useCallback(()=>{!t||!r||!c||g||(v(!0),t.emit("undo_transaction",{transactionId:c,gridId:e}))},[t,r,c,g,e]),S=x.useCallback(()=>{!t||!o||!f||g||(v(!0),t.emit("redo_transaction",{transactionId:f,gridId:e}))},[t,o,f,g,e]);return{canUndo:r,canRedo:o,undo:w,redo:S,isProcessing:g,refreshUndoState:y}}function SZ({onUndo:t,onRedo:e,enabled:n=!0}){const r=x.useCallback(i=>{if(!n)return;const o=i.target,a=o.tagName.toLowerCase();if(!(a==="input"||a==="textarea"||o.isContentEditable||!(i.ctrlKey||i.metaKey))){if(i.key==="z"&&!i.shiftKey){i.preventDefault(),t?.();return}if(i.key==="y"||i.key==="z"&&i.shiftKey||i.key==="Z"&&i.shiftKey){i.preventDefault(),e?.();return}}},[n,t,e]);x.useEffect(()=>{if(n)return window.addEventListener("keydown",r),()=>window.removeEventListener("keydown",r)},[n,r])}function EZ(t=[],e=1,n=1){const r=new Set(t.map(i=>`${i.row}-${i.col}`));for(let i=0;i<e;i++)for(let o=0;o<n;o++){const a=`${i}-${o}`;if(!r.has(a))return{row:i,col:o}}return{row:0,col:0}}function CZ(){const{state:t,dispatch:e}=aJ(),n=x.useMemo(()=>Zr(t.instances),[t.instances]),r=x.useMemo(()=>Zr(t.occurrences),[t.occurrences]),i=x.useMemo(()=>Zr(t.containers),[t.containers]),o=x.useMemo(()=>Zr(t.fields),[t.fields]),a=x.useMemo(()=>Zr(t.manifests),[t.manifests]),c=x.useMemo(()=>Zr(t.views),[t.views]),u=x.useMemo(()=>Zr(t.docs),[t.docs]),f=x.useMemo(()=>Zr(t.folders),[t.folders]),p=x.useMemo(()=>Zr(t.artifacts),[t.artifacts]),[g,v]=x.useState(!1),{canUndo:y,canRedo:w,undo:S,redo:C,isProcessing:T}=wZ(Lt,t.grid?._id);SZ({onUndo:S,onRedo:C,enabled:!T});const[N,k]=x.useState(""),[D,M]=x.useState("1"),[R,O]=x.useState("1"),I=t?.grid?.iterations||[{id:"default",name:"Daily",timeFilter:"daily"}],[z,U]=x.useState(t?.grid?.selectedIterationId||"default"),[Y,W]=x.useState(t?.grid?.currentIterationValue?new Date(t.grid.currentIterationValue):new Date),j=t?.grid?.categoryDimensions||[],[G,oe]=x.useState(t?.grid?.selectedCategoryId||null),[L,$]=x.useState(t?.grid?.currentCategoryValue||null);x.useEffect(()=>{t?.grid?(k(t.grid.name||""),M(String(t.grid.rows??1)),O(String(t.grid.cols??1)),t.grid.selectedIterationId&&U(t.grid.selectedIterationId),t.grid.currentIterationValue&&W(new Date(t.grid.currentIterationValue)),t.grid.selectedCategoryId!==void 0&&oe(t.grid.selectedCategoryId),t.grid.currentCategoryValue!==void 0&&$(t.grid.currentCategoryValue)):(k(""),M("1"),O("1"))},[t?.grid?._id,t?.grid?.name,t?.grid?.rows,t?.grid?.cols]),x.useEffect(()=>{const X=RP(Lt,e);if(!localStorage.getItem("moduli-token"))return()=>X?.();let Ce=!1;const Oe=()=>{if(Ce)return;Ce=!0;const Ye=localStorage.getItem("moduli-gridId");Lt.emit("request_full_state",Ye?{gridId:Ye}:void 0)};return Lt.connected?Oe():Lt.once("connect",Oe),()=>{Lt.off("connect",Oe),X?.()}},[e]);const V=X=>{const ve=X.target.value;!ve||ve===t.gridId||(e({type:ue.SET_GRID_ID,payload:ve}),localStorage.setItem("moduli-gridId",ve),Lt.emit("request_full_state",{gridId:ve}))},we=()=>{localStorage.removeItem("moduli-gridId"),Lt.emit("request_full_state")},pe=x.useCallback(X=>{const ve=t?.gridId||t?.grid?._id;if(!ve)return;const Ce=String(X??N??"").trim();Ce&&ti({dispatch:e,socket:Lt,gridId:ve,grid:{name:Ce},emit:!0})},[e,t?.gridId,t?.grid?._id,N]),P=x.useCallback(X=>{const ve=t?.gridId||t?.grid?._id;if(!ve)return;const Ce=Math.max(1,Number(X)||1);ti({dispatch:e,socket:Lt,gridId:ve,grid:{rows:Ce},emit:!0})},[e,t?.gridId,t?.grid?._id]),K=x.useCallback(X=>{const ve=t?.gridId||t?.grid?._id;if(!ve)return;const Ce=Math.max(1,Number(X)||1);ti({dispatch:e,socket:Lt,gridId:ve,grid:{cols:Ce},emit:!0})},[e,t?.gridId,t?.grid?._id]),B=x.useCallback((X="board")=>{if(!t.gridId||!t.grid||!t.userId)return;const ve=crypto.randomUUID(),{row:Ce,col:Oe}=EZ(t.panels||[],t.grid.rows??1,t.grid.cols??1),Ye=(t.panels?.length||0)+1,at={id:ve,kind:X,occurrences:[],layout:{name:`${{board:"Board",notebook:"Notebook",doc:"Doc",mixed:"Mixed"}[X]||"Panel"} ${Ye}`}};mR({dispatch:e,socket:Lt,grid:t.grid,panel:at,placement:{row:Ce,col:Oe,width:1,height:1},userId:t.userId,emit:!0})},[e,t.gridId,t.grid,t.panels,t.userId]),Z=x.useCallback((X,ve="list")=>{if(!X||!t.gridId||!t.userId)return;const Ce=crypto.randomUUID(),Ye=`${{list:"List",doc:"Doc",log:"Log",smart:"Smart"}[ve]||"List"} ${(t.containers?.length||0)+1}`,et={id:Ce,label:Ye,kind:ve,occurrences:[]},at=(t.panels||[]).find(ct=>ct.id===X);at&&gR({dispatch:e,socket:Lt,gridId:t.gridId,panel:at,container:et,userId:t.userId,emit:!0})},[e,t.gridId,t.userId,t.containers,t.panels,Lt]),le=x.useCallback(X=>{if(!X||!t.gridId||!t.userId)return;const ve=crypto.randomUUID(),Ce=`Item ${(t.instances?.length||0)+1}`,Oe={id:ve,label:Ce},Ye=(t.containers||[]).find(et=>et.id===X);Ye&&uh({dispatch:e,socket:Lt,gridId:t.gridId,container:Ye,instance:Oe,userId:t.userId,emit:!0})},[e,t.instances,t.gridId,t.userId,t.containers,Lt]),be=x.useCallback(()=>{const X=t?.gridId||t?.grid?._id;X&&MG({dispatch:e,socket:Lt,gridId:X,emit:!0})},[e,t?.gridId,t?.grid?._id]),H=x.useCallback(X=>{U(X);const ve=t?.gridId||t?.grid?._id;ve&&ti({dispatch:e,socket:Lt,gridId:ve,grid:{selectedIterationId:X},emit:!0})},[e,t?.gridId,t?.grid?._id]),ce=x.useCallback(X=>{W(X);const ve=t?.gridId||t?.grid?._id;ve&&ti({dispatch:e,socket:Lt,gridId:ve,grid:{currentIterationValue:X.toISOString()},emit:!0});const Ce=t?.folders||[],Oe=t?.docs||[],Ye=Ce.find(et=>et.folderType==="day-pages");if(Ye){const et=X.toISOString().slice(0,10);if(!Oe.find(ct=>ct.folderId===Ye.id&&ct.title===et)){const ct=crypto.randomUUID();yl({dispatch:e,socket:Lt,doc:{id:ct,userId:t?.userId,gridId:ve,folderId:Ye.id,manifestId:Ye.manifestId||null,title:et,docType:"day-page",sortOrder:Date.now(),content:{type:"doc",content:[{type:"heading",attrs:{level:2},content:[{type:"text",text:et}]},{type:"paragraph",content:[]}]}},emit:!0})}}},[e,t?.gridId,t?.grid?._id,t?.folders,t?.docs,t?.userId]),te=x.useCallback(X=>{oe(X);const ve=t?.gridId||t?.grid?._id;ve&&ti({dispatch:e,socket:Lt,gridId:ve,grid:{selectedCategoryId:X},emit:!0})},[e,t?.gridId,t?.grid?._id]),me=x.useCallback(X=>{$(X);const ve=t?.gridId||t?.grid?._id;ve&&ti({dispatch:e,socket:Lt,gridId:ve,grid:{currentCategoryValue:X},emit:!0})},[e,t?.gridId,t?.grid?._id]),Te=x.useCallback(X=>{const ve=t?.gridId||t?.grid?._id;ve&&ti({dispatch:e,socket:Lt,gridId:ve,grid:{categoryDimensions:X},emit:!0})},[e,t?.gridId,t?.grid?._id]),re=x.useCallback(X=>{const ve=t?.gridId||t?.grid?._id;ve&&ti({dispatch:e,socket:Lt,gridId:ve,grid:{iterations:X},emit:!0})},[e,t?.gridId,t?.grid?._id]),he=x.useCallback(X=>{const ve=t?.gridId||t?.grid?._id;if(!ve||!t.userId)return;const Ce={...X,gridId:ve,userId:t.userId};e({type:ue.CREATE_FIELD,payload:Ce}),Lt.emit("create_field",{field:Ce})},[e,t?.gridId,t?.grid?._id,t.userId]),Ae=x.useCallback(X=>{X?.id&&(e({type:ue.UPDATE_FIELD,payload:X}),Lt.emit("update_field",{field:X}))},[e]),Re=x.useCallback(X=>{X&&(e({type:ue.DELETE_FIELD,payload:X}),Lt.emit("delete_field",{fieldId:X}))},[e]),Le=x.useMemo(()=>({state:{userId:t.userId,gridId:t.gridId,grid:t.grid,panels:t.panels||[],containers:t.containers||[],instances:t.instances||[],occurrences:t.occurrences||[],fields:t.fields||[],activeId:t.activeId,activeSize:t.activeSize,softTick:t.softTick,containersById:i,panelsById:Zr(t.panels),selectedIterationId:z,currentIterationValue:Y}}),[t.userId,t.gridId,t.grid,t.panels,t.containers,t.instances,t.occurrences,t.fields,t.activeId,t.activeSize,t.softTick,i,z,Y]),ae=x.useMemo(()=>Zr(t.panels),[t.panels]),Me=x.useMemo(()=>({socket:Lt,dispatch:e,state:t,instancesById:n,occurrencesById:r,containersById:i,fieldsById:o,panelsById:ae,manifestsById:a,viewsById:c,docsById:u,foldersById:f,artifactsById:p,addContainerToPanel:Z,addInstanceToContainer:le,createField:he,updateField:Ae,deleteField:Re,onCommitIterations:re,iterations:I,selectedIterationId:z,currentIterationValue:Y,onSelectIteration:H,onIterationValueChange:ce,categoryDimensions:j,selectedCategoryId:G,currentCategoryValue:L,onSelectCategory:te,onCategoryValueChange:me,onCommitCategoryDimensions:Te,canUndo:y,canRedo:w,undo:S,redo:C,isProcessing:T}),[e,t,n,r,i,o,ae,a,c,u,f,p,Z,le,he,Ae,Re,re,I,z,Y,H,ce,j,G,L,te,me,Te,y,w,S,C,T]),J=x.useMemo(()=>({SortableContainer:NJ,Instance:Oj,SortableInstance:Mj}),[]);return t.userId?h.jsx(Rn.Provider,{value:Me,children:h.jsxs(lm.Provider,{value:Le,children:[h.jsx(IJ,{gridId:t.gridId,availableGrids:t.availableGrids||[],gridName:N,setGridName:k,rowInput:D,setRowInput:M,colInput:R,setColInput:O,onGridChange:V,onCreateNewGrid:we,onCommitGridName:pe,onUpdateRows:P,onUpdateCols:K,onAddPanel:B,onDeleteGrid:be,onCommitIterations:re,iterations:I,selectedIterationId:z,onSelectIteration:H,currentIterationValue:Y,onIterationValueChange:ce,categoryDimensions:j,selectedCategoryId:G,currentCategoryValue:L,onSelectCategory:te,onCategoryValueChange:me,onUndo:S,onRedo:C,canUndo:y&&!T,canRedo:w&&!T,onHistory:()=>v(!0)}),h.jsx(vZ,{open:g,onOpenChange:v,gridId:t.gridId}),h.jsx("div",{className:"app-root grid-frame bg-background2 ring-1 ring-black/40 rounded-xl p-3 shadow-inner border border-border",children:t.grid?._id?h.jsx(eJ,{components:J}):h.jsx(bZ,{label:"Syncing grid"})}),h.jsx(wQ,{})]})}):h.jsx(tJ,{})}mL.createRoot(document.getElementById("root")).render(h.jsx(CZ,{}));
